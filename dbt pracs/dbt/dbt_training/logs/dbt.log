[0m12:51:14.675228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FF490F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FF71E6230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FF71E6050>]}


============================== 12:51:14.681225 | 96553491-2c33-4cf4-ac18-6ca74bb1ba92 ==============================
[0m12:51:14.681225 [info ] [MainThread]: Running with dbt=1.7.9
[0m12:51:14.682225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:51:14.683242 [info ] [MainThread]: dbt version: 1.7.9
[0m12:51:14.684223 [info ] [MainThread]: python version: 3.10.0
[0m12:51:14.684223 [info ] [MainThread]: python path: C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\python.exe
[0m12:51:14.685223 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m12:51:14.689229 [info ] [MainThread]: Using profiles dir at C:\Users\NadimintiDeepthi\.dbt
[0m12:51:14.690165 [info ] [MainThread]: Using profiles.yml file at C:\Users\NadimintiDeepthi\.dbt\profiles.yml
[0m12:51:14.690664 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\NadimintiDeepthi\Desktop\dbt\dbt_training\dbt_project.yml
[0m12:51:14.780836 [info ] [MainThread]: Configuration:
[0m12:51:14.780836 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m12:51:14.781852 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:51:14.781852 [info ] [MainThread]: Required dependencies:
[0m12:51:14.782851 [debug] [MainThread]: Executing "git --help"
[0m12:51:14.827811 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:51:14.828825 [debug] [MainThread]: STDERR: "b''"
[0m12:51:14.828825 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:51:14.829829 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:51:14.830811 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:51:14.830811 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'dbt_training'


[0m12:51:14.833808 [debug] [MainThread]: Command `dbt debug` failed at 12:51:14.832813 after 0.24 seconds
[0m12:51:14.834806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FF490F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FF71B40D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FF71B48E0>]}
[0m12:51:14.835807 [debug] [MainThread]: Flushing usage events
[0m12:53:59.028005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C30510ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3079E61A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3079E5FC0>]}


============================== 12:53:59.035015 | 13a4b8bd-8a35-48d8-83b8-5d12aa642621 ==============================
[0m12:53:59.035015 [info ] [MainThread]: Running with dbt=1.7.9
[0m12:53:59.036014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:53:59.037002 [info ] [MainThread]: dbt version: 1.7.9
[0m12:53:59.037002 [info ] [MainThread]: python version: 3.10.0
[0m12:53:59.038001 [info ] [MainThread]: python path: C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\python.exe
[0m12:53:59.038999 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m12:53:59.307717 [info ] [MainThread]: Using profiles dir at C:\Users\NadimintiDeepthi\.dbt
[0m12:53:59.308718 [info ] [MainThread]: Using profiles.yml file at C:\Users\NadimintiDeepthi\.dbt\profiles.yml
[0m12:53:59.309717 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\NadimintiDeepthi\Desktop\dbt\dbt_training\dbt_project.yml
[0m12:53:59.311264 [info ] [MainThread]: adapter type: sqlserver
[0m12:53:59.311264 [info ] [MainThread]: adapter version: 1.7.4
[0m12:53:59.402227 [info ] [MainThread]: Configuration:
[0m12:53:59.403226 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:53:59.404231 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:53:59.406211 [info ] [MainThread]: Required dependencies:
[0m12:53:59.406211 [debug] [MainThread]: Executing "git --help"
[0m12:53:59.452185 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:53:59.452185 [debug] [MainThread]: STDERR: "b''"
[0m12:53:59.453184 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:53:59.454186 [info ] [MainThread]: Connection:
[0m12:53:59.455187 [info ] [MainThread]:   server: DESKTOP-GLV0LAC
[0m12:53:59.457182 [info ] [MainThread]:   database: master
[0m12:53:59.457182 [info ] [MainThread]:   schema: dbt
[0m12:53:59.458182 [info ] [MainThread]:   UID: None
[0m12:53:59.459181 [info ] [MainThread]:   client_id: None
[0m12:53:59.460180 [info ] [MainThread]:   authentication: Windows Login
[0m12:53:59.460180 [info ] [MainThread]:   encrypt: False
[0m12:53:59.461179 [info ] [MainThread]:   trust_cert: False
[0m12:53:59.462179 [info ] [MainThread]:   retries: 1
[0m12:53:59.462179 [info ] [MainThread]:   login_timeout: 0
[0m12:53:59.463178 [info ] [MainThread]:   query_timeout: 0
[0m12:53:59.463178 [info ] [MainThread]:   port: 1433
[0m12:53:59.464188 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m12:53:59.465179 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m12:53:59.466187 [debug] [MainThread]: Using sqlserver connection "debug"
[0m12:53:59.466187 [debug] [MainThread]: On debug: select 1 as id
[0m12:53:59.467186 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:59.467186 [debug] [MainThread]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m12:53:59.569417 [debug] [MainThread]: fabric adapter: Connected to db: master
[0m12:53:59.570761 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:53:59.571764 [debug] [MainThread]: On debug: Close
[0m12:53:59.572958 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:53:59.573569 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:53:59.575570 [debug] [MainThread]: Command `dbt debug` succeeded at 12:53:59.575570 after 0.63 seconds
[0m12:53:59.575570 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:53:59.576569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C30510ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C305A23970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3079B4E50>]}
[0m12:53:59.576569 [debug] [MainThread]: Flushing usage events
[0m14:05:04.266177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BFD3F5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C2616380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C26161A0>]}


============================== 14:05:04.272171 | dd37930f-2c9e-40eb-9c91-c96024480690 ==============================
[0m14:05:04.272171 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:05:04.273173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:04.916543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd37930f-2c9e-40eb-9c91-c96024480690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C2616440>]}
[0m14:05:05.021486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd37930f-2c9e-40eb-9c91-c96024480690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C2DA83A0>]}
[0m14:05:05.022498 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m14:05:05.045480 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:05:05.046506 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:05.047472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dd37930f-2c9e-40eb-9c91-c96024480690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C2D37670>]}
[0m14:05:07.506404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd37930f-2c9e-40eb-9c91-c96024480690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C333FF10>]}
[0m14:05:07.532389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd37930f-2c9e-40eb-9c91-c96024480690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C2D6A590>]}
[0m14:05:07.533388 [info ] [MainThread]: Found 4 models, 2 tests, 3 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:05:07.533388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd37930f-2c9e-40eb-9c91-c96024480690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C2D693F0>]}
[0m14:05:07.536387 [info ] [MainThread]: 
[0m14:05:07.537386 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:05:07.539384 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice'
[0m14:05:07.554378 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m14:05:07.555377 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m14:05:07.555377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:07.556377 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:05:07.605938 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:05:07.608511 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.610514 [debug] [ThreadPool]: On list_practice: Close
[0m14:05:07.614511 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m14:05:07.614511 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m14:05:07.615510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:07.615510 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:05:07.617772 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:05:07.619057 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.620058 [debug] [ThreadPool]: On list_practice: Close
[0m14:05:07.621057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice, now create_practice_dbt_mart)
[0m14:05:07.622881 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "dbt_mart"
"
[0m14:05:07.628880 [debug] [ThreadPool]: Using sqlserver connection "create_practice_dbt_mart"
[0m14:05:07.628880 [debug] [ThreadPool]: On create_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_dbt_mart"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m14:05:07.628880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:07.629879 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:05:07.629879 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:05:07.639986 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.641004 [debug] [ThreadPool]: On create_practice_dbt_mart: COMMIT
[0m14:05:07.642002 [debug] [ThreadPool]: On create_practice_dbt_mart: Close
[0m14:05:07.643001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_practice_dbt_mart, now create_practice_dbt_staging)
[0m14:05:07.644001 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "dbt_staging"
"
[0m14:05:07.646999 [debug] [ThreadPool]: Using sqlserver connection "create_practice_dbt_staging"
[0m14:05:07.647998 [debug] [ThreadPool]: On create_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_dbt_staging"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m14:05:07.647998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:07.647998 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:05:07.648998 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:05:07.652143 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.653145 [debug] [ThreadPool]: On create_practice_dbt_staging: COMMIT
[0m14:05:07.653145 [debug] [ThreadPool]: On create_practice_dbt_staging: Close
[0m14:05:07.655142 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice_dbt_mart'
[0m14:05:07.663140 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_mart"
[0m14:05:07.664139 [debug] [ThreadPool]: On list_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m14:05:07.664139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:07.665139 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:05:07.665139 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:05:07.678144 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.679131 [debug] [ThreadPool]: On list_practice_dbt_mart: ROLLBACK
[0m14:05:07.680645 [debug] [ThreadPool]: On list_practice_dbt_mart: Close
[0m14:05:07.681671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_mart, now list_practice_dbt_staging)
[0m14:05:07.684645 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_staging"
[0m14:05:07.684645 [debug] [ThreadPool]: On list_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m14:05:07.685664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:07.685664 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:05:07.686644 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:05:07.695221 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.696223 [debug] [ThreadPool]: On list_practice_dbt_staging: ROLLBACK
[0m14:05:07.697222 [debug] [ThreadPool]: On list_practice_dbt_staging: Close
[0m14:05:07.698221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd37930f-2c9e-40eb-9c91-c96024480690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C337DE40>]}
[0m14:05:07.698221 [debug] [MainThread]: On master: COMMIT
[0m14:05:07.699235 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:05:07.700221 [info ] [MainThread]: 
[0m14:05:07.705619 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_customers
[0m14:05:07.706622 [info ] [Thread-1 (]: 1 of 4 START sql view model practice.dbt_staging.stg_customers ................. [RUN]
[0m14:05:07.707078 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_training.stg_customers'
[0m14:05:07.708079 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_customers
[0m14:05:07.717074 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_customers"
[0m14:05:07.719072 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_customers (compile): 14:05:07.708079 => 14:05:07.719072
[0m14:05:07.721090 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_customers
[0m14:05:07.759051 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:05:07.760051 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customers__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:05:07.761051 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:07.762050 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:05:07.762050 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:05:07.776040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.778039 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:05:07.778039 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customers__dbt_backup";');

[0m14:05:07.779300 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.783299 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:05:07.783299 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customers'
  
[0m14:05:07.792642 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.802830 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_customers"
[0m14:05:07.805830 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:05:07.805830 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */
USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_customers" as 


WITH

required_fields AS (

    SELECT

        id                  AS customer_id
        , first_name
        , last_name

    FROM "training"."dbo"."jaffle_shop_customers"

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , first_name
        , last_name

    FROM required_fields

),

add_aggregate_field AS (

    SELECT 

        *
        , CONCAT(last_name, first_name)     AS full_name
        , getdate()                         AS data_loaded_at

    FROM datatype_conversion

)

SELECT * FROM add_aggregate_field;');



[0m14:05:07.814381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.816396 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_customers (execute): 14:05:07.721090 => 14:05:07.815397
[0m14:05:07.816396 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: ROLLBACK
[0m14:05:07.817395 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: Close
[0m14:05:07.817395 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_training\models\staging\stg_customers.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'training.dbo.jaffle_shop_customers'. (208) (SQLMoreResults)")
[0m14:05:07.901909 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'training.dbo.jaffle_shop_customers'. (208) (SQLMoreResults)")

[0m14:05:07.902909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd37930f-2c9e-40eb-9c91-c96024480690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C33F0D60>]}
[0m14:05:07.902909 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model practice.dbt_staging.stg_customers ........ [[31mERROR[0m in 0.19s]
[0m14:05:07.904903 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_customers
[0m14:05:07.904903 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_orders
[0m14:05:07.905903 [info ] [Thread-1 (]: 2 of 4 START sql view model practice.dbt_staging.stg_orders .................... [RUN]
[0m14:05:07.906903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_customers, now model.dbt_training.stg_orders)
[0m14:05:07.906903 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_orders
[0m14:05:07.911904 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_orders"
[0m14:05:07.913884 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_orders (compile): 14:05:07.907901 => 14:05:07.912903
[0m14:05:07.913884 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_orders
[0m14:05:07.919894 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:05:07.920893 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_orders__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:05:07.920893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:07.920893 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:05:07.921893 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:05:07.934806 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.936789 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:05:07.937802 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_orders__dbt_backup";');

[0m14:05:07.938874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.940889 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:05:07.941876 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_orders'
  
[0m14:05:07.951883 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.953881 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_orders"
[0m14:05:07.955866 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:05:07.955866 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */
USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_orders" as 

WITH

required_fields AS (

    SELECT

        id                  AS order_id
        , user_id           AS customer_id
        , order_date        AS order_date
        , status

    FROM "training"."dbo"."jaffle_shop_orders"

),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT)               AS order_id
        , CAST(customer_id AS INT)          AS customer_id        
        , CONVERT(date, order_date)         AS order_date
        , status

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m14:05:07.957964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.958980 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_orders (execute): 14:05:07.913884 => 14:05:07.958980
[0m14:05:07.959979 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: ROLLBACK
[0m14:05:07.959979 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: Close
[0m14:05:07.960978 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_training\models\staging\stg_orders.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'training.dbo.jaffle_shop_orders'. (208) (SQLMoreResults)")
[0m14:05:07.963976 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'training.dbo.jaffle_shop_orders'. (208) (SQLMoreResults)")

[0m14:05:07.964981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd37930f-2c9e-40eb-9c91-c96024480690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C34308B0>]}
[0m14:05:07.965963 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model practice.dbt_staging.stg_orders ........... [[31mERROR[0m in 0.06s]
[0m14:05:07.966965 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_orders
[0m14:05:07.967961 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_payments
[0m14:05:07.967961 [info ] [Thread-1 (]: 3 of 4 START sql view model practice.dbt_staging.stg_payments .................. [RUN]
[0m14:05:07.969969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_orders, now model.dbt_training.stg_payments)
[0m14:05:07.969969 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_payments
[0m14:05:07.973967 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_payments"
[0m14:05:07.975354 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_payments (compile): 14:05:07.969969 => 14:05:07.975354
[0m14:05:07.976356 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_payments
[0m14:05:07.983353 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:05:07.984365 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_payments__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:05:07.985351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:07.985351 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:05:07.986364 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:05:07.998343 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:08.000342 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:05:08.000342 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_payments__dbt_backup";');

[0m14:05:08.001349 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:08.003354 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:05:08.004362 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_payments'
  
[0m14:05:08.013334 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:08.016332 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_payments"
[0m14:05:08.017331 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:05:08.018331 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */
USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_payments" as 

WITH

required_fields AS(

    SELECT

        *

    FROM "training"."dbo"."jaffle_shop_payments"

),

datatype_and_renamed AS (

    SELECT

        CAST(id AS INT)             AS id
        , CAST(order_id AS INT)     AS order_id
        , payment_method
        , CAST(amount AS INT)       AS amount

    FROM required_fields

)

SELECT * FROM datatype_and_renamed;');



[0m14:05:08.019876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:08.020892 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_payments (execute): 14:05:07.976356 => 14:05:08.020892
[0m14:05:08.021891 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: ROLLBACK
[0m14:05:08.021891 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: Close
[0m14:05:08.022890 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_training\models\staging\stg_payments.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'training.dbo.jaffle_shop_payments'. (208) (SQLMoreResults)")
[0m14:05:08.024890 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'training.dbo.jaffle_shop_payments'. (208) (SQLMoreResults)")

[0m14:05:08.025888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd37930f-2c9e-40eb-9c91-c96024480690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C338EAA0>]}
[0m14:05:08.025888 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model practice.dbt_staging.stg_payments ......... [[31mERROR[0m in 0.06s]
[0m14:05:08.026875 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_payments
[0m14:05:08.027888 [debug] [Thread-1 (]: Began running node model.dbt_training.customer
[0m14:05:08.028873 [info ] [Thread-1 (]: 4 of 4 SKIP relation dbt_mart.customer ......................................... [[33mSKIP[0m]
[0m14:05:08.029873 [debug] [Thread-1 (]: Finished running node model.dbt_training.customer
[0m14:05:08.031882 [debug] [MainThread]: On master: COMMIT
[0m14:05:08.032886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:08.032886 [debug] [MainThread]: Connection 'create_practice_dbt_staging' was properly closed.
[0m14:05:08.032886 [debug] [MainThread]: Connection 'list_practice_dbt_staging' was properly closed.
[0m14:05:08.033885 [debug] [MainThread]: Connection 'model.dbt_training.stg_payments' was properly closed.
[0m14:05:08.033885 [info ] [MainThread]: 
[0m14:05:08.034870 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m14:05:08.036870 [debug] [MainThread]: Command end result
[0m14:05:08.050861 [info ] [MainThread]: 
[0m14:05:08.052860 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:05:08.052860 [info ] [MainThread]: 
[0m14:05:08.053873 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'training.dbo.jaffle_shop_customers'. (208) (SQLMoreResults)")
[0m14:05:08.054872 [info ] [MainThread]: 
[0m14:05:08.055764 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'training.dbo.jaffle_shop_orders'. (208) (SQLMoreResults)")
[0m14:05:08.056766 [info ] [MainThread]: 
[0m14:05:08.056766 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'training.dbo.jaffle_shop_payments'. (208) (SQLMoreResults)")
[0m14:05:08.057765 [info ] [MainThread]: 
[0m14:05:08.057765 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m14:05:08.059778 [debug] [MainThread]: Command `dbt run` failed at 14:05:08.059778 after 3.90 seconds
[0m14:05:08.060777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BFD3F5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C33F07C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C34C0940>]}
[0m14:05:08.060777 [debug] [MainThread]: Flushing usage events
[0m14:06:59.726321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D145D6CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D148646320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D148646140>]}


============================== 14:06:59.732332 | 75440bd1-352c-4e8e-aa0c-9ef82f3c2087 ==============================
[0m14:06:59.732332 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:06:59.733332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:07:00.122342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75440bd1-352c-4e8e-aa0c-9ef82f3c2087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1486463E0>]}
[0m14:07:00.224283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75440bd1-352c-4e8e-aa0c-9ef82f3c2087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D148DD9750>]}
[0m14:07:00.225282 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m14:07:00.238261 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:07:00.368934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:07:00.370933 [debug] [MainThread]: Partial parsing: updated file: dbt_training://models\source.yml
[0m14:07:00.839646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75440bd1-352c-4e8e-aa0c-9ef82f3c2087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1493110F0>]}
[0m14:07:00.854116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75440bd1-352c-4e8e-aa0c-9ef82f3c2087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D148FC5FC0>]}
[0m14:07:00.855134 [info ] [MainThread]: Found 4 models, 2 tests, 3 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:07:00.856133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75440bd1-352c-4e8e-aa0c-9ef82f3c2087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D148FC4BE0>]}
[0m14:07:00.857132 [info ] [MainThread]: 
[0m14:07:00.859114 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:07:00.861130 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice'
[0m14:07:00.879102 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m14:07:00.880100 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m14:07:00.880100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:00.881100 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:07:00.926407 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:07:00.927030 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.928047 [debug] [ThreadPool]: On list_practice: Close
[0m14:07:00.932028 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m14:07:00.932933 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m14:07:00.932933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:00.932933 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:07:00.933934 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:07:00.934828 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.935848 [debug] [ThreadPool]: On list_practice: Close
[0m14:07:00.936847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice, now create_practice_dbt_mart)
[0m14:07:00.937830 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "dbt_mart"
"
[0m14:07:00.944842 [debug] [ThreadPool]: Using sqlserver connection "create_practice_dbt_mart"
[0m14:07:00.944842 [debug] [ThreadPool]: On create_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_dbt_mart"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m14:07:00.945843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:00.945843 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:07:00.946841 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:07:00.948837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.949836 [debug] [ThreadPool]: On create_practice_dbt_mart: COMMIT
[0m14:07:00.950835 [debug] [ThreadPool]: On create_practice_dbt_mart: Close
[0m14:07:00.951834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_practice_dbt_mart, now create_practice_dbt_staging)
[0m14:07:00.952834 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "dbt_staging"
"
[0m14:07:00.955832 [debug] [ThreadPool]: Using sqlserver connection "create_practice_dbt_staging"
[0m14:07:00.955832 [debug] [ThreadPool]: On create_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_dbt_staging"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m14:07:00.955832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:00.956831 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:07:00.956831 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:07:00.958830 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.959830 [debug] [ThreadPool]: On create_practice_dbt_staging: COMMIT
[0m14:07:00.960830 [debug] [ThreadPool]: On create_practice_dbt_staging: Close
[0m14:07:00.962815 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice_dbt_mart'
[0m14:07:00.968824 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_mart"
[0m14:07:00.969824 [debug] [ThreadPool]: On list_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m14:07:00.969824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:00.969824 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:07:00.970823 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:07:00.971808 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.972826 [debug] [ThreadPool]: On list_practice_dbt_mart: ROLLBACK
[0m14:07:00.973826 [debug] [ThreadPool]: On list_practice_dbt_mart: Close
[0m14:07:00.974825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_mart, now list_practice_dbt_staging)
[0m14:07:00.977824 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_staging"
[0m14:07:00.977824 [debug] [ThreadPool]: On list_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m14:07:00.977824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:00.978824 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:07:00.978824 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:07:00.979823 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:00.981822 [debug] [ThreadPool]: On list_practice_dbt_staging: ROLLBACK
[0m14:07:00.981822 [debug] [ThreadPool]: On list_practice_dbt_staging: Close
[0m14:07:00.982821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75440bd1-352c-4e8e-aa0c-9ef82f3c2087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D148FC4A30>]}
[0m14:07:00.982821 [debug] [MainThread]: On master: COMMIT
[0m14:07:00.983816 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:07:00.984802 [info ] [MainThread]: 
[0m14:07:00.988800 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_customers
[0m14:07:00.988800 [info ] [Thread-1 (]: 1 of 4 START sql view model practice.dbt_staging.stg_customers ................. [RUN]
[0m14:07:00.990799 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_training.stg_customers'
[0m14:07:00.990799 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_customers
[0m14:07:01.000811 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_customers"
[0m14:07:01.001810 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_customers (compile): 14:07:00.990799 => 14:07:01.001810
[0m14:07:01.002811 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_customers
[0m14:07:01.039784 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:07:01.040789 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customers__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:07:01.040789 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:07:01.041782 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:07:01.041782 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:07:01.043225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.044245 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:07:01.045240 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customers__dbt_backup";');

[0m14:07:01.046227 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.049237 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:07:01.050237 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customers'
  
[0m14:07:01.051242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.063218 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_customers"
[0m14:07:01.064217 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:07:01.065217 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */
USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_customers" as 


WITH

required_fields AS (

    SELECT

        id                  AS customer_id
        , first_name
        , last_name

    FROM "practice"."dbo"."jaffle_shop_customers"

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , first_name
        , last_name

    FROM required_fields

),

add_aggregate_field AS (

    SELECT 

        *
        , CONCAT(last_name, first_name)     AS full_name
        , getdate()                         AS data_loaded_at

    FROM datatype_conversion

)

SELECT * FROM add_aggregate_field;');



[0m14:07:01.068194 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.085200 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: COMMIT
[0m14:07:01.089198 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:07:01.089198 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customers__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:07:01.106071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.107071 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:07:01.108070 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customers__dbt_backup";');

[0m14:07:01.108070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.110069 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_customers (execute): 14:07:01.002811 => 14:07:01.110069
[0m14:07:01.111068 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: ROLLBACK
[0m14:07:01.111068 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: Close
[0m14:07:01.112068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75440bd1-352c-4e8e-aa0c-9ef82f3c2087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1493719C0>]}
[0m14:07:01.112068 [info ] [Thread-1 (]: 1 of 4 OK created sql view model practice.dbt_staging.stg_customers ............ [[32mOK[0m in 0.12s]
[0m14:07:01.114071 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_customers
[0m14:07:01.114071 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_orders
[0m14:07:01.115070 [info ] [Thread-1 (]: 2 of 4 START sql view model practice.dbt_staging.stg_orders .................... [RUN]
[0m14:07:01.116053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_customers, now model.dbt_training.stg_orders)
[0m14:07:01.116053 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_orders
[0m14:07:01.120063 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_orders"
[0m14:07:01.122067 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_orders (compile): 14:07:01.117065 => 14:07:01.121062
[0m14:07:01.122067 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_orders
[0m14:07:01.129047 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:07:01.130045 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_orders__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:07:01.130045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:01.131062 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:07:01.131062 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:07:01.145037 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.146048 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:07:01.147048 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_orders__dbt_backup";');

[0m14:07:01.148033 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.149046 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:07:01.150046 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_orders'
  
[0m14:07:01.150046 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.152045 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_orders"
[0m14:07:01.154032 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:07:01.154032 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */
USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_orders" as 

WITH

required_fields AS (

    SELECT

        id                  AS order_id
        , user_id           AS customer_id
        , order_date        AS order_date
        , status

    FROM "practice"."dbo"."jaffle_shop_orders"

),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT)               AS order_id
        , CAST(customer_id AS INT)          AS customer_id        
        , CONVERT(date, order_date)         AS order_date
        , status

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m14:07:01.156029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.159046 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: COMMIT
[0m14:07:01.163045 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:07:01.164043 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_orders__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:07:01.177036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.178035 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:07:01.179034 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_orders__dbt_backup";');

[0m14:07:01.179034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.181029 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_orders (execute): 14:07:01.122067 => 14:07:01.181029
[0m14:07:01.182028 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: ROLLBACK
[0m14:07:01.182028 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: Close
[0m14:07:01.183027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75440bd1-352c-4e8e-aa0c-9ef82f3c2087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D149447A00>]}
[0m14:07:01.183027 [info ] [Thread-1 (]: 2 of 4 OK created sql view model practice.dbt_staging.stg_orders ............... [[32mOK[0m in 0.07s]
[0m14:07:01.184296 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_orders
[0m14:07:01.185312 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_payments
[0m14:07:01.185312 [info ] [Thread-1 (]: 3 of 4 START sql view model practice.dbt_staging.stg_payments .................. [RUN]
[0m14:07:01.187297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_orders, now model.dbt_training.stg_payments)
[0m14:07:01.187297 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_payments
[0m14:07:01.192295 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_payments"
[0m14:07:01.193293 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_payments (compile): 14:07:01.187297 => 14:07:01.193293
[0m14:07:01.194293 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_payments
[0m14:07:01.200289 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:07:01.201289 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_payments__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:07:01.201289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:01.202288 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:07:01.202288 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:07:01.217282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.219286 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:07:01.220292 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_payments__dbt_backup";');

[0m14:07:01.221295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.223278 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:07:01.224276 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_payments'
  
[0m14:07:01.225277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.228275 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_payments"
[0m14:07:01.229274 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:07:01.230274 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */
USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_payments" as 

WITH

required_fields AS(

    SELECT

        *

    FROM "practice"."dbo"."jaffle_shop_payments"

),

datatype_and_renamed AS (

    SELECT

        CAST(id AS INT)             AS id
        , CAST(order_id AS INT)     AS order_id
        , payment_method
        , CAST(amount AS INT)       AS amount

    FROM required_fields

)

SELECT * FROM datatype_and_renamed;');



[0m14:07:01.231358 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.233374 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_payments (execute): 14:07:01.194293 => 14:07:01.233374
[0m14:07:01.233374 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: ROLLBACK
[0m14:07:01.234372 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: Close
[0m14:07:01.235372 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_training\models\staging\stg_payments.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'practice.dbo.jaffle_shop_payments'. (208) (SQLMoreResults)")
[0m14:07:01.238935 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'practice.dbo.jaffle_shop_payments'. (208) (SQLMoreResults)")

[0m14:07:01.239955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75440bd1-352c-4e8e-aa0c-9ef82f3c2087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D149436050>]}
[0m14:07:01.240953 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model practice.dbt_staging.stg_payments ......... [[31mERROR[0m in 0.05s]
[0m14:07:01.242948 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_payments
[0m14:07:01.242948 [debug] [Thread-1 (]: Began running node model.dbt_training.customer
[0m14:07:01.243933 [info ] [Thread-1 (]: 4 of 4 START sql view model practice.dbt_mart.customer ......................... [RUN]
[0m14:07:01.245942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_payments, now model.dbt_training.customer)
[0m14:07:01.245942 [debug] [Thread-1 (]: Began compiling node model.dbt_training.customer
[0m14:07:01.250943 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.customer"
[0m14:07:01.251929 [debug] [Thread-1 (]: Timing info for model.dbt_training.customer (compile): 14:07:01.246947 => 14:07:01.251929
[0m14:07:01.252928 [debug] [Thread-1 (]: Began executing node model.dbt_training.customer
[0m14:07:01.261944 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:07:01.262930 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:07:01.263922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:01.263922 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:07:01.264920 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:07:01.276916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.278914 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:07:01.278914 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m14:07:01.280742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.281758 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:07:01.282762 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m14:07:01.291750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.294736 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.customer"
[0m14:07:01.296749 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:07:01.296749 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */
USE [practice];
    
    

    EXEC('create view "dbt_mart"."customer" as 

WITH

stg_customer AS (

    SELECT

        *

    FROM "practice"."dbt_staging"."stg_customers"

),

stg_orders AS (

    SELECT

        *

    FROM "practice"."dbt_staging"."stg_orders"

),

order_info AS (

    SELECT

        customer_id
        , COUNT(*)      AS total_orders

    FROM stg_orders

    GROUP BY 
        customer_id

),

final AS (

    SELECT 

        sc.*
        , oi.total_orders

    FROM stg_customer sc

    LEFT JOIN order_info oi
        ON sc.customer_id = oi.customer_id
)

SELECT * FROM final;');



[0m14:07:01.299747 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.301732 [debug] [Thread-1 (]: On model.dbt_training.customer: COMMIT
[0m14:07:01.305730 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:07:01.306729 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:07:01.318724 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.319736 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:07:01.320740 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m14:07:01.321739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:01.323733 [debug] [Thread-1 (]: Timing info for model.dbt_training.customer (execute): 14:07:01.252928 => 14:07:01.322720
[0m14:07:01.323733 [debug] [Thread-1 (]: On model.dbt_training.customer: ROLLBACK
[0m14:07:01.324732 [debug] [Thread-1 (]: On model.dbt_training.customer: Close
[0m14:07:01.324732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75440bd1-352c-4e8e-aa0c-9ef82f3c2087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D149503CD0>]}
[0m14:07:01.325732 [info ] [Thread-1 (]: 4 of 4 OK created sql view model practice.dbt_mart.customer .................... [[32mOK[0m in 0.08s]
[0m14:07:01.326726 [debug] [Thread-1 (]: Finished running node model.dbt_training.customer
[0m14:07:01.328728 [debug] [MainThread]: On master: COMMIT
[0m14:07:01.328728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:01.329727 [debug] [MainThread]: Connection 'create_practice_dbt_staging' was properly closed.
[0m14:07:01.329727 [debug] [MainThread]: Connection 'list_practice_dbt_staging' was properly closed.
[0m14:07:01.329727 [debug] [MainThread]: Connection 'model.dbt_training.customer' was properly closed.
[0m14:07:01.330726 [info ] [MainThread]: 
[0m14:07:01.331727 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m14:07:01.332726 [debug] [MainThread]: Command end result
[0m14:07:01.345718 [info ] [MainThread]: 
[0m14:07:01.346718 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:07:01.347731 [info ] [MainThread]: 
[0m14:07:01.348736 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'practice.dbo.jaffle_shop_payments'. (208) (SQLMoreResults)")
[0m14:07:01.349716 [info ] [MainThread]: 
[0m14:07:01.349716 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m14:07:01.351887 [debug] [MainThread]: Command `dbt run` failed at 14:07:01.351887 after 1.71 seconds
[0m14:07:01.351887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D145D6CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D148FC4760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D14950CD90>]}
[0m14:07:01.352886 [debug] [MainThread]: Flushing usage events
[0m14:07:51.437813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014523E0CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145266E6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145266E6140>]}


============================== 14:07:51.443804 | ad5e3d03-a1d1-44ed-9cd8-e4fd76715867 ==============================
[0m14:07:51.443804 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:07:51.444794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:07:51.838548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad5e3d03-a1d1-44ed-9cd8-e4fd76715867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145266E63E0>]}
[0m14:07:51.945488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad5e3d03-a1d1-44ed-9cd8-e4fd76715867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014526E79750>]}
[0m14:07:51.945488 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m14:07:51.960495 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:07:52.085058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:07:52.086058 [debug] [MainThread]: Partial parsing: updated file: dbt_training://models\source.yml
[0m14:07:52.527803 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_training.stg_payments' (models\staging\stg_payments.sql) depends on a source named 'jaffle_shop.jaffle_shop_payments' which was not found
[0m14:07:52.529816 [debug] [MainThread]: Command `dbt run` failed at 14:07:52.529816 after 1.18 seconds
[0m14:07:52.530815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014523E0CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001452726A1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014527268550>]}
[0m14:07:52.530815 [debug] [MainThread]: Flushing usage events
[0m14:08:31.585011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6D669A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6FF56230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6FF56050>]}


============================== 14:08:31.591007 | 99846e22-39b7-411f-b01c-094150e0eeaa ==============================
[0m14:08:31.591007 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:08:31.591992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:08:31.970788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99846e22-39b7-411f-b01c-094150e0eeaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6FF562F0>]}
[0m14:08:32.072715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99846e22-39b7-411f-b01c-094150e0eeaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD706E06A0>]}
[0m14:08:32.073715 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m14:08:32.085137 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:08:32.198077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:08:32.199077 [debug] [MainThread]: Partial parsing: updated file: dbt_training://models\source.yml
[0m14:08:32.199077 [debug] [MainThread]: Partial parsing: updated file: dbt_training://models\staging\stg_payments.sql
[0m14:08:32.650801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99846e22-39b7-411f-b01c-094150e0eeaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD70C25000>]}
[0m14:08:32.665791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99846e22-39b7-411f-b01c-094150e0eeaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD708D9EA0>]}
[0m14:08:32.666790 [info ] [MainThread]: Found 4 models, 2 tests, 3 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:08:32.667792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99846e22-39b7-411f-b01c-094150e0eeaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD708D8A30>]}
[0m14:08:32.669808 [info ] [MainThread]: 
[0m14:08:32.670787 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:08:32.672787 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice'
[0m14:08:32.685779 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m14:08:32.686778 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m14:08:32.686778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:32.686778 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:08:32.733834 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:08:32.734823 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:32.735823 [debug] [ThreadPool]: On list_practice: Close
[0m14:08:32.739820 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m14:08:32.739820 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m14:08:32.740820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:32.740820 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:08:32.741820 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:08:32.743258 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:32.744263 [debug] [ThreadPool]: On list_practice: Close
[0m14:08:32.746261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice, now create_practice_dbt_staging)
[0m14:08:32.746261 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "dbt_staging"
"
[0m14:08:32.752257 [debug] [ThreadPool]: Using sqlserver connection "create_practice_dbt_staging"
[0m14:08:32.753257 [debug] [ThreadPool]: On create_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_dbt_staging"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m14:08:32.753257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:32.754256 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:08:32.754256 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:08:32.756267 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:32.758254 [debug] [ThreadPool]: On create_practice_dbt_staging: COMMIT
[0m14:08:32.758254 [debug] [ThreadPool]: On create_practice_dbt_staging: Close
[0m14:08:32.760271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_practice_dbt_staging, now create_practice_dbt_mart)
[0m14:08:32.761264 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "dbt_mart"
"
[0m14:08:32.763263 [debug] [ThreadPool]: Using sqlserver connection "create_practice_dbt_mart"
[0m14:08:32.764262 [debug] [ThreadPool]: On create_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_dbt_mart"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m14:08:32.764262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:32.765262 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:08:32.765262 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:08:32.768260 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:32.769260 [debug] [ThreadPool]: On create_practice_dbt_mart: COMMIT
[0m14:08:32.769260 [debug] [ThreadPool]: On create_practice_dbt_mart: Close
[0m14:08:32.771246 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice_dbt_staging'
[0m14:08:32.778255 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_staging"
[0m14:08:32.778255 [debug] [ThreadPool]: On list_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m14:08:32.779254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:32.779254 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:08:32.779254 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:08:32.780253 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:32.782253 [debug] [ThreadPool]: On list_practice_dbt_staging: ROLLBACK
[0m14:08:32.782253 [debug] [ThreadPool]: On list_practice_dbt_staging: Close
[0m14:08:32.783256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_staging, now list_practice_dbt_mart)
[0m14:08:32.786255 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_mart"
[0m14:08:32.787254 [debug] [ThreadPool]: On list_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m14:08:32.787254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:32.787254 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:08:32.788253 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:08:32.789248 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:08:32.790248 [debug] [ThreadPool]: On list_practice_dbt_mart: ROLLBACK
[0m14:08:32.791252 [debug] [ThreadPool]: On list_practice_dbt_mart: Close
[0m14:08:32.792266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99846e22-39b7-411f-b01c-094150e0eeaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD70C8B730>]}
[0m14:08:32.792266 [debug] [MainThread]: On master: COMMIT
[0m14:08:32.793246 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:08:32.794242 [info ] [MainThread]: 
[0m14:08:32.797245 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_customers
[0m14:08:32.798231 [info ] [Thread-1 (]: 1 of 4 START sql view model practice.dbt_staging.stg_customers ................. [RUN]
[0m14:08:32.799248 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_training.stg_customers'
[0m14:08:32.800247 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_customers
[0m14:08:32.809242 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_customers"
[0m14:08:32.810241 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_customers (compile): 14:08:32.800247 => 14:08:32.810241
[0m14:08:32.811223 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_customers
[0m14:08:32.849220 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:08:32.850219 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customers__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:08:32.850219 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:08:32.851214 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:08:32.851214 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:08:32.865210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:32.866209 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:08:32.867191 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customers__dbt_backup";');

[0m14:08:32.868191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:32.872189 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:08:32.872189 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customers'
  
[0m14:08:32.873186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:32.883182 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:08:32.884182 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */
USE [practice];
      EXEC sp_rename 'dbt_staging.stg_customers', 'stg_customers__dbt_backup'
[0m14:08:33.069074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.082069 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_customers"
[0m14:08:33.083068 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:08:33.084066 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */
USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_customers" as 


WITH

required_fields AS (

    SELECT

        id                  AS customer_id
        , first_name
        , last_name

    FROM "practice"."dbo"."jaffle_shop_customers"

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , first_name
        , last_name

    FROM required_fields

),

add_aggregate_field AS (

    SELECT 

        *
        , CONCAT(last_name, first_name)     AS full_name
        , getdate()                         AS data_loaded_at

    FROM datatype_conversion

)

SELECT * FROM add_aggregate_field;');



[0m14:08:33.087064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.108053 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: COMMIT
[0m14:08:33.112051 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:08:33.113050 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customers__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:08:33.114049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.115048 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:08:33.116047 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customers__dbt_backup";');

[0m14:08:33.118397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.119399 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_customers (execute): 14:08:32.812223 => 14:08:33.119399
[0m14:08:33.120398 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: ROLLBACK
[0m14:08:33.120398 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: Close
[0m14:08:33.121397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99846e22-39b7-411f-b01c-094150e0eeaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD70CE5090>]}
[0m14:08:33.122396 [info ] [Thread-1 (]: 1 of 4 OK created sql view model practice.dbt_staging.stg_customers ............ [[32mOK[0m in 0.32s]
[0m14:08:33.122923 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_customers
[0m14:08:33.123943 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_orders
[0m14:08:33.124942 [info ] [Thread-1 (]: 2 of 4 START sql view model practice.dbt_staging.stg_orders .................... [RUN]
[0m14:08:33.125923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_customers, now model.dbt_training.stg_orders)
[0m14:08:33.125923 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_orders
[0m14:08:33.129921 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_orders"
[0m14:08:33.130920 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_orders (compile): 14:08:33.125923 => 14:08:33.130920
[0m14:08:33.131920 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_orders
[0m14:08:33.138916 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:08:33.138916 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_orders__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:08:33.139915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:33.139915 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:08:33.140915 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:08:33.141918 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.143921 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:08:33.143921 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_orders__dbt_backup";');

[0m14:08:33.144912 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.146930 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:08:33.146930 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_orders'
  
[0m14:08:33.147911 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.152923 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:08:33.152923 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */
USE [practice];
      EXEC sp_rename 'dbt_staging.stg_orders', 'stg_orders__dbt_backup'
[0m14:08:33.155313 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.157314 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_orders"
[0m14:08:33.159317 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:08:33.160313 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */
USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_orders" as 

WITH

required_fields AS (

    SELECT

        id                  AS order_id
        , user_id           AS customer_id
        , order_date        AS order_date
        , status

    FROM "practice"."dbo"."jaffle_shop_orders"

),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT)               AS order_id
        , CAST(customer_id AS INT)          AS customer_id        
        , CONVERT(date, order_date)         AS order_date
        , status

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m14:08:33.162312 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.165323 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: COMMIT
[0m14:08:33.168321 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:08:33.169320 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_orders__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:08:33.169991 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.170992 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:08:33.170992 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_orders__dbt_backup";');

[0m14:08:33.173238 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.175243 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_orders (execute): 14:08:33.131920 => 14:08:33.174245
[0m14:08:33.175243 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: ROLLBACK
[0m14:08:33.176235 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: Close
[0m14:08:33.177230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99846e22-39b7-411f-b01c-094150e0eeaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD70CE5090>]}
[0m14:08:33.177230 [info ] [Thread-1 (]: 2 of 4 OK created sql view model practice.dbt_staging.stg_orders ............... [[32mOK[0m in 0.05s]
[0m14:08:33.179229 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_orders
[0m14:08:33.179229 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_payments
[0m14:08:33.180229 [info ] [Thread-1 (]: 3 of 4 START sql view model practice.dbt_staging.stg_payments .................. [RUN]
[0m14:08:33.181239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_orders, now model.dbt_training.stg_payments)
[0m14:08:33.182238 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_payments
[0m14:08:33.186237 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_payments"
[0m14:08:33.187236 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_payments (compile): 14:08:33.182238 => 14:08:33.187236
[0m14:08:33.188241 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_payments
[0m14:08:33.195220 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:08:33.195220 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_payments__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:08:33.196219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:33.197219 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:08:33.197219 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:08:33.198231 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.200230 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:08:33.201229 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_payments__dbt_backup";');

[0m14:08:33.201229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.203228 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:08:33.203228 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_payments'
  
[0m14:08:33.204227 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.207225 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_payments"
[0m14:08:33.208236 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:08:33.209212 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */
USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_payments" as 

WITH

required_fields AS(

    SELECT

        *

    FROM "practice"."dbo"."stripe_payments"

),

datatype_and_renamed AS (

    SELECT

        CAST(id AS INT)             AS id
        , CAST(order_id AS INT)     AS order_id
        , payment_method
        , CAST(amount AS INT)       AS amount

    FROM required_fields

)

SELECT * FROM datatype_and_renamed;');



[0m14:08:33.211211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.212211 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_payments (execute): 14:08:33.188241 => 14:08:33.212211
[0m14:08:33.213210 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: ROLLBACK
[0m14:08:33.213210 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: Close
[0m14:08:33.214210 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_training\models\staging\stg_payments.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'order_id'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'payment_method'. (207)")
[0m14:08:33.219627 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'order_id'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'payment_method'. (207)")

[0m14:08:33.219627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99846e22-39b7-411f-b01c-094150e0eeaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD70D86320>]}
[0m14:08:33.220636 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model practice.dbt_staging.stg_payments ......... [[31mERROR[0m in 0.04s]
[0m14:08:33.221626 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_payments
[0m14:08:33.222625 [debug] [Thread-1 (]: Began running node model.dbt_training.customer
[0m14:08:33.223639 [info ] [Thread-1 (]: 4 of 4 START sql view model practice.dbt_mart.customer ......................... [RUN]
[0m14:08:33.224638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_payments, now model.dbt_training.customer)
[0m14:08:33.224638 [debug] [Thread-1 (]: Began compiling node model.dbt_training.customer
[0m14:08:33.230641 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.customer"
[0m14:08:33.232627 [debug] [Thread-1 (]: Timing info for model.dbt_training.customer (compile): 14:08:33.224638 => 14:08:33.232627
[0m14:08:33.233634 [debug] [Thread-1 (]: Began executing node model.dbt_training.customer
[0m14:08:33.240629 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:08:33.240629 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:08:33.241629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:33.241629 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:08:33.242616 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:08:33.243616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.244615 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:08:33.245614 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m14:08:33.246614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.248631 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:08:33.248631 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m14:08:33.249640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.253621 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:08:33.254621 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */
USE [practice];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m14:08:33.256486 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.258498 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.customer"
[0m14:08:33.260499 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:08:33.260499 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */
USE [practice];
    
    

    EXEC('create view "dbt_mart"."customer" as 

WITH

stg_customer AS (

    SELECT

        *

    FROM "practice"."dbt_staging"."stg_customers"

),

stg_orders AS (

    SELECT

        *

    FROM "practice"."dbt_staging"."stg_orders"

),

order_info AS (

    SELECT

        customer_id
        , COUNT(*)      AS total_orders

    FROM stg_orders

    GROUP BY 
        customer_id

),

final AS (

    SELECT 

        sc.*
        , oi.total_orders

    FROM stg_customer sc

    LEFT JOIN order_info oi
        ON sc.customer_id = oi.customer_id
)

SELECT * FROM final;');



[0m14:08:33.263978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.266992 [debug] [Thread-1 (]: On model.dbt_training.customer: COMMIT
[0m14:08:33.270976 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:08:33.270976 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:08:33.271975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.272975 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:08:33.273974 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m14:08:33.275576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:33.277579 [debug] [Thread-1 (]: Timing info for model.dbt_training.customer (execute): 14:08:33.233634 => 14:08:33.277579
[0m14:08:33.277579 [debug] [Thread-1 (]: On model.dbt_training.customer: ROLLBACK
[0m14:08:33.278579 [debug] [Thread-1 (]: On model.dbt_training.customer: Close
[0m14:08:33.279596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99846e22-39b7-411f-b01c-094150e0eeaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD70CE7D00>]}
[0m14:08:33.280594 [info ] [Thread-1 (]: 4 of 4 OK created sql view model practice.dbt_mart.customer .................... [[32mOK[0m in 0.06s]
[0m14:08:33.281576 [debug] [Thread-1 (]: Finished running node model.dbt_training.customer
[0m14:08:33.282595 [debug] [MainThread]: On master: COMMIT
[0m14:08:33.283576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:33.283576 [debug] [MainThread]: Connection 'create_practice_dbt_mart' was properly closed.
[0m14:08:33.284575 [debug] [MainThread]: Connection 'list_practice_dbt_mart' was properly closed.
[0m14:08:33.284575 [debug] [MainThread]: Connection 'model.dbt_training.customer' was properly closed.
[0m14:08:33.285574 [info ] [MainThread]: 
[0m14:08:33.285574 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m14:08:33.287586 [debug] [MainThread]: Command end result
[0m14:08:33.300566 [info ] [MainThread]: 
[0m14:08:33.301570 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:08:33.302563 [info ] [MainThread]: 
[0m14:08:33.302563 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'order_id'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'payment_method'. (207)")
[0m14:08:33.303581 [info ] [MainThread]: 
[0m14:08:33.304576 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m14:08:33.306571 [debug] [MainThread]: Command `dbt run` failed at 14:08:33.306571 after 1.80 seconds
[0m14:08:33.307570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6D669A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD708D8520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD708D8700>]}
[0m14:08:33.309560 [debug] [MainThread]: Flushing usage events
[0m14:09:57.380435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139F473CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139F701A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139F701A140>]}


============================== 14:09:57.387431 | 3ffeb6db-c0da-4336-af4a-d8c146f6669c ==============================
[0m14:09:57.387431 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:09:57.388428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:09:57.785311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ffeb6db-c0da-4336-af4a-d8c146f6669c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139F701A3E0>]}
[0m14:09:57.885252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ffeb6db-c0da-4336-af4a-d8c146f6669c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139F77A9750>]}
[0m14:09:57.886252 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m14:09:57.898245 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:09:58.030371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:09:58.031370 [debug] [MainThread]: Partial parsing: updated file: dbt_training://models\staging\stg_payments.sql
[0m14:09:58.189296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ffeb6db-c0da-4336-af4a-d8c146f6669c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139F7AF3E20>]}
[0m14:09:58.255249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ffeb6db-c0da-4336-af4a-d8c146f6669c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139F79C1A20>]}
[0m14:09:58.255249 [info ] [MainThread]: Found 4 models, 2 tests, 3 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:09:58.256239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ffeb6db-c0da-4336-af4a-d8c146f6669c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139F79C19F0>]}
[0m14:09:58.258238 [info ] [MainThread]: 
[0m14:09:58.259238 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:09:58.261237 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice'
[0m14:09:58.277242 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m14:09:58.278241 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m14:09:58.279240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:58.279240 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:09:58.324698 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:09:58.325710 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:58.327698 [debug] [ThreadPool]: On list_practice: Close
[0m14:09:58.331695 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m14:09:58.331695 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m14:09:58.332694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:58.332694 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:09:58.333694 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:09:58.334394 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:58.335395 [debug] [ThreadPool]: On list_practice: Close
[0m14:09:58.336409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice, now create_practice_dbt_staging)
[0m14:09:58.337394 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "dbt_staging"
"
[0m14:09:58.343391 [debug] [ThreadPool]: Using sqlserver connection "create_practice_dbt_staging"
[0m14:09:58.343391 [debug] [ThreadPool]: On create_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_dbt_staging"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m14:09:58.344390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:58.344390 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:09:58.345389 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:09:58.347402 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:58.348402 [debug] [ThreadPool]: On create_practice_dbt_staging: COMMIT
[0m14:09:58.348402 [debug] [ThreadPool]: On create_practice_dbt_staging: Close
[0m14:09:58.350406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_practice_dbt_staging, now create_practice_dbt_mart)
[0m14:09:58.351405 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "dbt_mart"
"
[0m14:09:58.353403 [debug] [ThreadPool]: Using sqlserver connection "create_practice_dbt_mart"
[0m14:09:58.354403 [debug] [ThreadPool]: On create_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_dbt_mart"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m14:09:58.354403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:58.355386 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:09:58.355386 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:09:58.358396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:58.359396 [debug] [ThreadPool]: On create_practice_dbt_mart: COMMIT
[0m14:09:58.360395 [debug] [ThreadPool]: On create_practice_dbt_mart: Close
[0m14:09:58.362394 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice_dbt_staging'
[0m14:09:58.370394 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_staging"
[0m14:09:58.370394 [debug] [ThreadPool]: On list_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m14:09:58.371393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:58.371393 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:09:58.372374 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:09:58.373764 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:58.374766 [debug] [ThreadPool]: On list_practice_dbt_staging: ROLLBACK
[0m14:09:58.374766 [debug] [ThreadPool]: On list_practice_dbt_staging: Close
[0m14:09:58.375765 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_staging, now list_practice_dbt_mart)
[0m14:09:58.378763 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_mart"
[0m14:09:58.379762 [debug] [ThreadPool]: On list_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m14:09:58.379762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:58.380762 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:09:58.380762 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:09:58.382112 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:09:58.383114 [debug] [ThreadPool]: On list_practice_dbt_mart: ROLLBACK
[0m14:09:58.383114 [debug] [ThreadPool]: On list_practice_dbt_mart: Close
[0m14:09:58.384113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ffeb6db-c0da-4336-af4a-d8c146f6669c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139F79CAE90>]}
[0m14:09:58.385127 [debug] [MainThread]: On master: COMMIT
[0m14:09:58.385127 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:09:58.386338 [info ] [MainThread]: 
[0m14:09:58.391351 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_customers
[0m14:09:58.391351 [info ] [Thread-1 (]: 1 of 4 START sql view model practice.dbt_staging.stg_customers ................. [RUN]
[0m14:09:58.393338 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_training.stg_customers'
[0m14:09:58.393338 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_customers
[0m14:09:58.405347 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_customers"
[0m14:09:58.407329 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_customers (compile): 14:09:58.394355 => 14:09:58.406343
[0m14:09:58.407329 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_customers
[0m14:09:58.443326 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:09:58.444325 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customers__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:09:58.444325 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:09:58.445324 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:09:58.445324 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:09:58.446305 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.447319 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:09:58.448323 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customers__dbt_backup";');

[0m14:09:58.449317 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.452320 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:09:58.453319 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customers'
  
[0m14:09:58.454301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.462315 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:09:58.462315 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */
USE [practice];
      EXEC sp_rename 'dbt_staging.stg_customers', 'stg_customers__dbt_backup'
[0m14:09:58.465092 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.476101 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_customers"
[0m14:09:58.478088 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:09:58.478088 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */
USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_customers" as 


WITH

required_fields AS (

    SELECT

        id                  AS customer_id
        , first_name
        , last_name

    FROM "practice"."dbo"."jaffle_shop_customers"

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , first_name
        , last_name

    FROM required_fields

),

add_aggregate_field AS (

    SELECT 

        *
        , CONCAT(last_name, first_name)     AS full_name
        , getdate()                         AS data_loaded_at

    FROM datatype_conversion

)

SELECT * FROM add_aggregate_field;');



[0m14:09:58.480601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.497607 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: COMMIT
[0m14:09:58.500605 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:09:58.501605 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customers__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:09:58.502582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.503584 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:09:58.504583 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customers__dbt_backup";');

[0m14:09:58.505596 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.507581 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_customers (execute): 14:09:58.408329 => 14:09:58.507581
[0m14:09:58.508580 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: ROLLBACK
[0m14:09:58.508580 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: Close
[0m14:09:58.509580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ffeb6db-c0da-4336-af4a-d8c146f6669c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139F7736C50>]}
[0m14:09:58.509580 [info ] [Thread-1 (]: 1 of 4 OK created sql view model practice.dbt_staging.stg_customers ............ [[32mOK[0m in 0.12s]
[0m14:09:58.510937 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_customers
[0m14:09:58.511954 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_orders
[0m14:09:58.512952 [info ] [Thread-1 (]: 2 of 4 START sql view model practice.dbt_staging.stg_orders .................... [RUN]
[0m14:09:58.513953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_customers, now model.dbt_training.stg_orders)
[0m14:09:58.513953 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_orders
[0m14:09:58.517949 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_orders"
[0m14:09:58.518936 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_orders (compile): 14:09:58.513953 => 14:09:58.518936
[0m14:09:58.519950 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_orders
[0m14:09:58.524944 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:09:58.525944 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_orders__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:09:58.525944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:58.526943 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:09:58.526943 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:09:58.527943 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.529942 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:09:58.530946 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_orders__dbt_backup";');

[0m14:09:58.531928 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.532928 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:09:58.533927 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_orders'
  
[0m14:09:58.534927 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.539923 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:09:58.540923 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */
USE [practice];
      EXEC sp_rename 'dbt_staging.stg_orders', 'stg_orders__dbt_backup'
[0m14:09:58.544064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.547083 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_orders"
[0m14:09:58.548081 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:09:58.549082 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */
USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_orders" as 

WITH

required_fields AS (

    SELECT

        id                  AS order_id
        , user_id           AS customer_id
        , order_date        AS order_date
        , status

    FROM "practice"."dbo"."jaffle_shop_orders"

),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT)               AS order_id
        , CAST(customer_id AS INT)          AS customer_id        
        , CONVERT(date, order_date)         AS order_date
        , status

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m14:09:58.551079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.553094 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: COMMIT
[0m14:09:58.557098 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:09:58.557098 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_orders__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:09:58.558096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.560076 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:09:58.561077 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_orders__dbt_backup";');

[0m14:09:58.562934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.564948 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_orders (execute): 14:09:58.519950 => 14:09:58.564948
[0m14:09:58.564948 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: ROLLBACK
[0m14:09:58.565948 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: Close
[0m14:09:58.566933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ffeb6db-c0da-4336-af4a-d8c146f6669c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139F7BE7250>]}
[0m14:09:58.566933 [info ] [Thread-1 (]: 2 of 4 OK created sql view model practice.dbt_staging.stg_orders ............... [[32mOK[0m in 0.05s]
[0m14:09:58.568947 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_orders
[0m14:09:58.568947 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_payments
[0m14:09:58.569951 [info ] [Thread-1 (]: 3 of 4 START sql view model practice.dbt_staging.stg_payments .................. [RUN]
[0m14:09:58.570946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_orders, now model.dbt_training.stg_payments)
[0m14:09:58.570946 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_payments
[0m14:09:58.577938 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_payments"
[0m14:09:58.579926 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_payments (compile): 14:09:58.571949 => 14:09:58.578937
[0m14:09:58.579926 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_payments
[0m14:09:58.585936 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:09:58.586936 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_payments__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:09:58.586936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:58.587935 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:09:58.587935 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:09:58.589084 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.591102 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:09:58.592105 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_payments__dbt_backup";');

[0m14:09:58.593103 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.595083 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:09:58.595083 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_payments'
  
[0m14:09:58.596548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.598549 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_payments"
[0m14:09:58.599548 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:09:58.600548 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */
USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_payments" as 

WITH

required_fields AS(

    SELECT

        *

    FROM "practice"."dbo"."stripe_payments"

),

datatype_and_renamed AS (

    SELECT

        CAST(id AS INT)             AS id
        , CAST(orderid AS INT)     AS order_id
        , paymentmethod
        , CAST(amount AS INT)       AS amount

    FROM required_fields

)

SELECT * FROM datatype_and_renamed;');



[0m14:09:58.602571 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.604574 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: COMMIT
[0m14:09:58.609572 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:09:58.610571 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_payments__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:09:58.620563 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.622563 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:09:58.623566 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_payments__dbt_backup";');

[0m14:09:58.624564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.626561 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_payments (execute): 14:09:58.579926 => 14:09:58.626561
[0m14:09:58.627561 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: ROLLBACK
[0m14:09:58.628560 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: Close
[0m14:09:58.628560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ffeb6db-c0da-4336-af4a-d8c146f6669c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139F7AF0100>]}
[0m14:09:58.629560 [info ] [Thread-1 (]: 3 of 4 OK created sql view model practice.dbt_staging.stg_payments ............. [[32mOK[0m in 0.06s]
[0m14:09:58.630559 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_payments
[0m14:09:58.631570 [debug] [Thread-1 (]: Began running node model.dbt_training.customer
[0m14:09:58.632558 [info ] [Thread-1 (]: 4 of 4 START sql view model practice.dbt_mart.customer ......................... [RUN]
[0m14:09:58.633064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_payments, now model.dbt_training.customer)
[0m14:09:58.634081 [debug] [Thread-1 (]: Began compiling node model.dbt_training.customer
[0m14:09:58.638077 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.customer"
[0m14:09:58.640063 [debug] [Thread-1 (]: Timing info for model.dbt_training.customer (compile): 14:09:58.634081 => 14:09:58.639077
[0m14:09:58.640063 [debug] [Thread-1 (]: Began executing node model.dbt_training.customer
[0m14:09:58.647073 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:09:58.648072 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:09:58.648072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:58.649071 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:09:58.649071 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:09:58.650653 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.651655 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:09:58.652654 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m14:09:58.652654 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.654653 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:09:58.655652 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m14:09:58.656652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.662648 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:09:58.662648 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */
USE [practice];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m14:09:58.665448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.667449 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.customer"
[0m14:09:58.668448 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:09:58.669462 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */
USE [practice];
    
    

    EXEC('create view "dbt_mart"."customer" as 

WITH

stg_customer AS (

    SELECT

        *

    FROM "practice"."dbt_staging"."stg_customers"

),

stg_orders AS (

    SELECT

        *

    FROM "practice"."dbt_staging"."stg_orders"

),

order_info AS (

    SELECT

        customer_id
        , COUNT(*)      AS total_orders

    FROM stg_orders

    GROUP BY 
        customer_id

),

final AS (

    SELECT 

        sc.*
        , oi.total_orders

    FROM stg_customer sc

    LEFT JOIN order_info oi
        ON sc.customer_id = oi.customer_id
)

SELECT * FROM final;');



[0m14:09:58.672175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.674176 [debug] [Thread-1 (]: On model.dbt_training.customer: COMMIT
[0m14:09:58.678173 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:09:58.679173 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:09:58.680517 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.681519 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:09:58.682518 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m14:09:58.684011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.685024 [debug] [Thread-1 (]: Timing info for model.dbt_training.customer (execute): 14:09:58.641081 => 14:09:58.685024
[0m14:09:58.686023 [debug] [Thread-1 (]: On model.dbt_training.customer: ROLLBACK
[0m14:09:58.686023 [debug] [Thread-1 (]: On model.dbt_training.customer: Close
[0m14:09:58.687022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ffeb6db-c0da-4336-af4a-d8c146f6669c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139F7BD9270>]}
[0m14:09:58.688022 [info ] [Thread-1 (]: 4 of 4 OK created sql view model practice.dbt_mart.customer .................... [[32mOK[0m in 0.05s]
[0m14:09:58.688699 [debug] [Thread-1 (]: Finished running node model.dbt_training.customer
[0m14:09:58.690704 [debug] [MainThread]: On master: COMMIT
[0m14:09:58.691714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:58.692699 [debug] [MainThread]: Connection 'create_practice_dbt_mart' was properly closed.
[0m14:09:58.692699 [debug] [MainThread]: Connection 'list_practice_dbt_mart' was properly closed.
[0m14:09:58.693718 [debug] [MainThread]: Connection 'model.dbt_training.customer' was properly closed.
[0m14:09:58.693718 [info ] [MainThread]: 
[0m14:09:58.694698 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m14:09:58.695711 [debug] [MainThread]: Command end result
[0m14:09:58.708691 [info ] [MainThread]: 
[0m14:09:58.709691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:58.710699 [info ] [MainThread]: 
[0m14:09:58.711690 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:09:58.713708 [debug] [MainThread]: Command `dbt run` succeeded at 14:09:58.713708 after 1.41 seconds
[0m14:09:58.714688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139F473CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139F7B15240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139F7ED7400>]}
[0m14:09:58.714688 [debug] [MainThread]: Flushing usage events
[0m14:22:37.589258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002674551ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026747DF62F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026747DF6110>]}


============================== 14:22:37.595266 | 16ffb25f-dae4-48f0-9841-556065b41d98 ==============================
[0m14:22:37.595266 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:22:37.596255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:22:38.190012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16ffb25f-dae4-48f0-9841-556065b41d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026747DF63B0>]}
[0m14:22:38.290955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16ffb25f-dae4-48f0-9841-556065b41d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002674858A5C0>]}
[0m14:22:38.290955 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m14:22:38.311929 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:22:38.335916 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:22:38.337915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '16ffb25f-dae4-48f0-9841-556065b41d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267484D3AC0>]}
[0m14:22:40.727674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16ffb25f-dae4-48f0-9841-556065b41d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026748B180D0>]}
[0m14:22:40.751116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16ffb25f-dae4-48f0-9841-556065b41d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026748756620>]}
[0m14:22:40.752108 [info ] [MainThread]: Found 4 models, 2 tests, 3 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:22:40.753107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16ffb25f-dae4-48f0-9841-556065b41d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026748819420>]}
[0m14:22:40.754124 [info ] [MainThread]: 
[0m14:22:40.756123 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:22:40.758103 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice'
[0m14:22:40.773094 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m14:22:40.774098 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m14:22:40.774098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:40.775093 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:22:40.824082 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:22:40.825095 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:40.827099 [debug] [ThreadPool]: On list_practice: Close
[0m14:22:40.831079 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m14:22:40.832078 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m14:22:40.833078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:40.833078 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:22:40.834077 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:22:40.834077 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:40.836076 [debug] [ThreadPool]: On list_practice: Close
[0m14:22:40.837088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice, now create_practice_dbt_staging)
[0m14:22:40.838087 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "dbt_staging"
"
[0m14:22:40.843071 [debug] [ThreadPool]: Using sqlserver connection "create_practice_dbt_staging"
[0m14:22:40.843071 [debug] [ThreadPool]: On create_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_dbt_staging"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m14:22:40.844084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:40.844084 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:22:40.845083 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:22:40.847069 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:40.848082 [debug] [ThreadPool]: On create_practice_dbt_staging: COMMIT
[0m14:22:40.849081 [debug] [ThreadPool]: On create_practice_dbt_staging: Close
[0m14:22:40.850080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_practice_dbt_staging, now create_practice_dbt_mart)
[0m14:22:40.851080 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "dbt_mart"
"
[0m14:22:40.854078 [debug] [ThreadPool]: Using sqlserver connection "create_practice_dbt_mart"
[0m14:22:40.855077 [debug] [ThreadPool]: On create_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_dbt_mart"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m14:22:40.855077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:40.856077 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:22:40.856077 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:22:40.858063 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:40.859076 [debug] [ThreadPool]: On create_practice_dbt_mart: COMMIT
[0m14:22:40.860075 [debug] [ThreadPool]: On create_practice_dbt_mart: Close
[0m14:22:40.861955 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice_dbt_staging'
[0m14:22:40.867953 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_staging"
[0m14:22:40.868952 [debug] [ThreadPool]: On list_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m14:22:40.868952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:40.869952 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:22:40.869952 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:22:40.871538 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:40.872540 [debug] [ThreadPool]: On list_practice_dbt_staging: ROLLBACK
[0m14:22:40.872540 [debug] [ThreadPool]: On list_practice_dbt_staging: Close
[0m14:22:40.873539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_staging, now list_practice_dbt_mart)
[0m14:22:40.876537 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_mart"
[0m14:22:40.877536 [debug] [ThreadPool]: On list_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m14:22:40.877536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:40.877536 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:22:40.878536 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:22:40.879636 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:22:40.880637 [debug] [ThreadPool]: On list_practice_dbt_mart: ROLLBACK
[0m14:22:40.880637 [debug] [ThreadPool]: On list_practice_dbt_mart: Close
[0m14:22:40.881636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16ffb25f-dae4-48f0-9841-556065b41d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026748B71B10>]}
[0m14:22:40.882650 [debug] [MainThread]: On master: COMMIT
[0m14:22:40.882650 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:22:40.883974 [info ] [MainThread]: 
[0m14:22:40.887760 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_customers
[0m14:22:40.887760 [info ] [Thread-1 (]: 1 of 4 START sql table model practice.dbt_staging.stg_customers ................ [RUN]
[0m14:22:40.889761 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_training.stg_customers'
[0m14:22:40.889761 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_customers
[0m14:22:40.900754 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_customers"
[0m14:22:40.901754 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_customers (compile): 14:22:40.890760 => 14:22:40.901754
[0m14:22:40.902753 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_customers
[0m14:22:40.933749 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:22:40.933749 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      
      
    USE [practice];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customers__dbt_backup";');

[0m14:22:40.934748 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:22:40.934748 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:22:40.935748 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:22:40.936747 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:40.940731 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:22:40.940731 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customers'
  
[0m14:22:40.941806 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:40.960797 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:22:40.961797 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customers_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:22:40.973083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:40.978079 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:22:40.978079 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customers_temp_view";');

  
[0m14:22:40.979076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:40.984070 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:22:40.985069 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customers_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:22:40.986055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:40.987069 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_customers"
[0m14:22:40.989055 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:22:40.990053 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

  
    

   

    USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_customers_temp_view" as 


WITH

required_fields AS (

    SELECT

        id                  AS customer_id
        , first_name
        , last_name

    FROM "practice"."dbo"."jaffle_shop_customers"

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , first_name
        , last_name

    FROM required_fields

),

add_aggregate_field AS (

    SELECT 

        *
        , CONCAT(last_name, first_name)     AS full_name
        , getdate()                         AS data_loaded_at

    FROM datatype_conversion

)

SELECT * FROM add_aggregate_field;');



    
      EXEC('SELECT * INTO [practice].[dbt_staging].[stg_customers] FROM [practice].[dbt_staging].[stg_customers_temp_view];');
    

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customers_temp_view";');



  
[0m14:22:40.998818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.013824 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: COMMIT
[0m14:22:41.017822 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:22:41.017822 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      USE [practice];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customers__dbt_backup'
  
[0m14:22:41.084525 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.088536 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:22:41.089536 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      
      
    USE [practice];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customers__dbt_backup";');

[0m14:22:41.090626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.094626 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_customers (execute): 14:22:40.902753 => 14:22:41.094626
[0m14:22:41.095625 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: ROLLBACK
[0m14:22:41.095625 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: Close
[0m14:22:41.096625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ffb25f-dae4-48f0-9841-556065b41d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026748BD9090>]}
[0m14:22:41.097624 [info ] [Thread-1 (]: 1 of 4 OK created sql table model practice.dbt_staging.stg_customers ........... [[32mOK[0m in 0.21s]
[0m14:22:41.098256 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_customers
[0m14:22:41.099272 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_orders
[0m14:22:41.099272 [info ] [Thread-1 (]: 2 of 4 START sql table model practice.dbt_staging.stg_orders ................... [RUN]
[0m14:22:41.100270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_customers, now model.dbt_training.stg_orders)
[0m14:22:41.101271 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_orders
[0m14:22:41.105268 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_orders"
[0m14:22:41.106255 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_orders (compile): 14:22:41.101271 => 14:22:41.106255
[0m14:22:41.107267 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_orders
[0m14:22:41.113250 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:22:41.113250 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      
      
    USE [practice];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_orders__dbt_backup";');

[0m14:22:41.114249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:41.114249 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:22:41.115248 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:22:41.116250 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.118249 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:22:41.119248 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_orders'
  
[0m14:22:41.120247 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.122246 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:22:41.123245 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:22:41.136061 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.138059 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:22:41.138059 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_orders_temp_view";');

  
[0m14:22:41.139059 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.141057 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:22:41.141057 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:22:41.142057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.144056 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_orders"
[0m14:22:41.146055 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:22:41.146055 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

  
    

   

    USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_orders_temp_view" as 

WITH

required_fields AS (

    SELECT

        id                  AS order_id
        , user_id           AS customer_id
        , order_date        AS order_date
        , status

    FROM "practice"."dbo"."jaffle_shop_orders"

),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT)               AS order_id
        , CAST(customer_id AS INT)          AS customer_id        
        , CONVERT(date, order_date)         AS order_date
        , status

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [practice].[dbt_staging].[stg_orders] FROM [practice].[dbt_staging].[stg_orders_temp_view];');
    

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_orders_temp_view";');



  
[0m14:22:41.152660 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.154675 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: COMMIT
[0m14:22:41.155674 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:22:41.156674 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      USE [practice];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_orders__dbt_backup'
  
[0m14:22:41.226620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.231616 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:22:41.231616 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      
      
    USE [practice];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_orders__dbt_backup";');

[0m14:22:41.233136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.234138 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_orders (execute): 14:22:41.107267 => 14:22:41.234138
[0m14:22:41.235137 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: ROLLBACK
[0m14:22:41.235137 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: Close
[0m14:22:41.236137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ffb25f-dae4-48f0-9841-556065b41d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026748B05810>]}
[0m14:22:41.237136 [info ] [Thread-1 (]: 2 of 4 OK created sql table model practice.dbt_staging.stg_orders .............. [[32mOK[0m in 0.14s]
[0m14:22:41.237952 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_orders
[0m14:22:41.238968 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_payments
[0m14:22:41.239971 [info ] [Thread-1 (]: 3 of 4 START sql table model practice.dbt_staging.stg_payments ................. [RUN]
[0m14:22:41.240954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_orders, now model.dbt_training.stg_payments)
[0m14:22:41.240954 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_payments
[0m14:22:41.246950 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_payments"
[0m14:22:41.248949 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_payments (compile): 14:22:41.241953 => 14:22:41.247949
[0m14:22:41.248949 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_payments
[0m14:22:41.256954 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:22:41.257944 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      
      
    USE [practice];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_payments__dbt_backup";');

[0m14:22:41.258944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:41.258944 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:22:41.259943 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:22:41.261954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.263938 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:22:41.263938 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_payments'
  
[0m14:22:41.264954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.267950 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:22:41.268950 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_payments_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:22:41.279462 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.282461 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:22:41.282461 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_payments_temp_view";');

  
[0m14:22:41.284460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.286472 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:22:41.286472 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_payments_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:22:41.287954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.288956 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_payments"
[0m14:22:41.289955 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:22:41.290955 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

  
    

   

    USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_payments_temp_view" as 

WITH

required_fields AS(

    SELECT

        *

    FROM "practice"."dbo"."stripe_payments"

),

datatype_and_renamed AS (

    SELECT

        CAST(id AS INT)             AS id
        , CAST(orderid AS INT)     AS order_id
        , paymentmethod
        , CAST(amount AS INT)       AS amount

    FROM required_fields

)

SELECT * FROM datatype_and_renamed;');



    
      EXEC('SELECT * INTO [practice].[dbt_staging].[stg_payments] FROM [practice].[dbt_staging].[stg_payments_temp_view];');
    

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_payments_temp_view";');



  
[0m14:22:41.298402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.300399 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: COMMIT
[0m14:22:41.300399 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:22:41.301399 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      USE [practice];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_payments__dbt_backup'
  
[0m14:22:41.368201 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.373199 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:22:41.373199 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      
      
    USE [practice];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_payments__dbt_backup";');

[0m14:22:41.374252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.376272 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_payments (execute): 14:22:41.248949 => 14:22:41.375269
[0m14:22:41.376272 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: ROLLBACK
[0m14:22:41.377271 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: Close
[0m14:22:41.378266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ffb25f-dae4-48f0-9841-556065b41d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026748C21DE0>]}
[0m14:22:41.378266 [info ] [Thread-1 (]: 3 of 4 OK created sql table model practice.dbt_staging.stg_payments ............ [[32mOK[0m in 0.14s]
[0m14:22:41.379270 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_payments
[0m14:22:41.380266 [debug] [Thread-1 (]: Began running node model.dbt_training.customer
[0m14:22:41.381251 [info ] [Thread-1 (]: 4 of 4 START sql table model practice.dbt_mart.customer ........................ [RUN]
[0m14:22:41.382264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_payments, now model.dbt_training.customer)
[0m14:22:41.382264 [debug] [Thread-1 (]: Began compiling node model.dbt_training.customer
[0m14:22:41.386261 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.customer"
[0m14:22:41.387261 [debug] [Thread-1 (]: Timing info for model.dbt_training.customer (compile): 14:22:41.383263 => 14:22:41.387261
[0m14:22:41.388266 [debug] [Thread-1 (]: Began executing node model.dbt_training.customer
[0m14:22:41.394262 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:22:41.395261 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      
      
    USE [practice];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m14:22:41.395261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:41.396243 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:22:41.397242 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:22:41.398244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.400258 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:22:41.401253 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m14:22:41.401253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.405250 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:22:41.406255 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:22:41.418248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.420242 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:22:41.420242 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m14:22:41.421246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.423240 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:22:41.424239 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:22:41.424239 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.426239 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.customer"
[0m14:22:41.428225 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:22:41.429224 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

  
    

   

    USE [practice];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 

WITH

stg_customer AS (

    SELECT

        *

    FROM "practice"."dbt_staging"."stg_customers"

),

stg_orders AS (

    SELECT

        *

    FROM "practice"."dbt_staging"."stg_orders"

),

order_info AS (

    SELECT

        customer_id
        , COUNT(*)      AS total_orders

    FROM stg_orders

    GROUP BY 
        customer_id

),

final AS (

    SELECT 

        sc.*
        , oi.total_orders

    FROM stg_customer sc

    LEFT JOIN order_info oi
        ON sc.customer_id = oi.customer_id
)

SELECT * FROM final;');



    
      EXEC('SELECT * INTO [practice].[dbt_mart].[customer] FROM [practice].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m14:22:41.443752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.446758 [debug] [Thread-1 (]: On model.dbt_training.customer: COMMIT
[0m14:22:41.447751 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:22:41.447751 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      USE [practice];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m14:22:41.512986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.576944 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:22:41.577943 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      
      
    USE [practice];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m14:22:41.578929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:41.580943 [debug] [Thread-1 (]: Timing info for model.dbt_training.customer (execute): 14:22:41.388266 => 14:22:41.579942
[0m14:22:41.580943 [debug] [Thread-1 (]: On model.dbt_training.customer: ROLLBACK
[0m14:22:41.581941 [debug] [Thread-1 (]: On model.dbt_training.customer: Close
[0m14:22:41.581941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ffb25f-dae4-48f0-9841-556065b41d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026748C84880>]}
[0m14:22:41.582940 [info ] [Thread-1 (]: 4 of 4 OK created sql table model practice.dbt_mart.customer ................... [[32mOK[0m in 0.20s]
[0m14:22:41.583948 [debug] [Thread-1 (]: Finished running node model.dbt_training.customer
[0m14:22:41.586074 [debug] [MainThread]: On master: COMMIT
[0m14:22:41.586074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:41.587073 [debug] [MainThread]: Connection 'create_practice_dbt_mart' was properly closed.
[0m14:22:41.587073 [debug] [MainThread]: Connection 'list_practice_dbt_mart' was properly closed.
[0m14:22:41.588072 [debug] [MainThread]: Connection 'model.dbt_training.customer' was properly closed.
[0m14:22:41.588072 [info ] [MainThread]: 
[0m14:22:41.589082 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m14:22:41.590538 [debug] [MainThread]: Command end result
[0m14:22:41.605543 [info ] [MainThread]: 
[0m14:22:41.606761 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:41.607782 [info ] [MainThread]: 
[0m14:22:41.608764 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:22:41.609772 [debug] [MainThread]: Command `dbt run` succeeded at 14:22:41.609772 after 4.12 seconds
[0m14:22:41.610771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002674551ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026748C84B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026748C84B80>]}
[0m14:22:41.610771 [debug] [MainThread]: Flushing usage events
[0m14:26:18.423133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDD1D1ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDD4601990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDD46017B0>]}


============================== 14:26:18.429144 | efe186fb-3758-48ed-bca7-e79c215a9641 ==============================
[0m14:26:18.429144 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:26:18.430129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:26:18.832799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efe186fb-3758-48ed-bca7-e79c215a9641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDD4601A50>]}
[0m14:26:18.934741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efe186fb-3758-48ed-bca7-e79c215a9641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDD4D939D0>]}
[0m14:26:18.935745 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m14:26:18.948719 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:26:19.071649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:26:19.072649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:26:19.080644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efe186fb-3758-48ed-bca7-e79c215a9641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDD4FB4220>]}
[0m14:26:19.084648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efe186fb-3758-48ed-bca7-e79c215a9641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDD4F76020>]}
[0m14:26:19.084648 [info ] [MainThread]: Found 4 models, 2 tests, 3 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:26:19.085890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efe186fb-3758-48ed-bca7-e79c215a9641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDD4F75FC0>]}
[0m14:26:19.087910 [info ] [MainThread]: 
[0m14:26:19.088910 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:26:19.090908 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice_dbt_staging'
[0m14:26:19.105901 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_staging"
[0m14:26:19.106899 [debug] [ThreadPool]: On list_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m14:26:19.106899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:19.107899 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:26:19.152006 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:26:19.152995 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:26:19.154994 [debug] [ThreadPool]: On list_practice_dbt_staging: ROLLBACK
[0m14:26:19.155994 [debug] [ThreadPool]: On list_practice_dbt_staging: Close
[0m14:26:19.157994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_staging, now list_practice_dbt_mart)
[0m14:26:19.161990 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_mart"
[0m14:26:19.161990 [debug] [ThreadPool]: On list_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m14:26:19.162990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:26:19.162990 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:26:19.163989 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:26:19.164988 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:26:19.166002 [debug] [ThreadPool]: On list_practice_dbt_mart: ROLLBACK
[0m14:26:19.167002 [debug] [ThreadPool]: On list_practice_dbt_mart: Close
[0m14:26:19.168001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efe186fb-3758-48ed-bca7-e79c215a9641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDD4F75C00>]}
[0m14:26:19.169005 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:26:19.169990 [info ] [MainThread]: 
[0m14:26:19.174997 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_customers
[0m14:26:19.175997 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_training.stg_customers'
[0m14:26:19.176995 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_customers
[0m14:26:19.187975 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_customers"
[0m14:26:19.189979 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_customers (compile): 14:26:19.176995 => 14:26:19.189979
[0m14:26:19.190975 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_customers
[0m14:26:19.190975 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_customers (execute): 14:26:19.190975 => 14:26:19.190975
[0m14:26:19.191975 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_customers
[0m14:26:19.192974 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_orders
[0m14:26:19.193973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_customers, now model.dbt_training.stg_orders)
[0m14:26:19.193973 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_orders
[0m14:26:19.197983 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_orders"
[0m14:26:19.199969 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_orders (compile): 14:26:19.194985 => 14:26:19.198982
[0m14:26:19.199969 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_orders
[0m14:26:19.200968 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_orders (execute): 14:26:19.199969 => 14:26:19.199969
[0m14:26:19.201967 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_orders
[0m14:26:19.202967 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_payments
[0m14:26:19.205966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_orders, now model.dbt_training.stg_payments)
[0m14:26:19.206968 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_payments
[0m14:26:19.210977 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_payments"
[0m14:26:19.213961 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_payments (compile): 14:26:19.206968 => 14:26:19.212968
[0m14:26:19.213961 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_payments
[0m14:26:19.214962 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_payments (execute): 14:26:19.213961 => 14:26:19.214962
[0m14:26:19.215961 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_payments
[0m14:26:19.215961 [debug] [Thread-1 (]: Began running node model.dbt_training.customer
[0m14:26:19.216960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_payments, now model.dbt_training.customer)
[0m14:26:19.217960 [debug] [Thread-1 (]: Began compiling node model.dbt_training.customer
[0m14:26:19.222955 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.customer"
[0m14:26:19.224954 [debug] [Thread-1 (]: Timing info for model.dbt_training.customer (compile): 14:26:19.217960 => 14:26:19.224954
[0m14:26:19.225954 [debug] [Thread-1 (]: Began executing node model.dbt_training.customer
[0m14:26:19.226953 [debug] [Thread-1 (]: Timing info for model.dbt_training.customer (execute): 14:26:19.225954 => 14:26:19.225954
[0m14:26:19.227967 [debug] [Thread-1 (]: Finished running node model.dbt_training.customer
[0m14:26:19.229967 [debug] [Thread-1 (]: Began running node test.dbt_training.not_null_customer_customer_id.c1a055ec3f
[0m14:26:19.230967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.customer, now test.dbt_training.not_null_customer_customer_id.c1a055ec3f)
[0m14:26:19.230967 [debug] [Thread-1 (]: Began compiling node test.dbt_training.not_null_customer_customer_id.c1a055ec3f
[0m14:26:19.246956 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_training.not_null_customer_customer_id.c1a055ec3f"
[0m14:26:19.249941 [debug] [Thread-1 (]: Timing info for test.dbt_training.not_null_customer_customer_id.c1a055ec3f (compile): 14:26:19.231965 => 14:26:19.248960
[0m14:26:19.249941 [debug] [Thread-1 (]: Began executing node test.dbt_training.not_null_customer_customer_id.c1a055ec3f
[0m14:26:19.250940 [debug] [Thread-1 (]: Timing info for test.dbt_training.not_null_customer_customer_id.c1a055ec3f (execute): 14:26:19.250940 => 14:26:19.250940
[0m14:26:19.251940 [debug] [Thread-1 (]: Finished running node test.dbt_training.not_null_customer_customer_id.c1a055ec3f
[0m14:26:19.252938 [debug] [Thread-1 (]: Began running node test.dbt_training.unique_customer_customer_id.f080c6d6bd
[0m14:26:19.254937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_training.not_null_customer_customer_id.c1a055ec3f, now test.dbt_training.unique_customer_customer_id.f080c6d6bd)
[0m14:26:19.255937 [debug] [Thread-1 (]: Began compiling node test.dbt_training.unique_customer_customer_id.f080c6d6bd
[0m14:26:19.264931 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_training.unique_customer_customer_id.f080c6d6bd"
[0m14:26:19.265930 [debug] [Thread-1 (]: Timing info for test.dbt_training.unique_customer_customer_id.f080c6d6bd (compile): 14:26:19.255937 => 14:26:19.265930
[0m14:26:19.266930 [debug] [Thread-1 (]: Began executing node test.dbt_training.unique_customer_customer_id.f080c6d6bd
[0m14:26:19.267930 [debug] [Thread-1 (]: Timing info for test.dbt_training.unique_customer_customer_id.f080c6d6bd (execute): 14:26:19.266930 => 14:26:19.266930
[0m14:26:19.268929 [debug] [Thread-1 (]: Finished running node test.dbt_training.unique_customer_customer_id.f080c6d6bd
[0m14:26:19.270933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:19.271942 [debug] [MainThread]: Connection 'list_practice_dbt_mart' was properly closed.
[0m14:26:19.271942 [debug] [MainThread]: Connection 'test.dbt_training.unique_customer_customer_id.f080c6d6bd' was properly closed.
[0m14:26:19.273940 [debug] [MainThread]: Command end result
[0m14:26:19.306622 [debug] [MainThread]: Acquiring new sqlserver connection 'generate_catalog'
[0m14:26:19.307625 [info ] [MainThread]: Building catalog
[0m14:26:19.369585 [debug] [ThreadPool]: Acquiring new sqlserver connection 'practice.information_schema'
[0m14:26:19.381579 [debug] [ThreadPool]: Using sqlserver connection "practice.information_schema"
[0m14:26:19.381579 [debug] [ThreadPool]: On practice.information_schema: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "practice.information_schema"} */
with
    principals as (
        select
            name as principal_name,
            principal_id as principal_id
        from
            sys.database_principals 
    ),

    schemas as (
        select
            name as schema_name,
            schema_id as schema_id,
            principal_id as principal_id
        from
            sys.schemas 
    ),

    tables as (
        select
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'BASE TABLE' as table_type
        from
            sys.tables 
    ),

    tables_with_metadata as (
        select
            table_name,
            schema_name,
            coalesce(tables.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            tables
        join schemas on tables.schema_id = schemas.schema_id
    ),

    views as (
        select
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'VIEW' as table_type
        from
            sys.views 
    ),

    views_with_metadata as (
        select
            table_name,
            schema_name,
            coalesce(views.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            views
        join schemas on views.schema_id = schemas.schema_id
    ),

    tables_and_views as (
        select
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            tables_with_metadata
        join principals on tables_with_metadata.owner_principal_id = principals.principal_id
        union all
        select
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            views_with_metadata
        join principals on views_with_metadata.owner_principal_id = principals.principal_id
    ),

    cols as (

        select
            table_catalog as table_database,
            table_schema,
            table_name,
            column_name,
            ordinal_position as column_index,
            data_type as column_type
        from INFORMATION_SCHEMA.COLUMNS 

    )

    select
        cols.table_database,
        tv.schema_name as table_schema,
        tv.table_name,
        tv.table_type,
        null as table_comment,
        tv.principal_name as table_owner,
        cols.column_name,
        cols.column_index,
        cols.column_type,
        null as column_comment
    from tables_and_views tv
    join cols on tv.schema_name = cols.table_schema and tv.table_name = cols.table_name
    where (
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('stripe_payments')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('jaffle_shop_orders')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('jaffle_shop_customers')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbt_staging')
                    and upper(tv.table_name) = upper('stg_orders')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbt_mart')
                    and upper(tv.table_name) = upper('customer')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbt_staging')
                    and upper(tv.table_name) = upper('stg_payments')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbt_staging')
                    and upper(tv.table_name) = upper('stg_customers')
                )
            )

    order by column_index
[0m14:26:19.382564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:19.382564 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:26:19.383577 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:26:19.507507 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:26:19.509506 [debug] [ThreadPool]: On practice.information_schema: ROLLBACK
[0m14:26:19.509506 [debug] [ThreadPool]: On practice.information_schema: Close
[0m14:26:19.522504 [info ] [MainThread]: Catalog written to C:\Users\NadimintiDeepthi\Desktop\dbt\dbt_training\target\catalog.json
[0m14:26:19.525502 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:26:19.524502 after 1.19 seconds
[0m14:26:19.525502 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:26:19.525502 [debug] [MainThread]: Connection 'practice.information_schema' was properly closed.
[0m14:26:19.526501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDD1D1ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDD4D939D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDD4C753F0>]}
[0m14:26:19.526501 [debug] [MainThread]: Flushing usage events
[0m14:26:50.854661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0A444ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0A6D26290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0A6D260B0>]}


============================== 14:26:50.861656 | 61407cf8-df10-4ad3-aa99-58bc197e589f ==============================
[0m14:26:50.861656 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:26:50.862120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:26:51.435667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61407cf8-df10-4ad3-aa99-58bc197e589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0A6D26350>]}
[0m14:26:51.538607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61407cf8-df10-4ad3-aa99-58bc197e589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0A74BBCD0>]}
[0m14:32:55.557743 [error] [MainThread]: Encountered an error:

[0m14:32:55.643705 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\main.py", line 324, in docs_serve
    results = task.run()
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m14:32:55.648704 [debug] [MainThread]: Command `dbt docs serve` failed at 14:32:55.648704 after 364.92 seconds
[0m14:32:55.649704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0A444ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0A74B98D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0A74B8580>]}
[0m14:32:55.650703 [debug] [MainThread]: Flushing usage events
[0m14:37:31.683845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4B6BF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4DF96350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4DF96170>]}


============================== 14:37:31.689842 | 69cb32d8-3046-4558-baa9-049450c46a47 ==============================
[0m14:37:31.689842 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:37:31.690836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:37:32.079409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69cb32d8-3046-4558-baa9-049450c46a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4DF96410>]}
[0m14:37:32.180351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69cb32d8-3046-4558-baa9-049450c46a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4E72FD00>]}
[0m14:37:32.181350 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m14:37:32.204881 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:37:33.267955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:33.267955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:33.274951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69cb32d8-3046-4558-baa9-049450c46a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4E954190>]}
[0m14:37:33.298410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69cb32d8-3046-4558-baa9-049450c46a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4E919F30>]}
[0m14:37:33.299391 [info ] [MainThread]: Found 4 models, 2 tests, 3 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:37:33.300409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69cb32d8-3046-4558-baa9-049450c46a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4E918F40>]}
[0m14:37:33.302391 [info ] [MainThread]: 
[0m14:37:33.304407 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:37:33.306401 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice_dbt_mart'
[0m14:37:33.322392 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_mart"
[0m14:37:33.323391 [debug] [ThreadPool]: On list_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m14:37:33.323391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:33.324390 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:37:33.388729 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:37:33.398737 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:37:33.400723 [debug] [ThreadPool]: On list_practice_dbt_mart: ROLLBACK
[0m14:37:33.400723 [debug] [ThreadPool]: On list_practice_dbt_mart: Close
[0m14:37:33.401722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_mart, now list_practice_dbt_staging)
[0m14:37:33.404720 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_staging"
[0m14:37:33.405720 [debug] [ThreadPool]: On list_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m14:37:33.405720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:33.406719 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:37:33.406719 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:37:33.414821 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:37:33.415807 [debug] [ThreadPool]: On list_practice_dbt_staging: ROLLBACK
[0m14:37:33.416806 [debug] [ThreadPool]: On list_practice_dbt_staging: Close
[0m14:37:33.417806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69cb32d8-3046-4558-baa9-049450c46a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4E90BD60>]}
[0m14:37:33.417806 [debug] [MainThread]: On master: COMMIT
[0m14:37:33.418819 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:37:33.419804 [info ] [MainThread]: 
[0m14:37:33.423835 [debug] [Thread-1 (]: Began running node test.dbt_training.not_null_customer_customer_id.c1a055ec3f
[0m14:37:33.423835 [info ] [Thread-1 (]: 1 of 2 START test not_null_customer_customer_id ................................ [RUN]
[0m14:37:33.425048 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_training.not_null_customer_customer_id.c1a055ec3f'
[0m14:37:33.426063 [debug] [Thread-1 (]: Began compiling node test.dbt_training.not_null_customer_customer_id.c1a055ec3f
[0m14:37:33.446037 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_training.not_null_customer_customer_id.c1a055ec3f"
[0m14:37:33.448037 [debug] [Thread-1 (]: Timing info for test.dbt_training.not_null_customer_customer_id.c1a055ec3f (compile): 14:37:33.426063 => 14:37:33.447037
[0m14:37:33.448037 [debug] [Thread-1 (]: Began executing node test.dbt_training.not_null_customer_customer_id.c1a055ec3f
[0m14:37:33.469024 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_training.not_null_customer_customer_id.c1a055ec3f"
[0m14:37:33.471023 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_training.not_null_customer_customer_id.c1a055ec3f"
[0m14:37:33.472023 [debug] [Thread-1 (]: On test.dbt_training.not_null_customer_customer_id.c1a055ec3f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "test.dbt_training.not_null_customer_customer_id.c1a055ec3f"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select customer_id
from "practice"."dbt_mart"."customer"
where customer_id is null



    ) dbt_internal_test
[0m14:37:33.473030 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:37:33.474022 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:37:33.478353 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:37:33.483133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:37:33.486150 [debug] [Thread-1 (]: Timing info for test.dbt_training.not_null_customer_customer_id.c1a055ec3f (execute): 14:37:33.449036 => 14:37:33.486150
[0m14:37:33.487139 [debug] [Thread-1 (]: On test.dbt_training.not_null_customer_customer_id.c1a055ec3f: ROLLBACK
[0m14:37:33.487139 [debug] [Thread-1 (]: On test.dbt_training.not_null_customer_customer_id.c1a055ec3f: Close
[0m14:37:33.488143 [info ] [Thread-1 (]: 1 of 2 PASS not_null_customer_customer_id ...................................... [[32mPASS[0m in 0.06s]
[0m14:37:33.490142 [debug] [Thread-1 (]: Finished running node test.dbt_training.not_null_customer_customer_id.c1a055ec3f
[0m14:37:33.490142 [debug] [Thread-1 (]: Began running node test.dbt_training.unique_customer_customer_id.f080c6d6bd
[0m14:37:33.491136 [info ] [Thread-1 (]: 2 of 2 START test unique_customer_customer_id .................................. [RUN]
[0m14:37:33.492134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_training.not_null_customer_customer_id.c1a055ec3f, now test.dbt_training.unique_customer_customer_id.f080c6d6bd)
[0m14:37:33.493127 [debug] [Thread-1 (]: Began compiling node test.dbt_training.unique_customer_customer_id.f080c6d6bd
[0m14:37:33.503122 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_training.unique_customer_customer_id.f080c6d6bd"
[0m14:37:33.504124 [debug] [Thread-1 (]: Timing info for test.dbt_training.unique_customer_customer_id.f080c6d6bd (compile): 14:37:33.493127 => 14:37:33.504124
[0m14:37:33.505120 [debug] [Thread-1 (]: Began executing node test.dbt_training.unique_customer_customer_id.f080c6d6bd
[0m14:37:33.510117 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_training.unique_customer_customer_id.f080c6d6bd"
[0m14:37:33.512114 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_training.unique_customer_customer_id.f080c6d6bd"
[0m14:37:33.512114 [debug] [Thread-1 (]: On test.dbt_training.unique_customer_customer_id.f080c6d6bd: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "test.dbt_training.unique_customer_customer_id.f080c6d6bd"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "practice"."dbt_mart"."customer"
where customer_id is not null
group by customer_id
having count(*) > 1



    ) dbt_internal_test
[0m14:37:33.513115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:33.513115 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:37:33.514115 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:37:33.517112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:37:33.520110 [debug] [Thread-1 (]: Timing info for test.dbt_training.unique_customer_customer_id.f080c6d6bd (execute): 14:37:33.505120 => 14:37:33.519111
[0m14:37:33.520110 [debug] [Thread-1 (]: On test.dbt_training.unique_customer_customer_id.f080c6d6bd: ROLLBACK
[0m14:37:33.521109 [debug] [Thread-1 (]: On test.dbt_training.unique_customer_customer_id.f080c6d6bd: Close
[0m14:37:33.522110 [info ] [Thread-1 (]: 2 of 2 PASS unique_customer_customer_id ........................................ [[32mPASS[0m in 0.03s]
[0m14:37:33.524110 [debug] [Thread-1 (]: Finished running node test.dbt_training.unique_customer_customer_id.f080c6d6bd
[0m14:37:33.525764 [debug] [MainThread]: On master: COMMIT
[0m14:37:33.525764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:33.526768 [debug] [MainThread]: Connection 'list_practice_dbt_staging' was properly closed.
[0m14:37:33.526768 [debug] [MainThread]: Connection 'test.dbt_training.unique_customer_customer_id.f080c6d6bd' was properly closed.
[0m14:37:33.526768 [info ] [MainThread]: 
[0m14:37:33.527768 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m14:37:33.529759 [debug] [MainThread]: Command end result
[0m14:37:33.596710 [info ] [MainThread]: 
[0m14:37:33.597741 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:37:33.598709 [info ] [MainThread]: 
[0m14:37:33.599715 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:37:33.601726 [debug] [MainThread]: Command `dbt test` succeeded at 14:37:33.600708 after 1.99 seconds
[0m14:37:33.601726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4B6BF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4EA0BBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4EA0A200>]}
[0m14:37:33.601726 [debug] [MainThread]: Flushing usage events
[0m14:38:49.857945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A685FEACB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6888D62C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6888D60E0>]}


============================== 14:38:49.863959 | ff5d6313-d888-401b-8a3b-2d41cedb9916 ==============================
[0m14:38:49.863959 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:38:49.864940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:38:50.253884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff5d6313-d888-401b-8a3b-2d41cedb9916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6888D6380>]}
[0m14:38:50.356826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff5d6313-d888-401b-8a3b-2d41cedb9916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A688ED9300>]}
[0m14:38:50.356826 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m14:38:50.368899 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:38:50.477840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:38:50.477840 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:38:50.484819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff5d6313-d888-401b-8a3b-2d41cedb9916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6892A4100>]}
[0m14:38:50.500809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff5d6313-d888-401b-8a3b-2d41cedb9916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A689269F00>]}
[0m14:38:50.500809 [info ] [MainThread]: Found 4 models, 2 tests, 3 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:38:50.501811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff5d6313-d888-401b-8a3b-2d41cedb9916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A689268E80>]}
[0m14:38:50.503809 [info ] [MainThread]: 
[0m14:38:50.504827 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:38:50.506806 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice_dbt_mart'
[0m14:38:50.523796 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_mart"
[0m14:38:50.523796 [debug] [ThreadPool]: On list_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m14:38:50.524795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:50.524795 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:38:50.569804 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:38:50.571798 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:38:50.572798 [debug] [ThreadPool]: On list_practice_dbt_mart: ROLLBACK
[0m14:38:50.573798 [debug] [ThreadPool]: On list_practice_dbt_mart: Close
[0m14:38:50.574797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_mart, now list_practice_dbt_staging)
[0m14:38:50.577795 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_staging"
[0m14:38:50.577795 [debug] [ThreadPool]: On list_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m14:38:50.578794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:50.578794 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:38:50.579794 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:38:50.580793 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:38:50.581807 [debug] [ThreadPool]: On list_practice_dbt_staging: ROLLBACK
[0m14:38:50.581807 [debug] [ThreadPool]: On list_practice_dbt_staging: Close
[0m14:38:50.582806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff5d6313-d888-401b-8a3b-2d41cedb9916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A68925B160>]}
[0m14:38:50.583792 [debug] [MainThread]: On master: COMMIT
[0m14:38:50.585790 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:38:50.586791 [info ] [MainThread]: 
[0m14:38:50.590802 [debug] [Thread-1 (]: Began running node test.dbt_training.not_null_customer_customer_id.c1a055ec3f
[0m14:38:50.590802 [info ] [Thread-1 (]: 1 of 2 START test not_null_customer_customer_id ................................ [RUN]
[0m14:38:50.591911 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_training.not_null_customer_customer_id.c1a055ec3f'
[0m14:38:50.592927 [debug] [Thread-1 (]: Began compiling node test.dbt_training.not_null_customer_customer_id.c1a055ec3f
[0m14:38:50.613902 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_training.not_null_customer_customer_id.c1a055ec3f"
[0m14:38:50.615902 [debug] [Thread-1 (]: Timing info for test.dbt_training.not_null_customer_customer_id.c1a055ec3f (compile): 14:38:50.592927 => 14:38:50.615902
[0m14:38:50.616918 [debug] [Thread-1 (]: Began executing node test.dbt_training.not_null_customer_customer_id.c1a055ec3f
[0m14:38:50.638901 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_training.not_null_customer_customer_id.c1a055ec3f"
[0m14:38:50.640900 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_training.not_null_customer_customer_id.c1a055ec3f"
[0m14:38:50.640900 [debug] [Thread-1 (]: On test.dbt_training.not_null_customer_customer_id.c1a055ec3f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "test.dbt_training.not_null_customer_customer_id.c1a055ec3f"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select customer_id
from "practice"."dbt_mart"."customer"
where customer_id is null



    ) dbt_internal_test
[0m14:38:50.641898 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:38:50.641898 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:38:50.645650 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:38:50.646650 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:38:50.649647 [debug] [Thread-1 (]: Timing info for test.dbt_training.not_null_customer_customer_id.c1a055ec3f (execute): 14:38:50.616918 => 14:38:50.648648
[0m14:38:50.649647 [debug] [Thread-1 (]: On test.dbt_training.not_null_customer_customer_id.c1a055ec3f: ROLLBACK
[0m14:38:50.650647 [debug] [Thread-1 (]: On test.dbt_training.not_null_customer_customer_id.c1a055ec3f: Close
[0m14:38:50.651632 [info ] [Thread-1 (]: 1 of 2 PASS not_null_customer_customer_id ...................................... [[32mPASS[0m in 0.06s]
[0m14:38:50.652632 [debug] [Thread-1 (]: Finished running node test.dbt_training.not_null_customer_customer_id.c1a055ec3f
[0m14:38:50.653651 [debug] [Thread-1 (]: Began running node test.dbt_training.unique_customer_customer_id.f080c6d6bd
[0m14:38:50.654642 [info ] [Thread-1 (]: 2 of 2 START test unique_customer_customer_id .................................. [RUN]
[0m14:38:50.655160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_training.not_null_customer_customer_id.c1a055ec3f, now test.dbt_training.unique_customer_customer_id.f080c6d6bd)
[0m14:38:50.656177 [debug] [Thread-1 (]: Began compiling node test.dbt_training.unique_customer_customer_id.f080c6d6bd
[0m14:38:50.664171 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_training.unique_customer_customer_id.f080c6d6bd"
[0m14:38:50.665170 [debug] [Thread-1 (]: Timing info for test.dbt_training.unique_customer_customer_id.f080c6d6bd (compile): 14:38:50.656177 => 14:38:50.665170
[0m14:38:50.666175 [debug] [Thread-1 (]: Began executing node test.dbt_training.unique_customer_customer_id.f080c6d6bd
[0m14:38:50.671155 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_training.unique_customer_customer_id.f080c6d6bd"
[0m14:38:50.673152 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_training.unique_customer_customer_id.f080c6d6bd"
[0m14:38:50.674152 [debug] [Thread-1 (]: On test.dbt_training.unique_customer_customer_id.f080c6d6bd: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "test.dbt_training.unique_customer_customer_id.f080c6d6bd"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "practice"."dbt_mart"."customer"
where customer_id is not null
group by customer_id
having count(*) > 1



    ) dbt_internal_test
[0m14:38:50.675151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:50.675151 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:38:50.676151 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:38:50.677150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:38:50.680167 [debug] [Thread-1 (]: Timing info for test.dbt_training.unique_customer_customer_id.f080c6d6bd (execute): 14:38:50.666175 => 14:38:50.679167
[0m14:38:50.680167 [debug] [Thread-1 (]: On test.dbt_training.unique_customer_customer_id.f080c6d6bd: ROLLBACK
[0m14:38:50.681162 [debug] [Thread-1 (]: On test.dbt_training.unique_customer_customer_id.f080c6d6bd: Close
[0m14:38:50.682161 [info ] [Thread-1 (]: 2 of 2 PASS unique_customer_customer_id ........................................ [[32mPASS[0m in 0.03s]
[0m14:38:50.683161 [debug] [Thread-1 (]: Finished running node test.dbt_training.unique_customer_customer_id.f080c6d6bd
[0m14:38:50.684151 [debug] [MainThread]: On master: COMMIT
[0m14:38:50.685147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:50.686146 [debug] [MainThread]: Connection 'list_practice_dbt_staging' was properly closed.
[0m14:38:50.686146 [debug] [MainThread]: Connection 'test.dbt_training.unique_customer_customer_id.f080c6d6bd' was properly closed.
[0m14:38:50.687146 [info ] [MainThread]: 
[0m14:38:50.687146 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m14:38:50.689161 [debug] [MainThread]: Command end result
[0m14:38:50.761102 [info ] [MainThread]: 
[0m14:38:50.762101 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:38:50.763081 [info ] [MainThread]: 
[0m14:38:50.764088 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:38:50.765097 [debug] [MainThread]: Command `dbt test` succeeded at 14:38:50.765097 after 0.98 seconds
[0m14:38:50.766096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A685FEACB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A689359BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A689359C00>]}
[0m14:38:50.766096 [debug] [MainThread]: Flushing usage events
[0m14:47:12.830853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001210448F940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012106D66290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012106D660B0>]}


============================== 14:47:12.835847 | e7eb96ea-9bc2-4a01-b458-e866ddd6317f ==============================
[0m14:47:12.835847 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:47:12.836846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:47:13.411392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7eb96ea-9bc2-4a01-b458-e866ddd6317f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012106D66350>]}
[0m14:47:13.512332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7eb96ea-9bc2-4a01-b458-e866ddd6317f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000121074FFCD0>]}
[0m14:47:13.513332 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m14:47:13.540861 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:47:14.597807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:47:14.598806 [debug] [MainThread]: Partial parsing: added file: dbt_training://snapshots\snap.sql
[0m14:47:14.823659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7eb96ea-9bc2-4a01-b458-e866ddd6317f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000121074179A0>]}
[0m14:47:14.848725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7eb96ea-9bc2-4a01-b458-e866ddd6317f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000121076DB310>]}
[0m14:47:14.848725 [info ] [MainThread]: Found 4 models, 2 tests, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:47:14.850721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7eb96ea-9bc2-4a01-b458-e866ddd6317f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000121076DA920>]}
[0m14:47:14.852739 [info ] [MainThread]: 
[0m14:47:14.854738 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:47:14.856732 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice'
[0m14:47:14.870729 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m14:47:14.871711 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m14:47:14.871711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:14.872718 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:47:14.923298 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:47:14.925288 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:47:14.928301 [debug] [ThreadPool]: On list_practice: Close
[0m14:47:14.929300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice, now create_practice_snapshots)
[0m14:47:14.930294 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "snapshots"
"
[0m14:47:14.936295 [debug] [ThreadPool]: Using sqlserver connection "create_practice_snapshots"
[0m14:47:14.936295 [debug] [ThreadPool]: On create_practice_snapshots: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_snapshots"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'snapshots')
    BEGIN
    EXEC('CREATE SCHEMA [snapshots]')
    END
  
[0m14:47:14.937294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:14.937294 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:47:14.938298 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:47:14.942291 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:47:14.944287 [debug] [ThreadPool]: On create_practice_snapshots: COMMIT
[0m14:47:14.944287 [debug] [ThreadPool]: On create_practice_snapshots: Close
[0m14:47:14.946285 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice_dbt_mart'
[0m14:47:14.954289 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_mart"
[0m14:47:14.955284 [debug] [ThreadPool]: On list_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m14:47:14.955284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:14.956288 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:47:14.956288 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:47:14.957279 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:47:14.959282 [debug] [ThreadPool]: On list_practice_dbt_mart: ROLLBACK
[0m14:47:14.959282 [debug] [ThreadPool]: On list_practice_dbt_mart: Close
[0m14:47:14.961281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_mart, now list_practice_dbt_staging)
[0m14:47:14.964279 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_staging"
[0m14:47:14.964279 [debug] [ThreadPool]: On list_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m14:47:14.965283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:14.965283 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:47:14.965283 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:47:14.966282 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:47:14.968277 [debug] [ThreadPool]: On list_practice_dbt_staging: ROLLBACK
[0m14:47:14.968277 [debug] [ThreadPool]: On list_practice_dbt_staging: Close
[0m14:47:14.969276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_staging, now list_practice_snapshots)
[0m14:47:14.972274 [debug] [ThreadPool]: Using sqlserver connection "list_practice_snapshots"
[0m14:47:14.972274 [debug] [ThreadPool]: On list_practice_snapshots: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_snapshots"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'snapshots'
  
[0m14:47:14.973278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:14.973278 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:47:14.974273 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:47:14.981984 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:47:14.982971 [debug] [ThreadPool]: On list_practice_snapshots: ROLLBACK
[0m14:47:14.983970 [debug] [ThreadPool]: On list_practice_snapshots: Close
[0m14:47:14.984970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7eb96ea-9bc2-4a01-b458-e866ddd6317f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012107870A60>]}
[0m14:47:14.984970 [debug] [MainThread]: On master: COMMIT
[0m14:47:14.985983 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:47:14.986814 [info ] [MainThread]: 
[0m14:47:14.990834 [debug] [Thread-1 (]: Began running node snapshot.dbt_training.orders_snapshot
[0m14:47:14.991829 [info ] [Thread-1 (]: 1 of 1 START snapshot practice.snapshots.orders_snapshot ....................... [RUN]
[0m14:47:14.992813 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'snapshot.dbt_training.orders_snapshot'
[0m14:47:14.993814 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_training.orders_snapshot
[0m14:47:15.002818 [debug] [Thread-1 (]: Timing info for snapshot.dbt_training.orders_snapshot (compile): 14:47:14.993814 => 14:47:15.002818
[0m14:47:15.003816 [debug] [Thread-1 (]: Began executing node snapshot.dbt_training.orders_snapshot
[0m14:47:15.068771 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m14:47:15.069770 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'snapshots'
      and refs.referenced_entity_name = 'orders_snapshot_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:47:15.069770 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:47:15.070770 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:47:15.074622 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:47:15.090611 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:47:15.094622 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m14:47:15.094622 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "snapshots"."orders_snapshot_temp_view";');

  
[0m14:47:15.095622 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:47:15.100619 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m14:47:15.101619 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'snapshots'
      and refs.referenced_entity_name = 'orders_snapshot_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:47:15.111620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:47:15.113621 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_training.orders_snapshot"
[0m14:47:15.115621 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m14:47:15.116633 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      
  
    

   

    USE [practice];
    
    

    EXEC('create view "snapshots"."orders_snapshot_temp_view" as 

    select *,
        
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(id as varchar(8000)), '''')  + ''|'' + 
    
        coalesce(cast(updated_at as varchar(8000)), '''') 
    ), 2)
 as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



select * from "practice"."dbo"."jaffle_shop_orders"

    ) sbq


;');



    
      EXEC('SELECT * INTO [practice].[snapshots].[orders_snapshot] FROM [practice].[snapshots].[orders_snapshot_temp_view];');
    

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "snapshots"."orders_snapshot_temp_view";');



  
  
[0m14:47:15.119636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:47:15.120617 [debug] [Thread-1 (]: Timing info for snapshot.dbt_training.orders_snapshot (execute): 14:47:15.003816 => 14:47:15.120617
[0m14:47:15.121616 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: ROLLBACK
[0m14:47:15.121616 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: Close
[0m14:47:15.122615 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_training\snapshots\snap.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207)")
[0m14:47:15.207858 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 164, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207)")

[0m14:47:15.208859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7eb96ea-9bc2-4a01-b458-e866ddd6317f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000121074C4CA0>]}
[0m14:47:15.210857 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting practice.snapshots.orders_snapshot ................... [[31mERROR[0m in 0.22s]
[0m14:47:15.211340 [debug] [Thread-1 (]: Finished running node snapshot.dbt_training.orders_snapshot
[0m14:47:15.213358 [debug] [MainThread]: On master: COMMIT
[0m14:47:15.214357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:15.214357 [debug] [MainThread]: Connection 'create_practice_snapshots' was properly closed.
[0m14:47:15.214357 [debug] [MainThread]: Connection 'list_practice_snapshots' was properly closed.
[0m14:47:15.215359 [debug] [MainThread]: Connection 'snapshot.dbt_training.orders_snapshot' was properly closed.
[0m14:47:15.215359 [info ] [MainThread]: 
[0m14:47:15.216350 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m14:47:15.217348 [debug] [MainThread]: Command end result
[0m14:47:15.232330 [info ] [MainThread]: 
[0m14:47:15.233331 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:47:15.234349 [info ] [MainThread]: 
[0m14:47:15.235328 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'updated_at'. (207)")
[0m14:47:15.236327 [info ] [MainThread]: 
[0m14:47:15.237328 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:47:15.238341 [debug] [MainThread]: Command `dbt snapshot` failed at 14:47:15.238341 after 2.51 seconds
[0m14:47:15.239340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001210448F940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000121074171F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012107417BE0>]}
[0m14:47:15.239340 [debug] [MainThread]: Flushing usage events
[0m14:50:24.582994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A0261CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A04ED6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A04ED6140>]}


============================== 14:50:24.587992 | 9333d4e4-23c5-457c-aa91-83b54e16926f ==============================
[0m14:50:24.587992 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:50:24.588993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m14:50:24.970741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9333d4e4-23c5-457c-aa91-83b54e16926f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A04ED63E0>]}
[0m14:50:25.073696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9333d4e4-23c5-457c-aa91-83b54e16926f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A05665FC0>]}
[0m14:50:25.074699 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m14:50:25.086688 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:50:25.207847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:50:25.208847 [debug] [MainThread]: Partial parsing: updated file: dbt_training://snapshots\snap.sql
[0m14:50:25.436717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9333d4e4-23c5-457c-aa91-83b54e16926f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A05699180>]}
[0m14:50:25.450709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9333d4e4-23c5-457c-aa91-83b54e16926f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A0577E6E0>]}
[0m14:50:25.451708 [info ] [MainThread]: Found 4 models, 2 tests, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:50:25.452504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9333d4e4-23c5-457c-aa91-83b54e16926f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A0577D270>]}
[0m14:50:25.454520 [info ] [MainThread]: 
[0m14:50:25.455520 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:50:25.456523 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice'
[0m14:50:25.471496 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m14:50:25.472495 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m14:50:25.472495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:25.472495 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:25.516712 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:50:25.517661 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:25.518662 [debug] [ThreadPool]: On list_practice: Close
[0m14:50:25.520667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice, now create_practice_snapshots)
[0m14:50:25.521660 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "snapshots"
"
[0m14:50:25.526657 [debug] [ThreadPool]: Using sqlserver connection "create_practice_snapshots"
[0m14:50:25.526657 [debug] [ThreadPool]: On create_practice_snapshots: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_snapshots"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'snapshots')
    BEGIN
    EXEC('CREATE SCHEMA [snapshots]')
    END
  
[0m14:50:25.527657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:25.527657 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:25.528656 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:50:25.530287 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:25.532299 [debug] [ThreadPool]: On create_practice_snapshots: COMMIT
[0m14:50:25.532299 [debug] [ThreadPool]: On create_practice_snapshots: Close
[0m14:50:25.534298 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice_dbt_mart'
[0m14:50:25.541294 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_mart"
[0m14:50:25.542293 [debug] [ThreadPool]: On list_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m14:50:25.542293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:25.543293 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:25.543293 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:50:25.544737 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:25.545739 [debug] [ThreadPool]: On list_practice_dbt_mart: ROLLBACK
[0m14:50:25.545739 [debug] [ThreadPool]: On list_practice_dbt_mart: Close
[0m14:50:25.546738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_mart, now list_practice_dbt_staging)
[0m14:50:25.549736 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_staging"
[0m14:50:25.550736 [debug] [ThreadPool]: On list_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m14:50:25.550736 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:25.551735 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:25.551735 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:50:25.552975 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:25.553990 [debug] [ThreadPool]: On list_practice_dbt_staging: ROLLBACK
[0m14:50:25.554989 [debug] [ThreadPool]: On list_practice_dbt_staging: Close
[0m14:50:25.555988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_staging, now list_practice_snapshots)
[0m14:50:25.557987 [debug] [ThreadPool]: Using sqlserver connection "list_practice_snapshots"
[0m14:50:25.558986 [debug] [ThreadPool]: On list_practice_snapshots: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_snapshots"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'snapshots'
  
[0m14:50:25.558986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:25.558986 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:25.559986 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:50:25.560972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:25.561985 [debug] [ThreadPool]: On list_practice_snapshots: ROLLBACK
[0m14:50:25.561985 [debug] [ThreadPool]: On list_practice_snapshots: Close
[0m14:50:25.562985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9333d4e4-23c5-457c-aa91-83b54e16926f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A059E9E70>]}
[0m14:50:25.563988 [debug] [MainThread]: On master: COMMIT
[0m14:50:25.564983 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:50:25.564983 [info ] [MainThread]: 
[0m14:50:25.568758 [debug] [Thread-1 (]: Began running node snapshot.dbt_training.orders_snapshot
[0m14:50:25.568758 [info ] [Thread-1 (]: 1 of 1 START snapshot practice.snapshots.orders_snapshot ....................... [RUN]
[0m14:50:25.570759 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'snapshot.dbt_training.orders_snapshot'
[0m14:50:25.570759 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_training.orders_snapshot
[0m14:50:25.580753 [debug] [Thread-1 (]: Timing info for snapshot.dbt_training.orders_snapshot (compile): 14:50:25.571759 => 14:50:25.580753
[0m14:50:25.581753 [debug] [Thread-1 (]: Began executing node snapshot.dbt_training.orders_snapshot
[0m14:50:25.649728 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m14:50:25.649728 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'snapshots'
      and refs.referenced_entity_name = 'orders_snapshot_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:50:25.650727 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:25.650727 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:25.655115 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:50:25.656113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:25.660111 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m14:50:25.660111 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "snapshots"."orders_snapshot_temp_view";');

  
[0m14:50:25.661120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:25.667107 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m14:50:25.667107 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'snapshots'
      and refs.referenced_entity_name = 'orders_snapshot_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:50:25.668107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:25.670105 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_training.orders_snapshot"
[0m14:50:25.671104 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m14:50:25.672105 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      
  
    

   

    USE [practice];
    
    

    EXEC('create view "snapshots"."orders_snapshot_temp_view" as 

    select *,
        
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(id as varchar(8000)), '''')  + ''|'' + 
    
        coalesce(cast(data_loaded_at as varchar(8000)), '''') 
    ), 2)
 as dbt_scd_id,
        data_loaded_at as dbt_updated_at,
        data_loaded_at as dbt_valid_from,
        nullif(data_loaded_at, data_loaded_at) as dbt_valid_to
    from (
        



select * from "practice"."dbo"."jaffle_shop_customers"

    ) sbq


;');



    
      EXEC('SELECT * INTO [practice].[snapshots].[orders_snapshot] FROM [practice].[snapshots].[orders_snapshot_temp_view];');
    

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "snapshots"."orders_snapshot_temp_view";');



  
  
[0m14:50:25.674103 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:25.675103 [debug] [Thread-1 (]: Timing info for snapshot.dbt_training.orders_snapshot (execute): 14:50:25.581753 => 14:50:25.675103
[0m14:50:25.676102 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: ROLLBACK
[0m14:50:25.676102 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: Close
[0m14:50:25.677102 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_training\snapshots\snap.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207)")
[0m14:50:25.682107 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 164, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207)")

[0m14:50:25.682107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9333d4e4-23c5-457c-aa91-83b54e16926f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A05699AB0>]}
[0m14:50:25.683111 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting practice.snapshots.orders_snapshot ................... [[31mERROR[0m in 0.11s]
[0m14:50:25.684095 [debug] [Thread-1 (]: Finished running node snapshot.dbt_training.orders_snapshot
[0m14:50:25.686096 [debug] [MainThread]: On master: COMMIT
[0m14:50:25.687096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:25.687096 [debug] [MainThread]: Connection 'create_practice_snapshots' was properly closed.
[0m14:50:25.688096 [debug] [MainThread]: Connection 'list_practice_snapshots' was properly closed.
[0m14:50:25.688096 [debug] [MainThread]: Connection 'snapshot.dbt_training.orders_snapshot' was properly closed.
[0m14:50:25.689095 [info ] [MainThread]: 
[0m14:50:25.689095 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m14:50:25.691092 [debug] [MainThread]: Command end result
[0m14:50:25.703086 [info ] [MainThread]: 
[0m14:50:25.704084 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:50:25.705086 [info ] [MainThread]: 
[0m14:50:25.706085 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207)")
[0m14:50:25.708085 [info ] [MainThread]: 
[0m14:50:25.709087 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:50:25.711080 [debug] [MainThread]: Command `dbt snapshot` failed at 14:50:25.711080 after 1.20 seconds
[0m14:50:25.712080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A0261CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A05699D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A056991B0>]}
[0m14:50:25.712080 [debug] [MainThread]: Flushing usage events
[0m14:50:41.789024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3806CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3A946320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3A946140>]}


============================== 14:50:41.795020 | 5a63dafd-5499-46e4-821c-d1e66e2797f3 ==============================
[0m14:50:41.795020 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:50:41.796020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:50:42.186594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a63dafd-5499-46e4-821c-d1e66e2797f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3A9463E0>]}
[0m14:50:42.293521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a63dafd-5499-46e4-821c-d1e66e2797f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3B0D9750>]}
[0m14:50:42.293521 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m14:50:42.305512 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:50:42.422822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:42.423821 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:42.430799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a63dafd-5499-46e4-821c-d1e66e2797f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3B30BF40>]}
[0m14:50:42.445790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a63dafd-5499-46e4-821c-d1e66e2797f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3B2CE710>]}
[0m14:50:42.445790 [info ] [MainThread]: Found 4 models, 2 tests, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:50:42.446790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a63dafd-5499-46e4-821c-d1e66e2797f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3B2CD690>]}
[0m14:50:42.448812 [info ] [MainThread]: 
[0m14:50:42.449789 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:50:42.451790 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice'
[0m14:50:42.467780 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m14:50:42.468793 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m14:50:42.468793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:42.469796 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:42.513483 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:50:42.514476 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:42.516480 [debug] [ThreadPool]: On list_practice: Close
[0m14:50:42.520483 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m14:50:42.521483 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m14:50:42.521483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:42.522482 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:42.522482 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:50:42.523481 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:42.524470 [debug] [ThreadPool]: On list_practice: Close
[0m14:50:42.525470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice, now create_practice_dbt_staging)
[0m14:50:42.526469 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "dbt_staging"
"
[0m14:50:42.532466 [debug] [ThreadPool]: Using sqlserver connection "create_practice_dbt_staging"
[0m14:50:42.533465 [debug] [ThreadPool]: On create_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_dbt_staging"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m14:50:42.533465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:42.534465 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:42.534465 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:50:42.537476 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:42.538477 [debug] [ThreadPool]: On create_practice_dbt_staging: COMMIT
[0m14:50:42.538477 [debug] [ThreadPool]: On create_practice_dbt_staging: Close
[0m14:50:42.539475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_practice_dbt_staging, now create_practice_dbt_mart)
[0m14:50:42.540475 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "dbt_mart"
"
[0m14:50:42.543473 [debug] [ThreadPool]: Using sqlserver connection "create_practice_dbt_mart"
[0m14:50:42.543473 [debug] [ThreadPool]: On create_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_dbt_mart"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m14:50:42.544473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:42.544473 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:42.545472 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:50:42.547457 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:42.548471 [debug] [ThreadPool]: On create_practice_dbt_mart: COMMIT
[0m14:50:42.549470 [debug] [ThreadPool]: On create_practice_dbt_mart: Close
[0m14:50:42.551468 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice_snapshots'
[0m14:50:42.557465 [debug] [ThreadPool]: Using sqlserver connection "list_practice_snapshots"
[0m14:50:42.557465 [debug] [ThreadPool]: On list_practice_snapshots: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_snapshots"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'snapshots'
  
[0m14:50:42.558464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:42.558464 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:42.559464 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:50:42.560450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:42.561449 [debug] [ThreadPool]: On list_practice_snapshots: ROLLBACK
[0m14:50:42.561449 [debug] [ThreadPool]: On list_practice_snapshots: Close
[0m14:50:42.563448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_snapshots, now list_practice_dbt_staging)
[0m14:50:42.566446 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_staging"
[0m14:50:42.567445 [debug] [ThreadPool]: On list_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m14:50:42.567445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:42.567445 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:42.568455 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:50:42.569444 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:42.570462 [debug] [ThreadPool]: On list_practice_dbt_staging: ROLLBACK
[0m14:50:42.571462 [debug] [ThreadPool]: On list_practice_dbt_staging: Close
[0m14:50:42.572462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_staging, now list_practice_dbt_mart)
[0m14:50:42.575460 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_mart"
[0m14:50:42.575460 [debug] [ThreadPool]: On list_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m14:50:42.576460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:42.576460 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:42.577458 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:50:42.578459 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:42.579455 [debug] [ThreadPool]: On list_practice_dbt_mart: ROLLBACK
[0m14:50:42.580452 [debug] [ThreadPool]: On list_practice_dbt_mart: Close
[0m14:50:42.581456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a63dafd-5499-46e4-821c-d1e66e2797f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3B2CC100>]}
[0m14:50:42.581456 [debug] [MainThread]: On master: COMMIT
[0m14:50:42.582451 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:50:42.583211 [info ] [MainThread]: 
[0m14:50:42.588224 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_customers
[0m14:50:42.589224 [info ] [Thread-1 (]: 1 of 4 START sql table model practice.dbt_staging.stg_customers ................ [RUN]
[0m14:50:42.590211 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.dbt_training.stg_customers'
[0m14:50:42.590211 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_customers
[0m14:50:42.656186 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_customers"
[0m14:50:42.658193 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_customers (compile): 14:50:42.591211 => 14:50:42.658193
[0m14:50:42.658193 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_customers
[0m14:50:42.685168 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:50:42.685168 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      
      
    USE [practice];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customers__dbt_backup";');

[0m14:50:42.686168 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:42.686168 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:42.689768 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:50:42.690784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:42.694781 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:50:42.695781 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customers'
  
[0m14:50:42.703776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:42.710772 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:50:42.710772 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */
USE [practice];
      EXEC sp_rename 'dbt_staging.stg_customers', 'stg_customers__dbt_backup'
[0m14:50:42.904607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:42.923758 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:50:42.923758 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customers_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:50:42.934154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:42.938165 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:50:42.938165 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customers_temp_view";');

  
[0m14:50:42.939168 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:42.944161 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:50:42.945161 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customers_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:50:42.945161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:42.947160 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_customers"
[0m14:50:42.948165 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:50:42.949147 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

  
    

   

    USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_customers_temp_view" as 


WITH

required_fields AS (

    SELECT

        id                  AS customer_id
        , first_name
        , last_name

    FROM "practice"."dbo"."jaffle_shop_customers"

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , first_name
        , last_name

    FROM required_fields

),

add_aggregate_field AS (

    SELECT 

        *
        , CONCAT(last_name, first_name)     AS full_name
        , getdate()                         AS data_loaded_at

    FROM datatype_conversion

)

SELECT * FROM add_aggregate_field;');



    
      EXEC('SELECT * INTO [practice].[dbt_staging].[stg_customers] FROM [practice].[dbt_staging].[stg_customers_temp_view];');
    

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customers_temp_view";');



  
[0m14:50:42.954076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:42.968068 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: COMMIT
[0m14:50:42.972065 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:50:42.973065 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      USE [practice];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customers__dbt_backup'
  
[0m14:50:43.038028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.043025 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_customers"
[0m14:50:43.044025 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_customers"} */

      
      
    USE [practice];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customers__dbt_backup";');

[0m14:50:43.048240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.055199 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_customers (execute): 14:50:42.659188 => 14:50:43.055199
[0m14:50:43.055199 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: ROLLBACK
[0m14:50:43.056198 [debug] [Thread-1 (]: On model.dbt_training.stg_customers: Close
[0m14:50:43.057198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a63dafd-5499-46e4-821c-d1e66e2797f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3B3D9600>]}
[0m14:50:43.057198 [info ] [Thread-1 (]: 1 of 4 OK created sql table model practice.dbt_staging.stg_customers ........... [[32mOK[0m in 0.47s]
[0m14:50:43.058197 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_customers
[0m14:50:43.059196 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_orders
[0m14:50:43.060196 [info ] [Thread-1 (]: 2 of 4 START sql table model practice.dbt_staging.stg_orders ................... [RUN]
[0m14:50:43.061195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_customers, now model.dbt_training.stg_orders)
[0m14:50:43.061195 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_orders
[0m14:50:43.065215 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_orders"
[0m14:50:43.067191 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_orders (compile): 14:50:43.061195 => 14:50:43.066211
[0m14:50:43.067191 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_orders
[0m14:50:43.073208 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:50:43.074207 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      
      
    USE [practice];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_orders__dbt_backup";');

[0m14:50:43.074207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:43.075201 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:43.075201 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:50:43.076203 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.078200 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:50:43.078200 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_orders'
  
[0m14:50:43.088192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.092191 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:50:43.092191 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */
USE [practice];
      EXEC sp_rename 'dbt_staging.stg_orders', 'stg_orders__dbt_backup'
[0m14:50:43.095177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.098173 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:50:43.098173 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:50:43.110180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.111180 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:50:43.112179 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_orders_temp_view";');

  
[0m14:50:43.113178 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.115164 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:50:43.115164 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:50:43.117165 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.118164 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_orders"
[0m14:50:43.120161 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:50:43.120161 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

  
    

   

    USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_orders_temp_view" as 

WITH

required_fields AS (

    SELECT

        id                  AS order_id
        , user_id           AS customer_id
        , order_date        AS order_date
        , status

    FROM "practice"."dbo"."jaffle_shop_orders"

),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT)               AS order_id
        , CAST(customer_id AS INT)          AS customer_id        
        , CONVERT(date, order_date)         AS order_date
        , status

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [practice].[dbt_staging].[stg_orders] FROM [practice].[dbt_staging].[stg_orders_temp_view];');
    

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_orders_temp_view";');



  
[0m14:50:43.125895 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.127894 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: COMMIT
[0m14:50:43.128893 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:50:43.128893 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      USE [practice];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_orders__dbt_backup'
  
[0m14:50:43.194877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.199861 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_orders"
[0m14:50:43.199861 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_orders"} */

      
      
    USE [practice];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_orders__dbt_backup";');

[0m14:50:43.202093 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.204113 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_orders (execute): 14:50:43.067191 => 14:50:43.203108
[0m14:50:43.204113 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: ROLLBACK
[0m14:50:43.205111 [debug] [Thread-1 (]: On model.dbt_training.stg_orders: Close
[0m14:50:43.206111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a63dafd-5499-46e4-821c-d1e66e2797f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3B338D90>]}
[0m14:50:43.206111 [info ] [Thread-1 (]: 2 of 4 OK created sql table model practice.dbt_staging.stg_orders .............. [[32mOK[0m in 0.14s]
[0m14:50:43.207105 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_orders
[0m14:50:43.208091 [debug] [Thread-1 (]: Began running node model.dbt_training.stg_payments
[0m14:50:43.209104 [info ] [Thread-1 (]: 3 of 4 START sql table model practice.dbt_staging.stg_payments ................. [RUN]
[0m14:50:43.210108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_orders, now model.dbt_training.stg_payments)
[0m14:50:43.210108 [debug] [Thread-1 (]: Began compiling node model.dbt_training.stg_payments
[0m14:50:43.214106 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.stg_payments"
[0m14:50:43.215086 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_payments (compile): 14:50:43.210108 => 14:50:43.215086
[0m14:50:43.216104 [debug] [Thread-1 (]: Began executing node model.dbt_training.stg_payments
[0m14:50:43.223102 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:50:43.224101 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      
      
    USE [practice];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_payments__dbt_backup";');

[0m14:50:43.224101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:43.225081 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:43.226101 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:50:43.227094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.229093 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:50:43.229093 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_payments'
  
[0m14:50:43.238654 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.243653 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:50:43.243653 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */
USE [practice];
      EXEC sp_rename 'dbt_staging.stg_payments', 'stg_payments__dbt_backup'
[0m14:50:43.246113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.249131 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:50:43.249131 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_payments_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:50:43.260590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.262589 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:50:43.263587 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_payments_temp_view";');

  
[0m14:50:43.264511 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.266512 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:50:43.267511 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_payments_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:50:43.268512 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.270509 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.stg_payments"
[0m14:50:43.271508 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:50:43.272526 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

  
    

   

    USE [practice];
    
    

    EXEC('create view "dbt_staging"."stg_payments_temp_view" as 

WITH

required_fields AS(

    SELECT

        *

    FROM "practice"."dbo"."stripe_payments"

),

datatype_and_renamed AS (

    SELECT

        CAST(id AS INT)             AS id
        , CAST(orderid AS INT)     AS order_id
        , paymentmethod
        , CAST(amount AS INT)       AS amount

    FROM required_fields

)

SELECT * FROM datatype_and_renamed;');



    
      EXEC('SELECT * INTO [practice].[dbt_staging].[stg_payments] FROM [practice].[dbt_staging].[stg_payments_temp_view];');
    

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_payments_temp_view";');



  
[0m14:50:43.277809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.279810 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: COMMIT
[0m14:50:43.280809 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:50:43.280809 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      USE [practice];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_payments__dbt_backup'
  
[0m14:50:43.348771 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.352768 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.stg_payments"
[0m14:50:43.353767 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.stg_payments"} */

      
      
    USE [practice];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_payments__dbt_backup";');

[0m14:50:43.355508 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.357527 [debug] [Thread-1 (]: Timing info for model.dbt_training.stg_payments (execute): 14:50:43.216104 => 14:50:43.356524
[0m14:50:43.357527 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: ROLLBACK
[0m14:50:43.357527 [debug] [Thread-1 (]: On model.dbt_training.stg_payments: Close
[0m14:50:43.358526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a63dafd-5499-46e4-821c-d1e66e2797f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3B3F5E10>]}
[0m14:50:43.359526 [info ] [Thread-1 (]: 3 of 4 OK created sql table model practice.dbt_staging.stg_payments ............ [[32mOK[0m in 0.15s]
[0m14:50:43.360509 [debug] [Thread-1 (]: Finished running node model.dbt_training.stg_payments
[0m14:50:43.360509 [debug] [Thread-1 (]: Began running node model.dbt_training.customer
[0m14:50:43.361525 [info ] [Thread-1 (]: 4 of 4 START sql table model practice.dbt_mart.customer ........................ [RUN]
[0m14:50:43.362507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_training.stg_payments, now model.dbt_training.customer)
[0m14:50:43.363524 [debug] [Thread-1 (]: Began compiling node model.dbt_training.customer
[0m14:50:43.366522 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_training.customer"
[0m14:50:43.368502 [debug] [Thread-1 (]: Timing info for model.dbt_training.customer (compile): 14:50:43.363524 => 14:50:43.367521
[0m14:50:43.368502 [debug] [Thread-1 (]: Began executing node model.dbt_training.customer
[0m14:50:43.374517 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:50:43.374517 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      
      
    USE [practice];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m14:50:43.375517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:43.375517 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:43.376498 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:50:43.377497 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.379496 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:50:43.379496 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m14:50:43.387491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.393487 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:50:43.394487 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */
USE [practice];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m14:50:43.397486 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.400484 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:50:43.400484 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:50:43.411491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.413476 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:50:43.413476 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m14:50:43.414476 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.417476 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:50:43.417476 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:50:43.418474 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.420473 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_training.customer"
[0m14:50:43.422475 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:50:43.423471 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

  
    

   

    USE [practice];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 

WITH

stg_customer AS (

    SELECT

        *

    FROM "practice"."dbt_staging"."stg_customers"

),

stg_orders AS (

    SELECT

        *

    FROM "practice"."dbt_staging"."stg_orders"

),

order_info AS (

    SELECT

        customer_id
        , COUNT(*)      AS total_orders

    FROM stg_orders

    GROUP BY 
        customer_id

),

final AS (

    SELECT 

        sc.*
        , oi.total_orders

    FROM stg_customer sc

    LEFT JOIN order_info oi
        ON sc.customer_id = oi.customer_id
)

SELECT * FROM final;');



    
      EXEC('SELECT * INTO [practice].[dbt_mart].[customer] FROM [practice].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m14:50:43.438285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.440300 [debug] [Thread-1 (]: On model.dbt_training.customer: COMMIT
[0m14:50:43.441299 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:50:43.441299 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      USE [practice];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m14:50:43.509246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.514243 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_training.customer"
[0m14:50:43.514243 [debug] [Thread-1 (]: On model.dbt_training.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "model.dbt_training.customer"} */

      
      
    USE [practice];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m14:50:43.516242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:43.518241 [debug] [Thread-1 (]: Timing info for model.dbt_training.customer (execute): 14:50:43.369520 => 14:50:43.518241
[0m14:50:43.519240 [debug] [Thread-1 (]: On model.dbt_training.customer: ROLLBACK
[0m14:50:43.519240 [debug] [Thread-1 (]: On model.dbt_training.customer: Close
[0m14:50:43.520240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a63dafd-5499-46e4-821c-d1e66e2797f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3B6B68F0>]}
[0m14:50:43.521239 [info ] [Thread-1 (]: 4 of 4 OK created sql table model practice.dbt_mart.customer ................... [[32mOK[0m in 0.16s]
[0m14:50:43.522239 [debug] [Thread-1 (]: Finished running node model.dbt_training.customer
[0m14:50:43.524238 [debug] [MainThread]: On master: COMMIT
[0m14:50:43.525237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:43.526237 [debug] [MainThread]: Connection 'create_practice_dbt_mart' was properly closed.
[0m14:50:43.527236 [debug] [MainThread]: Connection 'list_practice_dbt_mart' was properly closed.
[0m14:50:43.527236 [debug] [MainThread]: Connection 'model.dbt_training.customer' was properly closed.
[0m14:50:43.528235 [info ] [MainThread]: 
[0m14:50:43.529235 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m14:50:43.531234 [debug] [MainThread]: Command end result
[0m14:50:43.543227 [info ] [MainThread]: 
[0m14:50:43.544227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:43.545231 [info ] [MainThread]: 
[0m14:50:43.546225 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:50:43.548224 [debug] [MainThread]: Command `dbt run` succeeded at 14:50:43.547225 after 1.83 seconds
[0m14:50:43.548224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3806CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3B6D1BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3B3B3760>]}
[0m14:50:43.548224 [debug] [MainThread]: Flushing usage events
[0m14:50:50.786930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020482F2F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020485806350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020485806170>]}


============================== 14:50:50.792909 | 7a2f382f-320e-438c-8f1f-884478f08c76 ==============================
[0m14:50:50.792909 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:50:50.793908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:51.194101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a2f382f-320e-438c-8f1f-884478f08c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020485806410>]}
[0m14:50:51.299036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a2f382f-320e-438c-8f1f-884478f08c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020485F97D00>]}
[0m14:50:51.300041 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m14:50:51.312034 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:50:51.418954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:51.418954 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:51.425950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a2f382f-320e-438c-8f1f-884478f08c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204861CFEB0>]}
[0m14:50:51.440942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a2f382f-320e-438c-8f1f-884478f08c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002048618A6E0>]}
[0m14:50:51.441942 [info ] [MainThread]: Found 4 models, 2 tests, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:50:51.442941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a2f382f-320e-438c-8f1f-884478f08c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204861896F0>]}
[0m14:50:51.443939 [info ] [MainThread]: 
[0m14:50:51.445939 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:50:51.446938 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice'
[0m14:50:51.460930 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m14:50:51.461929 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m14:50:51.461929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:51.462930 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:51.507654 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:50:51.508443 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:51.509458 [debug] [ThreadPool]: On list_practice: Close
[0m14:50:51.511446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice, now create_practice_snapshots)
[0m14:50:51.512445 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "snapshots"
"
[0m14:50:51.518453 [debug] [ThreadPool]: Using sqlserver connection "create_practice_snapshots"
[0m14:50:51.518453 [debug] [ThreadPool]: On create_practice_snapshots: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_snapshots"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'snapshots')
    BEGIN
    EXEC('CREATE SCHEMA [snapshots]')
    END
  
[0m14:50:51.518453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:51.519452 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:51.520438 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:50:51.522450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:51.523450 [debug] [ThreadPool]: On create_practice_snapshots: COMMIT
[0m14:50:51.524449 [debug] [ThreadPool]: On create_practice_snapshots: Close
[0m14:50:51.526449 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice_dbt_staging'
[0m14:50:51.533444 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_staging"
[0m14:50:51.534443 [debug] [ThreadPool]: On list_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m14:50:51.534443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:51.534443 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:51.535443 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:50:51.536865 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:51.537867 [debug] [ThreadPool]: On list_practice_dbt_staging: ROLLBACK
[0m14:50:51.537867 [debug] [ThreadPool]: On list_practice_dbt_staging: Close
[0m14:50:51.538867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_staging, now list_practice_dbt_mart)
[0m14:50:51.541865 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_mart"
[0m14:50:51.542864 [debug] [ThreadPool]: On list_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m14:50:51.542864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:51.543866 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:51.543866 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:50:51.545747 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:51.546749 [debug] [ThreadPool]: On list_practice_dbt_mart: ROLLBACK
[0m14:50:51.546749 [debug] [ThreadPool]: On list_practice_dbt_mart: Close
[0m14:50:51.547748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_mart, now list_practice_snapshots)
[0m14:50:51.551745 [debug] [ThreadPool]: Using sqlserver connection "list_practice_snapshots"
[0m14:50:51.551745 [debug] [ThreadPool]: On list_practice_snapshots: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_snapshots"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'snapshots'
  
[0m14:50:51.551745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:51.552745 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:51.552745 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m14:50:51.554469 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:51.555472 [debug] [ThreadPool]: On list_practice_snapshots: ROLLBACK
[0m14:50:51.555472 [debug] [ThreadPool]: On list_practice_snapshots: Close
[0m14:50:51.556471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a2f382f-320e-438c-8f1f-884478f08c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204861FF070>]}
[0m14:50:51.557484 [debug] [MainThread]: On master: COMMIT
[0m14:50:51.557484 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:50:51.558797 [info ] [MainThread]: 
[0m14:50:51.561797 [debug] [Thread-1 (]: Began running node snapshot.dbt_training.orders_snapshot
[0m14:50:51.562813 [info ] [Thread-1 (]: 1 of 1 START snapshot practice.snapshots.orders_snapshot ....................... [RUN]
[0m14:50:51.564796 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'snapshot.dbt_training.orders_snapshot'
[0m14:50:51.565798 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_training.orders_snapshot
[0m14:50:51.584800 [debug] [Thread-1 (]: Timing info for snapshot.dbt_training.orders_snapshot (compile): 14:50:51.565798 => 14:50:51.584800
[0m14:50:51.585798 [debug] [Thread-1 (]: Began executing node snapshot.dbt_training.orders_snapshot
[0m14:50:51.719708 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m14:50:51.720707 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'snapshots'
      and refs.referenced_entity_name = 'orders_snapshot_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:50:51.720707 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:51.721707 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m14:50:51.724972 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m14:50:51.725988 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:51.729990 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m14:50:51.729990 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "snapshots"."orders_snapshot_temp_view";');

  
[0m14:50:51.730994 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:51.735986 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m14:50:51.735986 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'snapshots'
      and refs.referenced_entity_name = 'orders_snapshot_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:50:51.736985 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:51.737985 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_training.orders_snapshot"
[0m14:50:51.739968 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m14:50:51.740983 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      
  
    

   

    USE [practice];
    
    

    EXEC('create view "snapshots"."orders_snapshot_temp_view" as 

    select *,
        
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(id as varchar(8000)), '''')  + ''|'' + 
    
        coalesce(cast(data_loaded_at as varchar(8000)), '''') 
    ), 2)
 as dbt_scd_id,
        data_loaded_at as dbt_updated_at,
        data_loaded_at as dbt_valid_from,
        nullif(data_loaded_at, data_loaded_at) as dbt_valid_to
    from (
        



select * from "practice"."dbo"."jaffle_shop_customers"

    ) sbq


;');



    
      EXEC('SELECT * INTO [practice].[snapshots].[orders_snapshot] FROM [practice].[snapshots].[orders_snapshot_temp_view];');
    

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "snapshots"."orders_snapshot_temp_view";');



  
  
[0m14:50:51.742983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:51.743982 [debug] [Thread-1 (]: Timing info for snapshot.dbt_training.orders_snapshot (execute): 14:50:51.585798 => 14:50:51.743982
[0m14:50:51.744982 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: ROLLBACK
[0m14:50:51.744982 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: Close
[0m14:50:51.745980 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_training\snapshots\snap.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207)")
[0m14:50:51.749961 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 164, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207)")

[0m14:50:51.750960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a2f382f-320e-438c-8f1f-884478f08c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204861FFBE0>]}
[0m14:50:51.751960 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting practice.snapshots.orders_snapshot ................... [[31mERROR[0m in 0.19s]
[0m14:50:51.752959 [debug] [Thread-1 (]: Finished running node snapshot.dbt_training.orders_snapshot
[0m14:50:51.754976 [debug] [MainThread]: On master: COMMIT
[0m14:50:51.755975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:51.755975 [debug] [MainThread]: Connection 'create_practice_snapshots' was properly closed.
[0m14:50:51.755975 [debug] [MainThread]: Connection 'list_practice_snapshots' was properly closed.
[0m14:50:51.756975 [debug] [MainThread]: Connection 'snapshot.dbt_training.orders_snapshot' was properly closed.
[0m14:50:51.756975 [info ] [MainThread]: 
[0m14:50:51.757957 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m14:50:51.759968 [debug] [MainThread]: Command end result
[0m14:50:51.772946 [info ] [MainThread]: 
[0m14:50:51.773948 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:50:51.773948 [info ] [MainThread]: 
[0m14:50:51.774947 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'data_loaded_at'. (207)")
[0m14:50:51.775947 [info ] [MainThread]: 
[0m14:50:51.776946 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:50:51.778946 [debug] [MainThread]: Command `dbt snapshot` failed at 14:50:51.778946 after 1.07 seconds
[0m14:50:51.778946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020482F2F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204861FF8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204861FE320>]}
[0m14:50:51.779953 [debug] [MainThread]: Flushing usage events
[0m15:13:18.951281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A56C5F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59536260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59536080>]}


============================== 15:13:18.957278 | e354bc7b-178f-4d39-9ab2-ad82ebe79ab5 ==============================
[0m15:13:18.957278 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:13:18.957937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:13:19.551222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e354bc7b-178f-4d39-9ab2-ad82ebe79ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59536320>]}
[0m15:13:19.651170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e354bc7b-178f-4d39-9ab2-ad82ebe79ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59B287C0>]}
[0m15:13:19.652169 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m15:13:19.674157 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:13:20.737180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:13:20.738179 [debug] [MainThread]: Partial parsing: updated file: dbt_training://snapshots\snap.sql
[0m15:13:20.852630 [error] [MainThread]: Encountered an error:
keyword argument repeated: unique_key (<template>, line 14)
[0m15:13:20.921538 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 271, in wrapper
    ctx.obj["manifest"] = parse_manifest(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\manifest.py", line 1797, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\manifest.py", line 318, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\manifest.py", line 478, in load
    self.parse_project(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\manifest.py", line 674, in parse_project
    parser.parse_file(block)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\snapshots.py", line 80, in parse_file
    self.parse_node(block)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\base.py", line 444, in parse_node
    self.render_update(node, config)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\base.py", line 420, in render_update
    context = self.render_with_context(node, config)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\base.py", line 269, in render_with_context
    get_rendered(parsed_node.raw_code, context, parsed_node, capture_macros=True)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 592, in get_rendered
    template = get_template(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 541, in get_template
    return env.from_string(template_source, globals=ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\environment.py", line 1105, in from_string
    return cls.from_code(self, self.compile(source), gs, None)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\environment.py", line 766, in compile
    return self._compile(source, filename)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 107, in _compile
    return super()._compile(source, filename)  # type: ignore
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\environment.py", line 704, in _compile
    return compile(source, filename, "exec")
  File "<template>", line 14
SyntaxError: keyword argument repeated: unique_key

[0m15:13:20.929546 [debug] [MainThread]: Command `dbt snapshot` failed at 15:13:20.929546 after 2.08 seconds
[0m15:13:20.930545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A56C5F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59EEF610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A59F9E3B0>]}
[0m15:13:20.930545 [debug] [MainThread]: Flushing usage events
[0m15:14:03.362128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68E19CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A690A76320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A690A76140>]}


============================== 15:14:03.368125 | 06e60e7f-8e9f-4c5a-b848-d65195be1ef6 ==============================
[0m15:14:03.368125 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:14:03.369124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m15:14:03.797651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06e60e7f-8e9f-4c5a-b848-d65195be1ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A690A763E0>]}
[0m15:14:03.906589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06e60e7f-8e9f-4c5a-b848-d65195be1ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A69121D750>]}
[0m15:14:03.907588 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m15:14:03.923579 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:14:04.042512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:04.042512 [debug] [MainThread]: Partial parsing: updated file: dbt_training://snapshots\snap.sql
[0m15:14:04.279394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06e60e7f-8e9f-4c5a-b848-d65195be1ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A69112C850>]}
[0m15:14:04.304949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06e60e7f-8e9f-4c5a-b848-d65195be1ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A69132E7A0>]}
[0m15:14:04.305968 [info ] [MainThread]: Found 4 models, 2 tests, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m15:14:04.306949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06e60e7f-8e9f-4c5a-b848-d65195be1ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A69132D3C0>]}
[0m15:14:04.308966 [info ] [MainThread]: 
[0m15:14:04.309965 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:14:04.312316 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice'
[0m15:14:04.330305 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m15:14:04.331305 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m15:14:04.331305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:04.332304 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:14:04.380890 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m15:14:04.381890 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:14:04.382906 [debug] [ThreadPool]: On list_practice: Close
[0m15:14:04.384889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice, now create_practice_snapshots)
[0m15:14:04.385900 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "snapshots"
"
[0m15:14:04.391897 [debug] [ThreadPool]: Using sqlserver connection "create_practice_snapshots"
[0m15:14:04.392884 [debug] [ThreadPool]: On create_practice_snapshots: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_snapshots"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'snapshots')
    BEGIN
    EXEC('CREATE SCHEMA [snapshots]')
    END
  
[0m15:14:04.392884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:04.393895 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:14:04.394895 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m15:14:04.396894 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:14:04.397880 [debug] [ThreadPool]: On create_practice_snapshots: COMMIT
[0m15:14:04.398879 [debug] [ThreadPool]: On create_practice_snapshots: Close
[0m15:14:04.400819 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice_snapshots'
[0m15:14:04.407816 [debug] [ThreadPool]: Using sqlserver connection "list_practice_snapshots"
[0m15:14:04.407816 [debug] [ThreadPool]: On list_practice_snapshots: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_snapshots"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'snapshots'
  
[0m15:14:04.408816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:04.409815 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:14:04.409815 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m15:14:04.411467 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:14:04.412469 [debug] [ThreadPool]: On list_practice_snapshots: ROLLBACK
[0m15:14:04.412469 [debug] [ThreadPool]: On list_practice_snapshots: Close
[0m15:14:04.413468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_snapshots, now list_practice_dbt_staging)
[0m15:14:04.416466 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_staging"
[0m15:14:04.417465 [debug] [ThreadPool]: On list_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m15:14:04.417465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:04.418464 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:14:04.418464 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m15:14:04.419877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:14:04.420878 [debug] [ThreadPool]: On list_practice_dbt_staging: ROLLBACK
[0m15:14:04.420878 [debug] [ThreadPool]: On list_practice_dbt_staging: Close
[0m15:14:04.421878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_staging, now list_practice_dbt_mart)
[0m15:14:04.424876 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_mart"
[0m15:14:04.425875 [debug] [ThreadPool]: On list_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m15:14:04.425875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:04.426875 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:14:04.426875 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m15:14:04.428015 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:14:04.430029 [debug] [ThreadPool]: On list_practice_dbt_mart: ROLLBACK
[0m15:14:04.430029 [debug] [ThreadPool]: On list_practice_dbt_mart: Close
[0m15:14:04.431217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06e60e7f-8e9f-4c5a-b848-d65195be1ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A69144B4C0>]}
[0m15:14:04.431217 [debug] [MainThread]: On master: COMMIT
[0m15:14:04.432237 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:04.433219 [info ] [MainThread]: 
[0m15:14:04.437071 [debug] [Thread-1 (]: Began running node snapshot.dbt_training.orders_snapshot
[0m15:14:04.438081 [info ] [Thread-1 (]: 1 of 1 START snapshot practice.snapshots.orders_snapshot ....................... [RUN]
[0m15:14:04.439080 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'snapshot.dbt_training.orders_snapshot'
[0m15:14:04.439080 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_training.orders_snapshot
[0m15:14:04.450077 [debug] [Thread-1 (]: Timing info for snapshot.dbt_training.orders_snapshot (compile): 15:14:04.440069 => 15:14:04.449078
[0m15:14:04.450077 [debug] [Thread-1 (]: Began executing node snapshot.dbt_training.orders_snapshot
[0m15:14:04.531031 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m15:14:04.532030 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'snapshots'
      and refs.referenced_entity_name = 'orders_snapshot_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m15:14:04.532030 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:14:04.533030 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:14:04.536420 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m15:14:04.537561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:04.541575 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m15:14:04.541575 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "snapshots"."orders_snapshot_temp_view";');

  
[0m15:14:04.542560 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:04.548558 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m15:14:04.549558 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'snapshots'
      and refs.referenced_entity_name = 'orders_snapshot_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m15:14:04.550569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:04.551569 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_training.orders_snapshot"
[0m15:14:04.552568 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m15:14:04.553573 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      
  
    

   

    USE [practice];
    
    

    EXEC('create view "snapshots"."orders_snapshot_temp_view" as 

    select *,
        
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(id as varchar(8000)), '''')  + ''|'' + 
    
        coalesce(cast(
    SYSDATETIME()
 as varchar(8000)), '''') 
    ), 2)
 as dbt_scd_id,
        
    SYSDATETIME()
 as dbt_updated_at,
        
    SYSDATETIME()
 as dbt_valid_from,
        nullif(
    SYSDATETIME()
, 
    SYSDATETIME()
) as dbt_valid_to
    from (
        



select * from "practice"."dbo"."jaffle_shop_customers"

    ) sbq


;');



    
      EXEC('SELECT * INTO [practice].[snapshots].[orders_snapshot] FROM [practice].[snapshots].[orders_snapshot_temp_view];');
    

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "snapshots"."orders_snapshot_temp_view";');



  
  
[0m15:14:04.562112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:04.582116 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: COMMIT
[0m15:14:04.583116 [debug] [Thread-1 (]: Timing info for snapshot.dbt_training.orders_snapshot (execute): 15:14:04.451076 => 15:14:04.583116
[0m15:14:04.584115 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: Close
[0m15:14:04.585114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06e60e7f-8e9f-4c5a-b848-d65195be1ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A69160BD60>]}
[0m15:14:04.585114 [info ] [Thread-1 (]: 1 of 1 OK snapshotted practice.snapshots.orders_snapshot ....................... [[32mOK[0m in 0.15s]
[0m15:14:04.587435 [debug] [Thread-1 (]: Finished running node snapshot.dbt_training.orders_snapshot
[0m15:14:04.588444 [debug] [MainThread]: On master: COMMIT
[0m15:14:04.589434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:04.590437 [debug] [MainThread]: Connection 'create_practice_snapshots' was properly closed.
[0m15:14:04.590437 [debug] [MainThread]: Connection 'list_practice_dbt_mart' was properly closed.
[0m15:14:04.590437 [debug] [MainThread]: Connection 'snapshot.dbt_training.orders_snapshot' was properly closed.
[0m15:14:04.591437 [info ] [MainThread]: 
[0m15:14:04.591437 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m15:14:04.593419 [debug] [MainThread]: Command end result
[0m15:14:04.607409 [info ] [MainThread]: 
[0m15:14:04.607409 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:04.608411 [info ] [MainThread]: 
[0m15:14:04.609415 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:14:04.611410 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:14:04.611410 after 1.33 seconds
[0m15:14:04.613411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68E19CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A69112E7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A69112D9F0>]}
[0m15:14:04.613411 [debug] [MainThread]: Flushing usage events
[0m15:15:56.707396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB909EECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB932C62C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB932C60E0>]}


============================== 15:15:56.713394 | 6c6cd133-5538-4e63-a81d-ea2526119ec7 ==============================
[0m15:15:56.713394 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:15:56.714393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:15:57.123347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c6cd133-5538-4e63-a81d-ea2526119ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB932C6380>]}
[0m15:15:57.223289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c6cd133-5538-4e63-a81d-ea2526119ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB938B9300>]}
[0m15:15:57.224290 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m15:15:57.236287 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:15:57.362288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:15:57.363287 [debug] [MainThread]: Partial parsing: updated file: dbt_training://snapshots\snap.sql
[0m15:15:57.596137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c6cd133-5538-4e63-a81d-ea2526119ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB9396E800>]}
[0m15:15:57.613125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c6cd133-5538-4e63-a81d-ea2526119ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB93C4A680>]}
[0m15:15:57.614125 [info ] [MainThread]: Found 4 models, 2 tests, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m15:15:57.614125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c6cd133-5538-4e63-a81d-ea2526119ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB93C49210>]}
[0m15:15:57.616126 [info ] [MainThread]: 
[0m15:15:57.617123 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:15:57.619122 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice'
[0m15:15:57.633128 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m15:15:57.634127 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m15:15:57.634127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:57.634127 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:15:57.681973 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m15:15:57.682963 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:15:57.685963 [debug] [ThreadPool]: On list_practice: Close
[0m15:15:57.687960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice, now create_practice_snapshots)
[0m15:15:57.690959 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "snapshots"
"
[0m15:15:57.696969 [debug] [ThreadPool]: Using sqlserver connection "create_practice_snapshots"
[0m15:15:57.697968 [debug] [ThreadPool]: On create_practice_snapshots: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_snapshots"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'snapshots')
    BEGIN
    EXEC('CREATE SCHEMA [snapshots]')
    END
  
[0m15:15:57.697968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:57.698968 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:15:57.698968 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m15:15:57.701952 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:15:57.702966 [debug] [ThreadPool]: On create_practice_snapshots: COMMIT
[0m15:15:57.703953 [debug] [ThreadPool]: On create_practice_snapshots: Close
[0m15:15:57.705949 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice_dbt_staging'
[0m15:15:57.713963 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_staging"
[0m15:15:57.713963 [debug] [ThreadPool]: On list_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m15:15:57.714963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:57.714963 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:15:57.715962 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m15:15:57.716961 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:15:57.717945 [debug] [ThreadPool]: On list_practice_dbt_staging: ROLLBACK
[0m15:15:57.718944 [debug] [ThreadPool]: On list_practice_dbt_staging: Close
[0m15:15:57.719943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_staging, now list_practice_dbt_mart)
[0m15:15:57.722941 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_mart"
[0m15:15:57.723941 [debug] [ThreadPool]: On list_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m15:15:57.723941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:57.724940 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:15:57.724940 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m15:15:57.725942 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:15:57.726958 [debug] [ThreadPool]: On list_practice_dbt_mart: ROLLBACK
[0m15:15:57.727962 [debug] [ThreadPool]: On list_practice_dbt_mart: Close
[0m15:15:57.728961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_mart, now list_practice_snapshots)
[0m15:15:57.731947 [debug] [ThreadPool]: Using sqlserver connection "list_practice_snapshots"
[0m15:15:57.732941 [debug] [ThreadPool]: On list_practice_snapshots: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_snapshots"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'snapshots'
  
[0m15:15:57.732941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:57.732941 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:15:57.733940 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m15:15:57.735218 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:15:57.736220 [debug] [ThreadPool]: On list_practice_snapshots: ROLLBACK
[0m15:15:57.736220 [debug] [ThreadPool]: On list_practice_snapshots: Close
[0m15:15:57.737219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c6cd133-5538-4e63-a81d-ea2526119ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB93DE17B0>]}
[0m15:15:57.738237 [debug] [MainThread]: On master: COMMIT
[0m15:15:57.739237 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:15:57.740218 [info ] [MainThread]: 
[0m15:15:57.742877 [debug] [Thread-1 (]: Began running node snapshot.dbt_training.orders_snapshot
[0m15:15:57.743893 [info ] [Thread-1 (]: 1 of 1 START snapshot practice.snapshots.orders_snapshot ....................... [RUN]
[0m15:15:57.744880 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'snapshot.dbt_training.orders_snapshot'
[0m15:15:57.745880 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_training.orders_snapshot
[0m15:15:57.758889 [debug] [Thread-1 (]: Timing info for snapshot.dbt_training.orders_snapshot (compile): 15:15:57.745880 => 15:15:57.757886
[0m15:15:57.758889 [debug] [Thread-1 (]: Began executing node snapshot.dbt_training.orders_snapshot
[0m15:15:57.837825 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m15:15:57.837825 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'snapshots'
      and refs.referenced_entity_name = 'orders_snapshot_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m15:15:57.838825 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:15:57.838825 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:15:57.843836 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m15:15:57.844835 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:15:57.847833 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m15:15:57.848832 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "snapshots"."orders_snapshot_temp_view";');

  
[0m15:15:57.849742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:15:57.854741 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m15:15:57.855740 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'snapshots'
      and refs.referenced_entity_name = 'orders_snapshot_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m15:15:57.856740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:15:57.857740 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_training.orders_snapshot"
[0m15:15:57.859739 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m15:15:57.859739 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      
  
    

   

    USE [practice];
    
    

    EXEC('create view "snapshots"."orders_snapshot_temp_view" as 

    select *,
        
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(id as varchar(8000)), '''')  + ''|'' + 
    
        coalesce(cast(
    SYSDATETIME()
 as varchar(8000)), '''') 
    ), 2)
 as dbt_scd_id,
        
    SYSDATETIME()
 as dbt_updated_at,
        
    SYSDATETIME()
 as dbt_valid_from,
        nullif(
    SYSDATETIME()
, 
    SYSDATETIME()
) as dbt_valid_to
    from (
        



select * from "practice"."dbo"."jaffle_shop_orders"

    ) sbq


;');



    
      EXEC('SELECT * INTO [practice].[snapshots].[orders_snapshot] FROM [practice].[snapshots].[orders_snapshot_temp_view];');
    

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "snapshots"."orders_snapshot_temp_view";');



  
  
[0m15:15:57.883784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:15:57.886809 [debug] [Thread-1 (]: Timing info for snapshot.dbt_training.orders_snapshot (execute): 15:15:57.759872 => 15:15:57.885809
[0m15:15:57.887809 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: ROLLBACK
[0m15:15:57.889807 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: Close
[0m15:15:57.891806 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_training\snapshots\snap.sql[0m
('42S01', "[42S01] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]There is already an object named 'orders_snapshot' in the database. (2714) (SQLMoreResults)")
[0m15:15:57.962742 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 164, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S01', "[42S01] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]There is already an object named 'orders_snapshot' in the database. (2714) (SQLMoreResults)")

[0m15:15:57.963747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c6cd133-5538-4e63-a81d-ea2526119ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB93A5DC90>]}
[0m15:15:57.964754 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting practice.snapshots.orders_snapshot ................... [[31mERROR[0m in 0.22s]
[0m15:15:57.965741 [debug] [Thread-1 (]: Finished running node snapshot.dbt_training.orders_snapshot
[0m15:15:57.966755 [debug] [MainThread]: On master: COMMIT
[0m15:15:57.967754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:57.968753 [debug] [MainThread]: Connection 'create_practice_snapshots' was properly closed.
[0m15:15:57.968753 [debug] [MainThread]: Connection 'list_practice_snapshots' was properly closed.
[0m15:15:57.968753 [debug] [MainThread]: Connection 'snapshot.dbt_training.orders_snapshot' was properly closed.
[0m15:15:57.969752 [info ] [MainThread]: 
[0m15:15:57.969752 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:15:57.971740 [debug] [MainThread]: Command end result
[0m15:15:57.983749 [info ] [MainThread]: 
[0m15:15:57.984748 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:15:57.985743 [info ] [MainThread]: 
[0m15:15:57.986731 [error] [MainThread]:   ('42S01', "[42S01] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]There is already an object named 'orders_snapshot' in the database. (2714) (SQLMoreResults)")
[0m15:15:57.987728 [info ] [MainThread]: 
[0m15:15:57.988728 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:15:57.990727 [debug] [MainThread]: Command `dbt snapshot` failed at 15:15:57.990727 after 1.36 seconds
[0m15:15:57.991726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB909EECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB93C7F700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB93C7F520>]}
[0m15:15:57.991726 [debug] [MainThread]: Flushing usage events
[0m15:16:19.214642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB3569ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB37F7A2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB37F7A110>]}


============================== 15:16:19.221650 | eeb59594-64a8-4abe-b083-ba3915fe9158 ==============================
[0m15:16:19.221650 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:16:19.222637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\dbt\\dbt_training\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m15:16:19.628040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eeb59594-64a8-4abe-b083-ba3915fe9158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB37F7A3B0>]}
[0m15:16:19.727987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eeb59594-64a8-4abe-b083-ba3915fe9158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB38704C70>]}
[0m15:16:19.728987 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m15:16:19.742962 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:16:19.859626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:16:19.859626 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:16:19.867622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eeb59594-64a8-4abe-b083-ba3915fe9158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB3893FFD0>]}
[0m15:16:19.881614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eeb59594-64a8-4abe-b083-ba3915fe9158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB3881E6E0>]}
[0m15:16:19.881614 [info ] [MainThread]: Found 4 models, 2 tests, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m15:16:19.882632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eeb59594-64a8-4abe-b083-ba3915fe9158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB3881D660>]}
[0m15:16:19.884614 [info ] [MainThread]: 
[0m15:16:19.885630 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:16:19.887610 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice'
[0m15:16:19.901604 [debug] [ThreadPool]: Using sqlserver connection "list_practice"
[0m15:16:19.902602 [debug] [ThreadPool]: On list_practice: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice"} */
select  name as [schema]
    from sys.schemas 
  
[0m15:16:19.902602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:19.903602 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:16:19.946317 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m15:16:19.947168 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:16:19.949171 [debug] [ThreadPool]: On list_practice: Close
[0m15:16:19.950752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice, now create_practice_snapshots)
[0m15:16:19.951754 [debug] [ThreadPool]: Creating schema "database: "practice"
schema: "snapshots"
"
[0m15:16:19.956751 [debug] [ThreadPool]: Using sqlserver connection "create_practice_snapshots"
[0m15:16:19.957750 [debug] [ThreadPool]: On create_practice_snapshots: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "create_practice_snapshots"} */
USE [practice];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'snapshots')
    BEGIN
    EXEC('CREATE SCHEMA [snapshots]')
    END
  
[0m15:16:19.957750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:19.958750 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:16:19.958750 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m15:16:19.960845 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:16:19.962844 [debug] [ThreadPool]: On create_practice_snapshots: COMMIT
[0m15:16:19.962844 [debug] [ThreadPool]: On create_practice_snapshots: Close
[0m15:16:19.965857 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_practice_dbt_staging'
[0m15:16:19.972648 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_staging"
[0m15:16:19.972648 [debug] [ThreadPool]: On list_practice_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m15:16:19.973648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:19.973648 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:16:19.974647 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m15:16:19.975647 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:16:19.976648 [debug] [ThreadPool]: On list_practice_dbt_staging: ROLLBACK
[0m15:16:19.977647 [debug] [ThreadPool]: On list_practice_dbt_staging: Close
[0m15:16:19.978647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_staging, now list_practice_dbt_mart)
[0m15:16:19.981644 [debug] [ThreadPool]: Using sqlserver connection "list_practice_dbt_mart"
[0m15:16:19.982644 [debug] [ThreadPool]: On list_practice_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m15:16:19.982644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:19.983644 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:16:19.983644 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m15:16:19.985392 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:16:19.986394 [debug] [ThreadPool]: On list_practice_dbt_mart: ROLLBACK
[0m15:16:19.986394 [debug] [ThreadPool]: On list_practice_dbt_mart: Close
[0m15:16:19.987393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_practice_dbt_mart, now list_practice_snapshots)
[0m15:16:19.990391 [debug] [ThreadPool]: Using sqlserver connection "list_practice_snapshots"
[0m15:16:19.991390 [debug] [ThreadPool]: On list_practice_snapshots: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "connection_name": "list_practice_snapshots"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'snapshots'
  
[0m15:16:19.991390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:19.992390 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:16:19.992390 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m15:16:19.993940 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:16:19.994941 [debug] [ThreadPool]: On list_practice_snapshots: ROLLBACK
[0m15:16:19.994941 [debug] [ThreadPool]: On list_practice_snapshots: Close
[0m15:16:19.995941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eeb59594-64a8-4abe-b083-ba3915fe9158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB3896F070>]}
[0m15:16:19.996954 [debug] [MainThread]: On master: COMMIT
[0m15:16:19.997941 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:16:19.997941 [info ] [MainThread]: 
[0m15:16:20.002294 [debug] [Thread-1 (]: Began running node snapshot.dbt_training.orders_snapshot
[0m15:16:20.002294 [info ] [Thread-1 (]: 1 of 1 START snapshot practice.snapshots.orders_snapshot ....................... [RUN]
[0m15:16:20.004292 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'snapshot.dbt_training.orders_snapshot'
[0m15:16:20.005293 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_training.orders_snapshot
[0m15:16:20.016287 [debug] [Thread-1 (]: Timing info for snapshot.dbt_training.orders_snapshot (compile): 15:16:20.005293 => 15:16:20.016287
[0m15:16:20.017286 [debug] [Thread-1 (]: Began executing node snapshot.dbt_training.orders_snapshot
[0m15:16:20.168200 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m15:16:20.169199 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'snapshots'
      and refs.referenced_entity_name = 'orders_snapshot_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m15:16:20.169199 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:16:20.170199 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:16:20.172903 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m15:16:20.183909 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:16:20.187906 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m15:16:20.188907 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "snapshots"."orders_snapshot_temp_view";');

  
[0m15:16:20.190500 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:16:20.195513 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m15:16:20.196513 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      USE [practice];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'practice'
      and refs.referenced_schema_name = 'snapshots'
      and refs.referenced_entity_name = 'orders_snapshot_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m15:16:20.196513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:16:20.198512 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_training.orders_snapshot"
[0m15:16:20.200515 [debug] [Thread-1 (]: Using sqlserver connection "snapshot.dbt_training.orders_snapshot"
[0m15:16:20.200515 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_training", "target_name": "dev", "node_id": "snapshot.dbt_training.orders_snapshot"} */

      
  
    

   

    USE [practice];
    
    

    EXEC('create view "snapshots"."orders_snapshot_temp_view" as 

    select *,
        
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(id as varchar(8000)), '''')  + ''|'' + 
    
        coalesce(cast(
    SYSDATETIME()
 as varchar(8000)), '''') 
    ), 2)
 as dbt_scd_id,
        
    SYSDATETIME()
 as dbt_updated_at,
        
    SYSDATETIME()
 as dbt_valid_from,
        nullif(
    SYSDATETIME()
, 
    SYSDATETIME()
) as dbt_valid_to
    from (
        



select * from "practice"."dbo"."jaffle_shop_orders"

    ) sbq


;');



    
      EXEC('SELECT * INTO [practice].[snapshots].[orders_snapshot] FROM [practice].[snapshots].[orders_snapshot_temp_view];');
    

    
      
      
    
    USE [practice];
    EXEC('DROP view IF EXISTS "snapshots"."orders_snapshot_temp_view";');



  
  
[0m15:16:20.207511 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:16:20.227481 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: COMMIT
[0m15:16:20.229499 [debug] [Thread-1 (]: Timing info for snapshot.dbt_training.orders_snapshot (execute): 15:16:20.017286 => 15:16:20.228499
[0m15:16:20.229499 [debug] [Thread-1 (]: On snapshot.dbt_training.orders_snapshot: Close
[0m15:16:20.230498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeb59594-64a8-4abe-b083-ba3915fe9158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB3897A260>]}
[0m15:16:20.231498 [info ] [Thread-1 (]: 1 of 1 OK snapshotted practice.snapshots.orders_snapshot ....................... [[32mOK[0m in 0.23s]
[0m15:16:20.232483 [debug] [Thread-1 (]: Finished running node snapshot.dbt_training.orders_snapshot
[0m15:16:20.234478 [debug] [MainThread]: On master: COMMIT
[0m15:16:20.235495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:20.236476 [debug] [MainThread]: Connection 'create_practice_snapshots' was properly closed.
[0m15:16:20.236476 [debug] [MainThread]: Connection 'list_practice_snapshots' was properly closed.
[0m15:16:20.236476 [debug] [MainThread]: Connection 'snapshot.dbt_training.orders_snapshot' was properly closed.
[0m15:16:20.237475 [info ] [MainThread]: 
[0m15:16:20.238477 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:16:20.239474 [debug] [MainThread]: Command end result
[0m15:16:20.252467 [info ] [MainThread]: 
[0m15:16:20.253468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:16:20.254467 [info ] [MainThread]: 
[0m15:16:20.255476 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:16:20.257464 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:16:20.256465 after 1.12 seconds
[0m15:16:20.257464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB3569ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB389795A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB38979570>]}
[0m15:16:20.258473 [debug] [MainThread]: Flushing usage events
