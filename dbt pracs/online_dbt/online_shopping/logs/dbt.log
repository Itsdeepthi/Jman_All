[0m15:28:58.388845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E60F4CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E63826200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E63826020>]}


============================== 15:28:58.394843 | ffd83c71-7a19-4506-b1b4-a712e1ad5067 ==============================
[0m15:28:58.394843 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:28:58.395841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:28:58.396841 [info ] [MainThread]: dbt version: 1.7.9
[0m15:28:58.397841 [info ] [MainThread]: python version: 3.10.0
[0m15:28:58.397841 [info ] [MainThread]: python path: C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\python.exe
[0m15:28:58.398840 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m15:28:58.402837 [info ] [MainThread]: Using profiles dir at C:\Users\NadimintiDeepthi\.dbt
[0m15:28:58.403837 [info ] [MainThread]: Using profiles.yml file at C:\Users\NadimintiDeepthi\.dbt\profiles.yml
[0m15:28:58.403837 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\NadimintiDeepthi\Desktop\online_dbt\online_shopping\dbt_project.yml
[0m15:28:58.492785 [info ] [MainThread]: Configuration:
[0m15:28:58.493485 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m15:28:58.493485 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:28:58.494506 [info ] [MainThread]: Required dependencies:
[0m15:28:58.494506 [debug] [MainThread]: Executing "git --help"
[0m15:28:58.541636 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:28:58.542621 [debug] [MainThread]: STDERR: "b''"
[0m15:28:58.542621 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:28:58.543620 [info ] [MainThread]: Connection test skipped since no profile was found
[0m15:28:58.543620 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:28:58.544629 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'first'


[0m15:28:58.546252 [debug] [MainThread]: Command `dbt debug` failed at 15:28:58.545251 after 0.26 seconds
[0m15:28:58.546252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E60F4CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E637F6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E637F74F0>]}
[0m15:28:58.547251 [debug] [MainThread]: Flushing usage events
[0m15:30:34.802649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022740C5ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227435361A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022743535FC0>]}


============================== 15:30:34.807646 | a3bc4ce2-27e5-441a-8cc3-997628ab4be1 ==============================
[0m15:30:34.807646 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:30:34.808646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:30:34.808646 [info ] [MainThread]: dbt version: 1.7.9
[0m15:30:34.809647 [info ] [MainThread]: python version: 3.10.0
[0m15:30:34.809647 [info ] [MainThread]: python path: C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\python.exe
[0m15:30:34.810663 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m15:30:34.815641 [info ] [MainThread]: Using profiles dir at C:\Users\NadimintiDeepthi\.dbt
[0m15:30:34.815641 [info ] [MainThread]: Using profiles.yml file at C:\Users\NadimintiDeepthi\.dbt\profiles.yml
[0m15:30:34.816641 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\NadimintiDeepthi\Desktop\online_dbt\online_shopping\dbt_project.yml
[0m15:30:34.904604 [info ] [MainThread]: Configuration:
[0m15:30:34.905603 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m15:30:34.908314 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:30:34.909315 [info ] [MainThread]: Required dependencies:
[0m15:30:34.909315 [debug] [MainThread]: Executing "git --help"
[0m15:30:34.955650 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:30:34.956635 [debug] [MainThread]: STDERR: "b''"
[0m15:30:34.957649 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:30:34.957649 [info ] [MainThread]: Connection test skipped since no profile was found
[0m15:30:34.958789 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:30:34.960807 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'first'


[0m15:30:34.962564 [debug] [MainThread]: Command `dbt debug` failed at 15:30:34.962564 after 0.25 seconds
[0m15:30:34.962564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022740C5ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022743504370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022743507550>]}
[0m15:30:34.963563 [debug] [MainThread]: Flushing usage events
[0m15:31:31.729796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BAD2F940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BD606170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BD605F90>]}


============================== 15:31:31.735787 | 00b1b0f3-7b62-48b2-8bcb-e34793e5f5c7 ==============================
[0m15:31:31.735787 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:31:31.736799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:31:31.737777 [info ] [MainThread]: dbt version: 1.7.9
[0m15:31:31.738786 [info ] [MainThread]: python version: 3.10.0
[0m15:31:31.739776 [info ] [MainThread]: python path: C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\python.exe
[0m15:31:31.739776 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m15:31:32.193339 [info ] [MainThread]: Using profiles dir at C:\Users\NadimintiDeepthi\.dbt
[0m15:31:32.194344 [info ] [MainThread]: Using profiles.yml file at C:\Users\NadimintiDeepthi\.dbt\profiles.yml
[0m15:31:32.195324 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\NadimintiDeepthi\Desktop\online_dbt\online_shopping\dbt_project.yml
[0m15:31:32.197326 [info ] [MainThread]: adapter type: sqlserver
[0m15:31:32.197326 [info ] [MainThread]: adapter version: 1.7.4
[0m15:31:32.286286 [info ] [MainThread]: Configuration:
[0m15:31:32.287291 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:31:32.288272 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:31:32.289286 [info ] [MainThread]: Required dependencies:
[0m15:31:32.290284 [debug] [MainThread]: Executing "git --help"
[0m15:31:32.334260 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:31:32.335260 [debug] [MainThread]: STDERR: "b''"
[0m15:31:32.335260 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:31:32.336263 [info ] [MainThread]: Connection:
[0m15:31:32.337290 [info ] [MainThread]:   server: DESKTOP-GLV0LAC
[0m15:31:32.338257 [info ] [MainThread]:   database: master
[0m15:31:32.339306 [info ] [MainThread]:   schema: dbt
[0m15:31:32.340461 [info ] [MainThread]:   UID: None
[0m15:31:32.340461 [info ] [MainThread]:   client_id: None
[0m15:31:32.341487 [info ] [MainThread]:   authentication: Windows Login
[0m15:31:32.342461 [info ] [MainThread]:   encrypt: False
[0m15:31:32.342461 [info ] [MainThread]:   trust_cert: False
[0m15:31:32.343461 [info ] [MainThread]:   retries: 1
[0m15:31:32.343461 [info ] [MainThread]:   login_timeout: 0
[0m15:31:32.344460 [info ] [MainThread]:   query_timeout: 0
[0m15:31:32.344460 [info ] [MainThread]:   port: 1433
[0m15:31:32.345460 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m15:31:32.346473 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m15:31:32.346473 [debug] [MainThread]: Using sqlserver connection "debug"
[0m15:31:32.346473 [debug] [MainThread]: On debug: select 1 as id
[0m15:31:32.347478 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:31:32.347478 [debug] [MainThread]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m15:31:32.387559 [debug] [MainThread]: fabric adapter: Connected to db: master
[0m15:31:32.388573 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:31:32.389572 [debug] [MainThread]: On debug: Close
[0m15:31:32.390571 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:31:32.390571 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:31:32.392571 [debug] [MainThread]: Command `dbt debug` succeeded at 15:31:32.392571 after 0.75 seconds
[0m15:31:32.393565 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:31:32.393565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BAD2F940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BD5D00D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BDBEBB50>]}
[0m15:31:32.394569 [debug] [MainThread]: Flushing usage events
[0m16:29:47.290147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34734F940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C349C2A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C349C2A0B0>]}


============================== 16:29:47.297129 | 01739d4c-e475-420e-99e9-8097bd54ccb8 ==============================
[0m16:29:47.297129 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:29:47.298127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:29:47.874285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01739d4c-e475-420e-99e9-8097bd54ccb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C349C2A350>]}
[0m16:29:47.975227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01739d4c-e475-420e-99e9-8097bd54ccb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34A3C7CD0>]}
[0m16:29:47.976226 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m16:29:48.000215 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:29:48.002198 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:29:48.002198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '01739d4c-e475-420e-99e9-8097bd54ccb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34A30FA90>]}
[0m16:29:50.308987 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.online_shopping
- models.online_shopping.mart
- models.online_shopping.staging
[0m16:29:50.315978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01739d4c-e475-420e-99e9-8097bd54ccb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34A8200D0>]}
[0m16:29:50.345948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01739d4c-e475-420e-99e9-8097bd54ccb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34A350490>]}
[0m16:29:50.346947 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:29:50.347946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01739d4c-e475-420e-99e9-8097bd54ccb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34A3530A0>]}
[0m16:29:50.349945 [info ] [MainThread]: 
[0m16:29:50.351944 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m16:29:50.353943 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master'
[0m16:29:50.367937 [debug] [ThreadPool]: Using sqlserver connection "list_master"
[0m16:29:50.368954 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master"} */
select  name as [schema]
    from sys.schemas 
  
[0m16:29:50.368954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:50.369946 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:29:50.430903 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:29:50.432918 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:50.434916 [debug] [ThreadPool]: On list_master: Close
[0m16:29:50.436915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_master, now create_master_dbt)
[0m16:29:50.436915 [debug] [ThreadPool]: Creating schema "database: "master"
schema: "dbt"
"
[0m16:29:50.442911 [debug] [ThreadPool]: Using sqlserver connection "create_master_dbt"
[0m16:29:50.443911 [debug] [ThreadPool]: On create_master_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "create_master_dbt"} */
USE [master];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt')
    BEGIN
    EXEC('CREATE SCHEMA [dbt]')
    END
  
[0m16:29:50.443911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:50.443911 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:29:50.444911 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:29:50.448898 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:50.449896 [debug] [ThreadPool]: On create_master_dbt: COMMIT
[0m16:29:50.450895 [debug] [ThreadPool]: On create_master_dbt: Close
[0m16:29:50.452900 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master_dbt'
[0m16:29:50.459901 [debug] [ThreadPool]: Using sqlserver connection "list_master_dbt"
[0m16:29:50.459901 [debug] [ThreadPool]: On list_master_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master_dbt"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
  
[0m16:29:50.460901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:50.460901 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:29:50.461906 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:29:50.475776 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:50.477762 [debug] [ThreadPool]: On list_master_dbt: ROLLBACK
[0m16:29:50.477762 [debug] [ThreadPool]: On list_master_dbt: Close
[0m16:29:50.478761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01739d4c-e475-420e-99e9-8097bd54ccb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34A826F80>]}
[0m16:29:50.479774 [debug] [MainThread]: On master: COMMIT
[0m16:29:50.479774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:29:50.480774 [info ] [MainThread]: 
[0m16:29:50.484964 [debug] [Thread-1 (]: Began running node model.first.stg_customer
[0m16:29:50.485966 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt.stg_customer ................................... [RUN]
[0m16:29:50.486312 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.first.stg_customer'
[0m16:29:50.487312 [debug] [Thread-1 (]: Began compiling node model.first.stg_customer
[0m16:29:50.495308 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_customer"
[0m16:29:50.499325 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (compile): 16:29:50.487312 => 16:29:50.498307
[0m16:29:50.499325 [debug] [Thread-1 (]: Began executing node model.first.stg_customer
[0m16:29:50.535300 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:29:50.536298 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:29:50.536298 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:29:50.537298 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:29:50.537298 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:29:50.552277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.553289 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:29:50.554288 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m16:29:50.555274 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.559271 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:29:50.559271 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_customer'
  
[0m16:29:50.567269 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.577275 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_customer"
[0m16:29:50.580176 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:29:50.581193 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_customer" as 


WITH

required_fields AS (

    SELECT

        cust_id as CustomerID, 
        customer_name as CustomerName, 
        province, region, 
        customer_segment as CustomerSegment

    FROM "online"."dbo"."onlineshop_customer"

),

datatype_conversion AS (

    SELECT 

        CAST(cust_id AS INT) as CustomerID,
        province,
        region,
        customer_segment,
        customer_name

    FROM required_fields

),



SELECT * FROM datatype_conversion;');



[0m16:29:50.584186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.585322 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (execute): 16:29:50.500307 => 16:29:50.585322
[0m16:29:50.585322 [debug] [Thread-1 (]: On model.first.stg_customer: ROLLBACK
[0m16:29:50.586285 [debug] [Thread-1 (]: On model.first.stg_customer: Close
[0m16:29:50.587300 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_customer.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'SELECT'. (156) (SQLMoreResults)")
[0m16:29:50.676053 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'SELECT'. (156) (SQLMoreResults)")

[0m16:29:50.678033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01739d4c-e475-420e-99e9-8097bd54ccb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C349BABD90>]}
[0m16:29:50.679034 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model dbt.stg_customer .......................... [[31mERROR[0m in 0.19s]
[0m16:29:50.680033 [debug] [Thread-1 (]: Finished running node model.first.stg_customer
[0m16:29:50.681049 [debug] [Thread-1 (]: Began running node model.first.stg_market
[0m16:29:50.683030 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt.stg_market ..................................... [RUN]
[0m16:29:50.684049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_customer, now model.first.stg_market)
[0m16:29:50.684049 [debug] [Thread-1 (]: Began compiling node model.first.stg_market
[0m16:29:50.691026 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_market"
[0m16:29:50.694024 [debug] [Thread-1 (]: Timing info for model.first.stg_market (compile): 16:29:50.685047 => 16:29:50.693026
[0m16:29:50.694024 [debug] [Thread-1 (]: Began executing node model.first.stg_market
[0m16:29:50.709019 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:29:50.709019 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_market__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:29:50.710017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:50.711016 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:29:50.711016 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:29:50.725006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.727006 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:29:50.727006 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_market__dbt_backup";');

[0m16:29:50.728004 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.730003 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:29:50.731004 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_market'
  
[0m16:29:50.740997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.744996 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_market"
[0m16:29:50.746994 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:29:50.746994 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_market" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."onlineshop_market"
)

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id
        CAST(sales AS Float) AS sales,
        CAST(discount as Float) as discount,
        cast(order_quantity as int) as order_quantity,
        cast(profit as Float) as profit,
        cast(shipping_cost as Float) as shipping_cost,
        cast(product_base_margin as Float) as product_base_margin,

    FROM required_fields

),

SELECT * FROM datatype_conversion;');



[0m16:29:50.749474 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.751488 [debug] [Thread-1 (]: Timing info for model.first.stg_market (execute): 16:29:50.695023 => 16:29:50.750471
[0m16:29:50.752468 [debug] [Thread-1 (]: On model.first.stg_market: ROLLBACK
[0m16:29:50.752468 [debug] [Thread-1 (]: On model.first.stg_market: Close
[0m16:29:50.754467 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_market.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102)")
[0m16:29:50.757466 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102)")

[0m16:29:50.758464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01739d4c-e475-420e-99e9-8097bd54ccb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34A982A40>]}
[0m16:29:50.759463 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model dbt.stg_market ............................ [[31mERROR[0m in 0.08s]
[0m16:29:50.760463 [debug] [Thread-1 (]: Finished running node model.first.stg_market
[0m16:29:50.760463 [debug] [Thread-1 (]: Began running node model.first.stg_order
[0m16:29:50.761464 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt.stg_order ...................................... [RUN]
[0m16:29:50.762480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_market, now model.first.stg_order)
[0m16:29:50.763461 [debug] [Thread-1 (]: Began compiling node model.first.stg_order
[0m16:29:50.769457 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_order"
[0m16:29:50.771457 [debug] [Thread-1 (]: Timing info for model.first.stg_order (compile): 16:29:50.763461 => 16:29:50.771457
[0m16:29:50.772456 [debug] [Thread-1 (]: Began executing node model.first.stg_order
[0m16:29:50.782450 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:29:50.783450 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:29:50.784449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:50.784449 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:29:50.785449 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:29:50.796442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.798441 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:29:50.799440 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:29:50.799440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.801439 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:29:50.802440 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_order'
  
[0m16:29:50.811434 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.814431 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_order"
[0m16:29:50.815431 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:29:50.816430 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_order" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."onlineshop_order"
)

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS Order_id,
        CONVERT(date, order_date) AS Order_date,
        Order_Priority,
        Ord_id

    FROM required_fields

),

SELECT * FROM datatype_conversion;');



[0m16:29:50.818430 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.819430 [debug] [Thread-1 (]: Timing info for model.first.stg_order (execute): 16:29:50.773455 => 16:29:50.819430
[0m16:29:50.820429 [debug] [Thread-1 (]: On model.first.stg_order: ROLLBACK
[0m16:29:50.821428 [debug] [Thread-1 (]: On model.first.stg_order: Close
[0m16:29:50.822427 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_order.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102)")
[0m16:29:50.824427 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102)")

[0m16:29:50.824427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01739d4c-e475-420e-99e9-8097bd54ccb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34A85C910>]}
[0m16:29:50.825425 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model dbt.stg_order ............................. [[31mERROR[0m in 0.06s]
[0m16:29:50.826425 [debug] [Thread-1 (]: Finished running node model.first.stg_order
[0m16:29:50.827424 [debug] [Thread-1 (]: Began running node model.first.stg_product
[0m16:29:50.828424 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt.stg_product .................................... [RUN]
[0m16:29:50.829423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_order, now model.first.stg_product)
[0m16:29:50.830423 [debug] [Thread-1 (]: Began compiling node model.first.stg_product
[0m16:29:50.834423 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_product"
[0m16:29:50.837419 [debug] [Thread-1 (]: Timing info for model.first.stg_product (compile): 16:29:50.830423 => 16:29:50.836419
[0m16:29:50.837419 [debug] [Thread-1 (]: Began executing node model.first.stg_product
[0m16:29:50.848413 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:29:50.849412 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:29:50.850411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:50.850411 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:29:50.851412 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:29:50.865403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.868407 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:29:50.869400 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:29:50.870401 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.872400 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:29:50.873399 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_product'
  
[0m16:29:50.883392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.888390 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_product"
[0m16:29:50.889389 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:29:50.890389 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_product" as 

with required_fields as (
    
    SELECT

        prod_id, product_category,product_sub_category

    FROM "online"."dbo"."onlineshop_product"
)

SELECT * FROM required_fields;');



[0m16:29:50.891388 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.893387 [debug] [Thread-1 (]: Timing info for model.first.stg_product (execute): 16:29:50.837419 => 16:29:50.892388
[0m16:29:50.893387 [debug] [Thread-1 (]: On model.first.stg_product: ROLLBACK
[0m16:29:50.894386 [debug] [Thread-1 (]: On model.first.stg_product: Close
[0m16:29:50.895386 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_product.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_product'. (208) (SQLMoreResults)")
[0m16:29:50.897384 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_product'. (208) (SQLMoreResults)")

[0m16:29:50.898384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01739d4c-e475-420e-99e9-8097bd54ccb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34A9C4040>]}
[0m16:29:50.898384 [error] [Thread-1 (]: 4 of 6 ERROR creating sql view model dbt.stg_product ........................... [[31mERROR[0m in 0.07s]
[0m16:29:50.899383 [debug] [Thread-1 (]: Finished running node model.first.stg_product
[0m16:29:50.900383 [debug] [Thread-1 (]: Began running node model.first.stg_shipping
[0m16:29:50.901382 [info ] [Thread-1 (]: 5 of 6 START sql view model dbt.stg_shipping ................................... [RUN]
[0m16:29:50.903381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_product, now model.first.stg_shipping)
[0m16:29:50.903381 [debug] [Thread-1 (]: Began compiling node model.first.stg_shipping
[0m16:29:50.909377 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_shipping"
[0m16:29:50.911378 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (compile): 16:29:50.904381 => 16:29:50.910377
[0m16:29:50.911378 [debug] [Thread-1 (]: Began executing node model.first.stg_shipping
[0m16:29:50.918381 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:29:50.919372 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:29:50.920371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:50.920371 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:29:50.921371 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:29:50.936363 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.938362 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:29:50.938362 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:29:50.940360 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.942359 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:29:50.942359 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_shipping'
  
[0m16:29:50.951354 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.955352 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_shipping"
[0m16:29:50.958349 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:29:50.959349 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_shipping" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."onlineshop_shipping"
)

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS order_id,
        CONVERT(date, ship_date) AS ship_date,
        Ship_mode,
        ship_id

    FROM required_fields

),

SELECT * FROM datatype_conversion;');



[0m16:29:50.961348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:50.962347 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (execute): 16:29:50.912376 => 16:29:50.962347
[0m16:29:50.963347 [debug] [Thread-1 (]: On model.first.stg_shipping: ROLLBACK
[0m16:29:50.964346 [debug] [Thread-1 (]: On model.first.stg_shipping: Close
[0m16:29:50.965345 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_shipping.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102)")
[0m16:29:50.969345 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102)")

[0m16:29:50.971344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01739d4c-e475-420e-99e9-8097bd54ccb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34A8B1420>]}
[0m16:29:50.972343 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model dbt.stg_shipping .......................... [[31mERROR[0m in 0.07s]
[0m16:29:50.974340 [debug] [Thread-1 (]: Finished running node model.first.stg_shipping
[0m16:29:50.974340 [debug] [Thread-1 (]: Began running node model.first.customer
[0m16:29:50.975340 [info ] [Thread-1 (]: 6 of 6 SKIP relation dbt.customer .............................................. [[33mSKIP[0m]
[0m16:29:50.976168 [debug] [Thread-1 (]: Finished running node model.first.customer
[0m16:29:50.980168 [debug] [MainThread]: On master: COMMIT
[0m16:29:50.981168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:50.981168 [debug] [MainThread]: Connection 'create_master_dbt' was properly closed.
[0m16:29:50.982168 [debug] [MainThread]: Connection 'list_master_dbt' was properly closed.
[0m16:29:50.982168 [debug] [MainThread]: Connection 'model.first.stg_shipping' was properly closed.
[0m16:29:50.983167 [info ] [MainThread]: 
[0m16:29:50.986168 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m16:29:50.990185 [debug] [MainThread]: Command end result
[0m16:29:51.007158 [info ] [MainThread]: 
[0m16:29:51.009152 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m16:29:51.009152 [info ] [MainThread]: 
[0m16:29:51.010171 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'SELECT'. (156) (SQLMoreResults)")
[0m16:29:51.011151 [info ] [MainThread]: 
[0m16:29:51.012152 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102)")
[0m16:29:51.013164 [info ] [MainThread]: 
[0m16:29:51.013164 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102)")
[0m16:29:51.014148 [info ] [MainThread]: 
[0m16:29:51.015148 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_product'. (208) (SQLMoreResults)")
[0m16:29:51.016148 [info ] [MainThread]: 
[0m16:29:51.016148 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102)")
[0m16:29:51.017158 [info ] [MainThread]: 
[0m16:29:51.019152 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=1 TOTAL=6
[0m16:29:51.021148 [debug] [MainThread]: Command `dbt run` failed at 16:29:51.021148 after 3.83 seconds
[0m16:29:51.023148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34734F940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34A2DB400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34A823F10>]}
[0m16:29:51.024147 [debug] [MainThread]: Flushing usage events
[0m16:31:59.743272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7B8F8CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7E1EA320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7E1EA140>]}


============================== 16:31:59.750267 | 7b9424bf-7297-41ae-a693-82640ecba3c4 ==============================
[0m16:31:59.750267 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:31:59.751266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:32:00.150585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b9424bf-7297-41ae-a693-82640ecba3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7E1EA3E0>]}
[0m16:32:00.252526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b9424bf-7297-41ae-a693-82640ecba3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7E7D87C0>]}
[0m16:32:00.253526 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m16:32:00.268519 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:32:00.409659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m16:32:00.410658 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_order.sql
[0m16:32:00.410658 [debug] [MainThread]: Partial parsing: updated file: first://models\mart\customer.sql
[0m16:32:00.411658 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_shipping.sql
[0m16:32:00.412657 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_customer.sql
[0m16:32:00.412657 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_market.sql
[0m16:32:00.576562 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.online_shopping.mart
- models.online_shopping.staging
- models.online_shopping
[0m16:32:00.637541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b9424bf-7297-41ae-a693-82640ecba3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7ECD0FA0>]}
[0m16:32:00.654517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b9424bf-7297-41ae-a693-82640ecba3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7EB5BDC0>]}
[0m16:32:00.655517 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:32:00.656518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b9424bf-7297-41ae-a693-82640ecba3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7EB5BD30>]}
[0m16:32:00.660521 [info ] [MainThread]: 
[0m16:32:00.662532 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m16:32:00.664900 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master'
[0m16:32:00.679891 [debug] [ThreadPool]: Using sqlserver connection "list_master"
[0m16:32:00.680891 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master"} */
select  name as [schema]
    from sys.schemas 
  
[0m16:32:00.680891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:00.681890 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:32:00.729188 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:32:00.729188 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:32:00.731187 [debug] [ThreadPool]: On list_master: Close
[0m16:32:00.733186 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master_dbt'
[0m16:32:00.741181 [debug] [ThreadPool]: Using sqlserver connection "list_master_dbt"
[0m16:32:00.741181 [debug] [ThreadPool]: On list_master_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master_dbt"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
  
[0m16:32:00.741181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:00.742180 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:32:00.742180 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:32:00.746178 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:32:00.747178 [debug] [ThreadPool]: On list_master_dbt: ROLLBACK
[0m16:32:00.748186 [debug] [ThreadPool]: On list_master_dbt: Close
[0m16:32:00.749187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b9424bf-7297-41ae-a693-82640ecba3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7E9385E0>]}
[0m16:32:00.749187 [debug] [MainThread]: On master: COMMIT
[0m16:32:00.750180 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:32:00.751168 [info ] [MainThread]: 
[0m16:32:00.754178 [debug] [Thread-1 (]: Began running node model.first.stg_customer
[0m16:32:00.755178 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt.stg_customer ................................... [RUN]
[0m16:32:00.756181 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.first.stg_customer'
[0m16:32:00.756181 [debug] [Thread-1 (]: Began compiling node model.first.stg_customer
[0m16:32:00.766176 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_customer"
[0m16:32:00.768157 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (compile): 16:32:00.757181 => 16:32:00.767175
[0m16:32:00.768157 [debug] [Thread-1 (]: Began executing node model.first.stg_customer
[0m16:32:00.807148 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:32:00.808147 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:32:00.808147 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:32:00.809146 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:32:00.809146 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:32:00.810398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:00.811415 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:32:00.812414 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m16:32:00.813399 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:00.817410 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:32:00.817410 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_customer'
  
[0m16:32:00.818410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:00.827405 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_customer"
[0m16:32:00.829390 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:32:00.830389 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_customer" as 


WITH

required_fields AS (

    SELECT

        cust_id as CustomerID, 
        customer_name as CustomerName, 
        province, region, 
        customer_segment as CustomerSegment

    FROM "online"."dbo"."onlineshop_customer"

),

datatype_conversion AS (

    SELECT 

        CAST(cust_id AS INT) as CustomerID,
        province,
        region,
        customer_segment,
        customer_name

    FROM required_fields

)



SELECT * FROM datatype_conversion;');



[0m16:32:00.831389 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:00.832404 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (execute): 16:32:00.769174 => 16:32:00.832404
[0m16:32:00.833402 [debug] [Thread-1 (]: On model.first.stg_customer: ROLLBACK
[0m16:32:00.833402 [debug] [Thread-1 (]: On model.first.stg_customer: Close
[0m16:32:00.834405 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_customer.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_customer'. (208) (SQLMoreResults)")
[0m16:32:00.838389 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_customer'. (208) (SQLMoreResults)")

[0m16:32:00.839394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b9424bf-7297-41ae-a693-82640ecba3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7ECD28C0>]}
[0m16:32:00.840398 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model dbt.stg_customer .......................... [[31mERROR[0m in 0.08s]
[0m16:32:00.840398 [debug] [Thread-1 (]: Finished running node model.first.stg_customer
[0m16:32:00.841398 [debug] [Thread-1 (]: Began running node model.first.stg_market
[0m16:32:00.842398 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt.stg_market ..................................... [RUN]
[0m16:32:00.843392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_customer, now model.first.stg_market)
[0m16:32:00.843392 [debug] [Thread-1 (]: Began compiling node model.first.stg_market
[0m16:32:00.849396 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_market"
[0m16:32:00.850396 [debug] [Thread-1 (]: Timing info for model.first.stg_market (compile): 16:32:00.844391 => 16:32:00.850396
[0m16:32:00.851379 [debug] [Thread-1 (]: Began executing node model.first.stg_market
[0m16:32:00.863372 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:32:00.864372 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_market__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:32:00.864372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:00.865371 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:32:00.865371 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:32:00.866370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:00.868383 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:32:00.868383 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_market__dbt_backup";');

[0m16:32:00.869385 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:00.871369 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:32:00.872368 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_market'
  
[0m16:32:00.873367 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:00.878382 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_market"
[0m16:32:00.879380 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:32:00.880363 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_market" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."onlineshop_market"
)

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id
        CAST(sales AS Float) AS sales,
        CAST(discount as Float) as discount,
        cast(order_quantity as int) as order_quantity,
        cast(profit as Float) as profit,
        cast(shipping_cost as Float) as shipping_cost,
        cast(product_base_margin as Float) as product_base_margin,

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:32:00.881360 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:00.883378 [debug] [Thread-1 (]: Timing info for model.first.stg_market (execute): 16:32:00.851379 => 16:32:00.882379
[0m16:32:00.883378 [debug] [Thread-1 (]: On model.first.stg_market: ROLLBACK
[0m16:32:00.884376 [debug] [Thread-1 (]: On model.first.stg_market: Close
[0m16:32:00.885376 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_market.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102)")
[0m16:32:00.887380 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102)")

[0m16:32:00.888357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b9424bf-7297-41ae-a693-82640ecba3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7F032380>]}
[0m16:32:00.889370 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model dbt.stg_market ............................ [[31mERROR[0m in 0.05s]
[0m16:32:00.890368 [debug] [Thread-1 (]: Finished running node model.first.stg_market
[0m16:32:00.890368 [debug] [Thread-1 (]: Began running node model.first.stg_order
[0m16:32:00.891356 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt.stg_order ...................................... [RUN]
[0m16:32:00.892368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_market, now model.first.stg_order)
[0m16:32:00.892368 [debug] [Thread-1 (]: Began compiling node model.first.stg_order
[0m16:32:00.897364 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_order"
[0m16:32:00.898350 [debug] [Thread-1 (]: Timing info for model.first.stg_order (compile): 16:32:00.893355 => 16:32:00.898350
[0m16:32:00.899363 [debug] [Thread-1 (]: Began executing node model.first.stg_order
[0m16:32:00.906347 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:32:00.907347 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:32:00.907347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:00.909366 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:32:00.909366 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:32:00.911356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:00.912357 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:32:00.913355 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:32:00.913355 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:00.915354 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:32:00.916353 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_order'
  
[0m16:32:00.916353 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:00.918352 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_order"
[0m16:32:00.921337 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:32:00.922347 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_order" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."onlineshop_order"
)

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS Order_id,
        CONVERT(date, order_date) AS Order_date,
        Order_Priority,
        Ord_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:32:00.923337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:00.925353 [debug] [Thread-1 (]: Timing info for model.first.stg_order (execute): 16:32:00.899363 => 16:32:00.924349
[0m16:32:00.925353 [debug] [Thread-1 (]: On model.first.stg_order: ROLLBACK
[0m16:32:00.926352 [debug] [Thread-1 (]: On model.first.stg_order: Close
[0m16:32:00.927352 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_order.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults)")
[0m16:32:00.928347 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults)")

[0m16:32:00.929351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b9424bf-7297-41ae-a693-82640ecba3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7ED3F850>]}
[0m16:32:00.930345 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model dbt.stg_order ............................. [[31mERROR[0m in 0.04s]
[0m16:32:00.931345 [debug] [Thread-1 (]: Finished running node model.first.stg_order
[0m16:32:00.931345 [debug] [Thread-1 (]: Began running node model.first.stg_product
[0m16:32:00.932347 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt.stg_product .................................... [RUN]
[0m16:32:00.933331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_order, now model.first.stg_product)
[0m16:32:00.933331 [debug] [Thread-1 (]: Began compiling node model.first.stg_product
[0m16:32:00.938346 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_product"
[0m16:32:00.940326 [debug] [Thread-1 (]: Timing info for model.first.stg_product (compile): 16:32:00.934348 => 16:32:00.939329
[0m16:32:00.941327 [debug] [Thread-1 (]: Began executing node model.first.stg_product
[0m16:32:00.948343 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:32:00.949342 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:32:00.950337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:00.950337 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:32:00.951339 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:32:00.952319 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:00.954341 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:32:00.955325 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:32:00.956318 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:00.957318 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:32:00.958317 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_product'
  
[0m16:32:00.959318 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:00.962328 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_product"
[0m16:32:00.964315 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:32:00.965326 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_product" as 

with required_fields as (
    
    SELECT

        prod_id, product_category,product_sub_category

    FROM "online"."dbo"."onlineshop_product"
)

SELECT * FROM required_fields;');



[0m16:32:00.966312 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:00.967325 [debug] [Thread-1 (]: Timing info for model.first.stg_product (execute): 16:32:00.941327 => 16:32:00.967325
[0m16:32:00.968324 [debug] [Thread-1 (]: On model.first.stg_product: ROLLBACK
[0m16:32:00.968324 [debug] [Thread-1 (]: On model.first.stg_product: Close
[0m16:32:00.969323 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_product.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_product'. (208) (SQLMoreResults)")
[0m16:32:00.971311 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_product'. (208) (SQLMoreResults)")

[0m16:32:00.972326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b9424bf-7297-41ae-a693-82640ecba3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7F064820>]}
[0m16:32:00.973326 [error] [Thread-1 (]: 4 of 6 ERROR creating sql view model dbt.stg_product ........................... [[31mERROR[0m in 0.04s]
[0m16:32:00.974315 [debug] [Thread-1 (]: Finished running node model.first.stg_product
[0m16:32:00.975309 [debug] [Thread-1 (]: Began running node model.first.stg_shipping
[0m16:32:00.976324 [info ] [Thread-1 (]: 5 of 6 START sql view model dbt.stg_shipping ................................... [RUN]
[0m16:32:00.978320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_product, now model.first.stg_shipping)
[0m16:32:00.978320 [debug] [Thread-1 (]: Began compiling node model.first.stg_shipping
[0m16:32:00.983320 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_shipping"
[0m16:32:00.985300 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (compile): 16:32:00.979324 => 16:32:00.985300
[0m16:32:00.986301 [debug] [Thread-1 (]: Began executing node model.first.stg_shipping
[0m16:32:00.997314 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:32:00.998312 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:32:00.999311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:00.999311 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:32:01.000310 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:32:01.001291 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:01.002304 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:32:01.003304 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:32:01.004291 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:01.006290 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:32:01.006290 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_shipping'
  
[0m16:32:01.007289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:01.010300 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_shipping"
[0m16:32:01.011301 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:32:01.012289 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_shipping" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."onlineshop_shipping"
)

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS order_id,
        CONVERT(date, ship_date) AS ship_date,
        Ship_mode,
        ship_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:32:01.014298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:32:01.015298 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (execute): 16:32:00.987299 => 16:32:01.015298
[0m16:32:01.016302 [debug] [Thread-1 (]: On model.first.stg_shipping: ROLLBACK
[0m16:32:01.016302 [debug] [Thread-1 (]: On model.first.stg_shipping: Close
[0m16:32:01.017301 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_shipping.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults)")
[0m16:32:01.019514 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults)")

[0m16:32:01.020514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b9424bf-7297-41ae-a693-82640ecba3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7ECA4970>]}
[0m16:32:01.021513 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model dbt.stg_shipping .......................... [[31mERROR[0m in 0.04s]
[0m16:32:01.022511 [debug] [Thread-1 (]: Finished running node model.first.stg_shipping
[0m16:32:01.023513 [debug] [Thread-1 (]: Began running node model.first.customer
[0m16:32:01.024511 [info ] [Thread-1 (]: 6 of 6 SKIP relation dbt.customer .............................................. [[33mSKIP[0m]
[0m16:32:01.025211 [debug] [Thread-1 (]: Finished running node model.first.customer
[0m16:32:01.027212 [debug] [MainThread]: On master: COMMIT
[0m16:32:01.028210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:01.028210 [debug] [MainThread]: Connection 'list_master' was properly closed.
[0m16:32:01.028210 [debug] [MainThread]: Connection 'list_master_dbt' was properly closed.
[0m16:32:01.029210 [debug] [MainThread]: Connection 'model.first.stg_shipping' was properly closed.
[0m16:32:01.029210 [info ] [MainThread]: 
[0m16:32:01.030197 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m16:32:01.032212 [debug] [MainThread]: Command end result
[0m16:32:01.047194 [info ] [MainThread]: 
[0m16:32:01.049190 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m16:32:01.050188 [info ] [MainThread]: 
[0m16:32:01.050188 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_customer'. (208) (SQLMoreResults)")
[0m16:32:01.051201 [info ] [MainThread]: 
[0m16:32:01.052186 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102)")
[0m16:32:01.053200 [info ] [MainThread]: 
[0m16:32:01.053200 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults)")
[0m16:32:01.055186 [info ] [MainThread]: 
[0m16:32:01.055186 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_product'. (208) (SQLMoreResults)")
[0m16:32:01.056184 [info ] [MainThread]: 
[0m16:32:01.057183 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'datatype_conversion'. (102) (SQLMoreResults)")
[0m16:32:01.058184 [info ] [MainThread]: 
[0m16:32:01.059183 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=1 TOTAL=6
[0m16:32:01.061191 [debug] [MainThread]: Command `dbt run` failed at 16:32:01.060192 after 1.39 seconds
[0m16:32:01.061191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7B8F8CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7ED03D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7ED03CD0>]}
[0m16:32:01.062191 [debug] [MainThread]: Flushing usage events
[0m16:36:51.527107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54AF89A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54D87A230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54D87A050>]}


============================== 16:36:51.534121 | 439cfb96-d258-412e-ba4d-1ccd02267ae3 ==============================
[0m16:36:51.534121 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:36:51.535104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:36:51.929197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '439cfb96-d258-412e-ba4d-1ccd02267ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54DE2BB80>]}
[0m16:36:52.029140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '439cfb96-d258-412e-ba4d-1ccd02267ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54DE6D2D0>]}
[0m16:36:52.030139 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m16:36:52.043131 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:36:52.192051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m16:36:52.192051 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_market.sql
[0m16:36:52.193050 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_shipping.sql
[0m16:36:52.193050 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_order.sql
[0m16:36:52.194050 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_customer.sql
[0m16:36:52.359901 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.online_shopping
- models.online_shopping.staging
- models.online_shopping.mart
[0m16:36:52.423876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '439cfb96-d258-412e-ba4d-1ccd02267ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54E034130>]}
[0m16:36:52.440820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '439cfb96-d258-412e-ba4d-1ccd02267ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54E1EBF70>]}
[0m16:36:52.441782 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:36:52.443781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '439cfb96-d258-412e-ba4d-1ccd02267ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54DF1BAC0>]}
[0m16:36:52.445779 [info ] [MainThread]: 
[0m16:36:52.446779 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m16:36:52.449778 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master'
[0m16:36:52.464768 [debug] [ThreadPool]: Using sqlserver connection "list_master"
[0m16:36:52.465767 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master"} */
select  name as [schema]
    from sys.schemas 
  
[0m16:36:52.465767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:52.466767 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:36:52.515738 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:36:52.516744 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:52.517738 [debug] [ThreadPool]: On list_master: Close
[0m16:36:52.520736 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master_dbt'
[0m16:36:52.528732 [debug] [ThreadPool]: Using sqlserver connection "list_master_dbt"
[0m16:36:52.529731 [debug] [ThreadPool]: On list_master_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master_dbt"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
  
[0m16:36:52.529731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:52.530731 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:36:52.530731 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:36:52.533728 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:52.535728 [debug] [ThreadPool]: On list_master_dbt: ROLLBACK
[0m16:36:52.536727 [debug] [ThreadPool]: On list_master_dbt: Close
[0m16:36:52.538726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '439cfb96-d258-412e-ba4d-1ccd02267ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54E1EBD60>]}
[0m16:36:52.538726 [debug] [MainThread]: On master: COMMIT
[0m16:36:52.539725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:36:52.540725 [info ] [MainThread]: 
[0m16:36:52.544723 [debug] [Thread-1 (]: Began running node model.first.stg_customer
[0m16:36:52.544723 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt.stg_customer ................................... [RUN]
[0m16:36:52.545721 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.first.stg_customer'
[0m16:36:52.546721 [debug] [Thread-1 (]: Began compiling node model.first.stg_customer
[0m16:36:52.560713 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_customer"
[0m16:36:52.561713 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (compile): 16:36:52.546721 => 16:36:52.561713
[0m16:36:52.562713 [debug] [Thread-1 (]: Began executing node model.first.stg_customer
[0m16:36:52.603688 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:36:52.604688 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:36:52.604688 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:36:52.605687 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:36:52.605687 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:36:52.606687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.608685 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:36:52.608685 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m16:36:52.609685 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.613682 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:36:52.614682 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_customer'
  
[0m16:36:52.614682 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.624676 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_customer"
[0m16:36:52.625676 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:36:52.625676 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_customer" as 


WITH

required_fields AS (

    SELECT

        cust_id as CustomerID, 
        customer_name as CustomerName, 
        province, region, 
        customer_segment as CustomerSegment

    FROM "online"."dbo"."onlineshop_customer"

),

datatype_conversion AS (

    SELECT 

        CAST(cust_id AS INT) as CustomerID,
        province,
        region,
        customer_segment,
        customer_name

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



[0m16:36:52.627695 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.628693 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (execute): 16:36:52.562713 => 16:36:52.628693
[0m16:36:52.628693 [debug] [Thread-1 (]: On model.first.stg_customer: ROLLBACK
[0m16:36:52.629692 [debug] [Thread-1 (]: On model.first.stg_customer: Close
[0m16:36:52.630673 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_customer.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_customer'. (208) (SQLMoreResults)")
[0m16:36:52.634686 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_customer'. (208) (SQLMoreResults)")

[0m16:36:52.634686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439cfb96-d258-412e-ba4d-1ccd02267ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54E230700>]}
[0m16:36:52.635685 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model dbt.stg_customer .......................... [[31mERROR[0m in 0.09s]
[0m16:36:52.637669 [debug] [Thread-1 (]: Finished running node model.first.stg_customer
[0m16:36:52.638669 [debug] [Thread-1 (]: Began running node model.first.stg_market
[0m16:36:52.639669 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt.stg_market ..................................... [RUN]
[0m16:36:52.641668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_customer, now model.first.stg_market)
[0m16:36:52.642681 [debug] [Thread-1 (]: Began compiling node model.first.stg_market
[0m16:36:52.649662 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_market"
[0m16:36:52.651661 [debug] [Thread-1 (]: Timing info for model.first.stg_market (compile): 16:36:52.643667 => 16:36:52.650662
[0m16:36:52.651661 [debug] [Thread-1 (]: Began executing node model.first.stg_market
[0m16:36:52.661667 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:36:52.664656 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_market__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:36:52.665653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:52.666653 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:36:52.667653 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:36:52.668652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.670650 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:36:52.670650 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_market__dbt_backup";');

[0m16:36:52.671650 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.673649 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:36:52.674648 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_market'
  
[0m16:36:52.675665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.678647 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_market"
[0m16:36:52.679645 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:36:52.680645 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_market" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."onlineshop_market"
),

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id
        CAST(sales AS Float) AS sales,
        CAST(discount as Float) as discount,
        cast(order_quantity as int) as order_quantity,
        cast(profit as Float) as profit,
        cast(shipping_cost as Float) as shipping_cost,
        cast(product_base_margin as Float) as product_base_margin,

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:36:52.681644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.682658 [debug] [Thread-1 (]: Timing info for model.first.stg_market (execute): 16:36:52.652663 => 16:36:52.682658
[0m16:36:52.683656 [debug] [Thread-1 (]: On model.first.stg_market: ROLLBACK
[0m16:36:52.683656 [debug] [Thread-1 (]: On model.first.stg_market: Close
[0m16:36:52.685641 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_market.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102) (SQLMoreResults)")
[0m16:36:52.687640 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102) (SQLMoreResults)")

[0m16:36:52.689639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439cfb96-d258-412e-ba4d-1ccd02267ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54E6D22F0>]}
[0m16:36:52.690640 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model dbt.stg_market ............................ [[31mERROR[0m in 0.05s]
[0m16:36:52.691639 [debug] [Thread-1 (]: Finished running node model.first.stg_market
[0m16:36:52.692638 [debug] [Thread-1 (]: Began running node model.first.stg_order
[0m16:36:52.693637 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt.stg_order ...................................... [RUN]
[0m16:36:52.694638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_market, now model.first.stg_order)
[0m16:36:52.695655 [debug] [Thread-1 (]: Began compiling node model.first.stg_order
[0m16:36:52.700652 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_order"
[0m16:36:52.701633 [debug] [Thread-1 (]: Timing info for model.first.stg_order (compile): 16:36:52.695655 => 16:36:52.701633
[0m16:36:52.702634 [debug] [Thread-1 (]: Began executing node model.first.stg_order
[0m16:36:52.710642 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:36:52.710642 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:36:52.711641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:52.711641 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:36:52.712645 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:36:52.713645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.714640 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:36:52.715643 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:36:52.715643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.717642 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:36:52.717642 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_order'
  
[0m16:36:52.718642 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.721639 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_order"
[0m16:36:52.723621 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:36:52.723621 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_order" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."onlineshop_order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS Order_id,
        CONVERT(date, order_date) AS Order_date,
        Order_Priority,
        Ord_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:36:52.725623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.727634 [debug] [Thread-1 (]: Timing info for model.first.stg_order (execute): 16:36:52.702634 => 16:36:52.726633
[0m16:36:52.728631 [debug] [Thread-1 (]: On model.first.stg_order: ROLLBACK
[0m16:36:52.728631 [debug] [Thread-1 (]: On model.first.stg_order: Close
[0m16:36:52.729629 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_order.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_order'. (208) (SQLMoreResults)")
[0m16:36:52.731634 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_order'. (208) (SQLMoreResults)")

[0m16:36:52.732629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439cfb96-d258-412e-ba4d-1ccd02267ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54E6EBFD0>]}
[0m16:36:52.733632 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model dbt.stg_order ............................. [[31mERROR[0m in 0.04s]
[0m16:36:52.734632 [debug] [Thread-1 (]: Finished running node model.first.stg_order
[0m16:36:52.734632 [debug] [Thread-1 (]: Began running node model.first.stg_product
[0m16:36:52.735615 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt.stg_product .................................... [RUN]
[0m16:36:52.737613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_order, now model.first.stg_product)
[0m16:36:52.737613 [debug] [Thread-1 (]: Began compiling node model.first.stg_product
[0m16:36:52.742623 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_product"
[0m16:36:52.745607 [debug] [Thread-1 (]: Timing info for model.first.stg_product (compile): 16:36:52.738630 => 16:36:52.744610
[0m16:36:52.745607 [debug] [Thread-1 (]: Began executing node model.first.stg_product
[0m16:36:52.752605 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:36:52.753622 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:36:52.753622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:52.754621 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:36:52.755621 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:36:52.756602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.758600 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:36:52.758600 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:36:52.759599 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.762597 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:36:52.763597 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_product'
  
[0m16:36:52.764264 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.766264 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_product"
[0m16:36:52.768263 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:36:52.768263 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_product" as 

with required_fields as (
    
    SELECT

        prod_id, product_category,product_sub_category

    FROM "online"."dbo"."onlineshop_product"
)

SELECT * FROM required_fields;');



[0m16:36:52.770262 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.772280 [debug] [Thread-1 (]: Timing info for model.first.stg_product (execute): 16:36:52.746621 => 16:36:52.771276
[0m16:36:52.773280 [debug] [Thread-1 (]: On model.first.stg_product: ROLLBACK
[0m16:36:52.774270 [debug] [Thread-1 (]: On model.first.stg_product: Close
[0m16:36:52.775279 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_product.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_product'. (208) (SQLMoreResults)")
[0m16:36:52.777275 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_product'. (208) (SQLMoreResults)")

[0m16:36:52.778268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439cfb96-d258-412e-ba4d-1ccd02267ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54E6D2E30>]}
[0m16:36:52.779267 [error] [Thread-1 (]: 4 of 6 ERROR creating sql view model dbt.stg_product ........................... [[31mERROR[0m in 0.04s]
[0m16:36:52.780257 [debug] [Thread-1 (]: Finished running node model.first.stg_product
[0m16:36:52.780257 [debug] [Thread-1 (]: Began running node model.first.stg_shipping
[0m16:36:52.781265 [info ] [Thread-1 (]: 5 of 6 START sql view model dbt.stg_shipping ................................... [RUN]
[0m16:36:52.782270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_product, now model.first.stg_shipping)
[0m16:36:52.783264 [debug] [Thread-1 (]: Began compiling node model.first.stg_shipping
[0m16:36:52.788252 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_shipping"
[0m16:36:52.790251 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (compile): 16:36:52.783264 => 16:36:52.789271
[0m16:36:52.790251 [debug] [Thread-1 (]: Began executing node model.first.stg_shipping
[0m16:36:52.800258 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:36:52.800258 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:36:52.801258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:52.801258 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:36:52.802257 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:36:52.803247 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.805242 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:36:52.806242 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:36:52.806242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.808241 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:36:52.809240 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_shipping'
  
[0m16:36:52.810470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.813471 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_shipping"
[0m16:36:52.814470 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:36:52.815470 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_shipping" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."onlineshop_shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS order_id,
        CONVERT(date, ship_date) AS ship_date,
        Ship_mode,
        ship_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:36:52.816843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:52.817845 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (execute): 16:36:52.791269 => 16:36:52.817845
[0m16:36:52.818844 [debug] [Thread-1 (]: On model.first.stg_shipping: ROLLBACK
[0m16:36:52.818844 [debug] [Thread-1 (]: On model.first.stg_shipping: Close
[0m16:36:52.820843 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_shipping.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_shipping'. (208) (SQLMoreResults)")
[0m16:36:52.822860 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_shipping'. (208) (SQLMoreResults)")

[0m16:36:52.822860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439cfb96-d258-412e-ba4d-1ccd02267ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54E7213C0>]}
[0m16:36:52.823860 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model dbt.stg_shipping .......................... [[31mERROR[0m in 0.04s]
[0m16:36:52.824843 [debug] [Thread-1 (]: Finished running node model.first.stg_shipping
[0m16:36:52.825840 [debug] [Thread-1 (]: Began running node model.first.customer
[0m16:36:52.826860 [info ] [Thread-1 (]: 6 of 6 SKIP relation dbt.customer .............................................. [[33mSKIP[0m]
[0m16:36:52.827595 [debug] [Thread-1 (]: Finished running node model.first.customer
[0m16:36:52.829595 [debug] [MainThread]: On master: COMMIT
[0m16:36:52.830612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:52.830612 [debug] [MainThread]: Connection 'list_master' was properly closed.
[0m16:36:52.831610 [debug] [MainThread]: Connection 'list_master_dbt' was properly closed.
[0m16:36:52.831610 [debug] [MainThread]: Connection 'model.first.stg_shipping' was properly closed.
[0m16:36:52.832610 [info ] [MainThread]: 
[0m16:36:52.832610 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m16:36:52.834608 [debug] [MainThread]: Command end result
[0m16:36:52.849586 [info ] [MainThread]: 
[0m16:36:52.850585 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m16:36:52.850585 [info ] [MainThread]: 
[0m16:36:52.851597 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_customer'. (208) (SQLMoreResults)")
[0m16:36:52.852533 [info ] [MainThread]: 
[0m16:36:52.853536 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102) (SQLMoreResults)")
[0m16:36:52.854535 [info ] [MainThread]: 
[0m16:36:52.855535 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_order'. (208) (SQLMoreResults)")
[0m16:36:52.856538 [info ] [MainThread]: 
[0m16:36:52.856538 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_product'. (208) (SQLMoreResults)")
[0m16:36:52.857533 [info ] [MainThread]: 
[0m16:36:52.858532 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online.dbo.onlineshop_shipping'. (208) (SQLMoreResults)")
[0m16:36:52.859545 [info ] [MainThread]: 
[0m16:36:52.860530 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=1 TOTAL=6
[0m16:36:52.863530 [debug] [MainThread]: Command `dbt run` failed at 16:36:52.862532 after 1.41 seconds
[0m16:36:52.863530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54AF89A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54E6EBFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C54E3930A0>]}
[0m16:36:52.864529 [debug] [MainThread]: Flushing usage events
[0m16:45:07.429846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD63CEB9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD665DA260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD665DA080>]}


============================== 16:45:07.436829 | c3b3edb6-6566-4e61-9ac7-e3ad2565dc10 ==============================
[0m16:45:07.436829 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:45:07.437830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:45:08.049556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3b3edb6-6566-4e61-9ac7-e3ad2565dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD66B8B430>]}
[0m16:45:08.150499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3b3edb6-6566-4e61-9ac7-e3ad2565dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD66BD1AB0>]}
[0m16:45:08.150499 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m16:45:08.175484 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:45:09.263178 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:45:09.264177 [debug] [MainThread]: Partial parsing: updated file: first://models\source.yml
[0m16:45:09.566004 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.first.stg_customer' (models\staging\stg_customer.sql) depends on a source named 'onlineshop.onlineshop_customer' which was not found
[0m16:45:09.567614 [debug] [MainThread]: Command `dbt run` failed at 16:45:09.567614 after 2.24 seconds
[0m16:45:09.568618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD63CEB9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD66D2DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD66D2E890>]}
[0m16:45:09.568618 [debug] [MainThread]: Flushing usage events
[0m16:45:56.915841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CAC2ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CD50A2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CD50A110>]}


============================== 16:45:56.921840 | 298660e9-8b36-46d7-89a4-69f2e307db83 ==============================
[0m16:45:56.921840 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:45:56.921840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:45:57.304919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '298660e9-8b36-46d7-89a4-69f2e307db83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CD50A3B0>]}
[0m16:45:57.405862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '298660e9-8b36-46d7-89a4-69f2e307db83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CDAFC7C0>]}
[0m16:45:57.405862 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m16:45:57.421840 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:45:57.562757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m16:45:57.563757 [debug] [MainThread]: Partial parsing: updated file: first://models\source.yml
[0m16:45:57.564756 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_market.sql
[0m16:45:57.564756 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_shipping.sql
[0m16:45:57.565756 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_product.sql
[0m16:45:57.565756 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_order.sql
[0m16:45:57.566755 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_customer.sql
[0m16:45:57.874579 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.online_shopping.mart
- models.online_shopping
- models.online_shopping.staging
[0m16:45:57.881262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '298660e9-8b36-46d7-89a4-69f2e307db83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CDEDC5E0>]}
[0m16:45:57.910119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '298660e9-8b36-46d7-89a4-69f2e307db83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CDE7BE20>]}
[0m16:45:57.911119 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:45:57.911119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '298660e9-8b36-46d7-89a4-69f2e307db83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CDE7BEE0>]}
[0m16:45:57.914117 [info ] [MainThread]: 
[0m16:45:57.915130 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m16:45:57.918128 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master'
[0m16:45:57.933106 [debug] [ThreadPool]: Using sqlserver connection "list_master"
[0m16:45:57.935124 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master"} */
select  name as [schema]
    from sys.schemas 
  
[0m16:45:57.935124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:57.936104 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:45:58.001463 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:45:58.003476 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:45:58.005462 [debug] [ThreadPool]: On list_master: Close
[0m16:45:58.008473 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master_dbt'
[0m16:45:58.015474 [debug] [ThreadPool]: Using sqlserver connection "list_master_dbt"
[0m16:45:58.016455 [debug] [ThreadPool]: On list_master_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master_dbt"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
  
[0m16:45:58.016455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:58.017460 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:45:58.018477 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:45:58.031446 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:45:58.033459 [debug] [ThreadPool]: On list_master_dbt: ROLLBACK
[0m16:45:58.034459 [debug] [ThreadPool]: On list_master_dbt: Close
[0m16:45:58.035458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '298660e9-8b36-46d7-89a4-69f2e307db83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CE012B30>]}
[0m16:45:58.036444 [debug] [MainThread]: On master: COMMIT
[0m16:45:58.036444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:45:58.037443 [info ] [MainThread]: 
[0m16:45:58.041454 [debug] [Thread-1 (]: Began running node model.first.stg_customer
[0m16:45:58.042442 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt.stg_customer ................................... [RUN]
[0m16:45:58.044439 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.first.stg_customer'
[0m16:45:58.045438 [debug] [Thread-1 (]: Began compiling node model.first.stg_customer
[0m16:45:58.058446 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_customer"
[0m16:45:58.059430 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (compile): 16:45:58.045438 => 16:45:58.059430
[0m16:45:58.060430 [debug] [Thread-1 (]: Began executing node model.first.stg_customer
[0m16:45:58.105420 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:45:58.106404 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:45:58.106404 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:45:58.107423 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:45:58.107423 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:45:58.125393 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.126392 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:45:58.127392 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m16:45:58.128391 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.131405 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:45:58.132390 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_customer'
  
[0m16:45:58.141402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.151377 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_customer"
[0m16:45:58.153389 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:45:58.155377 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_customer" as 


WITH

required_fields AS (

    SELECT

        cust_id as CustomerID, 
        customer_name as CustomerName, 
        province, region, 
        customer_segment as CustomerSegment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        CAST(cust_id AS INT) as CustomerID,
        province,
        region,
        customer_segment,
        customer_name

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



[0m16:45:58.157376 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.159375 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (execute): 16:45:58.060430 => 16:45:58.159375
[0m16:45:58.160376 [debug] [Thread-1 (]: On model.first.stg_customer: ROLLBACK
[0m16:45:58.160376 [debug] [Thread-1 (]: On model.first.stg_customer: Close
[0m16:45:58.161372 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_customer.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'cust_id'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_segment'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_name'. (207)")
[0m16:45:58.247336 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'cust_id'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_segment'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_name'. (207)")

[0m16:45:58.248322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '298660e9-8b36-46d7-89a4-69f2e307db83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CE138D00>]}
[0m16:45:58.249340 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model dbt.stg_customer .......................... [[31mERROR[0m in 0.20s]
[0m16:45:58.250321 [debug] [Thread-1 (]: Finished running node model.first.stg_customer
[0m16:45:58.251321 [debug] [Thread-1 (]: Began running node model.first.stg_market
[0m16:45:58.252322 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt.stg_market ..................................... [RUN]
[0m16:45:58.253334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_customer, now model.first.stg_market)
[0m16:45:58.253334 [debug] [Thread-1 (]: Began compiling node model.first.stg_market
[0m16:45:58.259330 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_market"
[0m16:45:58.260315 [debug] [Thread-1 (]: Timing info for model.first.stg_market (compile): 16:45:58.253334 => 16:45:58.260315
[0m16:45:58.260315 [debug] [Thread-1 (]: Began executing node model.first.stg_market
[0m16:45:58.268329 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:45:58.268329 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_market__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:45:58.269329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:58.269329 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:45:58.270329 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:45:58.281322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.283304 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:45:58.283304 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_market__dbt_backup";');

[0m16:45:58.285306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.286319 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:45:58.287318 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_market'
  
[0m16:45:58.296485 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.299503 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_market"
[0m16:45:58.300486 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:45:58.301502 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_market" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id
        CAST(sales AS Float) AS sales,
        CAST(discount as Float) as discount,
        cast(order_quantity as int) as order_quantity,
        cast(profit as Float) as profit,
        cast(shipping_cost as Float) as shipping_cost,
        cast(product_base_margin as Float) as product_base_margin,

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:45:58.302482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.304488 [debug] [Thread-1 (]: Timing info for model.first.stg_market (execute): 16:45:58.261329 => 16:45:58.303496
[0m16:45:58.304488 [debug] [Thread-1 (]: On model.first.stg_market: ROLLBACK
[0m16:45:58.305501 [debug] [Thread-1 (]: On model.first.stg_market: Close
[0m16:45:58.306498 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_market.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102) (SQLMoreResults)")
[0m16:45:58.308148 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102) (SQLMoreResults)")

[0m16:45:58.308148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '298660e9-8b36-46d7-89a4-69f2e307db83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CE123010>]}
[0m16:45:58.309147 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model dbt.stg_market ............................ [[31mERROR[0m in 0.06s]
[0m16:45:58.310151 [debug] [Thread-1 (]: Finished running node model.first.stg_market
[0m16:45:58.311134 [debug] [Thread-1 (]: Began running node model.first.stg_order
[0m16:45:58.312133 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt.stg_order ...................................... [RUN]
[0m16:45:58.313131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_market, now model.first.stg_order)
[0m16:45:58.313131 [debug] [Thread-1 (]: Began compiling node model.first.stg_order
[0m16:45:58.317143 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_order"
[0m16:45:58.319128 [debug] [Thread-1 (]: Timing info for model.first.stg_order (compile): 16:45:58.313131 => 16:45:58.319128
[0m16:45:58.320146 [debug] [Thread-1 (]: Began executing node model.first.stg_order
[0m16:45:58.329136 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:45:58.330135 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:45:58.330135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:58.331134 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:45:58.331134 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:45:58.344128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.345128 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:45:58.346131 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:45:58.347130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.348126 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:45:58.349130 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_order'
  
[0m16:45:58.358120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.361118 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_order"
[0m16:45:58.362118 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:45:58.363117 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_order" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS Order_id,
        CONVERT(date, order_date) AS Order_date,
        Order_Priority,
        Ord_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:45:58.367363 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.385354 [debug] [Thread-1 (]: On model.first.stg_order: COMMIT
[0m16:45:58.391351 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:45:58.391351 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:45:58.409651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.410650 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:45:58.411649 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:45:58.412427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.413429 [debug] [Thread-1 (]: Timing info for model.first.stg_order (execute): 16:45:58.320146 => 16:45:58.413429
[0m16:45:58.414428 [debug] [Thread-1 (]: On model.first.stg_order: ROLLBACK
[0m16:45:58.414428 [debug] [Thread-1 (]: On model.first.stg_order: Close
[0m16:45:58.415427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '298660e9-8b36-46d7-89a4-69f2e307db83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CE133A30>]}
[0m16:45:58.416427 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dbt.stg_order ................................. [[32mOK[0m in 0.10s]
[0m16:45:58.417428 [debug] [Thread-1 (]: Finished running node model.first.stg_order
[0m16:45:58.417428 [debug] [Thread-1 (]: Began running node model.first.stg_product
[0m16:45:58.418427 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt.stg_product .................................... [RUN]
[0m16:45:58.420425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_order, now model.first.stg_product)
[0m16:45:58.421424 [debug] [Thread-1 (]: Began compiling node model.first.stg_product
[0m16:45:58.425422 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_product"
[0m16:45:58.427420 [debug] [Thread-1 (]: Timing info for model.first.stg_product (compile): 16:45:58.422424 => 16:45:58.426421
[0m16:45:58.427420 [debug] [Thread-1 (]: Began executing node model.first.stg_product
[0m16:45:58.434430 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:45:58.434430 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:45:58.435430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:58.436425 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:45:58.437433 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:45:58.450421 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.452407 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:45:58.453406 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:45:58.454407 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.457424 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:45:58.457424 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_product'
  
[0m16:45:58.465412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.469412 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_product"
[0m16:45:58.471409 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:45:58.472396 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_product" as 

with required_fields as (
    
    SELECT

        prod_id, product_category,product_sub_category

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



[0m16:45:58.476393 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.479391 [debug] [Thread-1 (]: On model.first.stg_product: COMMIT
[0m16:45:58.482389 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:45:58.483388 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:45:58.484388 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.486407 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:45:58.487405 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:45:58.488385 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.490385 [debug] [Thread-1 (]: Timing info for model.first.stg_product (execute): 16:45:58.428421 => 16:45:58.490385
[0m16:45:58.491384 [debug] [Thread-1 (]: On model.first.stg_product: ROLLBACK
[0m16:45:58.491384 [debug] [Thread-1 (]: On model.first.stg_product: Close
[0m16:45:58.492383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '298660e9-8b36-46d7-89a4-69f2e307db83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CE1710C0>]}
[0m16:45:58.493383 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dbt.stg_product ............................... [[32mOK[0m in 0.07s]
[0m16:45:58.494006 [debug] [Thread-1 (]: Finished running node model.first.stg_product
[0m16:45:58.495022 [debug] [Thread-1 (]: Began running node model.first.stg_shipping
[0m16:45:58.496008 [info ] [Thread-1 (]: 5 of 6 START sql view model dbt.stg_shipping ................................... [RUN]
[0m16:45:58.496463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_product, now model.first.stg_shipping)
[0m16:45:58.497479 [debug] [Thread-1 (]: Began compiling node model.first.stg_shipping
[0m16:45:58.501476 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_shipping"
[0m16:45:58.504461 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (compile): 16:45:58.497479 => 16:45:58.503463
[0m16:45:58.504461 [debug] [Thread-1 (]: Began executing node model.first.stg_shipping
[0m16:45:58.512470 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:45:58.512470 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:45:58.513469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:58.513469 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:45:58.514468 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:45:58.526448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.528461 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:45:58.528461 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:45:58.530448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.531447 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:45:58.532446 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_shipping'
  
[0m16:45:58.541057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.544043 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_shipping"
[0m16:45:58.546041 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:45:58.547040 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_shipping" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS order_id,
        CONVERT(date, ship_date) AS ship_date,
        Ship_mode,
        ship_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:45:58.549226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.551227 [debug] [Thread-1 (]: On model.first.stg_shipping: COMMIT
[0m16:45:58.556225 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:45:58.556225 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:45:58.557742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.558744 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:45:58.559743 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:45:58.559743 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:45:58.561742 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (execute): 16:45:58.505476 => 16:45:58.561742
[0m16:45:58.562741 [debug] [Thread-1 (]: On model.first.stg_shipping: ROLLBACK
[0m16:45:58.562741 [debug] [Thread-1 (]: On model.first.stg_shipping: Close
[0m16:45:58.563740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '298660e9-8b36-46d7-89a4-69f2e307db83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CE51A500>]}
[0m16:45:58.564740 [info ] [Thread-1 (]: 5 of 6 OK created sql view model dbt.stg_shipping .............................. [[32mOK[0m in 0.07s]
[0m16:45:58.565758 [debug] [Thread-1 (]: Finished running node model.first.stg_shipping
[0m16:45:58.565758 [debug] [Thread-1 (]: Began running node model.first.customer
[0m16:45:58.566753 [info ] [Thread-1 (]: 6 of 6 SKIP relation dbt.customer .............................................. [[33mSKIP[0m]
[0m16:45:58.567526 [debug] [Thread-1 (]: Finished running node model.first.customer
[0m16:45:58.569532 [debug] [MainThread]: On master: COMMIT
[0m16:45:58.570530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:58.571526 [debug] [MainThread]: Connection 'list_master' was properly closed.
[0m16:45:58.571526 [debug] [MainThread]: Connection 'list_master_dbt' was properly closed.
[0m16:45:58.571526 [debug] [MainThread]: Connection 'model.first.stg_shipping' was properly closed.
[0m16:45:58.572526 [info ] [MainThread]: 
[0m16:45:58.573382 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m16:45:58.575397 [debug] [MainThread]: Command end result
[0m16:45:58.588375 [info ] [MainThread]: 
[0m16:45:58.588375 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:45:58.589376 [info ] [MainThread]: 
[0m16:45:58.590375 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'cust_id'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_segment'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_name'. (207)")
[0m16:45:58.591373 [info ] [MainThread]: 
[0m16:45:58.592373 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102) (SQLMoreResults)")
[0m16:45:58.593374 [info ] [MainThread]: 
[0m16:45:58.594387 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=1 TOTAL=6
[0m16:45:58.596386 [debug] [MainThread]: Command `dbt run` failed at 16:45:58.596386 after 1.75 seconds
[0m16:45:58.597384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CAC2ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CE505D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CE51A500>]}
[0m16:45:58.597384 [debug] [MainThread]: Flushing usage events
[0m16:47:49.142615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A46FECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A6FDA2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A6FDA0E0>]}


============================== 16:47:49.149614 | 44801af5-53f2-4a41-8f82-69bf63960e05 ==============================
[0m16:47:49.149614 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:47:49.151613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:47:49.541346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44801af5-53f2-4a41-8f82-69bf63960e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A6FDA380>]}
[0m16:47:49.641288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44801af5-53f2-4a41-8f82-69bf63960e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A75CC7C0>]}
[0m16:47:49.642288 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m16:47:49.656266 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:47:49.782213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:47:49.783213 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_customer.sql
[0m16:47:49.936119 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.online_shopping
- models.online_shopping.staging
- models.online_shopping.mart
[0m16:47:50.003081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44801af5-53f2-4a41-8f82-69bf63960e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A79982B0>]}
[0m16:47:50.019068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44801af5-53f2-4a41-8f82-69bf63960e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A794BEB0>]}
[0m16:47:50.020087 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:47:50.021064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44801af5-53f2-4a41-8f82-69bf63960e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A794BEE0>]}
[0m16:47:50.023074 [info ] [MainThread]: 
[0m16:47:50.024060 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m16:47:50.027067 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master'
[0m16:47:50.039657 [debug] [ThreadPool]: Using sqlserver connection "list_master"
[0m16:47:50.040660 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master"} */
select  name as [schema]
    from sys.schemas 
  
[0m16:47:50.040660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:50.040660 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:47:50.087837 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:47:50.089411 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:47:50.091412 [debug] [ThreadPool]: On list_master: Close
[0m16:47:50.093898 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master_dbt'
[0m16:47:50.099913 [debug] [ThreadPool]: Using sqlserver connection "list_master_dbt"
[0m16:47:50.100914 [debug] [ThreadPool]: On list_master_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master_dbt"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
  
[0m16:47:50.100914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:50.101912 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:47:50.101912 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:47:50.105910 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:47:50.106911 [debug] [ThreadPool]: On list_master_dbt: ROLLBACK
[0m16:47:50.107909 [debug] [ThreadPool]: On list_master_dbt: Close
[0m16:47:50.108907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44801af5-53f2-4a41-8f82-69bf63960e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A799A3B0>]}
[0m16:47:50.109907 [debug] [MainThread]: On master: COMMIT
[0m16:47:50.110906 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:47:50.111428 [info ] [MainThread]: 
[0m16:47:50.114969 [debug] [Thread-1 (]: Began running node model.first.stg_customer
[0m16:47:50.114969 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt.stg_customer ................................... [RUN]
[0m16:47:50.116973 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.first.stg_customer'
[0m16:47:50.116973 [debug] [Thread-1 (]: Began compiling node model.first.stg_customer
[0m16:47:50.130984 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_customer"
[0m16:47:50.132961 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (compile): 16:47:50.117971 => 16:47:50.131982
[0m16:47:50.133976 [debug] [Thread-1 (]: Began executing node model.first.stg_customer
[0m16:47:50.181934 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:47:50.181934 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:47:50.182932 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:47:50.182932 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:47:50.183950 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:47:50.196924 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.198924 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:47:50.199923 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m16:47:50.201046 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.205046 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:47:50.205046 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_customer'
  
[0m16:47:50.206392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.215388 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_customer"
[0m16:47:50.217387 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:47:50.217387 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_customer" as 


WITH

required_fields AS (

    SELECT

        Cust_id as CustomerID, 
        Customer_Name as CustomerName, 
        province, region, 
        customer_segment as CustomerSegment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        CAST(cust_id AS INT) as CustomerID,
        province,
        region,
        customer_segment,
        customer_name

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



[0m16:47:50.219399 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.220386 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (execute): 16:47:50.134960 => 16:47:50.220386
[0m16:47:50.221385 [debug] [Thread-1 (]: On model.first.stg_customer: ROLLBACK
[0m16:47:50.221385 [debug] [Thread-1 (]: On model.first.stg_customer: Close
[0m16:47:50.222384 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_customer.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'cust_id'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_segment'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_name'. (207)")
[0m16:47:50.226391 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'cust_id'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_segment'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_name'. (207)")

[0m16:47:50.227392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44801af5-53f2-4a41-8f82-69bf63960e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A798EA40>]}
[0m16:47:50.228396 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model dbt.stg_customer .......................... [[31mERROR[0m in 0.11s]
[0m16:47:50.229382 [debug] [Thread-1 (]: Finished running node model.first.stg_customer
[0m16:47:50.229382 [debug] [Thread-1 (]: Began running node model.first.stg_market
[0m16:47:50.230395 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt.stg_market ..................................... [RUN]
[0m16:47:50.231387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_customer, now model.first.stg_market)
[0m16:47:50.232389 [debug] [Thread-1 (]: Began compiling node model.first.stg_market
[0m16:47:50.236386 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_market"
[0m16:47:50.237390 [debug] [Thread-1 (]: Timing info for model.first.stg_market (compile): 16:47:50.232389 => 16:47:50.237390
[0m16:47:50.238375 [debug] [Thread-1 (]: Began executing node model.first.stg_market
[0m16:47:50.245389 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:47:50.246373 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_market__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:47:50.247372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:50.247372 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:47:50.248383 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:47:50.259365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.261364 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:47:50.262363 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_market__dbt_backup";');

[0m16:47:50.263364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.265374 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:47:50.266373 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_market'
  
[0m16:47:50.267365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.269357 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_market"
[0m16:47:50.271356 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:47:50.271356 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_market" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id
        CAST(sales AS Float) AS sales,
        CAST(discount as Float) as discount,
        cast(order_quantity as int) as order_quantity,
        cast(profit as Float) as profit,
        cast(shipping_cost as Float) as shipping_cost,
        cast(product_base_margin as Float) as product_base_margin,

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:47:50.273147 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.274148 [debug] [Thread-1 (]: Timing info for model.first.stg_market (execute): 16:47:50.238375 => 16:47:50.274148
[0m16:47:50.275152 [debug] [Thread-1 (]: On model.first.stg_market: ROLLBACK
[0m16:47:50.275152 [debug] [Thread-1 (]: On model.first.stg_market: Close
[0m16:47:50.276147 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_market.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102) (SQLMoreResults)")
[0m16:47:50.278146 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102) (SQLMoreResults)")

[0m16:47:50.279146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44801af5-53f2-4a41-8f82-69bf63960e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A7E46980>]}
[0m16:47:50.280145 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model dbt.stg_market ............................ [[31mERROR[0m in 0.05s]
[0m16:47:50.280872 [debug] [Thread-1 (]: Finished running node model.first.stg_market
[0m16:47:50.281889 [debug] [Thread-1 (]: Began running node model.first.stg_order
[0m16:47:50.282874 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt.stg_order ...................................... [RUN]
[0m16:47:50.283873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_market, now model.first.stg_order)
[0m16:47:50.284886 [debug] [Thread-1 (]: Began compiling node model.first.stg_order
[0m16:47:50.289882 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_order"
[0m16:47:50.291873 [debug] [Thread-1 (]: Timing info for model.first.stg_order (compile): 16:47:50.284886 => 16:47:50.290871
[0m16:47:50.291873 [debug] [Thread-1 (]: Began executing node model.first.stg_order
[0m16:47:50.299880 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:47:50.300877 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:47:50.300877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:50.301876 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:47:50.301876 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:47:50.302875 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.304862 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:47:50.304862 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:47:50.305877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.306893 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:47:50.307880 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_order'
  
[0m16:47:50.308897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.317887 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:47:50.317887 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
      EXEC sp_rename 'dbt.stg_order', 'stg_order__dbt_backup'
[0m16:47:50.498197 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.500825 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_order"
[0m16:47:50.501824 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:47:50.502824 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_order" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS Order_id,
        CONVERT(date, order_date) AS Order_date,
        Order_Priority,
        Ord_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:47:50.504507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.523511 [debug] [Thread-1 (]: On model.first.stg_order: COMMIT
[0m16:47:50.526509 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:47:50.527509 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:47:50.528495 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.530495 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:47:50.530495 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:47:50.532564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.533579 [debug] [Thread-1 (]: Timing info for model.first.stg_order (execute): 16:47:50.291873 => 16:47:50.533579
[0m16:47:50.534579 [debug] [Thread-1 (]: On model.first.stg_order: ROLLBACK
[0m16:47:50.534579 [debug] [Thread-1 (]: On model.first.stg_order: Close
[0m16:47:50.535578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44801af5-53f2-4a41-8f82-69bf63960e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A7B4D3F0>]}
[0m16:47:50.536578 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dbt.stg_order ................................. [[32mOK[0m in 0.25s]
[0m16:47:50.537563 [debug] [Thread-1 (]: Finished running node model.first.stg_order
[0m16:47:50.538577 [debug] [Thread-1 (]: Began running node model.first.stg_product
[0m16:47:50.538577 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt.stg_product .................................... [RUN]
[0m16:47:50.539581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_order, now model.first.stg_product)
[0m16:47:50.540575 [debug] [Thread-1 (]: Began compiling node model.first.stg_product
[0m16:47:50.544578 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_product"
[0m16:47:50.545577 [debug] [Thread-1 (]: Timing info for model.first.stg_product (compile): 16:47:50.540575 => 16:47:50.545577
[0m16:47:50.546558 [debug] [Thread-1 (]: Began executing node model.first.stg_product
[0m16:47:50.554572 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:47:50.555566 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:47:50.555566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:50.556566 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:47:50.556566 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:47:50.559560 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.561549 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:47:50.562563 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:47:50.563548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.565564 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:47:50.565564 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_product'
  
[0m16:47:50.566560 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.570557 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:47:50.570557 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
      EXEC sp_rename 'dbt.stg_product', 'stg_product__dbt_backup'
[0m16:47:50.572544 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.574555 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_product"
[0m16:47:50.576541 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:47:50.576541 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_product" as 

with required_fields as (
    
    SELECT

        prod_id, product_category,product_sub_category

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



[0m16:47:50.578539 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.581539 [debug] [Thread-1 (]: On model.first.stg_product: COMMIT
[0m16:47:50.585549 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:47:50.586549 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:47:50.587548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.588548 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:47:50.588548 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:47:50.590532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.592534 [debug] [Thread-1 (]: Timing info for model.first.stg_product (execute): 16:47:50.546558 => 16:47:50.591546
[0m16:47:50.592534 [debug] [Thread-1 (]: On model.first.stg_product: ROLLBACK
[0m16:47:50.593545 [debug] [Thread-1 (]: On model.first.stg_product: Close
[0m16:47:50.594530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44801af5-53f2-4a41-8f82-69bf63960e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A7E57FD0>]}
[0m16:47:50.595530 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dbt.stg_product ............................... [[32mOK[0m in 0.05s]
[0m16:47:50.596529 [debug] [Thread-1 (]: Finished running node model.first.stg_product
[0m16:47:50.597529 [debug] [Thread-1 (]: Began running node model.first.stg_shipping
[0m16:47:50.597529 [info ] [Thread-1 (]: 5 of 6 START sql view model dbt.stg_shipping ................................... [RUN]
[0m16:47:50.599542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_product, now model.first.stg_shipping)
[0m16:47:50.599542 [debug] [Thread-1 (]: Began compiling node model.first.stg_shipping
[0m16:47:50.603544 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_shipping"
[0m16:47:50.605543 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (compile): 16:47:50.600546 => 16:47:50.604543
[0m16:47:50.605543 [debug] [Thread-1 (]: Began executing node model.first.stg_shipping
[0m16:47:50.612539 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:47:50.613520 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:47:50.613520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:50.614539 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:47:50.614539 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:47:50.616519 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.618531 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:47:50.618531 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:47:50.619529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.621529 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:47:50.621529 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_shipping'
  
[0m16:47:50.622528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.628529 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:47:50.628529 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
      EXEC sp_rename 'dbt.stg_shipping', 'stg_shipping__dbt_backup'
[0m16:47:50.631531 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.634545 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_shipping"
[0m16:47:50.635549 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:47:50.636530 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_shipping" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS order_id,
        CONVERT(date, ship_date) AS ship_date,
        Ship_mode,
        ship_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:47:50.638529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.640541 [debug] [Thread-1 (]: On model.first.stg_shipping: COMMIT
[0m16:47:50.644543 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:47:50.645525 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:47:50.646538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.648537 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:47:50.648537 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:47:50.650536 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:47:50.651536 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (execute): 16:47:50.605543 => 16:47:50.651536
[0m16:47:50.652534 [debug] [Thread-1 (]: On model.first.stg_shipping: ROLLBACK
[0m16:47:50.652534 [debug] [Thread-1 (]: On model.first.stg_shipping: Close
[0m16:47:50.653533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44801af5-53f2-4a41-8f82-69bf63960e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A7ECFEE0>]}
[0m16:47:50.654534 [info ] [Thread-1 (]: 5 of 6 OK created sql view model dbt.stg_shipping .............................. [[32mOK[0m in 0.05s]
[0m16:47:50.655520 [debug] [Thread-1 (]: Finished running node model.first.stg_shipping
[0m16:47:50.655520 [debug] [Thread-1 (]: Began running node model.first.customer
[0m16:47:50.656533 [info ] [Thread-1 (]: 6 of 6 SKIP relation dbt.customer .............................................. [[33mSKIP[0m]
[0m16:47:50.657519 [debug] [Thread-1 (]: Finished running node model.first.customer
[0m16:47:50.658517 [debug] [MainThread]: On master: COMMIT
[0m16:47:50.659521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:50.660517 [debug] [MainThread]: Connection 'list_master' was properly closed.
[0m16:47:50.660517 [debug] [MainThread]: Connection 'list_master_dbt' was properly closed.
[0m16:47:50.661526 [debug] [MainThread]: Connection 'model.first.stg_shipping' was properly closed.
[0m16:47:50.661526 [info ] [MainThread]: 
[0m16:47:50.662525 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m16:47:50.664514 [debug] [MainThread]: Command end result
[0m16:47:50.676512 [info ] [MainThread]: 
[0m16:47:50.677516 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:47:50.678508 [info ] [MainThread]: 
[0m16:47:50.678508 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'cust_id'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_segment'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_name'. (207)")
[0m16:47:50.680524 [info ] [MainThread]: 
[0m16:47:50.680524 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102) (SQLMoreResults)")
[0m16:47:50.681505 [info ] [MainThread]: 
[0m16:47:50.682504 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=1 TOTAL=6
[0m16:47:50.684504 [debug] [MainThread]: Command `dbt run` failed at 16:47:50.684504 after 1.62 seconds
[0m16:47:50.685503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A46FECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A76797E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A772E800>]}
[0m16:47:50.685503 [debug] [MainThread]: Flushing usage events
[0m16:48:52.172236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D52F3B910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D5582A350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D5582A170>]}


============================== 16:48:52.178233 | 4f4c09a9-54ab-4a69-ae5b-a51881e5dcf9 ==============================
[0m16:48:52.178233 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:48:52.179234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:48:52.582600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f4c09a9-54ab-4a69-ae5b-a51881e5dcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D5582A410>]}
[0m16:48:52.689539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f4c09a9-54ab-4a69-ae5b-a51881e5dcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D55E207C0>]}
[0m16:48:52.690538 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m16:48:52.706535 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:48:52.834447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:48:52.835442 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_customer.sql
[0m16:48:52.999347 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.online_shopping.mart
- models.online_shopping.staging
- models.online_shopping
[0m16:48:53.078302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f4c09a9-54ab-4a69-ae5b-a51881e5dcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D561E8340>]}
[0m16:48:53.099290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f4c09a9-54ab-4a69-ae5b-a51881e5dcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D5619BE20>]}
[0m16:48:53.100290 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:48:53.101289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f4c09a9-54ab-4a69-ae5b-a51881e5dcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D5619BD60>]}
[0m16:48:53.103288 [info ] [MainThread]: 
[0m16:48:53.104287 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m16:48:53.106286 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master'
[0m16:48:53.122280 [debug] [ThreadPool]: Using sqlserver connection "list_master"
[0m16:48:53.123277 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master"} */
select  name as [schema]
    from sys.schemas 
  
[0m16:48:53.123277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:53.124277 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:48:53.170000 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:48:53.171000 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:48:53.171999 [debug] [ThreadPool]: On list_master: Close
[0m16:48:53.173997 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master_dbt'
[0m16:48:53.182012 [debug] [ThreadPool]: Using sqlserver connection "list_master_dbt"
[0m16:48:53.183011 [debug] [ThreadPool]: On list_master_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master_dbt"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
  
[0m16:48:53.183011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:53.183011 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:48:53.184005 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:48:53.187004 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:48:53.189003 [debug] [ThreadPool]: On list_master_dbt: ROLLBACK
[0m16:48:53.189003 [debug] [ThreadPool]: On list_master_dbt: Close
[0m16:48:53.191002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f4c09a9-54ab-4a69-ae5b-a51881e5dcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D561E81C0>]}
[0m16:48:53.191002 [debug] [MainThread]: On master: COMMIT
[0m16:48:53.192002 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:48:53.192993 [info ] [MainThread]: 
[0m16:48:53.195996 [debug] [Thread-1 (]: Began running node model.first.stg_customer
[0m16:48:53.196994 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt.stg_customer ................................... [RUN]
[0m16:48:53.197986 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.first.stg_customer'
[0m16:48:53.198985 [debug] [Thread-1 (]: Began compiling node model.first.stg_customer
[0m16:48:53.212977 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_customer"
[0m16:48:53.214976 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (compile): 16:48:53.198985 => 16:48:53.213977
[0m16:48:53.214976 [debug] [Thread-1 (]: Began executing node model.first.stg_customer
[0m16:48:53.258950 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:48:53.259950 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:48:53.260949 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:48:53.261949 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:48:53.262949 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:48:53.264146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.265148 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:48:53.266147 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m16:48:53.267165 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.270144 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:48:53.271144 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_customer'
  
[0m16:48:53.272284 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.281299 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_customer"
[0m16:48:53.283280 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:48:53.283280 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_customer" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment as CustomerSegment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        CAST(Cust_id AS INT) as CustomerID,
        province,
        region,
        customer_segment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



[0m16:48:53.284279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.286292 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (execute): 16:48:53.215974 => 16:48:53.285297
[0m16:48:53.286292 [debug] [Thread-1 (]: On model.first.stg_customer: ROLLBACK
[0m16:48:53.287296 [debug] [Thread-1 (]: On model.first.stg_customer: Close
[0m16:48:53.288296 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_customer.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_segment'. (207) (SQLMoreResults)")
[0m16:48:53.291290 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_segment'. (207) (SQLMoreResults)")

[0m16:48:53.292274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f4c09a9-54ab-4a69-ae5b-a51881e5dcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D561DF3A0>]}
[0m16:48:53.293289 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model dbt.stg_customer .......................... [[31mERROR[0m in 0.09s]
[0m16:48:53.294276 [debug] [Thread-1 (]: Finished running node model.first.stg_customer
[0m16:48:53.295286 [debug] [Thread-1 (]: Began running node model.first.stg_market
[0m16:48:53.295286 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt.stg_market ..................................... [RUN]
[0m16:48:53.297282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_customer, now model.first.stg_market)
[0m16:48:53.297282 [debug] [Thread-1 (]: Began compiling node model.first.stg_market
[0m16:48:53.301279 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_market"
[0m16:48:53.303268 [debug] [Thread-1 (]: Timing info for model.first.stg_market (compile): 16:48:53.297282 => 16:48:53.302279
[0m16:48:53.303268 [debug] [Thread-1 (]: Began executing node model.first.stg_market
[0m16:48:53.310264 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:48:53.310264 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_market__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:48:53.311282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:53.311282 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:48:53.312282 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:48:53.313281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.314281 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:48:53.315269 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_market__dbt_backup";');

[0m16:48:53.316261 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.319264 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:48:53.320273 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_market'
  
[0m16:48:53.320273 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.323271 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_market"
[0m16:48:53.324270 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:48:53.325274 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_market" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id
        CAST(sales AS Float) AS sales,
        CAST(discount as Float) as discount,
        cast(order_quantity as int) as order_quantity,
        cast(profit as Float) as profit,
        cast(shipping_cost as Float) as shipping_cost,
        cast(product_base_margin as Float) as product_base_margin,

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:48:53.326545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.327548 [debug] [Thread-1 (]: Timing info for model.first.stg_market (execute): 16:48:53.304281 => 16:48:53.327548
[0m16:48:53.328547 [debug] [Thread-1 (]: On model.first.stg_market: ROLLBACK
[0m16:48:53.328547 [debug] [Thread-1 (]: On model.first.stg_market: Close
[0m16:48:53.329546 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_market.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102) (SQLMoreResults)")
[0m16:48:53.331544 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102) (SQLMoreResults)")

[0m16:48:53.332544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f4c09a9-54ab-4a69-ae5b-a51881e5dcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D56686A10>]}
[0m16:48:53.333570 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model dbt.stg_market ............................ [[31mERROR[0m in 0.04s]
[0m16:48:53.334585 [debug] [Thread-1 (]: Finished running node model.first.stg_market
[0m16:48:53.335605 [debug] [Thread-1 (]: Began running node model.first.stg_order
[0m16:48:53.336587 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt.stg_order ...................................... [RUN]
[0m16:48:53.338250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_market, now model.first.stg_order)
[0m16:48:53.338250 [debug] [Thread-1 (]: Began compiling node model.first.stg_order
[0m16:48:53.344232 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_order"
[0m16:48:53.346230 [debug] [Thread-1 (]: Timing info for model.first.stg_order (compile): 16:48:53.338250 => 16:48:53.346230
[0m16:48:53.347249 [debug] [Thread-1 (]: Began executing node model.first.stg_order
[0m16:48:53.357238 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:48:53.357238 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:48:53.358237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:53.358237 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:48:53.359236 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:48:53.360236 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.362224 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:48:53.362224 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:48:53.363223 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.365222 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:48:53.366221 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_order'
  
[0m16:48:53.367687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.375685 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:48:53.375685 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
      EXEC sp_rename 'dbt.stg_order', 'stg_order__dbt_backup'
[0m16:48:53.378697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.380701 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_order"
[0m16:48:53.382682 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:48:53.383700 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_order" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS Order_id,
        CONVERT(date, order_date) AS Order_date,
        Order_Priority,
        Ord_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:48:53.385707 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.406708 [debug] [Thread-1 (]: On model.first.stg_order: COMMIT
[0m16:48:53.409706 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:48:53.410692 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:48:53.411715 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.414690 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:48:53.414690 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:48:53.417007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.419008 [debug] [Thread-1 (]: Timing info for model.first.stg_order (execute): 16:48:53.348243 => 16:48:53.418009
[0m16:48:53.419008 [debug] [Thread-1 (]: On model.first.stg_order: ROLLBACK
[0m16:48:53.420007 [debug] [Thread-1 (]: On model.first.stg_order: Close
[0m16:48:53.420007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f4c09a9-54ab-4a69-ae5b-a51881e5dcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D561DF040>]}
[0m16:48:53.421007 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dbt.stg_order ................................. [[32mOK[0m in 0.08s]
[0m16:48:53.421978 [debug] [Thread-1 (]: Finished running node model.first.stg_order
[0m16:48:53.422994 [debug] [Thread-1 (]: Began running node model.first.stg_product
[0m16:48:53.423993 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt.stg_product .................................... [RUN]
[0m16:48:53.424311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_order, now model.first.stg_product)
[0m16:48:53.425327 [debug] [Thread-1 (]: Began compiling node model.first.stg_product
[0m16:48:53.431328 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_product"
[0m16:48:53.433308 [debug] [Thread-1 (]: Timing info for model.first.stg_product (compile): 16:48:53.425327 => 16:48:53.432309
[0m16:48:53.433308 [debug] [Thread-1 (]: Began executing node model.first.stg_product
[0m16:48:53.441317 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:48:53.442317 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:48:53.442317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:53.443315 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:48:53.444302 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:48:53.446300 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.447302 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:48:53.448321 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:48:53.449275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.451291 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:48:53.451291 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_product'
  
[0m16:48:53.452292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.456288 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:48:53.456288 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
      EXEC sp_rename 'dbt.stg_product', 'stg_product__dbt_backup'
[0m16:48:53.458287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.461272 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_product"
[0m16:48:53.463272 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:48:53.463272 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_product" as 

with required_fields as (
    
    SELECT

        prod_id, product_category,product_sub_category

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



[0m16:48:53.465268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.468281 [debug] [Thread-1 (]: On model.first.stg_product: COMMIT
[0m16:48:53.472279 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:48:53.472279 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:48:53.473278 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.475262 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:48:53.475262 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:48:53.477261 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.479260 [debug] [Thread-1 (]: Timing info for model.first.stg_product (execute): 16:48:53.434309 => 16:48:53.479260
[0m16:48:53.480260 [debug] [Thread-1 (]: On model.first.stg_product: ROLLBACK
[0m16:48:53.480260 [debug] [Thread-1 (]: On model.first.stg_product: Close
[0m16:48:53.482259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f4c09a9-54ab-4a69-ae5b-a51881e5dcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D56683EE0>]}
[0m16:48:53.482259 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dbt.stg_product ............................... [[32mOK[0m in 0.06s]
[0m16:48:53.484258 [debug] [Thread-1 (]: Finished running node model.first.stg_product
[0m16:48:53.484258 [debug] [Thread-1 (]: Began running node model.first.stg_shipping
[0m16:48:53.485257 [info ] [Thread-1 (]: 5 of 6 START sql view model dbt.stg_shipping ................................... [RUN]
[0m16:48:53.486256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_product, now model.first.stg_shipping)
[0m16:48:53.487256 [debug] [Thread-1 (]: Began compiling node model.first.stg_shipping
[0m16:48:53.492273 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_shipping"
[0m16:48:53.493252 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (compile): 16:48:53.487256 => 16:48:53.493252
[0m16:48:53.494256 [debug] [Thread-1 (]: Began executing node model.first.stg_shipping
[0m16:48:53.503272 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:48:53.504268 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:48:53.505265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:53.505265 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:48:53.506265 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:48:53.507244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.509263 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:48:53.510263 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:48:53.511242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.513241 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:48:53.514260 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_shipping'
  
[0m16:48:53.515243 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.522236 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:48:53.523255 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
      EXEC sp_rename 'dbt.stg_shipping', 'stg_shipping__dbt_backup'
[0m16:48:53.525246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.528232 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_shipping"
[0m16:48:53.530231 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:48:53.531250 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_shipping" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS order_id,
        CONVERT(date, ship_date) AS ship_date,
        Ship_mode,
        ship_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:48:53.534229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.537228 [debug] [Thread-1 (]: On model.first.stg_shipping: COMMIT
[0m16:48:53.541244 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:48:53.542243 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:48:53.543224 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.544238 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:48:53.545226 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:48:53.547241 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:48:53.549237 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (execute): 16:48:53.494256 => 16:48:53.549237
[0m16:48:53.550239 [debug] [Thread-1 (]: On model.first.stg_shipping: ROLLBACK
[0m16:48:53.550239 [debug] [Thread-1 (]: On model.first.stg_shipping: Close
[0m16:48:53.551238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f4c09a9-54ab-4a69-ae5b-a51881e5dcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D5670FF70>]}
[0m16:48:53.552238 [info ] [Thread-1 (]: 5 of 6 OK created sql view model dbt.stg_shipping .............................. [[32mOK[0m in 0.06s]
[0m16:48:53.553221 [debug] [Thread-1 (]: Finished running node model.first.stg_shipping
[0m16:48:53.554236 [debug] [Thread-1 (]: Began running node model.first.customer
[0m16:48:53.554236 [info ] [Thread-1 (]: 6 of 6 SKIP relation dbt.customer .............................................. [[33mSKIP[0m]
[0m16:48:53.555231 [debug] [Thread-1 (]: Finished running node model.first.customer
[0m16:48:53.556231 [debug] [MainThread]: On master: COMMIT
[0m16:48:53.557230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:53.558229 [debug] [MainThread]: Connection 'list_master' was properly closed.
[0m16:48:53.558229 [debug] [MainThread]: Connection 'list_master_dbt' was properly closed.
[0m16:48:53.558229 [debug] [MainThread]: Connection 'model.first.stg_shipping' was properly closed.
[0m16:48:53.559228 [info ] [MainThread]: 
[0m16:48:53.559228 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m16:48:53.561214 [debug] [MainThread]: Command end result
[0m16:48:53.575206 [info ] [MainThread]: 
[0m16:48:53.576224 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:48:53.577205 [info ] [MainThread]: 
[0m16:48:53.578204 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_segment'. (207) (SQLMoreResults)")
[0m16:48:53.580204 [info ] [MainThread]: 
[0m16:48:53.580204 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102) (SQLMoreResults)")
[0m16:48:53.581203 [info ] [MainThread]: 
[0m16:48:53.582203 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=1 TOTAL=6
[0m16:48:53.584201 [debug] [MainThread]: Command `dbt run` failed at 16:48:53.584201 after 1.49 seconds
[0m16:48:53.585201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D52F3B910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D55FE7F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D55F433A0>]}
[0m16:48:53.585201 [debug] [MainThread]: Flushing usage events
[0m16:49:23.542040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AAC6ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AD54A2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AD54A110>]}


============================== 16:49:23.548037 | a2682cfe-ba80-4561-92f4-f0974ca92557 ==============================
[0m16:49:23.548037 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:49:23.549036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:49:23.972860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2682cfe-ba80-4561-92f4-f0974ca92557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AD54A3B0>]}
[0m16:49:24.074807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2682cfe-ba80-4561-92f4-f0974ca92557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265ADB3C7C0>]}
[0m16:49:24.075801 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m16:49:24.090781 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:49:24.214884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:49:24.215888 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_customer.sql
[0m16:49:24.370800 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.online_shopping
- models.online_shopping.staging
- models.online_shopping.mart
[0m16:49:24.436756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2682cfe-ba80-4561-92f4-f0974ca92557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265ADF082E0>]}
[0m16:49:24.452733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2682cfe-ba80-4561-92f4-f0974ca92557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265ADEBBD00>]}
[0m16:49:24.452733 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:49:24.453733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2682cfe-ba80-4561-92f4-f0974ca92557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265ADEBBE20>]}
[0m16:49:24.455732 [info ] [MainThread]: 
[0m16:49:24.456731 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m16:49:24.458730 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master'
[0m16:49:24.474740 [debug] [ThreadPool]: Using sqlserver connection "list_master"
[0m16:49:24.474740 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master"} */
select  name as [schema]
    from sys.schemas 
  
[0m16:49:24.475734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:24.475734 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:49:24.522762 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:49:24.523768 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:49:24.525766 [debug] [ThreadPool]: On list_master: Close
[0m16:49:24.528375 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master_dbt'
[0m16:49:24.535373 [debug] [ThreadPool]: Using sqlserver connection "list_master_dbt"
[0m16:49:24.536372 [debug] [ThreadPool]: On list_master_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master_dbt"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
  
[0m16:49:24.536372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:24.537372 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:49:24.538371 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:49:24.542370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:49:24.544381 [debug] [ThreadPool]: On list_master_dbt: ROLLBACK
[0m16:49:24.544381 [debug] [ThreadPool]: On list_master_dbt: Close
[0m16:49:24.546381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2682cfe-ba80-4561-92f4-f0974ca92557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265ADF08280>]}
[0m16:49:24.546381 [debug] [MainThread]: On master: COMMIT
[0m16:49:24.547380 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:49:24.548385 [info ] [MainThread]: 
[0m16:49:24.552020 [debug] [Thread-1 (]: Began running node model.first.stg_customer
[0m16:49:24.553036 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt.stg_customer ................................... [RUN]
[0m16:49:24.555035 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.first.stg_customer'
[0m16:49:24.555035 [debug] [Thread-1 (]: Began compiling node model.first.stg_customer
[0m16:49:24.567023 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_customer"
[0m16:49:24.569032 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (compile): 16:49:24.556019 => 16:49:24.568023
[0m16:49:24.571016 [debug] [Thread-1 (]: Began executing node model.first.stg_customer
[0m16:49:24.613993 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:49:24.615004 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:49:24.616004 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:49:24.616984 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:49:24.617983 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:49:24.620982 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.624982 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:49:24.625998 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m16:49:24.626997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.630976 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:49:24.631975 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_customer'
  
[0m16:49:24.632975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.649966 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_customer"
[0m16:49:24.651966 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:49:24.651966 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_customer" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        CAST(Cust_id AS INT) as CustomerID,
        province,
        region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



[0m16:49:24.654963 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.671971 [debug] [Thread-1 (]: On model.first.stg_customer: COMMIT
[0m16:49:24.675969 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:49:24.676968 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:49:24.677968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.678967 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:49:24.679967 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m16:49:24.679967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.681965 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (execute): 16:49:24.571016 => 16:49:24.681965
[0m16:49:24.682965 [debug] [Thread-1 (]: On model.first.stg_customer: ROLLBACK
[0m16:49:24.682965 [debug] [Thread-1 (]: On model.first.stg_customer: Close
[0m16:49:24.683969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2682cfe-ba80-4561-92f4-f0974ca92557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265ADEFCDC0>]}
[0m16:49:24.684964 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt.stg_customer .............................. [[32mOK[0m in 0.13s]
[0m16:49:24.685945 [debug] [Thread-1 (]: Finished running node model.first.stg_customer
[0m16:49:24.686962 [debug] [Thread-1 (]: Began running node model.first.stg_market
[0m16:49:24.686962 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt.stg_market ..................................... [RUN]
[0m16:49:24.687962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_customer, now model.first.stg_market)
[0m16:49:24.688961 [debug] [Thread-1 (]: Began compiling node model.first.stg_market
[0m16:49:24.692959 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_market"
[0m16:49:24.693959 [debug] [Thread-1 (]: Timing info for model.first.stg_market (compile): 16:49:24.688961 => 16:49:24.693959
[0m16:49:24.694958 [debug] [Thread-1 (]: Began executing node model.first.stg_market
[0m16:49:24.709932 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:49:24.710931 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_market__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:49:24.711930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:24.711930 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:49:24.712929 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:49:24.713929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.715929 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:49:24.715929 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_market__dbt_backup";');

[0m16:49:24.716929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.718928 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:49:24.718928 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_market'
  
[0m16:49:24.719927 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.722926 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_market"
[0m16:49:24.724923 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:49:24.725922 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_market" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id
        CAST(sales AS Float) AS sales,
        CAST(discount as Float) as discount,
        cast(order_quantity as int) as order_quantity,
        cast(profit as Float) as profit,
        cast(shipping_cost as Float) as shipping_cost,
        cast(product_base_margin as Float) as product_base_margin,

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:49:24.726941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.727923 [debug] [Thread-1 (]: Timing info for model.first.stg_market (execute): 16:49:24.694958 => 16:49:24.727923
[0m16:49:24.728922 [debug] [Thread-1 (]: On model.first.stg_market: ROLLBACK
[0m16:49:24.728922 [debug] [Thread-1 (]: On model.first.stg_market: Close
[0m16:49:24.729921 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_market.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102) (SQLMoreResults)")
[0m16:49:24.733919 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102) (SQLMoreResults)")

[0m16:49:24.734918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2682cfe-ba80-4561-92f4-f0974ca92557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AE0FAE30>]}
[0m16:49:24.735918 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model dbt.stg_market ............................ [[31mERROR[0m in 0.05s]
[0m16:49:24.737917 [debug] [Thread-1 (]: Finished running node model.first.stg_market
[0m16:49:24.738918 [debug] [Thread-1 (]: Began running node model.first.stg_order
[0m16:49:24.740916 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt.stg_order ...................................... [RUN]
[0m16:49:24.742913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_market, now model.first.stg_order)
[0m16:49:24.742913 [debug] [Thread-1 (]: Began compiling node model.first.stg_order
[0m16:49:24.747909 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_order"
[0m16:49:24.748909 [debug] [Thread-1 (]: Timing info for model.first.stg_order (compile): 16:49:24.743912 => 16:49:24.748909
[0m16:49:24.749908 [debug] [Thread-1 (]: Began executing node model.first.stg_order
[0m16:49:24.758903 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:49:24.758903 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:49:24.759902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:24.760902 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:49:24.761902 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:49:24.762901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.764900 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:49:24.764900 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:49:24.765899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.766899 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:49:24.767898 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_order'
  
[0m16:49:24.768898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.778892 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:49:24.778892 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
      EXEC sp_rename 'dbt.stg_order', 'stg_order__dbt_backup'
[0m16:49:24.780891 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.783888 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_order"
[0m16:49:24.784888 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:49:24.784888 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_order" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS Order_id,
        CONVERT(date, order_date) AS Order_date,
        Order_Priority,
        Ord_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:49:24.787887 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.793901 [debug] [Thread-1 (]: On model.first.stg_order: COMMIT
[0m16:49:24.797899 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:49:24.798898 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:49:24.798898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.800897 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:49:24.800897 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:49:24.802893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.805898 [debug] [Thread-1 (]: Timing info for model.first.stg_order (execute): 16:49:24.749908 => 16:49:24.804881
[0m16:49:24.805898 [debug] [Thread-1 (]: On model.first.stg_order: ROLLBACK
[0m16:49:24.806894 [debug] [Thread-1 (]: On model.first.stg_order: Close
[0m16:49:24.807894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2682cfe-ba80-4561-92f4-f0974ca92557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265ADEE7DF0>]}
[0m16:49:24.808893 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dbt.stg_order ................................. [[32mOK[0m in 0.06s]
[0m16:49:24.809893 [debug] [Thread-1 (]: Finished running node model.first.stg_order
[0m16:49:24.809893 [debug] [Thread-1 (]: Began running node model.first.stg_product
[0m16:49:24.810892 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt.stg_product .................................... [RUN]
[0m16:49:24.811891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_order, now model.first.stg_product)
[0m16:49:24.811891 [debug] [Thread-1 (]: Began compiling node model.first.stg_product
[0m16:49:24.815889 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_product"
[0m16:49:24.817869 [debug] [Thread-1 (]: Timing info for model.first.stg_product (compile): 16:49:24.812890 => 16:49:24.816888
[0m16:49:24.817869 [debug] [Thread-1 (]: Began executing node model.first.stg_product
[0m16:49:24.827882 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:49:24.828881 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:49:24.828881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:24.829881 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:49:24.829881 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:49:24.831892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.833878 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:49:24.833878 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:49:24.834878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.835859 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:49:24.836858 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_product'
  
[0m16:49:24.837858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.842855 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:49:24.843875 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
      EXEC sp_rename 'dbt.stg_product', 'stg_product__dbt_backup'
[0m16:49:24.846871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.848871 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_product"
[0m16:49:24.849864 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:49:24.850869 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_product" as 

with required_fields as (
    
    SELECT

        prod_id, product_category,product_sub_category

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



[0m16:49:24.852863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.855848 [debug] [Thread-1 (]: On model.first.stg_product: COMMIT
[0m16:49:24.859860 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:49:24.860859 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:49:24.861860 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.863856 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:49:24.863856 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:49:24.865856 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.866854 [debug] [Thread-1 (]: Timing info for model.first.stg_product (execute): 16:49:24.818887 => 16:49:24.866854
[0m16:49:24.867854 [debug] [Thread-1 (]: On model.first.stg_product: ROLLBACK
[0m16:49:24.867854 [debug] [Thread-1 (]: On model.first.stg_product: Close
[0m16:49:24.868858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2682cfe-ba80-4561-92f4-f0974ca92557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AE418E80>]}
[0m16:49:24.869858 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dbt.stg_product ............................... [[32mOK[0m in 0.06s]
[0m16:49:24.871838 [debug] [Thread-1 (]: Finished running node model.first.stg_product
[0m16:49:24.872839 [debug] [Thread-1 (]: Began running node model.first.stg_shipping
[0m16:49:24.872839 [info ] [Thread-1 (]: 5 of 6 START sql view model dbt.stg_shipping ................................... [RUN]
[0m16:49:24.874838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_product, now model.first.stg_shipping)
[0m16:49:24.875836 [debug] [Thread-1 (]: Began compiling node model.first.stg_shipping
[0m16:49:24.879834 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_shipping"
[0m16:49:24.880833 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (compile): 16:49:24.875836 => 16:49:24.880833
[0m16:49:24.880833 [debug] [Thread-1 (]: Began executing node model.first.stg_shipping
[0m16:49:24.888828 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:49:24.888828 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:49:24.889828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:24.889828 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:49:24.890828 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:49:24.892827 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.894825 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:49:24.894825 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:49:24.895825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.897823 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:49:24.897823 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_shipping'
  
[0m16:49:24.898823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.904820 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:49:24.905819 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
      EXEC sp_rename 'dbt.stg_shipping', 'stg_shipping__dbt_backup'
[0m16:49:24.907818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.910816 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_shipping"
[0m16:49:24.911817 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:49:24.912818 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_shipping" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS order_id,
        CONVERT(date, ship_date) AS ship_date,
        Ship_mode,
        ship_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:49:24.914814 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.917811 [debug] [Thread-1 (]: On model.first.stg_shipping: COMMIT
[0m16:49:24.921810 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:49:24.921810 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:49:24.922809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.924808 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:49:24.925807 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:49:24.926807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.928805 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (execute): 16:49:24.881833 => 16:49:24.928805
[0m16:49:24.929805 [debug] [Thread-1 (]: On model.first.stg_shipping: ROLLBACK
[0m16:49:24.929805 [debug] [Thread-1 (]: On model.first.stg_shipping: Close
[0m16:49:24.930804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2682cfe-ba80-4561-92f4-f0974ca92557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AE462170>]}
[0m16:49:24.931803 [info ] [Thread-1 (]: 5 of 6 OK created sql view model dbt.stg_shipping .............................. [[32mOK[0m in 0.06s]
[0m16:49:24.932803 [debug] [Thread-1 (]: Finished running node model.first.stg_shipping
[0m16:49:24.933803 [debug] [Thread-1 (]: Began running node model.first.customer
[0m16:49:24.933803 [info ] [Thread-1 (]: 6 of 6 START sql view model dbt.customer ....................................... [RUN]
[0m16:49:24.934802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_shipping, now model.first.customer)
[0m16:49:24.935802 [debug] [Thread-1 (]: Began compiling node model.first.customer
[0m16:49:24.940799 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.customer"
[0m16:49:24.942798 [debug] [Thread-1 (]: Timing info for model.first.customer (compile): 16:49:24.935802 => 16:49:24.941798
[0m16:49:24.942798 [debug] [Thread-1 (]: Began executing node model.first.customer
[0m16:49:24.949794 [debug] [Thread-1 (]: Using sqlserver connection "model.first.customer"
[0m16:49:24.950793 [debug] [Thread-1 (]: On model.first.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:49:24.950793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:24.951792 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:49:24.951792 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:49:24.964784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.966784 [debug] [Thread-1 (]: Using sqlserver connection "model.first.customer"
[0m16:49:24.967783 [debug] [Thread-1 (]: On model.first.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."customer__dbt_backup";');

[0m16:49:24.967783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.969782 [debug] [Thread-1 (]: Using sqlserver connection "model.first.customer"
[0m16:49:24.969782 [debug] [Thread-1 (]: On model.first.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'customer'
  
[0m16:49:24.981775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.983774 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.customer"
[0m16:49:24.985773 [debug] [Thread-1 (]: Using sqlserver connection "model.first.customer"
[0m16:49:24.986773 [debug] [Thread-1 (]: On model.first.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.customer"} */
USE [master];
    
    

    EXEC('create view "dbt"."customer" as /*

WITH

stg_customer AS (

    SELECT

        *

    FROM "master"."dbt"."stg_customer" where region != "NUNAVUT"

),

order_info AS (

    SELECT

        cust_id
        , COUNT(*)  AS total_orders

    FROM stg_order

    GROUP BY 
        cust_id

)

-- final AS (

--     SELECT 

--         sc.*
--         , oi.total_orders

--     FROM stg_customer sc

--     LEFT JOIN order_info oi
--         ON sc.customer_id = oi.customer_id
-- )

-- SELECT * FROM final;');



[0m16:49:24.987773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:24.989772 [debug] [Thread-1 (]: Timing info for model.first.customer (execute): 16:49:24.942798 => 16:49:24.988771
[0m16:49:24.989772 [debug] [Thread-1 (]: On model.first.customer: ROLLBACK
[0m16:49:24.990771 [debug] [Thread-1 (]: On model.first.customer: Close
[0m16:49:24.991770 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\mart\customer.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Missing end comment mark '*/'. (113) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'as'. (102)")
[0m16:49:24.992770 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Missing end comment mark '*/'. (113) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'as'. (102)")

[0m16:49:24.993768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2682cfe-ba80-4561-92f4-f0974ca92557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265ADEFE440>]}
[0m16:49:24.994767 [error] [Thread-1 (]: 6 of 6 ERROR creating sql view model dbt.customer .............................. [[31mERROR[0m in 0.06s]
[0m16:49:24.995767 [debug] [Thread-1 (]: Finished running node model.first.customer
[0m16:49:24.996766 [debug] [MainThread]: On master: COMMIT
[0m16:49:24.997766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:24.998765 [debug] [MainThread]: Connection 'list_master' was properly closed.
[0m16:49:24.998765 [debug] [MainThread]: Connection 'list_master_dbt' was properly closed.
[0m16:49:24.998765 [debug] [MainThread]: Connection 'model.first.customer' was properly closed.
[0m16:49:24.999764 [info ] [MainThread]: 
[0m16:49:24.999764 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m16:49:25.001764 [debug] [MainThread]: Command end result
[0m16:49:25.017756 [info ] [MainThread]: 
[0m16:49:25.017756 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:49:25.018757 [info ] [MainThread]: 
[0m16:49:25.019755 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near '('. (102) (SQLMoreResults)")
[0m16:49:25.020753 [info ] [MainThread]: 
[0m16:49:25.021754 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Missing end comment mark '*/'. (113) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'as'. (102)")
[0m16:49:25.022752 [info ] [MainThread]: 
[0m16:49:25.023770 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m16:49:25.025752 [debug] [MainThread]: Command `dbt run` failed at 16:49:25.025752 after 1.56 seconds
[0m16:49:25.026753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AAC6ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265ADC99E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AE419DE0>]}
[0m16:49:25.026753 [debug] [MainThread]: Flushing usage events
[0m16:53:53.410992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FA1FECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FCADA2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FCADA0E0>]}


============================== 16:53:53.417001 | 28d919cf-cac1-447f-a0c1-ec4b5bc4e9cc ==============================
[0m16:53:53.417001 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:53:53.418018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:53:53.807657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28d919cf-cac1-447f-a0c1-ec4b5bc4e9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FCADA380>]}
[0m16:53:53.910599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28d919cf-cac1-447f-a0c1-ec4b5bc4e9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FD0CC7C0>]}
[0m16:53:53.911598 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m16:53:53.925590 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:53:54.083485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m16:53:54.084485 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_order.sql
[0m16:53:54.085484 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_market.sql
[0m16:53:54.085484 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_product.sql
[0m16:53:54.086484 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_shipping.sql
[0m16:53:54.250409 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.online_shopping.mart
- models.online_shopping
- models.online_shopping.staging
[0m16:53:54.317365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28d919cf-cac1-447f-a0c1-ec4b5bc4e9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FD48F970>]}
[0m16:53:54.333342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28d919cf-cac1-447f-a0c1-ec4b5bc4e9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FD44BEE0>]}
[0m16:53:54.334356 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:53:54.335343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28d919cf-cac1-447f-a0c1-ec4b5bc4e9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FD13D6F0>]}
[0m16:53:54.337359 [info ] [MainThread]: 
[0m16:53:54.338359 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m16:53:54.341340 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master'
[0m16:53:54.356348 [debug] [ThreadPool]: Using sqlserver connection "list_master"
[0m16:53:54.356348 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master"} */
select  name as [schema]
    from sys.schemas 
  
[0m16:53:54.357347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:54.357347 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:53:54.417751 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:53:54.420118 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:53:54.421120 [debug] [ThreadPool]: On list_master: Close
[0m16:53:54.424132 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master_dbt'
[0m16:53:54.432126 [debug] [ThreadPool]: Using sqlserver connection "list_master_dbt"
[0m16:53:54.433126 [debug] [ThreadPool]: On list_master_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master_dbt"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
  
[0m16:53:54.433126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:54.434125 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:53:54.434125 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:53:54.447118 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:53:54.448118 [debug] [ThreadPool]: On list_master_dbt: ROLLBACK
[0m16:53:54.449117 [debug] [ThreadPool]: On list_master_dbt: Close
[0m16:53:54.451155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28d919cf-cac1-447f-a0c1-ec4b5bc4e9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FD17A740>]}
[0m16:53:54.451155 [debug] [MainThread]: On master: COMMIT
[0m16:53:54.452171 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:53:54.452956 [info ] [MainThread]: 
[0m16:53:54.456432 [debug] [Thread-1 (]: Began running node model.first.stg_customer
[0m16:53:54.457448 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt.stg_customer ................................... [RUN]
[0m16:53:54.459434 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.first.stg_customer'
[0m16:53:54.459434 [debug] [Thread-1 (]: Began compiling node model.first.stg_customer
[0m16:53:54.476444 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_customer"
[0m16:53:54.479422 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (compile): 16:53:54.459434 => 16:53:54.478423
[0m16:53:54.480425 [debug] [Thread-1 (]: Began executing node model.first.stg_customer
[0m16:53:54.522410 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:53:54.523409 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:53:54.523409 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:53:54.524409 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:53:54.524409 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:53:54.540387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.542385 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:53:54.543414 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m16:53:54.544408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.548400 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:53:54.548400 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_customer'
  
[0m16:53:54.556395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.563386 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:53:54.564386 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
USE [master];
      EXEC sp_rename 'dbt.stg_customer', 'stg_customer__dbt_backup'
[0m16:53:54.736020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.746014 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_customer"
[0m16:53:54.748013 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:53:54.748013 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_customer" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        CAST(Cust_id AS INT) as CustomerID,
        province,
        region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



[0m16:53:54.751009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.774997 [debug] [Thread-1 (]: On model.first.stg_customer: COMMIT
[0m16:53:54.779994 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:53:54.780994 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:53:54.781590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.782606 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:53:54.783605 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m16:53:54.785036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.786051 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (execute): 16:53:54.481423 => 16:53:54.786051
[0m16:53:54.787050 [debug] [Thread-1 (]: On model.first.stg_customer: ROLLBACK
[0m16:53:54.787050 [debug] [Thread-1 (]: On model.first.stg_customer: Close
[0m16:53:54.788049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28d919cf-cac1-447f-a0c1-ec4b5bc4e9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FD492E00>]}
[0m16:53:54.789049 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt.stg_customer .............................. [[32mOK[0m in 0.33s]
[0m16:53:54.790035 [debug] [Thread-1 (]: Finished running node model.first.stg_customer
[0m16:53:54.791053 [debug] [Thread-1 (]: Began running node model.first.stg_market
[0m16:53:54.791053 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt.stg_market ..................................... [RUN]
[0m16:53:54.792052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_customer, now model.first.stg_market)
[0m16:53:54.793053 [debug] [Thread-1 (]: Began compiling node model.first.stg_market
[0m16:53:54.798043 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_market"
[0m16:53:54.799030 [debug] [Thread-1 (]: Timing info for model.first.stg_market (compile): 16:53:54.793053 => 16:53:54.799030
[0m16:53:54.800043 [debug] [Thread-1 (]: Began executing node model.first.stg_market
[0m16:53:54.805040 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:53:54.806039 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_market__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:53:54.807038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:54.807038 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:53:54.808038 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:53:54.821031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.822031 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:53:54.823029 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_market__dbt_backup";');

[0m16:53:54.824028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.825029 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:53:54.826028 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_market'
  
[0m16:53:54.834028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.837021 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_market"
[0m16:53:54.838021 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:53:54.839007 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_market" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id,
        CAST(sales AS Float) AS Sales,
        CAST(discount as Float) as Discount,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Float) as Profit,
        cast(shipping_cost as Float) as ShippingCost,
        cast(product_base_margin as Float) as ProductBaseMargin,

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:53:54.840025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.841006 [debug] [Thread-1 (]: Timing info for model.first.stg_market (execute): 16:53:54.800043 => 16:53:54.841006
[0m16:53:54.842005 [debug] [Thread-1 (]: On model.first.stg_market: ROLLBACK
[0m16:53:54.842005 [debug] [Thread-1 (]: On model.first.stg_market: Close
[0m16:53:54.843004 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\staging\stg_market.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'FROM'. (156) (SQLMoreResults)")
[0m16:53:54.849015 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'FROM'. (156) (SQLMoreResults)")

[0m16:53:54.850000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28d919cf-cac1-447f-a0c1-ec4b5bc4e9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FD650EB0>]}
[0m16:53:54.851002 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model dbt.stg_market ............................ [[31mERROR[0m in 0.06s]
[0m16:53:54.852999 [debug] [Thread-1 (]: Finished running node model.first.stg_market
[0m16:53:54.852999 [debug] [Thread-1 (]: Began running node model.first.stg_order
[0m16:53:54.853998 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt.stg_order ...................................... [RUN]
[0m16:53:54.854997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_market, now model.first.stg_order)
[0m16:53:54.856012 [debug] [Thread-1 (]: Began compiling node model.first.stg_order
[0m16:53:54.859995 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_order"
[0m16:53:54.861994 [debug] [Thread-1 (]: Timing info for model.first.stg_order (compile): 16:53:54.856012 => 16:53:54.861994
[0m16:53:54.861994 [debug] [Thread-1 (]: Began executing node model.first.stg_order
[0m16:53:54.869005 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:53:54.870004 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:53:54.870004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:54.871003 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:53:54.871003 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:53:54.884981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.885980 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:53:54.886979 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:53:54.887993 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.889979 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:53:54.890977 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_order'
  
[0m16:53:54.901984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.906970 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:53:54.906970 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
      EXEC sp_rename 'dbt.stg_order', 'stg_order__dbt_backup'
[0m16:53:54.909965 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.912964 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_order"
[0m16:53:54.914971 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:53:54.915962 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_order" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date) AS OrderDate,
        Order_Priority,
        Ord_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:53:54.917980 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.920960 [debug] [Thread-1 (]: On model.first.stg_order: COMMIT
[0m16:53:54.925957 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:53:54.926956 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:53:54.927956 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.929968 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:53:54.929968 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:53:54.931963 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.933966 [debug] [Thread-1 (]: Timing info for model.first.stg_order (execute): 16:53:54.863007 => 16:53:54.933966
[0m16:53:54.934965 [debug] [Thread-1 (]: On model.first.stg_order: ROLLBACK
[0m16:53:54.934965 [debug] [Thread-1 (]: On model.first.stg_order: Close
[0m16:53:54.935965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28d919cf-cac1-447f-a0c1-ec4b5bc4e9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FD9B25F0>]}
[0m16:53:54.935965 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dbt.stg_order ................................. [[32mOK[0m in 0.08s]
[0m16:53:54.937286 [debug] [Thread-1 (]: Finished running node model.first.stg_order
[0m16:53:54.938302 [debug] [Thread-1 (]: Began running node model.first.stg_product
[0m16:53:54.939301 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt.stg_product .................................... [RUN]
[0m16:53:54.940305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_order, now model.first.stg_product)
[0m16:53:54.940305 [debug] [Thread-1 (]: Began compiling node model.first.stg_product
[0m16:53:54.944303 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_product"
[0m16:53:54.946302 [debug] [Thread-1 (]: Timing info for model.first.stg_product (compile): 16:53:54.940305 => 16:53:54.945302
[0m16:53:54.946302 [debug] [Thread-1 (]: Began executing node model.first.stg_product
[0m16:53:54.952298 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:53:54.953297 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:53:54.953297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:54.954297 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:53:54.955296 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:53:54.967290 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.969288 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:53:54.969288 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:53:54.970269 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.972282 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:53:54.972282 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_product'
  
[0m16:53:54.980298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.985276 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:53:54.985276 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
      EXEC sp_rename 'dbt.stg_product', 'stg_product__dbt_backup'
[0m16:53:54.987989 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.990005 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_product"
[0m16:53:54.991004 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:53:54.992003 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_product" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



[0m16:53:54.993988 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:54.996987 [debug] [Thread-1 (]: On model.first.stg_product: COMMIT
[0m16:53:55.000998 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:53:55.000998 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:53:55.001997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:55.003997 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:53:55.003997 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:53:55.005935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:55.006937 [debug] [Thread-1 (]: Timing info for model.first.stg_product (execute): 16:53:54.947301 => 16:53:55.006937
[0m16:53:55.007936 [debug] [Thread-1 (]: On model.first.stg_product: ROLLBACK
[0m16:53:55.007936 [debug] [Thread-1 (]: On model.first.stg_product: Close
[0m16:53:55.008936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28d919cf-cac1-447f-a0c1-ec4b5bc4e9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FD650D00>]}
[0m16:53:55.009935 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dbt.stg_product ............................... [[32mOK[0m in 0.07s]
[0m16:53:55.010935 [debug] [Thread-1 (]: Finished running node model.first.stg_product
[0m16:53:55.011934 [debug] [Thread-1 (]: Began running node model.first.stg_shipping
[0m16:53:55.012933 [info ] [Thread-1 (]: 5 of 6 START sql view model dbt.stg_shipping ................................... [RUN]
[0m16:53:55.014932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_product, now model.first.stg_shipping)
[0m16:53:55.014932 [debug] [Thread-1 (]: Began compiling node model.first.stg_shipping
[0m16:53:55.018930 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_shipping"
[0m16:53:55.019929 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (compile): 16:53:55.014932 => 16:53:55.019929
[0m16:53:55.020929 [debug] [Thread-1 (]: Began executing node model.first.stg_shipping
[0m16:53:55.027924 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:53:55.028924 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:53:55.029923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:55.029923 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:53:55.030923 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:53:55.042927 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:55.044915 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:53:55.045914 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:53:55.046915 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:55.048913 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:53:55.048913 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_shipping'
  
[0m16:53:55.056942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:55.060944 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:53:55.061939 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
      EXEC sp_rename 'dbt.stg_shipping', 'stg_shipping__dbt_backup'
[0m16:53:55.063924 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:55.066940 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_shipping"
[0m16:53:55.067935 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:53:55.068939 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_shipping" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date) AS ShipDate,
        Ship_mode,
        ship_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:53:55.070701 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:55.072716 [debug] [Thread-1 (]: On model.first.stg_shipping: COMMIT
[0m16:53:55.076718 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:53:55.077699 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:53:55.078699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:55.080699 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:53:55.080699 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:53:55.082710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:55.083710 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (execute): 16:53:55.020929 => 16:53:55.083710
[0m16:53:55.084709 [debug] [Thread-1 (]: On model.first.stg_shipping: ROLLBACK
[0m16:53:55.084709 [debug] [Thread-1 (]: On model.first.stg_shipping: Close
[0m16:53:55.085708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28d919cf-cac1-447f-a0c1-ec4b5bc4e9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FD614C70>]}
[0m16:53:55.086707 [info ] [Thread-1 (]: 5 of 6 OK created sql view model dbt.stg_shipping .............................. [[32mOK[0m in 0.07s]
[0m16:53:55.087693 [debug] [Thread-1 (]: Finished running node model.first.stg_shipping
[0m16:53:55.088707 [debug] [Thread-1 (]: Began running node model.first.customer
[0m16:53:55.088707 [info ] [Thread-1 (]: 6 of 6 START sql view model dbt.customer ....................................... [RUN]
[0m16:53:55.089706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_shipping, now model.first.customer)
[0m16:53:55.090706 [debug] [Thread-1 (]: Began compiling node model.first.customer
[0m16:53:55.096706 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.customer"
[0m16:53:55.097702 [debug] [Thread-1 (]: Timing info for model.first.customer (compile): 16:53:55.090706 => 16:53:55.097702
[0m16:53:55.098705 [debug] [Thread-1 (]: Began executing node model.first.customer
[0m16:53:55.104698 [debug] [Thread-1 (]: Using sqlserver connection "model.first.customer"
[0m16:53:55.104698 [debug] [Thread-1 (]: On model.first.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:53:55.105697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:55.105697 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:53:55.106696 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:53:55.119480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:55.120483 [debug] [Thread-1 (]: Using sqlserver connection "model.first.customer"
[0m16:53:55.121482 [debug] [Thread-1 (]: On model.first.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."customer__dbt_backup";');

[0m16:53:55.122507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:55.123496 [debug] [Thread-1 (]: Using sqlserver connection "model.first.customer"
[0m16:53:55.124494 [debug] [Thread-1 (]: On model.first.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'customer'
  
[0m16:53:55.133196 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:55.136193 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.customer"
[0m16:53:55.137181 [debug] [Thread-1 (]: Using sqlserver connection "model.first.customer"
[0m16:53:55.138180 [debug] [Thread-1 (]: On model.first.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.customer"} */
USE [master];
    
    

    EXEC('create view "dbt"."customer" as /*

WITH

stg_customer AS (

    SELECT

        *

    FROM "master"."dbt"."stg_customer" where region != "NUNAVUT"

),

order_info AS (

    SELECT

        cust_id
        , COUNT(*)  AS total_orders

    FROM stg_order

    GROUP BY 
        cust_id

)

-- final AS (

--     SELECT 

--         sc.*
--         , oi.total_orders

--     FROM stg_customer sc

--     LEFT JOIN order_info oi
--         ON sc.customer_id = oi.customer_id
-- )

-- SELECT * FROM final;');



[0m16:53:55.139192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:55.140192 [debug] [Thread-1 (]: Timing info for model.first.customer (execute): 16:53:55.098705 => 16:53:55.140192
[0m16:53:55.140192 [debug] [Thread-1 (]: On model.first.customer: ROLLBACK
[0m16:53:55.141191 [debug] [Thread-1 (]: On model.first.customer: Close
[0m16:53:55.142190 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\mart\customer.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Missing end comment mark '*/'. (113) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'as'. (102)")
[0m16:53:55.143696 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Missing end comment mark '*/'. (113) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'as'. (102)")

[0m16:53:55.144688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28d919cf-cac1-447f-a0c1-ec4b5bc4e9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FD995690>]}
[0m16:53:55.145699 [error] [Thread-1 (]: 6 of 6 ERROR creating sql view model dbt.customer .............................. [[31mERROR[0m in 0.05s]
[0m16:53:55.146679 [debug] [Thread-1 (]: Finished running node model.first.customer
[0m16:53:55.148688 [debug] [MainThread]: On master: COMMIT
[0m16:53:55.148688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:55.149687 [debug] [MainThread]: Connection 'list_master' was properly closed.
[0m16:53:55.149687 [debug] [MainThread]: Connection 'list_master_dbt' was properly closed.
[0m16:53:55.150687 [debug] [MainThread]: Connection 'model.first.customer' was properly closed.
[0m16:53:55.150687 [info ] [MainThread]: 
[0m16:53:55.151676 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m16:53:55.153677 [debug] [MainThread]: Command end result
[0m16:53:55.167669 [info ] [MainThread]: 
[0m16:53:55.168667 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:53:55.169687 [info ] [MainThread]: 
[0m16:53:55.170666 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'FROM'. (156) (SQLMoreResults)")
[0m16:53:55.171684 [info ] [MainThread]: 
[0m16:53:55.171684 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Missing end comment mark '*/'. (113) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'as'. (102)")
[0m16:53:55.172680 [info ] [MainThread]: 
[0m16:53:55.173665 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m16:53:55.175665 [debug] [MainThread]: Command `dbt run` failed at 16:53:55.175665 after 1.85 seconds
[0m16:53:55.176665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FA1FECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FCADA3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260FD995AE0>]}
[0m16:53:55.177664 [debug] [MainThread]: Flushing usage events
[0m16:54:41.725701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024139F6ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413C84A2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413C84A110>]}


============================== 16:54:41.731702 | b202cb5e-a1cc-455c-9cac-3107c3b09604 ==============================
[0m16:54:41.731702 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:54:41.732685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:54:42.127884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b202cb5e-a1cc-455c-9cac-3107c3b09604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413C84A3B0>]}
[0m16:54:42.230825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b202cb5e-a1cc-455c-9cac-3107c3b09604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413CE3C7C0>]}
[0m16:54:42.231825 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m16:54:42.245822 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:54:42.373495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:54:42.374494 [debug] [MainThread]: Partial parsing: updated file: first://models\staging\stg_market.sql
[0m16:54:42.523428 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.online_shopping.staging
- models.online_shopping.mart
- models.online_shopping
[0m16:54:42.588386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b202cb5e-a1cc-455c-9cac-3107c3b09604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413D2082E0>]}
[0m16:54:42.604363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b202cb5e-a1cc-455c-9cac-3107c3b09604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413D1BBD00>]}
[0m16:54:42.605378 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:54:42.605378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b202cb5e-a1cc-455c-9cac-3107c3b09604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413D1BBE20>]}
[0m16:54:42.607363 [info ] [MainThread]: 
[0m16:54:42.609362 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m16:54:42.611363 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master'
[0m16:54:42.624370 [debug] [ThreadPool]: Using sqlserver connection "list_master"
[0m16:54:42.624370 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master"} */
select  name as [schema]
    from sys.schemas 
  
[0m16:54:42.625370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:42.625370 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:54:42.691102 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:54:42.694090 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:54:42.696086 [debug] [ThreadPool]: On list_master: Close
[0m16:54:42.699084 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master_dbt'
[0m16:54:42.706093 [debug] [ThreadPool]: Using sqlserver connection "list_master_dbt"
[0m16:54:42.706093 [debug] [ThreadPool]: On list_master_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master_dbt"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
  
[0m16:54:42.707082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:42.707082 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:54:42.708080 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:54:42.722070 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:54:42.724072 [debug] [ThreadPool]: On list_master_dbt: ROLLBACK
[0m16:54:42.724072 [debug] [ThreadPool]: On list_master_dbt: Close
[0m16:54:42.726070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b202cb5e-a1cc-455c-9cac-3107c3b09604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413CEAB6D0>]}
[0m16:54:42.727069 [debug] [MainThread]: On master: COMMIT
[0m16:54:42.728069 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:54:42.729067 [info ] [MainThread]: 
[0m16:54:42.733067 [debug] [Thread-1 (]: Began running node model.first.stg_customer
[0m16:54:42.734064 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt.stg_customer ................................... [RUN]
[0m16:54:42.735065 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.first.stg_customer'
[0m16:54:42.736082 [debug] [Thread-1 (]: Began compiling node model.first.stg_customer
[0m16:54:42.752054 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_customer"
[0m16:54:42.755054 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (compile): 16:54:42.736082 => 16:54:42.754054
[0m16:54:42.755054 [debug] [Thread-1 (]: Began executing node model.first.stg_customer
[0m16:54:42.796029 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:54:42.797028 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:54:42.797028 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:54:42.798027 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:54:42.798027 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:54:42.815017 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:42.816035 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:54:42.817035 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m16:54:42.818035 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:42.821014 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:54:42.822014 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_customer'
  
[0m16:54:42.831027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:42.838018 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:54:42.839017 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
USE [master];
      EXEC sp_rename 'dbt.stg_customer', 'stg_customer__dbt_backup'
[0m16:54:43.013945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.022955 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_customer"
[0m16:54:43.024944 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:54:43.024944 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_customer" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        CAST(Cust_id AS INT) as CustomerID,
        province,
        region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



[0m16:54:43.027771 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.046762 [debug] [Thread-1 (]: On model.first.stg_customer: COMMIT
[0m16:54:43.049761 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:54:43.050760 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:54:43.051801 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.052802 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:54:43.053801 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m16:54:43.055402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.056404 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (execute): 16:54:42.756053 => 16:54:43.056404
[0m16:54:43.057403 [debug] [Thread-1 (]: On model.first.stg_customer: ROLLBACK
[0m16:54:43.057403 [debug] [Thread-1 (]: On model.first.stg_customer: Close
[0m16:54:43.058402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b202cb5e-a1cc-455c-9cac-3107c3b09604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413D1FFB50>]}
[0m16:54:43.059402 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt.stg_customer .............................. [[32mOK[0m in 0.32s]
[0m16:54:43.060107 [debug] [Thread-1 (]: Finished running node model.first.stg_customer
[0m16:54:43.061122 [debug] [Thread-1 (]: Began running node model.first.stg_market
[0m16:54:43.062109 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt.stg_market ..................................... [RUN]
[0m16:54:43.063121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_customer, now model.first.stg_market)
[0m16:54:43.063121 [debug] [Thread-1 (]: Began compiling node model.first.stg_market
[0m16:54:43.071104 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_market"
[0m16:54:43.073105 [debug] [Thread-1 (]: Timing info for model.first.stg_market (compile): 16:54:43.063121 => 16:54:43.072102
[0m16:54:43.074102 [debug] [Thread-1 (]: Began executing node model.first.stg_market
[0m16:54:43.086093 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:54:43.087093 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_market__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:54:43.087093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:43.088092 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:54:43.088092 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:54:43.103086 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.105084 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:54:43.105084 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_market__dbt_backup";');

[0m16:54:43.106083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.107083 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:54:43.108083 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_market'
  
[0m16:54:43.117077 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.120076 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_market"
[0m16:54:43.121076 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:54:43.122075 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_market" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id,
        CAST(sales AS Float) AS Sales,
        CAST(discount as Float) as Discount,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Float) as Profit,
        cast(shipping_cost as Float) as ShippingCost,
        cast(product_base_margin as Float) as ProductBaseMargin

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:54:43.124074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.126072 [debug] [Thread-1 (]: On model.first.stg_market: COMMIT
[0m16:54:43.131068 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:54:43.131068 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_market__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:54:43.132070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.134068 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:54:43.134068 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_market__dbt_backup";');

[0m16:54:43.135067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.137065 [debug] [Thread-1 (]: Timing info for model.first.stg_market (execute): 16:54:43.074102 => 16:54:43.137065
[0m16:54:43.137065 [debug] [Thread-1 (]: On model.first.stg_market: ROLLBACK
[0m16:54:43.138065 [debug] [Thread-1 (]: On model.first.stg_market: Close
[0m16:54:43.139064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b202cb5e-a1cc-455c-9cac-3107c3b09604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413D1CB2B0>]}
[0m16:54:43.139064 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dbt.stg_market ................................ [[32mOK[0m in 0.08s]
[0m16:54:43.141062 [debug] [Thread-1 (]: Finished running node model.first.stg_market
[0m16:54:43.142062 [debug] [Thread-1 (]: Began running node model.first.stg_order
[0m16:54:43.143063 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt.stg_order ...................................... [RUN]
[0m16:54:43.144062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_market, now model.first.stg_order)
[0m16:54:43.144062 [debug] [Thread-1 (]: Began compiling node model.first.stg_order
[0m16:54:43.150057 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_order"
[0m16:54:43.152056 [debug] [Thread-1 (]: Timing info for model.first.stg_order (compile): 16:54:43.145062 => 16:54:43.151056
[0m16:54:43.153055 [debug] [Thread-1 (]: Began executing node model.first.stg_order
[0m16:54:43.162056 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:54:43.163049 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:54:43.164049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:43.165048 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:54:43.166048 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:54:43.180042 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.183050 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:54:43.184038 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:54:43.186039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.188038 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:54:43.189038 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_order'
  
[0m16:54:43.197855 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.203863 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:54:43.204862 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
      EXEC sp_rename 'dbt.stg_order', 'stg_order__dbt_backup'
[0m16:54:43.207342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.209362 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_order"
[0m16:54:43.210361 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:54:43.211361 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_order" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date) AS OrderDate,
        Order_Priority,
        Ord_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:54:43.214361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.217352 [debug] [Thread-1 (]: On model.first.stg_order: COMMIT
[0m16:54:43.221354 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:54:43.221354 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:54:43.222743 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.223764 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:54:43.224763 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:54:43.226204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.228217 [debug] [Thread-1 (]: Timing info for model.first.stg_order (execute): 16:54:43.153055 => 16:54:43.227206
[0m16:54:43.228217 [debug] [Thread-1 (]: On model.first.stg_order: ROLLBACK
[0m16:54:43.229205 [debug] [Thread-1 (]: On model.first.stg_order: Close
[0m16:54:43.230203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b202cb5e-a1cc-455c-9cac-3107c3b09604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413D4236A0>]}
[0m16:54:43.230203 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dbt.stg_order ................................. [[32mOK[0m in 0.09s]
[0m16:54:43.232203 [debug] [Thread-1 (]: Finished running node model.first.stg_order
[0m16:54:43.232203 [debug] [Thread-1 (]: Began running node model.first.stg_product
[0m16:54:43.233203 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt.stg_product .................................... [RUN]
[0m16:54:43.234201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_order, now model.first.stg_product)
[0m16:54:43.234201 [debug] [Thread-1 (]: Began compiling node model.first.stg_product
[0m16:54:43.239199 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_product"
[0m16:54:43.241197 [debug] [Thread-1 (]: Timing info for model.first.stg_product (compile): 16:54:43.235201 => 16:54:43.240198
[0m16:54:43.241197 [debug] [Thread-1 (]: Began executing node model.first.stg_product
[0m16:54:43.250193 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:54:43.251191 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:54:43.252191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:43.252191 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:54:43.253190 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:54:43.267197 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.268196 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:54:43.269195 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:54:43.270037 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.271039 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:54:43.272038 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_product'
  
[0m16:54:43.280035 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.286044 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:54:43.287044 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
      EXEC sp_rename 'dbt.stg_product', 'stg_product__dbt_backup'
[0m16:54:43.289046 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.291049 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_product"
[0m16:54:43.293048 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:54:43.293048 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_product" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



[0m16:54:43.295047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.299048 [debug] [Thread-1 (]: On model.first.stg_product: COMMIT
[0m16:54:43.303041 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:54:43.303041 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:54:43.304040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.306040 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:54:43.306040 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:54:43.307984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.309986 [debug] [Thread-1 (]: Timing info for model.first.stg_product (execute): 16:54:43.242197 => 16:54:43.308987
[0m16:54:43.309986 [debug] [Thread-1 (]: On model.first.stg_product: ROLLBACK
[0m16:54:43.310986 [debug] [Thread-1 (]: On model.first.stg_product: Close
[0m16:54:43.311985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b202cb5e-a1cc-455c-9cac-3107c3b09604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413D3AF730>]}
[0m16:54:43.312994 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dbt.stg_product ............................... [[32mOK[0m in 0.08s]
[0m16:54:43.315002 [debug] [Thread-1 (]: Finished running node model.first.stg_product
[0m16:54:43.315002 [debug] [Thread-1 (]: Began running node model.first.stg_shipping
[0m16:54:43.315996 [info ] [Thread-1 (]: 5 of 6 START sql view model dbt.stg_shipping ................................... [RUN]
[0m16:54:43.317093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_product, now model.first.stg_shipping)
[0m16:54:43.318109 [debug] [Thread-1 (]: Began compiling node model.first.stg_shipping
[0m16:54:43.323105 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_shipping"
[0m16:54:43.325091 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (compile): 16:54:43.318109 => 16:54:43.324105
[0m16:54:43.325091 [debug] [Thread-1 (]: Began executing node model.first.stg_shipping
[0m16:54:43.332105 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:54:43.333086 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:54:43.334086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:43.334086 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:54:43.335098 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:54:43.348077 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.350077 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:54:43.350077 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:54:43.352077 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.354076 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:54:43.354076 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_shipping'
  
[0m16:54:43.363083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.368068 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:54:43.369067 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
      EXEC sp_rename 'dbt.stg_shipping', 'stg_shipping__dbt_backup'
[0m16:54:43.371108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.373108 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_shipping"
[0m16:54:43.375107 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:54:43.375107 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_shipping" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date) AS ShipDate,
        Ship_mode,
        ship_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:54:43.377120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.380105 [debug] [Thread-1 (]: On model.first.stg_shipping: COMMIT
[0m16:54:43.384102 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:54:43.385101 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:54:43.386101 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.387100 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:54:43.387100 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:54:43.389113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.391098 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (execute): 16:54:43.325091 => 16:54:43.391098
[0m16:54:43.391098 [debug] [Thread-1 (]: On model.first.stg_shipping: ROLLBACK
[0m16:54:43.392097 [debug] [Thread-1 (]: On model.first.stg_shipping: Close
[0m16:54:43.393097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b202cb5e-a1cc-455c-9cac-3107c3b09604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413D433580>]}
[0m16:54:43.393097 [info ] [Thread-1 (]: 5 of 6 OK created sql view model dbt.stg_shipping .............................. [[32mOK[0m in 0.08s]
[0m16:54:43.394182 [debug] [Thread-1 (]: Finished running node model.first.stg_shipping
[0m16:54:43.395198 [debug] [Thread-1 (]: Began running node model.first.customer
[0m16:54:43.396194 [info ] [Thread-1 (]: 6 of 6 START sql view model dbt.customer ....................................... [RUN]
[0m16:54:43.397196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_shipping, now model.first.customer)
[0m16:54:43.397196 [debug] [Thread-1 (]: Began compiling node model.first.customer
[0m16:54:43.401194 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.customer"
[0m16:54:43.403181 [debug] [Thread-1 (]: Timing info for model.first.customer (compile): 16:54:43.398196 => 16:54:43.402193
[0m16:54:43.403181 [debug] [Thread-1 (]: Began executing node model.first.customer
[0m16:54:43.414176 [debug] [Thread-1 (]: Using sqlserver connection "model.first.customer"
[0m16:54:43.415174 [debug] [Thread-1 (]: On model.first.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:54:43.416177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:43.416177 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:54:43.417173 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:54:43.430173 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.431165 [debug] [Thread-1 (]: Using sqlserver connection "model.first.customer"
[0m16:54:43.432164 [debug] [Thread-1 (]: On model.first.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."customer__dbt_backup";');

[0m16:54:43.433181 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.435163 [debug] [Thread-1 (]: Using sqlserver connection "model.first.customer"
[0m16:54:43.435163 [debug] [Thread-1 (]: On model.first.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'customer'
  
[0m16:54:43.444169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.447155 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.customer"
[0m16:54:43.449156 [debug] [Thread-1 (]: Using sqlserver connection "model.first.customer"
[0m16:54:43.450156 [debug] [Thread-1 (]: On model.first.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.customer"} */
USE [master];
    
    

    EXEC('create view "dbt"."customer" as /*

WITH

stg_customer AS (

    SELECT

        *

    FROM "master"."dbt"."stg_customer" where region != "NUNAVUT"

),

order_info AS (

    SELECT

        cust_id
        , COUNT(*)  AS total_orders

    FROM stg_order

    GROUP BY 
        cust_id

)

-- final AS (

--     SELECT 

--         sc.*
--         , oi.total_orders

--     FROM stg_customer sc

--     LEFT JOIN order_info oi
--         ON sc.customer_id = oi.customer_id
-- )

-- SELECT * FROM final;');



[0m16:54:43.451153 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:54:43.453152 [debug] [Thread-1 (]: Timing info for model.first.customer (execute): 16:54:43.403181 => 16:54:43.452153
[0m16:54:43.453152 [debug] [Thread-1 (]: On model.first.customer: ROLLBACK
[0m16:54:43.453152 [debug] [Thread-1 (]: On model.first.customer: Close
[0m16:54:43.454151 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\mart\customer.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Missing end comment mark '*/'. (113) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'as'. (102)")
[0m16:54:43.458515 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Missing end comment mark '*/'. (113) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'as'. (102)")

[0m16:54:43.459515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b202cb5e-a1cc-455c-9cac-3107c3b09604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413D747460>]}
[0m16:54:43.459515 [error] [Thread-1 (]: 6 of 6 ERROR creating sql view model dbt.customer .............................. [[31mERROR[0m in 0.06s]
[0m16:54:43.461515 [debug] [Thread-1 (]: Finished running node model.first.customer
[0m16:54:43.463509 [debug] [MainThread]: On master: COMMIT
[0m16:54:43.464504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:43.464504 [debug] [MainThread]: Connection 'list_master' was properly closed.
[0m16:54:43.465504 [debug] [MainThread]: Connection 'list_master_dbt' was properly closed.
[0m16:54:43.465504 [debug] [MainThread]: Connection 'model.first.customer' was properly closed.
[0m16:54:43.466503 [info ] [MainThread]: 
[0m16:54:43.467504 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m16:54:43.469515 [debug] [MainThread]: Command end result
[0m16:54:43.482493 [info ] [MainThread]: 
[0m16:54:43.483492 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:54:43.484506 [info ] [MainThread]: 
[0m16:54:43.485505 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Missing end comment mark '*/'. (113) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'as'. (102)")
[0m16:54:43.486725 [info ] [MainThread]: 
[0m16:54:43.487726 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m16:54:43.489739 [debug] [MainThread]: Command `dbt run` failed at 16:54:43.489739 after 1.84 seconds
[0m16:54:43.489739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024139F6ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413D747D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413D747CA0>]}
[0m16:54:43.490738 [debug] [MainThread]: Flushing usage events
[0m16:55:14.050423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B11D96CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B12024A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B12024A140>]}


============================== 16:55:14.057420 | 698e1729-6bf1-4a7d-b0a6-6fd6f6dad671 ==============================
[0m16:55:14.057420 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:55:14.058419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:55:14.462093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '698e1729-6bf1-4a7d-b0a6-6fd6f6dad671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B12024A3E0>]}
[0m16:55:14.563030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '698e1729-6bf1-4a7d-b0a6-6fd6f6dad671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1208387C0>]}
[0m16:55:14.564029 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m16:55:14.577019 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:55:14.700950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:55:14.700950 [debug] [MainThread]: Partial parsing: updated file: first://models\mart\customer.sql
[0m16:55:14.848853 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.online_shopping.staging
- models.online_shopping
- models.online_shopping.mart
[0m16:55:14.916827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '698e1729-6bf1-4a7d-b0a6-6fd6f6dad671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B120C082B0>]}
[0m16:55:14.931804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '698e1729-6bf1-4a7d-b0a6-6fd6f6dad671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B120BBBF70>]}
[0m16:55:14.932825 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:55:14.934823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '698e1729-6bf1-4a7d-b0a6-6fd6f6dad671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B120BBBE80>]}
[0m16:55:14.937802 [info ] [MainThread]: 
[0m16:55:14.939816 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m16:55:14.943800 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master'
[0m16:55:14.962805 [debug] [ThreadPool]: Using sqlserver connection "list_master"
[0m16:55:14.963805 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master"} */
select  name as [schema]
    from sys.schemas 
  
[0m16:55:14.963805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:14.964804 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:55:15.011248 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:55:15.012247 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:15.013246 [debug] [ThreadPool]: On list_master: Close
[0m16:55:15.015897 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master_dbt'
[0m16:55:15.022896 [debug] [ThreadPool]: Using sqlserver connection "list_master_dbt"
[0m16:55:15.022896 [debug] [ThreadPool]: On list_master_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master_dbt"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
  
[0m16:55:15.023895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:15.023895 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:55:15.024894 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:55:15.028077 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:15.029078 [debug] [ThreadPool]: On list_master_dbt: ROLLBACK
[0m16:55:15.030077 [debug] [ThreadPool]: On list_master_dbt: Close
[0m16:55:15.032093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '698e1729-6bf1-4a7d-b0a6-6fd6f6dad671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B120999BD0>]}
[0m16:55:15.033090 [debug] [MainThread]: On master: COMMIT
[0m16:55:15.033090 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:15.034390 [info ] [MainThread]: 
[0m16:55:15.037701 [debug] [Thread-1 (]: Began running node model.first.stg_customer
[0m16:55:15.038713 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt.stg_customer ................................... [RUN]
[0m16:55:15.039708 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.first.stg_customer'
[0m16:55:15.040702 [debug] [Thread-1 (]: Began compiling node model.first.stg_customer
[0m16:55:15.050709 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_customer"
[0m16:55:15.052694 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (compile): 16:55:15.041701 => 16:55:15.051709
[0m16:55:15.052694 [debug] [Thread-1 (]: Began executing node model.first.stg_customer
[0m16:55:15.089673 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:55:15.090672 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:55:15.090672 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:55:15.091676 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:55:15.092671 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:55:15.093678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.095684 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:55:15.096683 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m16:55:15.097687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.100685 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:55:15.101685 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_customer'
  
[0m16:55:15.102531 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.110529 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:55:15.110529 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
USE [master];
      EXEC sp_rename 'dbt.stg_customer', 'stg_customer__dbt_backup'
[0m16:55:15.113337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.122347 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_customer"
[0m16:55:15.123333 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:55:15.124332 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_customer" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        CAST(Cust_id AS INT) as CustomerID,
        province,
        region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



[0m16:55:15.126345 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.145339 [debug] [Thread-1 (]: On model.first.stg_customer: COMMIT
[0m16:55:15.149334 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:55:15.150332 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:55:15.150332 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.152333 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:55:15.152333 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m16:55:15.154704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.156719 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (execute): 16:55:15.052694 => 16:55:15.155720
[0m16:55:15.156719 [debug] [Thread-1 (]: On model.first.stg_customer: ROLLBACK
[0m16:55:15.157718 [debug] [Thread-1 (]: On model.first.stg_customer: Close
[0m16:55:15.158717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698e1729-6bf1-4a7d-b0a6-6fd6f6dad671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B120BFD510>]}
[0m16:55:15.158717 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt.stg_customer .............................. [[32mOK[0m in 0.12s]
[0m16:55:15.159704 [debug] [Thread-1 (]: Finished running node model.first.stg_customer
[0m16:55:15.160721 [debug] [Thread-1 (]: Began running node model.first.stg_market
[0m16:55:15.161716 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt.stg_market ..................................... [RUN]
[0m16:55:15.162715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_customer, now model.first.stg_market)
[0m16:55:15.162715 [debug] [Thread-1 (]: Began compiling node model.first.stg_market
[0m16:55:15.167717 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_market"
[0m16:55:15.169697 [debug] [Thread-1 (]: Timing info for model.first.stg_market (compile): 16:55:15.162715 => 16:55:15.169697
[0m16:55:15.170716 [debug] [Thread-1 (]: Began executing node model.first.stg_market
[0m16:55:15.180691 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:55:15.180691 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_market__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:55:15.181692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:15.182690 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:55:15.182690 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:55:15.184689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.186689 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:55:15.186689 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_market__dbt_backup";');

[0m16:55:15.187702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.190709 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:55:15.191685 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_market'
  
[0m16:55:15.192685 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.198695 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:55:15.199694 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
USE [master];
      EXEC sp_rename 'dbt.stg_market', 'stg_market__dbt_backup'
[0m16:55:15.201687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.204680 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_market"
[0m16:55:15.205678 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:55:15.206677 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_market" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id,
        CAST(sales AS Float) AS Sales,
        CAST(discount as Float) as Discount,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Float) as Profit,
        cast(shipping_cost as Float) as ShippingCost,
        cast(product_base_margin as Float) as ProductBaseMargin

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:55:15.209675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.214673 [debug] [Thread-1 (]: On model.first.stg_market: COMMIT
[0m16:55:15.218670 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:55:15.219669 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_market__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:55:15.220688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.222686 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:55:15.223666 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_market__dbt_backup";');

[0m16:55:15.225666 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.228678 [debug] [Thread-1 (]: Timing info for model.first.stg_market (execute): 16:55:15.170716 => 16:55:15.228678
[0m16:55:15.228678 [debug] [Thread-1 (]: On model.first.stg_market: ROLLBACK
[0m16:55:15.229677 [debug] [Thread-1 (]: On model.first.stg_market: Close
[0m16:55:15.230677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698e1729-6bf1-4a7d-b0a6-6fd6f6dad671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B120BC9750>]}
[0m16:55:15.230677 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dbt.stg_market ................................ [[32mOK[0m in 0.07s]
[0m16:55:15.231676 [debug] [Thread-1 (]: Finished running node model.first.stg_market
[0m16:55:15.232662 [debug] [Thread-1 (]: Began running node model.first.stg_order
[0m16:55:15.233681 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt.stg_order ...................................... [RUN]
[0m16:55:15.234674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_market, now model.first.stg_order)
[0m16:55:15.235661 [debug] [Thread-1 (]: Began compiling node model.first.stg_order
[0m16:55:15.239679 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_order"
[0m16:55:15.242657 [debug] [Thread-1 (]: Timing info for model.first.stg_order (compile): 16:55:15.235661 => 16:55:15.241657
[0m16:55:15.242657 [debug] [Thread-1 (]: Began executing node model.first.stg_order
[0m16:55:15.251664 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:55:15.252664 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:55:15.252664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:15.253663 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:55:15.253663 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:55:15.255649 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.257667 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:55:15.257667 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:55:15.258654 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.260646 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:55:15.260646 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_order'
  
[0m16:55:15.261665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.266661 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:55:15.266661 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
      EXEC sp_rename 'dbt.stg_order', 'stg_order__dbt_backup'
[0m16:55:15.268659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.271658 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_order"
[0m16:55:15.272640 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:55:15.273638 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_order" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date) AS OrderDate,
        Order_Priority,
        Ord_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:55:15.275644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.278635 [debug] [Thread-1 (]: On model.first.stg_order: COMMIT
[0m16:55:15.282663 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:55:15.283652 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:55:15.284651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.285647 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:55:15.285647 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:55:15.287882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.288898 [debug] [Thread-1 (]: Timing info for model.first.stg_order (execute): 16:55:15.243670 => 16:55:15.288898
[0m16:55:15.289883 [debug] [Thread-1 (]: On model.first.stg_order: ROLLBACK
[0m16:55:15.290884 [debug] [Thread-1 (]: On model.first.stg_order: Close
[0m16:55:15.290884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698e1729-6bf1-4a7d-b0a6-6fd6f6dad671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B120E28AF0>]}
[0m16:55:15.291902 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dbt.stg_order ................................. [[32mOK[0m in 0.06s]
[0m16:55:15.293882 [debug] [Thread-1 (]: Finished running node model.first.stg_order
[0m16:55:15.293882 [debug] [Thread-1 (]: Began running node model.first.stg_product
[0m16:55:15.294890 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt.stg_product .................................... [RUN]
[0m16:55:15.295880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_order, now model.first.stg_product)
[0m16:55:15.296880 [debug] [Thread-1 (]: Began compiling node model.first.stg_product
[0m16:55:15.300877 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_product"
[0m16:55:15.301876 [debug] [Thread-1 (]: Timing info for model.first.stg_product (compile): 16:55:15.296880 => 16:55:15.301876
[0m16:55:15.302895 [debug] [Thread-1 (]: Began executing node model.first.stg_product
[0m16:55:15.310890 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:55:15.311873 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:55:15.312872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:15.312872 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:55:15.313888 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:55:15.314894 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.316882 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:55:15.316882 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:55:15.317886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.319884 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:55:15.319884 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_product'
  
[0m16:55:15.320879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.324863 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:55:15.324863 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
      EXEC sp_rename 'dbt.stg_product', 'stg_product__dbt_backup'
[0m16:55:15.327862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.331862 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_product"
[0m16:55:15.334859 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:55:15.335858 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_product" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



[0m16:55:15.364841 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.369837 [debug] [Thread-1 (]: On model.first.stg_product: COMMIT
[0m16:55:15.377834 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:55:15.379833 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:55:15.381832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.384831 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:55:15.385832 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:55:15.388828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.390827 [debug] [Thread-1 (]: Timing info for model.first.stg_product (execute): 16:55:15.302895 => 16:55:15.390827
[0m16:55:15.391825 [debug] [Thread-1 (]: On model.first.stg_product: ROLLBACK
[0m16:55:15.392824 [debug] [Thread-1 (]: On model.first.stg_product: Close
[0m16:55:15.393824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698e1729-6bf1-4a7d-b0a6-6fd6f6dad671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1210BD000>]}
[0m16:55:15.393824 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dbt.stg_product ............................... [[32mOK[0m in 0.10s]
[0m16:55:15.394823 [debug] [Thread-1 (]: Finished running node model.first.stg_product
[0m16:55:15.395823 [debug] [Thread-1 (]: Began running node model.first.stg_shipping
[0m16:55:15.395823 [info ] [Thread-1 (]: 5 of 6 START sql view model dbt.stg_shipping ................................... [RUN]
[0m16:55:15.396822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_product, now model.first.stg_shipping)
[0m16:55:15.397822 [debug] [Thread-1 (]: Began compiling node model.first.stg_shipping
[0m16:55:15.401819 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_shipping"
[0m16:55:15.402818 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (compile): 16:55:15.397822 => 16:55:15.402818
[0m16:55:15.403818 [debug] [Thread-1 (]: Began executing node model.first.stg_shipping
[0m16:55:15.412813 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:55:15.412813 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:55:15.413813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:15.414812 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:55:15.414812 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:55:15.416811 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.417810 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:55:15.418809 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:55:15.419809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.420808 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:55:15.421808 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_shipping'
  
[0m16:55:15.422807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.427805 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:55:15.428804 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
      EXEC sp_rename 'dbt.stg_shipping', 'stg_shipping__dbt_backup'
[0m16:55:15.430623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.432625 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_shipping"
[0m16:55:15.434624 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:55:15.434624 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_shipping" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date) AS ShipDate,
        Ship_mode,
        ship_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:55:15.436519 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.439520 [debug] [Thread-1 (]: On model.first.stg_shipping: COMMIT
[0m16:55:15.444518 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:55:15.444518 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:55:15.445518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.447516 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:55:15.447516 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:55:15.449514 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.450514 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (execute): 16:55:15.404818 => 16:55:15.450514
[0m16:55:15.451513 [debug] [Thread-1 (]: On model.first.stg_shipping: ROLLBACK
[0m16:55:15.451513 [debug] [Thread-1 (]: On model.first.stg_shipping: Close
[0m16:55:15.452513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698e1729-6bf1-4a7d-b0a6-6fd6f6dad671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1210D3EB0>]}
[0m16:55:15.453512 [info ] [Thread-1 (]: 5 of 6 OK created sql view model dbt.stg_shipping .............................. [[32mOK[0m in 0.06s]
[0m16:55:15.454444 [debug] [Thread-1 (]: Finished running node model.first.stg_shipping
[0m16:55:15.455464 [debug] [Thread-1 (]: Began running node model.first.customer
[0m16:55:15.455464 [info ] [Thread-1 (]: 6 of 6 START sql view model dbt.customer ....................................... [RUN]
[0m16:55:15.456637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_shipping, now model.first.customer)
[0m16:55:15.457639 [debug] [Thread-1 (]: Began compiling node model.first.customer
[0m16:55:15.462649 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.customer"
[0m16:55:15.463637 [debug] [Thread-1 (]: Timing info for model.first.customer (compile): 16:55:15.457639 => 16:55:15.463637
[0m16:55:15.464652 [debug] [Thread-1 (]: Began executing node model.first.customer
[0m16:55:15.472648 [debug] [Thread-1 (]: Using sqlserver connection "model.first.customer"
[0m16:55:15.473643 [debug] [Thread-1 (]: On model.first.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:55:15.474640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:15.475630 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:55:15.475630 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:55:15.477629 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.479645 [debug] [Thread-1 (]: Using sqlserver connection "model.first.customer"
[0m16:55:15.480639 [debug] [Thread-1 (]: On model.first.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."customer__dbt_backup";');

[0m16:55:15.480639 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.482626 [debug] [Thread-1 (]: Using sqlserver connection "model.first.customer"
[0m16:55:15.483625 [debug] [Thread-1 (]: On model.first.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'customer'
  
[0m16:55:15.483625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.486623 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.customer"
[0m16:55:15.487622 [debug] [Thread-1 (]: Using sqlserver connection "model.first.customer"
[0m16:55:15.488640 [debug] [Thread-1 (]: On model.first.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.customer"} */
USE [master];
    
    

    EXEC('create view "dbt"."customer" as /*

WITH

stg_customer AS (

    SELECT

        *

    FROM "master"."dbt"."stg_customer" where region != "NUNAVUT"

),

order_info AS (

    SELECT

        cust_id
        , COUNT(*)  AS total_orders

    FROM stg_order

    GROUP BY 
        cust_id

)

-- final AS (

--     SELECT 

--         sc.*
--         , oi.total_orders

--     FROM stg_customer sc

--     LEFT JOIN order_info oi
--         ON sc.customer_id = oi.customer_id
-- )

-- SELECT * FROM final

*/;');



[0m16:55:15.489638 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:15.491621 [debug] [Thread-1 (]: Timing info for model.first.customer (execute): 16:55:15.464652 => 16:55:15.490622
[0m16:55:15.491621 [debug] [Thread-1 (]: On model.first.customer: ROLLBACK
[0m16:55:15.492621 [debug] [Thread-1 (]: On model.first.customer: Close
[0m16:55:15.493633 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\first\models\mart\customer.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ';'. (102) (SQLMoreResults)")
[0m16:55:15.497617 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 86, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ';'. (102) (SQLMoreResults)")

[0m16:55:15.498617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698e1729-6bf1-4a7d-b0a6-6fd6f6dad671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B120D591B0>]}
[0m16:55:15.499616 [error] [Thread-1 (]: 6 of 6 ERROR creating sql view model dbt.customer .............................. [[31mERROR[0m in 0.04s]
[0m16:55:15.500614 [debug] [Thread-1 (]: Finished running node model.first.customer
[0m16:55:15.502613 [debug] [MainThread]: On master: COMMIT
[0m16:55:15.502613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:15.503612 [debug] [MainThread]: Connection 'list_master' was properly closed.
[0m16:55:15.503612 [debug] [MainThread]: Connection 'list_master_dbt' was properly closed.
[0m16:55:15.503612 [debug] [MainThread]: Connection 'model.first.customer' was properly closed.
[0m16:55:15.504611 [info ] [MainThread]: 
[0m16:55:15.505309 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m16:55:15.507310 [debug] [MainThread]: Command end result
[0m16:55:15.522301 [info ] [MainThread]: 
[0m16:55:15.523302 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:55:15.524300 [info ] [MainThread]: 
[0m16:55:15.525300 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ';'. (102) (SQLMoreResults)")
[0m16:55:15.526300 [info ] [MainThread]: 
[0m16:55:15.527301 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m16:55:15.529300 [debug] [MainThread]: Command `dbt run` failed at 16:55:15.529300 after 1.56 seconds
[0m16:55:15.530300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B11D96CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B120964760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B120D58460>]}
[0m16:55:15.530300 [debug] [MainThread]: Flushing usage events
[0m16:56:20.189819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388D9AECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002389028A2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002389028A0E0>]}


============================== 16:56:20.195816 | 9948de47-c4c5-4afc-b139-b11fa84f7e23 ==============================
[0m16:56:20.195816 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:56:20.196815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:56:20.593694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9948de47-c4c5-4afc-b139-b11fa84f7e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002389028A380>]}
[0m16:56:20.702633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9948de47-c4c5-4afc-b139-b11fa84f7e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238908787C0>]}
[0m16:56:20.703642 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m16:56:20.718610 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:56:20.900523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:56:20.900523 [debug] [MainThread]: Partial parsing: updated file: first://models\mart\customer.sql
[0m16:56:21.058414 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.online_shopping
- models.online_shopping.staging
- models.online_shopping.mart
[0m16:56:21.128374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9948de47-c4c5-4afc-b139-b11fa84f7e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023890C48220>]}
[0m16:56:21.144365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9948de47-c4c5-4afc-b139-b11fa84f7e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023890BFBD00>]}
[0m16:56:21.144365 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m16:56:21.145364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9948de47-c4c5-4afc-b139-b11fa84f7e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023890BFBE20>]}
[0m16:56:21.147363 [info ] [MainThread]: 
[0m16:56:21.149364 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m16:56:21.152361 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master'
[0m16:56:21.166371 [debug] [ThreadPool]: Using sqlserver connection "list_master"
[0m16:56:21.167370 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master"} */
select  name as [schema]
    from sys.schemas 
  
[0m16:56:21.167370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:21.168369 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:56:21.229464 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:56:21.231462 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:56:21.233478 [debug] [ThreadPool]: On list_master: Close
[0m16:56:21.235472 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master_dbt'
[0m16:56:21.242473 [debug] [ThreadPool]: Using sqlserver connection "list_master_dbt"
[0m16:56:21.242473 [debug] [ThreadPool]: On list_master_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master_dbt"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
  
[0m16:56:21.243472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:21.243472 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:56:21.244472 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m16:56:21.257464 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:56:21.259459 [debug] [ThreadPool]: On list_master_dbt: ROLLBACK
[0m16:56:21.260458 [debug] [ThreadPool]: On list_master_dbt: Close
[0m16:56:21.262461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9948de47-c4c5-4afc-b139-b11fa84f7e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238908E87F0>]}
[0m16:56:21.263461 [debug] [MainThread]: On master: COMMIT
[0m16:56:21.263461 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:56:21.264460 [info ] [MainThread]: 
[0m16:56:21.268968 [debug] [Thread-1 (]: Began running node model.first.stg_customer
[0m16:56:21.268968 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt.stg_customer ................................... [RUN]
[0m16:56:21.270953 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.first.stg_customer'
[0m16:56:21.271952 [debug] [Thread-1 (]: Began compiling node model.first.stg_customer
[0m16:56:21.282946 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_customer"
[0m16:56:21.284945 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (compile): 16:56:21.271952 => 16:56:21.283945
[0m16:56:21.284945 [debug] [Thread-1 (]: Began executing node model.first.stg_customer
[0m16:56:21.322921 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:56:21.323922 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:56:21.323922 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:56:21.324920 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:56:21.324920 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:56:21.341199 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.343203 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:56:21.343203 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m16:56:21.344198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.348195 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:56:21.349195 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_customer'
  
[0m16:56:21.357191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.364188 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:56:21.365186 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
USE [master];
      EXEC sp_rename 'dbt.stg_customer', 'stg_customer__dbt_backup'
[0m16:56:21.539612 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.549608 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_customer"
[0m16:56:21.550608 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:56:21.551607 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_customer" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        CAST(Cust_id AS INT) as CustomerID,
        province,
        region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



[0m16:56:21.554116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.573119 [debug] [Thread-1 (]: On model.first.stg_customer: COMMIT
[0m16:56:21.576117 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:56:21.577117 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:56:21.578157 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.579159 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m16:56:21.580159 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m16:56:21.582322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.584323 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (execute): 16:56:21.285944 => 16:56:21.583323
[0m16:56:21.584323 [debug] [Thread-1 (]: On model.first.stg_customer: ROLLBACK
[0m16:56:21.584323 [debug] [Thread-1 (]: On model.first.stg_customer: Close
[0m16:56:21.585322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9948de47-c4c5-4afc-b139-b11fa84f7e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023890C3FDC0>]}
[0m16:56:21.586321 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt.stg_customer .............................. [[32mOK[0m in 0.32s]
[0m16:56:21.587322 [debug] [Thread-1 (]: Finished running node model.first.stg_customer
[0m16:56:21.588343 [debug] [Thread-1 (]: Began running node model.first.stg_market
[0m16:56:21.588343 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt.stg_market ..................................... [RUN]
[0m16:56:21.590333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_customer, now model.first.stg_market)
[0m16:56:21.590333 [debug] [Thread-1 (]: Began compiling node model.first.stg_market
[0m16:56:21.595329 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_market"
[0m16:56:21.597315 [debug] [Thread-1 (]: Timing info for model.first.stg_market (compile): 16:56:21.590333 => 16:56:21.596329
[0m16:56:21.597315 [debug] [Thread-1 (]: Began executing node model.first.stg_market
[0m16:56:21.605311 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:56:21.605311 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_market__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:56:21.606324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:21.606324 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:56:21.607323 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:56:21.618317 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.620302 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:56:21.621301 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_market__dbt_backup";');

[0m16:56:21.622303 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.624300 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:56:21.624300 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_market'
  
[0m16:56:21.665277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.670273 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:56:21.671273 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
USE [master];
      EXEC sp_rename 'dbt.stg_market', 'stg_market__dbt_backup'
[0m16:56:21.675271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.682266 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_market"
[0m16:56:21.684267 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:56:21.685266 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_market" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id,
        CAST(sales AS Float) AS Sales,
        CAST(discount as Float) as Discount,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Float) as Profit,
        cast(shipping_cost as Float) as ShippingCost,
        cast(product_base_margin as Float) as ProductBaseMargin

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:56:21.688263 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.691261 [debug] [Thread-1 (]: On model.first.stg_market: COMMIT
[0m16:56:21.695259 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:56:21.695259 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_market__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:56:21.696258 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.698257 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m16:56:21.698257 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_market__dbt_backup";');

[0m16:56:21.700256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.702255 [debug] [Thread-1 (]: Timing info for model.first.stg_market (execute): 16:56:21.598328 => 16:56:21.701255
[0m16:56:21.702255 [debug] [Thread-1 (]: On model.first.stg_market: ROLLBACK
[0m16:56:21.703254 [debug] [Thread-1 (]: On model.first.stg_market: Close
[0m16:56:21.703254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9948de47-c4c5-4afc-b139-b11fa84f7e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023890C097E0>]}
[0m16:56:21.704254 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt.stg_market ................................ [[32mOK[0m in 0.11s]
[0m16:56:21.705253 [debug] [Thread-1 (]: Finished running node model.first.stg_market
[0m16:56:21.706252 [debug] [Thread-1 (]: Began running node model.first.stg_order
[0m16:56:21.706252 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt.stg_order ...................................... [RUN]
[0m16:56:21.707252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_market, now model.first.stg_order)
[0m16:56:21.708252 [debug] [Thread-1 (]: Began compiling node model.first.stg_order
[0m16:56:21.712249 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_order"
[0m16:56:21.713248 [debug] [Thread-1 (]: Timing info for model.first.stg_order (compile): 16:56:21.708252 => 16:56:21.713248
[0m16:56:21.714248 [debug] [Thread-1 (]: Began executing node model.first.stg_order
[0m16:56:21.722243 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:56:21.722243 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:56:21.723243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:21.723243 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:56:21.724242 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:56:21.737235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.739234 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:56:21.739234 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:56:21.740233 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.742232 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:56:21.743248 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_order'
  
[0m16:56:21.751347 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.756363 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:56:21.757344 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
      EXEC sp_rename 'dbt.stg_order', 'stg_order__dbt_backup'
[0m16:56:21.759941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.761960 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_order"
[0m16:56:21.763941 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:56:21.763941 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_order" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date) AS OrderDate,
        Order_Priority,
        Ord_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:56:21.766116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.768122 [debug] [Thread-1 (]: On model.first.stg_order: COMMIT
[0m16:56:21.772105 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:56:21.773124 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:56:21.774106 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.776119 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m16:56:21.776119 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m16:56:21.779036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.781051 [debug] [Thread-1 (]: Timing info for model.first.stg_order (execute): 16:56:21.714248 => 16:56:21.780052
[0m16:56:21.781051 [debug] [Thread-1 (]: On model.first.stg_order: ROLLBACK
[0m16:56:21.781051 [debug] [Thread-1 (]: On model.first.stg_order: Close
[0m16:56:21.782050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9948de47-c4c5-4afc-b139-b11fa84f7e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023890E53EE0>]}
[0m16:56:21.783049 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt.stg_order ................................. [[32mOK[0m in 0.07s]
[0m16:56:21.784036 [debug] [Thread-1 (]: Finished running node model.first.stg_order
[0m16:56:21.785049 [debug] [Thread-1 (]: Began running node model.first.stg_product
[0m16:56:21.785049 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt.stg_product .................................... [RUN]
[0m16:56:21.786135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_order, now model.first.stg_product)
[0m16:56:21.787152 [debug] [Thread-1 (]: Began compiling node model.first.stg_product
[0m16:56:21.791150 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_product"
[0m16:56:21.792149 [debug] [Thread-1 (]: Timing info for model.first.stg_product (compile): 16:56:21.787152 => 16:56:21.792149
[0m16:56:21.793133 [debug] [Thread-1 (]: Began executing node model.first.stg_product
[0m16:56:21.800144 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:56:21.800144 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:56:21.801142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:21.801142 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:56:21.802142 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:56:21.816248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.817246 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:56:21.818245 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:56:21.818245 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.820244 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:56:21.820244 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_product'
  
[0m16:56:21.830226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.834237 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:56:21.835237 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
      EXEC sp_rename 'dbt.stg_product', 'stg_product__dbt_backup'
[0m16:56:21.837185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.839185 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_product"
[0m16:56:21.841186 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:56:21.842186 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_product" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



[0m16:56:21.844201 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.847194 [debug] [Thread-1 (]: On model.first.stg_product: COMMIT
[0m16:56:21.851191 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:56:21.852200 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:56:21.853177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.854191 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m16:56:21.855176 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m16:56:21.857175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.859195 [debug] [Thread-1 (]: Timing info for model.first.stg_product (execute): 16:56:21.793133 => 16:56:21.859195
[0m16:56:21.860188 [debug] [Thread-1 (]: On model.first.stg_product: ROLLBACK
[0m16:56:21.860188 [debug] [Thread-1 (]: On model.first.stg_product: Close
[0m16:56:21.861192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9948de47-c4c5-4afc-b139-b11fa84f7e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238910FCE50>]}
[0m16:56:21.862191 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt.stg_product ............................... [[32mOK[0m in 0.08s]
[0m16:56:21.863172 [debug] [Thread-1 (]: Finished running node model.first.stg_product
[0m16:56:21.864185 [debug] [Thread-1 (]: Began running node model.first.stg_shipping
[0m16:56:21.864185 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt.stg_shipping ................................... [RUN]
[0m16:56:21.865186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_product, now model.first.stg_shipping)
[0m16:56:21.866172 [debug] [Thread-1 (]: Began compiling node model.first.stg_shipping
[0m16:56:21.871168 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_shipping"
[0m16:56:21.873166 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (compile): 16:56:21.866172 => 16:56:21.873166
[0m16:56:21.874167 [debug] [Thread-1 (]: Began executing node model.first.stg_shipping
[0m16:56:21.884162 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:56:21.885161 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:56:21.886177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:21.886177 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m16:56:21.887177 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m16:56:21.901150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.903168 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:56:21.903168 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:56:21.904148 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.906149 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:56:21.907148 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_shipping'
  
[0m16:56:21.917155 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.923137 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:56:21.924137 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
      EXEC sp_rename 'dbt.stg_shipping', 'stg_shipping__dbt_backup'
[0m16:56:21.927076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.929091 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_shipping"
[0m16:56:21.930090 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:56:21.931077 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_shipping" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date) AS ShipDate,
        Ship_mode,
        ship_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m16:56:21.933241 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.935255 [debug] [Thread-1 (]: On model.first.stg_shipping: COMMIT
[0m16:56:21.939240 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:56:21.940241 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:56:21.941253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.942248 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m16:56:21.943251 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m16:56:21.944933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:56:21.945949 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (execute): 16:56:21.874167 => 16:56:21.945949
[0m16:56:21.946949 [debug] [Thread-1 (]: On model.first.stg_shipping: ROLLBACK
[0m16:56:21.946949 [debug] [Thread-1 (]: On model.first.stg_shipping: Close
[0m16:56:21.947948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9948de47-c4c5-4afc-b139-b11fa84f7e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023890C094B0>]}
[0m16:56:21.948947 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt.stg_shipping .............................. [[32mOK[0m in 0.08s]
[0m16:56:21.949932 [debug] [Thread-1 (]: Finished running node model.first.stg_shipping
[0m16:56:21.951092 [debug] [MainThread]: On master: COMMIT
[0m16:56:21.952107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:21.952107 [debug] [MainThread]: Connection 'list_master' was properly closed.
[0m16:56:21.953111 [debug] [MainThread]: Connection 'list_master_dbt' was properly closed.
[0m16:56:21.953111 [debug] [MainThread]: Connection 'model.first.stg_shipping' was properly closed.
[0m16:56:21.954110 [info ] [MainThread]: 
[0m16:56:21.954110 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m16:56:21.957092 [debug] [MainThread]: Command end result
[0m16:56:21.972081 [info ] [MainThread]: 
[0m16:56:21.974082 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:56:21.974082 [info ] [MainThread]: 
[0m16:56:21.975082 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:56:21.977081 [debug] [MainThread]: Command `dbt run` succeeded at 16:56:21.977081 after 1.91 seconds
[0m16:56:21.978080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002388D9AECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023890A45A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002389110F640>]}
[0m16:56:21.979080 [debug] [MainThread]: Flushing usage events
[0m17:02:02.088339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546497F5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546725A380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546725A1A0>]}


============================== 17:02:02.095335 | aa47b132-82d1-4d35-9d52-abd0e4485ff6 ==============================
[0m17:02:02.095335 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:02:02.096335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:02:02.675685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa47b132-82d1-4d35-9d52-abd0e4485ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546725A440>]}
[0m17:02:02.780625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa47b132-82d1-4d35-9d52-abd0e4485ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546784FF10>]}
[0m17:02:02.780625 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:02:02.804920 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:02:02.828906 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:02:02.829900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa47b132-82d1-4d35-9d52-abd0e4485ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254671DB070>]}
[0m17:02:05.086434 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.online_shopping
- models.online_shopping.mart
- models.online_shopping.staging
[0m17:02:05.094449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa47b132-82d1-4d35-9d52-abd0e4485ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025467C0AFB0>]}
[0m17:02:05.123430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa47b132-82d1-4d35-9d52-abd0e4485ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025467978370>]}
[0m17:02:05.123430 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:02:05.124427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa47b132-82d1-4d35-9d52-abd0e4485ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025467978910>]}
[0m17:02:05.126426 [info ] [MainThread]: 
[0m17:02:05.128411 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:02:05.130585 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master'
[0m17:02:05.144577 [debug] [ThreadPool]: Using sqlserver connection "list_master"
[0m17:02:05.144577 [debug] [ThreadPool]: On list_master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:02:05.145576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:05.145576 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:02:05.211247 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:02:05.213208 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:02:05.215206 [debug] [ThreadPool]: On list_master: Close
[0m17:02:05.218204 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_master_dbt'
[0m17:02:05.226204 [debug] [ThreadPool]: Using sqlserver connection "list_master_dbt"
[0m17:02:05.227204 [debug] [ThreadPool]: On list_master_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_master_dbt"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
  
[0m17:02:05.227204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:05.228203 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:02:05.228203 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:02:05.242190 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:02:05.243190 [debug] [ThreadPool]: On list_master_dbt: ROLLBACK
[0m17:02:05.244189 [debug] [ThreadPool]: On list_master_dbt: Close
[0m17:02:05.246193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa47b132-82d1-4d35-9d52-abd0e4485ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025467E44C70>]}
[0m17:02:05.246193 [debug] [MainThread]: On master: COMMIT
[0m17:02:05.247188 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:02:05.248186 [info ] [MainThread]: 
[0m17:02:05.252185 [debug] [Thread-1 (]: Began running node model.first.stg_customer
[0m17:02:05.252185 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt.stg_customer ................................... [RUN]
[0m17:02:05.254184 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.first.stg_customer'
[0m17:02:05.254184 [debug] [Thread-1 (]: Began compiling node model.first.stg_customer
[0m17:02:05.264178 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_customer"
[0m17:02:05.265183 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (compile): 17:02:05.255183 => 17:02:05.265183
[0m17:02:05.266164 [debug] [Thread-1 (]: Began executing node model.first.stg_customer
[0m17:02:05.305152 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m17:02:05.305152 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:02:05.306152 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:02:05.306152 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:02:05.307150 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:02:05.323133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.324130 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m17:02:05.325144 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m17:02:05.326142 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.330140 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m17:02:05.330140 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_customer'
  
[0m17:02:05.339140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.347135 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m17:02:05.347135 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
USE [master];
      EXEC sp_rename 'dbt.stg_customer', 'stg_customer__dbt_backup'
[0m17:02:05.532024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.542024 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_customer"
[0m17:02:05.544004 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m17:02:05.544004 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_customer" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        CAST(Cust_id AS INT) as CustomerID,
        province,
        region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



[0m17:02:05.547002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.568990 [debug] [Thread-1 (]: On model.first.stg_customer: COMMIT
[0m17:02:05.572987 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m17:02:05.573987 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_customer__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:02:05.575000 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.575986 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_customer"
[0m17:02:05.576985 [debug] [Thread-1 (]: On model.first.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_customer"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_customer__dbt_backup";');

[0m17:02:05.577998 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.579983 [debug] [Thread-1 (]: Timing info for model.first.stg_customer (execute): 17:02:05.267172 => 17:02:05.579983
[0m17:02:05.580982 [debug] [Thread-1 (]: On model.first.stg_customer: ROLLBACK
[0m17:02:05.580982 [debug] [Thread-1 (]: On model.first.stg_customer: Close
[0m17:02:05.581982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa47b132-82d1-4d35-9d52-abd0e4485ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025467E97B80>]}
[0m17:02:05.582982 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt.stg_customer .............................. [[32mOK[0m in 0.33s]
[0m17:02:05.583994 [debug] [Thread-1 (]: Finished running node model.first.stg_customer
[0m17:02:05.583994 [debug] [Thread-1 (]: Began running node model.first.stg_market
[0m17:02:05.584981 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt.stg_market ..................................... [RUN]
[0m17:02:05.585982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_customer, now model.first.stg_market)
[0m17:02:05.586993 [debug] [Thread-1 (]: Began compiling node model.first.stg_market
[0m17:02:05.590995 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_market"
[0m17:02:05.591995 [debug] [Thread-1 (]: Timing info for model.first.stg_market (compile): 17:02:05.586993 => 17:02:05.591995
[0m17:02:05.592976 [debug] [Thread-1 (]: Began executing node model.first.stg_market
[0m17:02:05.599971 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m17:02:05.600971 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_market__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:02:05.601971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:05.601971 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:02:05.602970 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:02:05.614639 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.616651 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m17:02:05.617655 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_market__dbt_backup";');

[0m17:02:05.618638 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.619638 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m17:02:05.620637 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_market'
  
[0m17:02:05.629633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.633642 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m17:02:05.634641 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
USE [master];
      EXEC sp_rename 'dbt.stg_market', 'stg_market__dbt_backup'
[0m17:02:05.636628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.639627 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_market"
[0m17:02:05.641623 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m17:02:05.641623 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_market" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id,
        CAST(sales AS Float) AS Sales,
        CAST(discount as Float) as Discount,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Float) as Profit,
        cast(shipping_cost as Float) as ShippingCost,
        cast(product_base_margin as Float) as ProductBaseMargin

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m17:02:05.644656 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.646657 [debug] [Thread-1 (]: On model.first.stg_market: COMMIT
[0m17:02:05.650655 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m17:02:05.650655 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_market__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:02:05.652660 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.654654 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_market"
[0m17:02:05.654654 [debug] [Thread-1 (]: On model.first.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_market"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_market__dbt_backup";');

[0m17:02:05.656665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.658664 [debug] [Thread-1 (]: Timing info for model.first.stg_market (execute): 17:02:05.592976 => 17:02:05.658664
[0m17:02:05.659664 [debug] [Thread-1 (]: On model.first.stg_market: ROLLBACK
[0m17:02:05.659664 [debug] [Thread-1 (]: On model.first.stg_market: Close
[0m17:02:05.660663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa47b132-82d1-4d35-9d52-abd0e4485ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025467EC2590>]}
[0m17:02:05.660663 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt.stg_market ................................ [[32mOK[0m in 0.07s]
[0m17:02:05.662662 [debug] [Thread-1 (]: Finished running node model.first.stg_market
[0m17:02:05.662662 [debug] [Thread-1 (]: Began running node model.first.stg_order
[0m17:02:05.663666 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt.stg_order ...................................... [RUN]
[0m17:02:05.664647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_market, now model.first.stg_order)
[0m17:02:05.664647 [debug] [Thread-1 (]: Began compiling node model.first.stg_order
[0m17:02:05.670643 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_order"
[0m17:02:05.672646 [debug] [Thread-1 (]: Timing info for model.first.stg_order (compile): 17:02:05.665646 => 17:02:05.672646
[0m17:02:05.673641 [debug] [Thread-1 (]: Began executing node model.first.stg_order
[0m17:02:05.679638 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m17:02:05.679638 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:02:05.680638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:05.680638 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:02:05.681637 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:02:05.694620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.696633 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m17:02:05.696633 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m17:02:05.697619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.698620 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m17:02:05.699619 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_order'
  
[0m17:02:05.708416 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.713426 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m17:02:05.713426 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
      EXEC sp_rename 'dbt.stg_order', 'stg_order__dbt_backup'
[0m17:02:05.716425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.718429 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_order"
[0m17:02:05.720410 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m17:02:05.720410 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_order" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date) AS OrderDate,
        Order_Priority,
        Ord_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m17:02:05.724426 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.726419 [debug] [Thread-1 (]: On model.first.stg_order: COMMIT
[0m17:02:05.730416 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m17:02:05.731416 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_order__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:02:05.732045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.733047 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_order"
[0m17:02:05.734046 [debug] [Thread-1 (]: On model.first.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_order"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_order__dbt_backup";');

[0m17:02:05.735060 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.738045 [debug] [Thread-1 (]: Timing info for model.first.stg_order (execute): 17:02:05.673641 => 17:02:05.737049
[0m17:02:05.738045 [debug] [Thread-1 (]: On model.first.stg_order: ROLLBACK
[0m17:02:05.739058 [debug] [Thread-1 (]: On model.first.stg_order: Close
[0m17:02:05.740056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa47b132-82d1-4d35-9d52-abd0e4485ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025467F440D0>]}
[0m17:02:05.740056 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt.stg_order ................................. [[32mOK[0m in 0.08s]
[0m17:02:05.742055 [debug] [Thread-1 (]: Finished running node model.first.stg_order
[0m17:02:05.742055 [debug] [Thread-1 (]: Began running node model.first.stg_product
[0m17:02:05.743054 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt.stg_product .................................... [RUN]
[0m17:02:05.743667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_order, now model.first.stg_product)
[0m17:02:05.744683 [debug] [Thread-1 (]: Began compiling node model.first.stg_product
[0m17:02:05.747680 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_product"
[0m17:02:05.749665 [debug] [Thread-1 (]: Timing info for model.first.stg_product (compile): 17:02:05.744683 => 17:02:05.748679
[0m17:02:05.750679 [debug] [Thread-1 (]: Began executing node model.first.stg_product
[0m17:02:05.757675 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m17:02:05.758675 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:02:05.760673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:05.760673 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:02:05.761672 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:02:05.774478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.776492 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m17:02:05.777490 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m17:02:05.778477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.779477 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m17:02:05.780476 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_product'
  
[0m17:02:05.789479 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.793488 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m17:02:05.793488 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
      EXEC sp_rename 'dbt.stg_product', 'stg_product__dbt_backup'
[0m17:02:05.796486 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.798486 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_product"
[0m17:02:05.799474 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m17:02:05.800484 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_product" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



[0m17:02:05.802052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.806053 [debug] [Thread-1 (]: On model.first.stg_product: COMMIT
[0m17:02:05.809064 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m17:02:05.810063 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_product__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:02:05.810063 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.812062 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_product"
[0m17:02:05.812062 [debug] [Thread-1 (]: On model.first.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_product"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_product__dbt_backup";');

[0m17:02:05.814210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.816213 [debug] [Thread-1 (]: Timing info for model.first.stg_product (execute): 17:02:05.750679 => 17:02:05.815214
[0m17:02:05.816213 [debug] [Thread-1 (]: On model.first.stg_product: ROLLBACK
[0m17:02:05.817212 [debug] [Thread-1 (]: On model.first.stg_product: Close
[0m17:02:05.817212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa47b132-82d1-4d35-9d52-abd0e4485ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025467F43340>]}
[0m17:02:05.818212 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt.stg_product ............................... [[32mOK[0m in 0.07s]
[0m17:02:05.820211 [debug] [Thread-1 (]: Finished running node model.first.stg_product
[0m17:02:05.820211 [debug] [Thread-1 (]: Began running node model.first.stg_shipping
[0m17:02:05.821210 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt.stg_shipping ................................... [RUN]
[0m17:02:05.822339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.first.stg_product, now model.first.stg_shipping)
[0m17:02:05.823356 [debug] [Thread-1 (]: Began compiling node model.first.stg_shipping
[0m17:02:05.827353 [debug] [Thread-1 (]: Writing injected SQL for node "model.first.stg_shipping"
[0m17:02:05.829337 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (compile): 17:02:05.823356 => 17:02:05.828337
[0m17:02:05.830336 [debug] [Thread-1 (]: Began executing node model.first.stg_shipping
[0m17:02:05.839345 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m17:02:05.840343 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:02:05.840343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:05.841341 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:02:05.841341 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:02:05.853323 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.855322 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m17:02:05.856335 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m17:02:05.857334 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.858322 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m17:02:05.859321 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt'
    and table_name like 'stg_shipping'
  
[0m17:02:05.867234 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.871234 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m17:02:05.872234 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
      EXEC sp_rename 'dbt.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:02:05.875257 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.878245 [debug] [Thread-1 (]: Writing runtime sql for node "model.first.stg_shipping"
[0m17:02:05.879244 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m17:02:05.880231 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */
USE [master];
    
    

    EXEC('create view "dbt"."stg_shipping" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date) AS ShipDate,
        Ship_mode,
        ship_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



[0m17:02:05.882244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.884257 [debug] [Thread-1 (]: On model.first.stg_shipping: COMMIT
[0m17:02:05.890255 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m17:02:05.891254 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      USE [master];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'master'
      and refs.referenced_schema_name = 'dbt'
      and refs.referenced_entity_name = 'stg_shipping__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:02:05.892463 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.893465 [debug] [Thread-1 (]: Using sqlserver connection "model.first.stg_shipping"
[0m17:02:05.894463 [debug] [Thread-1 (]: On model.first.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.first.stg_shipping"} */

      
      
    
    USE [master];
    EXEC('DROP view IF EXISTS "dbt"."stg_shipping__dbt_backup";');

[0m17:02:05.895777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:05.897779 [debug] [Thread-1 (]: Timing info for model.first.stg_shipping (execute): 17:02:05.830336 => 17:02:05.896781
[0m17:02:05.897779 [debug] [Thread-1 (]: On model.first.stg_shipping: ROLLBACK
[0m17:02:05.898779 [debug] [Thread-1 (]: On model.first.stg_shipping: Close
[0m17:02:05.899778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa47b132-82d1-4d35-9d52-abd0e4485ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025467C3B820>]}
[0m17:02:05.899778 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt.stg_shipping .............................. [[32mOK[0m in 0.08s]
[0m17:02:05.900778 [debug] [Thread-1 (]: Finished running node model.first.stg_shipping
[0m17:02:05.902775 [debug] [MainThread]: On master: COMMIT
[0m17:02:05.903788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:02:05.904773 [debug] [MainThread]: Connection 'list_master' was properly closed.
[0m17:02:05.904773 [debug] [MainThread]: Connection 'list_master_dbt' was properly closed.
[0m17:02:05.905788 [debug] [MainThread]: Connection 'model.first.stg_shipping' was properly closed.
[0m17:02:05.905788 [info ] [MainThread]: 
[0m17:02:05.906787 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m17:02:05.908786 [debug] [MainThread]: Command end result
[0m17:02:05.921765 [info ] [MainThread]: 
[0m17:02:05.922765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:02:05.923772 [info ] [MainThread]: 
[0m17:02:05.924763 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:02:05.926762 [debug] [MainThread]: Command `dbt run` succeeded at 17:02:05.926762 after 3.94 seconds
[0m17:02:05.927784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546497F5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025467E97B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025467E12440>]}
[0m17:02:05.927784 [debug] [MainThread]: Flushing usage events
[0m17:07:12.935411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023864A8B5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002386737A380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002386737A1A0>]}


============================== 17:07:12.942407 | aa552e78-7966-4163-9bf4-e1d2b4dc802b ==============================
[0m17:07:12.942407 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:07:12.943407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:07:13.335055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa552e78-7966-4163-9bf4-e1d2b4dc802b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002386737A440>]}
[0m17:07:13.436996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa552e78-7966-4163-9bf4-e1d2b4dc802b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023867B0A980>]}
[0m17:07:13.437996 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:07:13.449989 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:07:13.471977 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:07:13.472968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa552e78-7966-4163-9bf4-e1d2b4dc802b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023867B09C00>]}
[0m17:07:14.912137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa552e78-7966-4163-9bf4-e1d2b4dc802b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023867E32DA0>]}
[0m17:07:14.927129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa552e78-7966-4163-9bf4-e1d2b4dc802b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023867B0BBB0>]}
[0m17:07:14.928128 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:07:14.929128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa552e78-7966-4163-9bf4-e1d2b4dc802b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023867B0B820>]}
[0m17:07:14.931126 [info ] [MainThread]: 
[0m17:07:14.932127 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:07:14.934425 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:07:14.947418 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:07:14.948417 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:07:14.948417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:14.949417 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:07:15.007497 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:07:15.009496 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:07:15.011499 [debug] [ThreadPool]: On list_online: Close
[0m17:07:15.012482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:07:15.013493 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:07:15.019489 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:07:15.020494 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:07:15.020494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:15.021493 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:07:15.021493 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:07:15.025596 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:07:15.026612 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:07:15.026612 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:07:15.029615 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:07:15.036611 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:07:15.036611 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:07:15.037610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:15.037610 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:07:15.037610 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:07:15.048603 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:07:15.050598 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:07:15.050598 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:07:15.051602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:07:15.054600 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:07:15.055599 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:07:15.055599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:15.056599 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:07:15.056599 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:07:15.064594 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:07:15.065589 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:07:15.066588 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:07:15.067575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa552e78-7966-4163-9bf4-e1d2b4dc802b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023867F6AE60>]}
[0m17:07:15.067575 [debug] [MainThread]: On master: COMMIT
[0m17:07:15.068575 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:15.069574 [info ] [MainThread]: 
[0m17:07:15.073581 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:07:15.074580 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:07:15.075571 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:07:15.076584 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:07:15.086564 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:07:15.089561 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:07:15.076584 => 17:07:15.089561
[0m17:07:15.090580 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:07:15.124555 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:07:15.125555 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:07:15.125555 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:07:15.125555 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:07:15.126554 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:07:15.127945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.132946 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:07:15.132946 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:07:15.144938 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.167938 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:07:15.168938 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:07:15.182929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.186913 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:07:15.186913 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:07:15.188482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.193481 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:07:15.193481 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:07:15.194727 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.195728 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:07:15.198726 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:07:15.198726 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        CAST(Cust_id AS INT) as CustomerID,
        province,
        region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:07:15.216551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.217569 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:07:15.090580 => 17:07:15.217569
[0m17:07:15.218566 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:07:15.218566 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:07:15.219567 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_customer.sql[0m
('22018', "[22018] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting the varchar value 'Cust_1' to data type int. (245) (SQLMoreResults)")
[0m17:07:15.299161 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.DataError: ('22018', "[22018] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting the varchar value 'Cust_1' to data type int. (245) (SQLMoreResults)")

[0m17:07:15.300146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa552e78-7966-4163-9bf4-e1d2b4dc802b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023867F36470>]}
[0m17:07:15.301146 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model online.dbt_staging.stg_customer .......... [[31mERROR[0m in 0.23s]
[0m17:07:15.301735 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:07:15.302752 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:07:15.303751 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:07:15.304748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:07:15.304748 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:07:15.309751 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:07:15.310733 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:07:15.305750 => 17:07:15.310733
[0m17:07:15.311750 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:07:15.317747 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:07:15.317747 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:07:15.318746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:15.318746 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:07:15.319745 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:07:15.320726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.322727 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:07:15.322727 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:07:15.334720 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.338716 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:07:15.338716 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:07:15.357706 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.359718 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:07:15.359718 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:07:15.360718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.362716 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:07:15.362716 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:07:15.363705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.365702 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:07:15.367702 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:07:15.368717 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id,
        CAST(sales AS Float) AS Sales,
        CAST(discount as Float) as Discount,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Float) as Profit,
        cast(shipping_cost as Float) as ShippingCost,
        cast(product_base_margin as Float) as ProductBaseMargin

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:07:15.375761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.376777 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:07:15.311750 => 17:07:15.376777
[0m17:07:15.377776 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:07:15.377776 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:07:15.378775 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to float. (8114) (SQLMoreResults)')
[0m17:07:15.380762 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to float. (8114) (SQLMoreResults)')

[0m17:07:15.381759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa552e78-7966-4163-9bf4-e1d2b4dc802b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023867F6AE60>]}
[0m17:07:15.382761 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.08s]
[0m17:07:15.383758 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:07:15.384772 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:07:15.385771 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:07:15.386758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:07:15.387770 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:07:15.391768 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:07:15.392753 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:07:15.387770 => 17:07:15.392753
[0m17:07:15.393754 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:07:15.399763 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:07:15.400750 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:07:15.401750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:15.402762 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:07:15.403761 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:07:15.405045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.407045 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:07:15.407045 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:07:15.415732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.420730 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:07:15.421729 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:07:15.433738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.435719 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:07:15.436732 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:07:15.437719 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.439726 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:07:15.440717 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:07:15.441586 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.442588 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:07:15.444586 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:07:15.445586 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date) AS OrderDate,
        Order_Priority,
        Ord_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:07:15.451171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.453183 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:07:15.393754 => 17:07:15.452184
[0m17:07:15.453183 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:07:15.454182 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:07:15.455181 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_order.sql[0m
('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:07:15.456175 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.DataError: ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')

[0m17:07:15.457180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa552e78-7966-4163-9bf4-e1d2b4dc802b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023868311510>]}
[0m17:07:15.458179 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model online.dbt_staging.stg_order ............. [[31mERROR[0m in 0.07s]
[0m17:07:15.459179 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:07:15.459179 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:07:15.460179 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:07:15.461178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:07:15.462179 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:07:15.467180 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:07:15.469164 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:07:15.462179 => 17:07:15.468166
[0m17:07:15.470163 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:07:15.476174 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:07:15.476174 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:07:15.477174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:15.477174 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:07:15.478174 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:07:15.479173 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.481158 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:07:15.482158 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:07:15.491165 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.494163 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:07:15.495162 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:07:15.508291 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.510292 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:07:15.511292 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:07:15.512066 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.514070 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:07:15.515066 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:07:15.516065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.518078 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:07:15.519963 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:07:15.520975 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:07:15.526412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.546400 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:07:15.551398 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:07:15.552397 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:07:15.622012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.627012 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:07:15.628011 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:07:15.628840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.632840 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:07:15.470163 => 17:07:15.632840
[0m17:07:15.633839 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:07:15.633839 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:07:15.634838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa552e78-7966-4163-9bf4-e1d2b4dc802b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238683123E0>]}
[0m17:07:15.634838 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.17s]
[0m17:07:15.636352 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:07:15.637368 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:07:15.638354 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:07:15.638808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:07:15.639824 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:07:15.642820 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:07:15.644806 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:07:15.639824 => 17:07:15.644806
[0m17:07:15.645819 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:07:15.654814 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:07:15.654814 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:07:15.655801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:15.655801 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:07:15.656801 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:07:15.657818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.660811 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:07:15.660811 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:07:15.670805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.673791 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:07:15.674790 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:07:15.686672 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.688669 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:07:15.688669 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:07:15.690449 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.691451 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:07:15.692450 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:07:15.693477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.694478 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:07:15.695484 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:07:15.696477 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "first", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date) AS ShipDate,
        Ship_mode,
        ship_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:07:15.702543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:07:15.703545 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:07:15.645819 => 17:07:15.703545
[0m17:07:15.704544 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:07:15.704544 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:07:15.705543 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_shipping.sql[0m
('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:07:15.707522 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.DataError: ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')

[0m17:07:15.708520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa552e78-7966-4163-9bf4-e1d2b4dc802b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023868348BE0>]}
[0m17:07:15.708520 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model online.dbt_staging.stg_shipping .......... [[31mERROR[0m in 0.07s]
[0m17:07:15.709519 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:07:15.711518 [debug] [MainThread]: On master: COMMIT
[0m17:07:15.712518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:15.712518 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:07:15.712518 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:07:15.713517 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:07:15.713517 [info ] [MainThread]: 
[0m17:07:15.714503 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m17:07:15.717522 [debug] [MainThread]: Command end result
[0m17:07:15.729494 [info ] [MainThread]: 
[0m17:07:15.731494 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m17:07:15.732496 [info ] [MainThread]: 
[0m17:07:15.733494 [error] [MainThread]:   ('22018', "[22018] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting the varchar value 'Cust_1' to data type int. (245) (SQLMoreResults)")
[0m17:07:15.733494 [info ] [MainThread]: 
[0m17:07:15.734510 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to float. (8114) (SQLMoreResults)')
[0m17:07:15.735490 [info ] [MainThread]: 
[0m17:07:15.736492 [error] [MainThread]:   ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:07:15.737512 [info ] [MainThread]: 
[0m17:07:15.738504 [error] [MainThread]:   ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:07:15.739509 [info ] [MainThread]: 
[0m17:07:15.740506 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=4 SKIP=0 TOTAL=5
[0m17:07:15.742498 [debug] [MainThread]: Command `dbt run` failed at 17:07:15.742498 after 2.89 seconds
[0m17:07:15.743500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023864A8B5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238683363E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023868349510>]}
[0m17:07:15.743500 [debug] [MainThread]: Flushing usage events
[0m17:08:11.889426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F492FCCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4BBDA320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4BBDA140>]}


============================== 17:08:11.895423 | 5974d6f0-f463-43b6-be03-ac7373f1e19c ==============================
[0m17:08:11.895423 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:08:11.895423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:08:12.284598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5974d6f0-f463-43b6-be03-ac7373f1e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4BBDA3E0>]}
[0m17:08:12.383543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5974d6f0-f463-43b6-be03-ac7373f1e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4C1CBEB0>]}
[0m17:08:12.384542 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:08:12.399539 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:08:12.421520 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:08:12.422519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5974d6f0-f463-43b6-be03-ac7373f1e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4BB59C00>]}
[0m17:08:13.725772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5974d6f0-f463-43b6-be03-ac7373f1e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4C58B820>]}
[0m17:08:13.740750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5974d6f0-f463-43b6-be03-ac7373f1e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4C326860>]}
[0m17:08:13.741749 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:08:13.742749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5974d6f0-f463-43b6-be03-ac7373f1e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4C58A710>]}
[0m17:08:13.744747 [info ] [MainThread]: 
[0m17:08:13.745747 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:08:13.747711 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:08:13.762726 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:08:13.763727 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:08:13.763727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:13.764705 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:08:13.824815 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:08:13.827087 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:08:13.828089 [debug] [ThreadPool]: On list_online: Close
[0m17:08:13.830087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:08:13.831087 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:08:13.837083 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:08:13.838083 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:08:13.838083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:08:13.839082 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:08:13.839082 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:08:13.844060 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:08:13.845060 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:08:13.846060 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:08:13.848058 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:08:13.855040 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:08:13.855040 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:08:13.856040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:13.856040 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:08:13.857039 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:08:13.867495 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:08:13.869494 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:08:13.869494 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:08:13.870493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:08:13.873491 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:08:13.874490 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:08:13.874490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:08:13.875490 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:08:13.875490 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:08:13.883485 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:08:13.884485 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:08:13.885484 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:08:13.886484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5974d6f0-f463-43b6-be03-ac7373f1e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4C7C2E00>]}
[0m17:08:13.886484 [debug] [MainThread]: On master: COMMIT
[0m17:08:13.887483 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:08:13.888469 [info ] [MainThread]: 
[0m17:08:13.892630 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:08:13.892630 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:08:13.893897 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:08:13.894913 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:08:13.905905 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:08:13.906905 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:08:13.894913 => 17:08:13.906905
[0m17:08:13.907891 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:08:13.938873 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:08:13.938873 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:08:13.939872 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:08:13.940888 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:08:13.941895 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:08:13.943871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:13.948882 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:08:13.949881 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:08:13.961874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:13.973855 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:08:13.974854 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:08:14.169761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.187753 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:08:14.188752 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:08:14.202755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.206755 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:08:14.206755 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:08:14.208763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.213758 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:08:14.214758 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:08:14.215553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.216555 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:08:14.218554 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:08:14.218554 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        CAST(Cust_id AS INT) as CustomerID,
        province,
        region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:08:14.223496 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.224498 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:08:13.907891 => 17:08:14.224498
[0m17:08:14.225497 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:08:14.225497 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:08:14.226496 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_customer.sql[0m
('22018', "[22018] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting the varchar value 'Cust_1' to data type int. (245) (SQLMoreResults)")
[0m17:08:14.230563 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.DataError: ('22018', "[22018] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting the varchar value 'Cust_1' to data type int. (245) (SQLMoreResults)")

[0m17:08:14.231562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5974d6f0-f463-43b6-be03-ac7373f1e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4C845FF0>]}
[0m17:08:14.231562 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model online.dbt_staging.stg_customer .......... [[31mERROR[0m in 0.34s]
[0m17:08:14.232561 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:08:14.233566 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:08:14.234561 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:08:14.235562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:08:14.235562 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:08:14.240559 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:08:14.242557 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:08:14.236562 => 17:08:14.241558
[0m17:08:14.243557 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:08:14.249554 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:08:14.249554 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:08:14.250553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:14.250553 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:08:14.251553 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:08:14.253562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.255570 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:08:14.256566 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:08:14.265545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.271542 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:08:14.273542 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:08:14.276612 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.279612 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:08:14.279612 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:08:14.293763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.294763 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:08:14.295762 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:08:14.297697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.299699 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:08:14.299699 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:08:14.300881 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.302886 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:08:14.305881 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:08:14.305881 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id,
        CAST(sales AS Float) AS Sales,
        CAST(discount as Float) as Discount,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Float) as Profit,
        cast(shipping_cost as Float) as ShippingCost,
        cast(product_base_margin as Float) as ProductBaseMargin

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:08:14.311544 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.312546 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:08:14.243557 => 17:08:14.312546
[0m17:08:14.313545 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:08:14.313545 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:08:14.314544 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to float. (8114) (SQLMoreResults)')
[0m17:08:14.316543 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to float. (8114) (SQLMoreResults)')

[0m17:08:14.317543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5974d6f0-f463-43b6-be03-ac7373f1e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4C7C2E00>]}
[0m17:08:14.317543 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.08s]
[0m17:08:14.319543 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:08:14.320563 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:08:14.320563 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:08:14.322986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:08:14.322986 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:08:14.326980 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:08:14.327976 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:08:14.322986 => 17:08:14.327976
[0m17:08:14.328985 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:08:14.336980 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:08:14.337970 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:08:14.337970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:14.338979 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:08:14.338979 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:08:14.340959 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.342977 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:08:14.342977 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:08:14.353951 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.358949 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:08:14.359963 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:08:14.362955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.365946 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:08:14.366946 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:08:14.379181 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.381183 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:08:14.382183 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:08:14.384293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.386294 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:08:14.387293 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:08:14.388711 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.390726 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:08:14.392711 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:08:14.392711 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date) AS OrderDate,
        Order_Priority,
        Ord_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:08:14.397392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.399407 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:08:14.328985 => 17:08:14.399407
[0m17:08:14.399407 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:08:14.400406 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:08:14.401406 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_order.sql[0m
('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:08:14.403391 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.DataError: ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')

[0m17:08:14.404391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5974d6f0-f463-43b6-be03-ac7373f1e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4CB5A500>]}
[0m17:08:14.404391 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model online.dbt_staging.stg_order ............. [[31mERROR[0m in 0.08s]
[0m17:08:14.405420 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:08:14.406436 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:08:14.406436 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:08:14.408420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:08:14.408420 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:08:14.413419 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:08:14.415422 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:08:14.408420 => 17:08:14.415422
[0m17:08:14.416438 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:08:14.423431 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:08:14.424411 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:08:14.424411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:14.425425 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:08:14.425425 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:08:14.428413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.430421 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:08:14.430421 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:08:14.440403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.445413 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:08:14.446412 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:08:14.448752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.450753 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:08:14.454752 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:08:14.466744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.468749 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:08:14.469745 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:08:14.470744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.473740 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:08:14.474739 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:08:14.475739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.477738 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:08:14.478737 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:08:14.479736 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:08:14.484759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.500752 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:08:14.504750 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:08:14.506723 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:08:14.571744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.576735 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:08:14.576735 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:08:14.579167 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.583180 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:08:14.416438 => 17:08:14.583180
[0m17:08:14.584180 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:08:14.584180 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:08:14.585179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5974d6f0-f463-43b6-be03-ac7373f1e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4C87BBB0>]}
[0m17:08:14.586179 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.18s]
[0m17:08:14.587167 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:08:14.587167 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:08:14.588178 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:08:14.589164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:08:14.590177 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:08:14.593180 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:08:14.595161 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:08:14.590177 => 17:08:14.594179
[0m17:08:14.595161 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:08:14.602156 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:08:14.602156 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:08:14.603155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:14.603155 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:08:14.604154 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:08:14.606175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.608167 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:08:14.609170 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:08:14.617166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.624162 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:08:14.625143 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:08:14.627966 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.630966 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:08:14.630966 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:08:14.644348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.646347 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:08:14.646347 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:08:14.648759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.650759 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:08:14.650759 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:08:14.651825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.653826 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:08:14.656834 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:08:14.656834 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date) AS ShipDate,
        Ship_mode,
        ship_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:08:14.661859 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:14.662861 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:08:14.596178 => 17:08:14.662861
[0m17:08:14.663861 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:08:14.663861 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:08:14.664860 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_shipping.sql[0m
('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:08:14.666874 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.DataError: ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')

[0m17:08:14.667872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5974d6f0-f463-43b6-be03-ac7373f1e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4C7D75E0>]}
[0m17:08:14.667872 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model online.dbt_staging.stg_shipping .......... [[31mERROR[0m in 0.08s]
[0m17:08:14.669868 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:08:14.671872 [debug] [MainThread]: On master: COMMIT
[0m17:08:14.672871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:14.673868 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:08:14.673868 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:08:14.673868 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:08:14.674869 [info ] [MainThread]: 
[0m17:08:14.675855 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m17:08:14.677867 [debug] [MainThread]: Command end result
[0m17:08:14.690846 [info ] [MainThread]: 
[0m17:08:14.692844 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m17:08:14.693845 [info ] [MainThread]: 
[0m17:08:14.694854 [error] [MainThread]:   ('22018', "[22018] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting the varchar value 'Cust_1' to data type int. (245) (SQLMoreResults)")
[0m17:08:14.695861 [info ] [MainThread]: 
[0m17:08:14.696843 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to float. (8114) (SQLMoreResults)')
[0m17:08:14.697842 [info ] [MainThread]: 
[0m17:08:14.697842 [error] [MainThread]:   ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:08:14.699204 [info ] [MainThread]: 
[0m17:08:14.700220 [error] [MainThread]:   ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:08:14.700220 [info ] [MainThread]: 
[0m17:08:14.701219 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=4 SKIP=0 TOTAL=5
[0m17:08:14.703222 [debug] [MainThread]: Command `dbt run` failed at 17:08:14.703222 after 2.90 seconds
[0m17:08:14.704223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F492FCCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4CB5A620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4CB589D0>]}
[0m17:08:14.705222 [debug] [MainThread]: Flushing usage events
[0m17:10:28.532570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252422DECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025244BBA2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025244BBA0E0>]}


============================== 17:10:28.539568 | f66f2592-2112-43bd-b9a7-607351ad5bb7 ==============================
[0m17:10:28.539568 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:10:28.540569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:10:28.928357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f66f2592-2112-43bd-b9a7-607351ad5bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025244BBA380>]}
[0m17:10:29.033302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f66f2592-2112-43bd-b9a7-607351ad5bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252451AFE50>]}
[0m17:10:29.034301 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:10:29.052274 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:10:29.178200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:10:29.179200 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_customer.sql
[0m17:10:29.394077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f66f2592-2112-43bd-b9a7-607351ad5bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002524557C130>]}
[0m17:10:29.411069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f66f2592-2112-43bd-b9a7-607351ad5bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002524552BEB0>]}
[0m17:10:29.412067 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:10:29.413066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66f2592-2112-43bd-b9a7-607351ad5bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025245218880>]}
[0m17:10:29.415066 [info ] [MainThread]: 
[0m17:10:29.416065 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:10:29.418064 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:10:29.434053 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:10:29.434053 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:10:29.435052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:29.435052 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:10:29.501024 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:10:29.503016 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:29.506031 [debug] [ThreadPool]: On list_online: Close
[0m17:10:29.507048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:10:29.508023 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:10:29.514021 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:10:29.515009 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:10:29.515009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:29.516008 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:10:29.516008 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:10:29.522017 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:29.523022 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:10:29.524003 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:10:29.527003 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:10:29.533996 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:10:29.535001 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:10:29.535001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:29.536009 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:10:29.536009 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:10:29.548007 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:29.550001 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:10:29.550001 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:10:29.551987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:10:29.554986 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:10:29.555985 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:10:29.555985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:29.555985 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:10:29.556985 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:10:29.564992 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:29.566991 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:10:29.566991 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:10:29.567990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66f2592-2112-43bd-b9a7-607351ad5bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252452D8AC0>]}
[0m17:10:29.568978 [debug] [MainThread]: On master: COMMIT
[0m17:10:29.569977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:29.569977 [info ] [MainThread]: 
[0m17:10:29.573976 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:10:29.574973 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:10:29.575972 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:10:29.576972 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:10:29.585967 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:10:29.586966 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:10:29.576972 => 17:10:29.586966
[0m17:10:29.587965 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:10:29.625965 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:10:29.626945 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:10:29.626945 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:10:29.627957 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:10:29.627957 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:10:29.630940 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:29.634938 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:10:29.635938 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:10:29.646950 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:29.655928 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:10:29.655928 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:10:29.850275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:29.868264 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:10:29.868264 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:10:29.882621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:29.885620 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:10:29.886619 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:10:29.888419 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:29.893419 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:10:29.893419 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:10:29.894613 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:29.897627 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:10:29.898631 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:10:29.899646 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province,
        region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:10:29.906614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:29.921607 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:10:29.925605 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:10:29.926605 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:10:29.994321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:29.999313 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:10:29.999313 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:10:30.001313 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.006309 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:10:29.587965 => 17:10:30.005311
[0m17:10:30.006309 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:10:30.007313 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:10:30.007313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f2592-2112-43bd-b9a7-607351ad5bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025245707700>]}
[0m17:10:30.008313 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.43s]
[0m17:10:30.009296 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:10:30.010295 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:10:30.010295 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:10:30.011418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:10:30.012434 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:10:30.015436 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:10:30.017420 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:10:30.012434 => 17:10:30.016436
[0m17:10:30.017420 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:10:30.023427 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:10:30.023427 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:10:30.024424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:30.024424 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:10:30.025414 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:10:30.028412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.030430 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:10:30.030430 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:10:30.039418 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.044419 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:10:30.045401 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:10:30.048419 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.051411 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:10:30.051411 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:10:30.063393 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.065408 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:10:30.066413 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:10:30.068367 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.070369 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:10:30.070369 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:10:30.071368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.072367 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:10:30.074367 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:10:30.075366 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id,
        CAST(sales AS Float) AS Sales,
        CAST(discount as Float) as Discount,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Float) as Profit,
        cast(shipping_cost as Float) as ShippingCost,
        cast(product_base_margin as Float) as ProductBaseMargin

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:10:30.080953 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.081953 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:10:30.017420 => 17:10:30.081953
[0m17:10:30.081953 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:10:30.082952 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:10:30.083951 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to float. (8114) (SQLMoreResults)')
[0m17:10:30.086954 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to float. (8114) (SQLMoreResults)')

[0m17:10:30.087946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f2592-2112-43bd-b9a7-607351ad5bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025245574CD0>]}
[0m17:10:30.088950 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.08s]
[0m17:10:30.088950 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:10:30.089944 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:10:30.090934 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:10:30.091933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:10:30.091933 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:10:30.095930 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:10:30.097929 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:10:30.092932 => 17:10:30.096930
[0m17:10:30.097929 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:10:30.108924 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:10:30.109924 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:10:30.110924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:30.111921 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:10:30.112921 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:10:30.114934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.116932 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:10:30.117932 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:10:30.125932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.131924 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:10:30.132928 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:10:30.135921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.137920 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:10:30.138920 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:10:30.150521 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.152538 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:10:30.153538 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:10:30.155532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.157530 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:10:30.157530 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:10:30.158530 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.160529 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:10:30.162513 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:10:30.162513 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date) AS OrderDate,
        Order_Priority,
        Ord_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:10:30.167516 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.168518 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:10:30.097929 => 17:10:30.168518
[0m17:10:30.169517 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:10:30.169517 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:10:30.170516 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_order.sql[0m
('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:10:30.172524 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.DataError: ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')

[0m17:10:30.173523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f2592-2112-43bd-b9a7-607351ad5bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025245A6AA70>]}
[0m17:10:30.174523 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model online.dbt_staging.stg_order ............. [[31mERROR[0m in 0.08s]
[0m17:10:30.175534 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:10:30.175534 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:10:30.176535 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:10:30.177433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:10:30.178448 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:10:30.182445 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:10:30.184432 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:10:30.178448 => 17:10:30.183444
[0m17:10:30.184432 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:10:30.190441 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:10:30.190441 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:10:30.191440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:30.191440 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:10:30.192444 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:10:30.193425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.195425 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:10:30.196424 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:10:30.206420 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.212416 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:10:30.212416 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:10:30.215933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.219933 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:10:30.219933 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:10:30.232940 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.234924 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:10:30.235924 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:10:30.236841 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.238856 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:10:30.238856 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:10:30.239855 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.241840 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:10:30.244840 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:10:30.245846 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:10:30.251216 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.253216 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:10:30.254216 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:10:30.254216 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:10:30.325406 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.332416 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:10:30.332416 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:10:30.334401 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.336400 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:10:30.184432 => 17:10:30.336400
[0m17:10:30.337399 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:10:30.337399 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:10:30.338399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f2592-2112-43bd-b9a7-607351ad5bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025245A875B0>]}
[0m17:10:30.339399 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.16s]
[0m17:10:30.341415 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:10:30.342415 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:10:30.343414 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:10:30.344413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:10:30.345413 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:10:30.352391 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:10:30.353389 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:10:30.346413 => 17:10:30.353389
[0m17:10:30.354389 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:10:30.360386 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:10:30.361386 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:10:30.361386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:30.362385 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:10:30.363385 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:10:30.366388 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.369382 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:10:30.369382 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:10:30.379375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.386371 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:10:30.387372 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:10:30.392369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.400363 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:10:30.403361 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:10:30.421352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.423350 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:10:30.424349 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:10:30.427347 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.431345 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:10:30.432345 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:10:30.433344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.436342 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:10:30.437341 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:10:30.439342 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date) AS ShipDate,
        Ship_mode,
        ship_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:10:30.448337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:30.450334 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:10:30.354389 => 17:10:30.449335
[0m17:10:30.451334 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:10:30.452333 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:10:30.455332 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_shipping.sql[0m
('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:10:30.460329 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.DataError: ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')

[0m17:10:30.462327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f2592-2112-43bd-b9a7-607351ad5bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002524557BB80>]}
[0m17:10:30.463327 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model online.dbt_staging.stg_shipping .......... [[31mERROR[0m in 0.12s]
[0m17:10:30.465326 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:10:30.486315 [debug] [MainThread]: On master: COMMIT
[0m17:10:30.489318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:30.491312 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:10:30.492311 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:10:30.493317 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:10:30.494310 [info ] [MainThread]: 
[0m17:10:30.496309 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m17:10:30.501307 [debug] [MainThread]: Command end result
[0m17:10:30.531289 [info ] [MainThread]: 
[0m17:10:30.533288 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m17:10:30.534287 [info ] [MainThread]: 
[0m17:10:30.536288 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to float. (8114) (SQLMoreResults)')
[0m17:10:30.539285 [info ] [MainThread]: 
[0m17:10:30.543287 [error] [MainThread]:   ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:10:30.576262 [info ] [MainThread]: 
[0m17:10:30.577262 [error] [MainThread]:   ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:10:30.588256 [info ] [MainThread]: 
[0m17:10:30.596251 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 TOTAL=5
[0m17:10:30.655217 [debug] [MainThread]: Command `dbt run` failed at 17:10:30.647223 after 2.20 seconds
[0m17:10:30.656217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252422DECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002524528FE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025245775C30>]}
[0m17:10:30.657216 [debug] [MainThread]: Flushing usage events
[0m17:18:49.384605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022864BDED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228674BA2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228674BA110>]}


============================== 17:18:49.390602 | ae241837-8490-4625-8155-1577ba2e9b3a ==============================
[0m17:18:49.390602 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:18:49.391601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:18:49.984867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae241837-8490-4625-8155-1577ba2e9b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228674BA3B0>]}
[0m17:18:50.095786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae241837-8490-4625-8155-1577ba2e9b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022867AAFE80>]}
[0m17:18:50.095786 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:18:50.123070 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:18:51.223634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:18:51.223634 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:18:51.431517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae241837-8490-4625-8155-1577ba2e9b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022867E7C1F0>]}
[0m17:18:51.457542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae241837-8490-4625-8155-1577ba2e9b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022867E2BD60>]}
[0m17:18:51.457542 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:18:51.458543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae241837-8490-4625-8155-1577ba2e9b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022867E2BE50>]}
[0m17:18:51.460559 [info ] [MainThread]: 
[0m17:18:51.461559 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:18:51.463558 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:18:51.477549 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:18:51.478548 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:18:51.478548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:51.479548 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:18:51.543545 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:18:51.545873 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:18:51.546875 [debug] [ThreadPool]: On list_online: Close
[0m17:18:51.548873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:18:51.549872 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:18:51.554869 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:18:51.555869 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:18:51.555869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:51.556868 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:18:51.556868 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:18:51.559880 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:18:51.560881 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:18:51.561880 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:18:51.564295 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:18:51.571294 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:18:51.572293 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:18:51.572293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:51.573292 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:18:51.573292 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:18:51.584264 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:18:51.585267 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:18:51.586265 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:18:51.587265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:18:51.591263 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:18:51.591263 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:18:51.591263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:51.592262 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:18:51.592262 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:18:51.600482 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:18:51.601482 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:18:51.602484 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:18:51.603480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae241837-8490-4625-8155-1577ba2e9b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228674BA3E0>]}
[0m17:18:51.603480 [debug] [MainThread]: On master: COMMIT
[0m17:18:51.604479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:18:51.605479 [info ] [MainThread]: 
[0m17:18:51.609824 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:18:51.609824 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:18:51.611085 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:18:51.612086 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:18:51.621094 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:18:51.623079 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:18:51.612086 => 17:18:51.622094
[0m17:18:51.623079 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:18:51.652076 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:18:51.653076 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:18:51.653076 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:18:51.654065 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:18:51.655063 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:18:51.656062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:51.661072 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:18:51.662072 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:18:51.674052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:51.683046 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:18:51.684058 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:18:51.888941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:51.910914 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:18:51.911914 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:18:51.925925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:51.929904 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:18:51.930903 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:18:51.930903 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:51.935900 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:18:51.936899 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:18:51.938277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:51.941277 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:18:51.942276 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:18:51.942276 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province,
        region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:18:51.949501 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:51.964513 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:18:51.968510 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:18:51.968510 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:18:52.033768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.037768 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:18:52.038768 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:18:52.041011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.045010 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:18:51.624097 => 17:18:52.045010
[0m17:18:52.046009 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:18:52.047009 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:18:52.047009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae241837-8490-4625-8155-1577ba2e9b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022868003730>]}
[0m17:18:52.048008 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.44s]
[0m17:18:52.048811 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:18:52.049826 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:18:52.050578 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:18:52.051186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:18:52.052188 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:18:52.055186 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:18:52.057185 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:18:52.052188 => 17:18:52.056185
[0m17:18:52.057185 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:18:52.066180 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:18:52.067182 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:18:52.068180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:52.068180 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:18:52.069178 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:18:52.071775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.073771 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:18:52.074785 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:18:52.083482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.088483 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:18:52.089482 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:18:52.091481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.095479 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:18:52.096478 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:18:52.108471 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.110469 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:18:52.110469 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:18:52.112477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.113493 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:18:52.114491 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:18:52.115341 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.116357 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:18:52.118356 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:18:52.118356 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id,
        CAST(sales AS FLOAT) AS sales,
        CAST(discount AS FLOAT) AS discount,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Float) as Profit,
        cast(shipping_cost as Float) as ShippingCost,
        cast(product_base_margin as Float) as ProductBaseMargin

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:18:52.123832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.125845 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:18:52.057185 => 17:18:52.124845
[0m17:18:52.125845 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:18:52.126844 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:18:52.127843 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to float. (8114) (SQLMoreResults)')
[0m17:18:52.204786 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to float. (8114) (SQLMoreResults)')

[0m17:18:52.205803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae241837-8490-4625-8155-1577ba2e9b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022867E7C220>]}
[0m17:18:52.206803 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.15s]
[0m17:18:52.207802 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:18:52.207802 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:18:52.208802 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:18:52.209489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:18:52.210491 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:18:52.214489 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:18:52.215488 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:18:52.210491 => 17:18:52.215488
[0m17:18:52.216487 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:18:52.226482 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:18:52.227481 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:18:52.227481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:52.228481 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:18:52.228481 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:18:52.231536 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.233491 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:18:52.234491 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:18:52.243488 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.248483 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:18:52.248483 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:18:52.251051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.254048 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:18:52.255043 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:18:52.269040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.271039 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:18:52.271039 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:18:52.274018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.276031 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:18:52.277037 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:18:52.278036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.279034 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:18:52.281015 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:18:52.283014 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date) AS OrderDate,
        Order_Priority,
        Ord_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:18:52.288011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.291008 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:18:52.216487 => 17:18:52.291008
[0m17:18:52.292022 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:18:52.292022 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:18:52.293021 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_order.sql[0m
('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:18:52.295021 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.DataError: ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')

[0m17:18:52.296020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae241837-8490-4625-8155-1577ba2e9b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022867E7D810>]}
[0m17:18:52.297026 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model online.dbt_staging.stg_order ............. [[31mERROR[0m in 0.09s]
[0m17:18:52.298015 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:18:52.298015 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:18:52.299023 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:18:52.300003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:18:52.301004 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:18:52.305011 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:18:52.307000 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:18:52.301004 => 17:18:52.307000
[0m17:18:52.308013 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:18:52.315009 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:18:52.315009 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:18:52.316008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:52.316008 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:18:52.317008 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:18:52.318007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.319007 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:18:52.320011 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:18:52.328987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.334002 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:18:52.334002 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:18:52.336996 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.339994 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:18:52.340981 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:18:52.353476 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.355479 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:18:52.355479 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:18:52.357459 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.360457 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:18:52.361470 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:18:52.362456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.363469 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:18:52.365454 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:18:52.365454 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:18:52.370280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.373283 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:18:52.374281 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:18:52.375279 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:18:52.450255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.457251 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:18:52.457251 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:18:52.459231 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.461248 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:18:52.308013 => 17:18:52.461248
[0m17:18:52.462248 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:18:52.462248 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:18:52.463247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae241837-8490-4625-8155-1577ba2e9b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228684675E0>]}
[0m17:18:52.464246 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.16s]
[0m17:18:52.465246 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:18:52.465246 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:18:52.466246 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:18:52.467246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:18:52.467246 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:18:52.471243 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:18:52.473223 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:18:52.468245 => 17:18:52.473223
[0m17:18:52.473223 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:18:52.479239 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:18:52.480238 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:18:52.480238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:52.481238 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:18:52.481238 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:18:52.483237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.485236 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:18:52.486235 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:18:52.494231 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.498227 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:18:52.499227 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:18:52.501207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.504205 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:18:52.506205 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:18:52.574166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.578163 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:18:52.580164 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:18:52.595153 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.599151 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:18:52.600151 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:18:52.601150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.604148 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:18:52.607152 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:18:52.608146 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date) AS ShipDate,
        Ship_mode,
        ship_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:18:52.615142 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:18:52.617140 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:18:52.474241 => 17:18:52.616141
[0m17:18:52.618140 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:18:52.618140 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:18:52.619139 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_shipping.sql[0m
('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:18:52.622138 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.DataError: ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')

[0m17:18:52.622138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae241837-8490-4625-8155-1577ba2e9b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022867E78BB0>]}
[0m17:18:52.624139 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model online.dbt_staging.stg_shipping .......... [[31mERROR[0m in 0.16s]
[0m17:18:52.626135 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:18:52.628134 [debug] [MainThread]: On master: COMMIT
[0m17:18:52.630133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:52.631134 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:18:52.631134 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:18:52.632132 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:18:52.633131 [info ] [MainThread]: 
[0m17:18:52.634132 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m17:18:52.639139 [debug] [MainThread]: Command end result
[0m17:18:52.666113 [info ] [MainThread]: 
[0m17:18:52.669111 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m17:18:52.670111 [info ] [MainThread]: 
[0m17:18:52.671111 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to float. (8114) (SQLMoreResults)')
[0m17:18:52.672109 [info ] [MainThread]: 
[0m17:18:52.672109 [error] [MainThread]:   ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:18:52.673109 [info ] [MainThread]: 
[0m17:18:52.675109 [error] [MainThread]:   ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:18:52.676107 [info ] [MainThread]: 
[0m17:18:52.677113 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 TOTAL=5
[0m17:18:52.679105 [debug] [MainThread]: Command `dbt run` failed at 17:18:52.679105 after 3.40 seconds
[0m17:18:52.679105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022864BDED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022867FBC430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228680760B0>]}
[0m17:18:52.680104 [debug] [MainThread]: Flushing usage events
[0m17:26:18.452734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002417FAEACB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002410246A2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002410246A0E0>]}


============================== 17:26:18.458736 | df629a9d-815b-4a37-aff1-e6e70d49adbc ==============================
[0m17:26:18.458736 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:26:18.459736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:26:18.850391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df629a9d-815b-4a37-aff1-e6e70d49adbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002410246A380>]}
[0m17:26:18.952333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df629a9d-815b-4a37-aff1-e6e70d49adbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024102B5BE50>]}
[0m17:26:18.952333 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:26:18.965325 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:26:19.094905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:26:19.095905 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_shipping.sql
[0m17:26:19.095905 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:26:19.310781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df629a9d-815b-4a37-aff1-e6e70d49adbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024102F2E440>]}
[0m17:26:19.325773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df629a9d-815b-4a37-aff1-e6e70d49adbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024102EDBDC0>]}
[0m17:26:19.325773 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:26:19.326773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df629a9d-815b-4a37-aff1-e6e70d49adbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024102EDBEE0>]}
[0m17:26:19.328771 [info ] [MainThread]: 
[0m17:26:19.329771 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:26:19.331771 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:26:19.349759 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:26:19.350758 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:26:19.351758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:19.351758 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:19.419503 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:26:19.423497 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:26:19.426499 [debug] [ThreadPool]: On list_online: Close
[0m17:26:19.428498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:26:19.430496 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:26:19.441490 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:26:19.442490 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:26:19.443489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:19.444489 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:19.445488 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:26:19.451505 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:26:19.453484 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:26:19.454483 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:26:19.459480 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:26:19.468474 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:26:19.469473 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:26:19.469473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:19.469473 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:19.470473 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:26:19.481762 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:26:19.482764 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:26:19.483763 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:26:19.484763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:26:19.487760 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:26:19.487760 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:26:19.488760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:19.488760 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:19.489759 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:26:19.497756 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:26:19.499773 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:26:19.500767 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:26:19.501758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df629a9d-815b-4a37-aff1-e6e70d49adbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024102F2C7F0>]}
[0m17:26:19.502754 [debug] [MainThread]: On master: COMMIT
[0m17:26:19.502754 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:26:19.503759 [info ] [MainThread]: 
[0m17:26:19.507763 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:26:19.508751 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:26:19.509750 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:26:19.510760 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:26:19.521742 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:26:19.522742 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:26:19.510760 => 17:26:19.522742
[0m17:26:19.523742 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:26:19.553736 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:19.553736 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:26:19.554736 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:26:19.555735 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:19.555735 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:26:19.556734 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:19.561720 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:19.561720 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:26:19.572726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:19.581708 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:19.581708 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:26:19.776596 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:19.798584 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:19.799583 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:19.813576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:19.817573 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:19.817573 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:26:19.818572 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:19.824569 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:19.824569 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:19.825568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:19.828567 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:26:19.829566 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:19.830566 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province,
        region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:26:19.837441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:19.856431 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:26:19.860443 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:19.860443 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:26:19.924824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:19.929823 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:19.929823 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:26:19.932356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:19.936356 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:26:19.524740 => 17:26:19.936356
[0m17:26:19.937355 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:26:19.937355 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:26:19.938355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df629a9d-815b-4a37-aff1-e6e70d49adbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241030B36A0>]}
[0m17:26:19.939354 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.43s]
[0m17:26:19.940036 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:26:19.941052 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:26:19.941052 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:26:19.942076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:26:19.943050 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:26:19.946048 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:26:19.948035 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:26:19.943050 => 17:26:19.947048
[0m17:26:19.948035 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:26:19.955032 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:19.956042 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:26:19.956042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:19.957043 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:19.958029 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:26:19.960698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:19.962699 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:19.962699 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:26:19.971693 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:19.975692 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:19.976691 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:26:19.979005 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:19.982006 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:19.983005 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:19.994384 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:19.997393 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:19.997393 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:26:20.000321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.002336 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:20.002336 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:20.003335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.004335 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:26:20.006325 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:20.006325 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id,
        CAST(sales AS Decimal(10,4)) AS sales
        -- CAST(discount AS Decimal(10,4)) AS discount,
        -- cast(order_quantity as int) as OrderQuantity,
        -- cast(profit as Float) as Profit,
        -- cast(shipping_cost as Float) as ShippingCost,
        -- cast(product_base_margin as Float) as ProductBaseMargin

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:26:20.022689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.024704 [debug] [Thread-1 (]: On model.online_shopping.stg_market: COMMIT
[0m17:26:20.025703 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:20.025703 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_market__dbt_backup'
  
[0m17:26:20.091233 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.095233 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:20.096233 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:26:20.098497 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.100517 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:26:19.948035 => 17:26:20.099515
[0m17:26:20.100517 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:26:20.101517 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:26:20.101517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df629a9d-815b-4a37-aff1-e6e70d49adbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024102BC8880>]}
[0m17:26:20.102516 [info ] [Thread-1 (]: 2 of 5 OK created sql table model online.dbt_staging.stg_market ................ [[32mOK[0m in 0.16s]
[0m17:26:20.103517 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:26:20.104514 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:26:20.104514 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:26:20.105514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:26:20.105514 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:26:20.111511 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:26:20.112496 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:26:20.106515 => 17:26:20.112496
[0m17:26:20.112496 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:26:20.118505 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:26:20.118505 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:26:20.119505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:20.119505 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:20.120505 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:26:20.122487 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.124498 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:26:20.125502 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:26:20.135478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.140488 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:26:20.141487 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:26:20.143522 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.145485 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:26:20.146485 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:20.159076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.161077 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:26:20.161077 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:26:20.163142 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.165138 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:26:20.166126 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:20.167125 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.168135 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:26:20.170123 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:26:20.170123 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date) AS OrderDate,
        Order_Priority,
        Ord_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:26:20.175100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.176101 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:26:20.113511 => 17:26:20.176101
[0m17:26:20.177100 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:26:20.177100 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:26:20.178100 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_order.sql[0m
('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:26:20.181975 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.DataError: ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')

[0m17:26:20.182971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df629a9d-815b-4a37-aff1-e6e70d49adbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024102BC8880>]}
[0m17:26:20.183971 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model online.dbt_staging.stg_order ............. [[31mERROR[0m in 0.08s]
[0m17:26:20.184970 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:26:20.185970 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:26:20.186983 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:26:20.187983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:26:20.188983 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:26:20.193979 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:26:20.195966 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:26:20.188983 => 17:26:20.194980
[0m17:26:20.195966 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:26:20.204961 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:20.204961 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:26:20.205960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:20.205960 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:20.206960 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:26:20.207971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.209958 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:20.209958 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:26:20.219914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.225923 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:20.225923 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:26:20.229023 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.232031 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:20.232031 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:20.245030 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.248017 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:20.249019 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:26:20.251013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.254011 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:20.255010 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:20.256010 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.258010 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:26:20.259009 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:20.260009 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:26:20.265006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.268005 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:26:20.269004 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:20.269004 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:26:20.344959 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.348956 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:20.349956 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:26:20.351955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.352954 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:26:20.196978 => 17:26:20.352954
[0m17:26:20.353954 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:26:20.353954 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:26:20.354953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df629a9d-815b-4a37-aff1-e6e70d49adbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002410342FBB0>]}
[0m17:26:20.355952 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.17s]
[0m17:26:20.356953 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:26:20.357951 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:26:20.357951 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:26:20.358951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:26:20.359951 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:26:20.363948 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:26:20.364948 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:26:20.359951 => 17:26:20.364948
[0m17:26:20.365952 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:26:20.371943 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:20.371943 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:26:20.372951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:20.372951 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:20.373944 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:26:20.375943 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.378942 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:20.379944 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:26:20.391932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.399927 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:20.400928 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:26:20.404925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.413922 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:20.414920 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:20.442904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.444902 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:20.445901 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:26:20.450899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.454896 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:20.454896 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:20.456895 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.458894 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:26:20.461892 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:20.462892 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode,
        ship_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:26:20.484880 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.487877 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:26:20.488877 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:20.488877 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:26:20.568833 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.572829 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:20.573828 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:26:20.575618 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:20.577619 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:26:20.365952 => 17:26:20.576620
[0m17:26:20.577619 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:26:20.578618 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:26:20.579618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df629a9d-815b-4a37-aff1-e6e70d49adbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024102FE0880>]}
[0m17:26:20.579618 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.22s]
[0m17:26:20.580617 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:26:20.582617 [debug] [MainThread]: On master: COMMIT
[0m17:26:20.582617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:20.583616 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:26:20.583616 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:26:20.584615 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:26:20.584615 [info ] [MainThread]: 
[0m17:26:20.585615 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m17:26:20.586614 [debug] [MainThread]: Command end result
[0m17:26:20.601625 [info ] [MainThread]: 
[0m17:26:20.602607 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:26:20.604613 [info ] [MainThread]: 
[0m17:26:20.604613 [error] [MainThread]:   ('22007', '[22007] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Conversion failed when converting date and/or time from character string. (241) (SQLMoreResults)')
[0m17:26:20.605617 [info ] [MainThread]: 
[0m17:26:20.606560 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:26:20.608570 [debug] [MainThread]: Command `dbt run` failed at 17:26:20.607572 after 2.23 seconds
[0m17:26:20.608570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002417FAEACB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024102CBF790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024103457E80>]}
[0m17:26:20.609575 [debug] [MainThread]: Flushing usage events
[0m17:26:39.175816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D987BECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9B09A2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9B09A0E0>]}


============================== 17:26:39.181813 | cfe9ee91-fec6-48b0-98ba-aaa0990f58d8 ==============================
[0m17:26:39.181813 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:26:39.182813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:26:39.598953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfe9ee91-fec6-48b0-98ba-aaa0990f58d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9B09A380>]}
[0m17:26:39.716891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfe9ee91-fec6-48b0-98ba-aaa0990f58d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9B68FE50>]}
[0m17:26:39.716891 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:26:39.732870 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:26:39.861794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:26:39.862794 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_order.sql
[0m17:26:40.078670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfe9ee91-fec6-48b0-98ba-aaa0990f58d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9BA5C130>]}
[0m17:26:40.094661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfe9ee91-fec6-48b0-98ba-aaa0990f58d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9BA0BEB0>]}
[0m17:26:40.094661 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:26:40.095660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfe9ee91-fec6-48b0-98ba-aaa0990f58d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9B73F430>]}
[0m17:26:40.098658 [info ] [MainThread]: 
[0m17:26:40.100659 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:26:40.103656 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:26:40.120647 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:26:40.121646 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:26:40.122646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:40.122646 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:40.167432 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:26:40.168432 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:26:40.170431 [debug] [ThreadPool]: On list_online: Close
[0m17:26:40.172429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:26:40.173429 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:26:40.179429 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:26:40.180438 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:26:40.180438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:40.181438 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:40.181438 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:26:40.184441 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:26:40.185436 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:26:40.186435 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:26:40.188911 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m17:26:40.197914 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:26:40.197914 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:26:40.198915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:40.198915 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:40.199914 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:26:40.200897 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:26:40.201912 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:26:40.202912 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:26:40.203911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m17:26:40.206909 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:26:40.206909 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:26:40.207908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:40.207908 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:40.207908 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:26:40.208908 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:26:40.210893 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:26:40.210893 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:26:40.212890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfe9ee91-fec6-48b0-98ba-aaa0990f58d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9BB8EB30>]}
[0m17:26:40.212890 [debug] [MainThread]: On master: COMMIT
[0m17:26:40.213906 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:26:40.214682 [info ] [MainThread]: 
[0m17:26:40.218570 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:26:40.219579 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:26:40.220569 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:26:40.221568 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:26:40.232563 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:26:40.234561 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:26:40.221568 => 17:26:40.233563
[0m17:26:40.235561 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:26:40.271541 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:40.272541 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:26:40.272541 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:26:40.273540 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:40.274539 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:26:40.275537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.279534 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:40.279534 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:26:40.280535 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.290530 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:40.290530 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:26:40.293530 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.311517 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:40.312516 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:40.313517 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.316514 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:40.317513 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:26:40.318513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.323510 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:40.324509 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:40.324509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.327521 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:26:40.329508 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:40.330519 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province,
        region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:26:40.338093 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.353086 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:26:40.357083 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:40.357083 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:26:40.358333 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.362347 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:26:40.363346 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:26:40.364934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.369946 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:26:40.235561 => 17:26:40.369946
[0m17:26:40.369946 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:26:40.370945 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:26:40.371945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfe9ee91-fec6-48b0-98ba-aaa0990f58d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9BBE3700>]}
[0m17:26:40.371945 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.15s]
[0m17:26:40.372944 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:26:40.373944 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:26:40.374943 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:26:40.375944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:26:40.375944 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:26:40.379945 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:26:40.380945 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:26:40.376947 => 17:26:40.380945
[0m17:26:40.381927 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:26:40.388924 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:40.389940 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:26:40.389940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:40.390939 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:40.391939 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:26:40.392933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.393933 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:40.394932 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:26:40.394932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.398930 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:40.399929 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:26:40.401928 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.404916 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:40.405914 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:40.406913 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.408911 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:40.408911 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:26:40.409912 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.411922 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:40.411922 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:40.412921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.413921 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:26:40.415911 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:40.415911 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id,prod_id,cust_id,ship_id,
        CAST(sales AS Decimal(10,4)) AS sales
        -- CAST(discount AS Decimal(10,4)) AS discount,
        -- cast(order_quantity as int) as OrderQuantity,
        -- cast(profit as Float) as Profit,
        -- cast(shipping_cost as Float) as ShippingCost,
        -- cast(product_base_margin as Float) as ProductBaseMargin

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:26:40.432541 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.434551 [debug] [Thread-1 (]: On model.online_shopping.stg_market: COMMIT
[0m17:26:40.435541 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:40.436541 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_market__dbt_backup'
  
[0m17:26:40.437540 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.442551 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:26:40.442551 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:26:40.444538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.446549 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:26:40.381927 => 17:26:40.446549
[0m17:26:40.446549 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:26:40.447548 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:26:40.448547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfe9ee91-fec6-48b0-98ba-aaa0990f58d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9BA5C1C0>]}
[0m17:26:40.448547 [info ] [Thread-1 (]: 2 of 5 OK created sql table model online.dbt_staging.stg_market ................ [[32mOK[0m in 0.07s]
[0m17:26:40.449547 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:26:40.450546 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:26:40.451550 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:26:40.452536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:26:40.453545 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:26:40.458538 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:26:40.459538 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:26:40.453545 => 17:26:40.459538
[0m17:26:40.460531 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:26:40.466537 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:26:40.467537 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:26:40.467537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:40.468522 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:40.469522 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:26:40.471521 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.472520 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:26:40.473519 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:26:40.474519 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.479531 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:26:40.480535 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:26:40.482516 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.485512 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:26:40.486512 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:40.487511 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.488511 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:26:40.489510 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:26:40.491509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.493522 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:26:40.494521 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:40.495507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.496520 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:26:40.498525 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:26:40.498525 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority,
        Ord_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:26:40.510919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.512917 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:26:40.513916 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:26:40.513916 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:26:40.580722 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.585722 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:26:40.585722 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:26:40.588220 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.590221 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:26:40.460531 => 17:26:40.589222
[0m17:26:40.590221 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:26:40.591220 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:26:40.591220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfe9ee91-fec6-48b0-98ba-aaa0990f58d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9BA5C1C0>]}
[0m17:26:40.592219 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.14s]
[0m17:26:40.593220 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:26:40.594233 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:26:40.594233 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:26:40.595439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:26:40.596456 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:26:40.600452 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:26:40.601438 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:26:40.596456 => 17:26:40.601438
[0m17:26:40.602438 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:26:40.609446 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:40.610447 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:26:40.610447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:40.611446 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:40.611446 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:26:40.612445 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.614432 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:40.614432 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:26:40.615431 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.621431 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:40.622430 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:26:40.624770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.627771 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:40.627771 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:40.629056 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.630057 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:40.631056 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:26:40.631056 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.634054 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:40.634054 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:40.635463 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.637464 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:26:40.639463 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:40.640463 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:26:40.645678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.647679 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:26:40.648678 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:40.648678 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:26:40.650291 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.656291 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:26:40.656291 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:26:40.658837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.660838 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:26:40.602438 => 17:26:40.660838
[0m17:26:40.660838 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:26:40.661837 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:26:40.662836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfe9ee91-fec6-48b0-98ba-aaa0990f58d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9BBEC5E0>]}
[0m17:26:40.662836 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.07s]
[0m17:26:40.663932 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:26:40.664951 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:26:40.665934 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:26:40.666947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:26:40.666947 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:26:40.671931 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:26:40.673930 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:26:40.666947 => 17:26:40.673930
[0m17:26:40.673930 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:26:40.680938 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:40.680938 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:26:40.680938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:40.681938 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:26:40.681938 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:26:40.682937 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.684924 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:40.685933 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:26:40.686922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.691919 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:40.692919 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:26:40.695395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.697395 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:40.698395 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:40.699363 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.700364 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:40.701363 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:26:40.701363 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.704362 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:40.705361 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:26:40.706375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.708359 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:26:40.709358 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:40.710359 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode,
        ship_id

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:26:40.725404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.727402 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:26:40.728402 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:40.728402 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:26:40.729875 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.734874 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:26:40.735881 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:26:40.738781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:26:40.740795 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:26:40.674941 => 17:26:40.740795
[0m17:26:40.741800 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:26:40.741800 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:26:40.742794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfe9ee91-fec6-48b0-98ba-aaa0990f58d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9BF0F010>]}
[0m17:26:40.743794 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.08s]
[0m17:26:40.744779 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:26:40.746324 [debug] [MainThread]: On master: COMMIT
[0m17:26:40.746324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:40.747323 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:26:40.747323 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m17:26:40.748322 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:26:40.748322 [info ] [MainThread]: 
[0m17:26:40.749321 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m17:26:40.751335 [debug] [MainThread]: Command end result
[0m17:26:40.764314 [info ] [MainThread]: 
[0m17:26:40.765313 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:26:40.765313 [info ] [MainThread]: 
[0m17:26:40.766322 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:26:40.768321 [debug] [MainThread]: Command `dbt run` succeeded at 17:26:40.767322 after 1.67 seconds
[0m17:26:40.768321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D987BECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9B9EE020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9BF0F010>]}
[0m17:26:40.769326 [debug] [MainThread]: Flushing usage events
[0m17:32:27.913988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160109AB940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001601329A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001601329A0B0>]}


============================== 17:32:27.919985 | 02b370b9-a102-421d-9d16-1a17b0cdd572 ==============================
[0m17:32:27.919985 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:32:27.919985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:32:28.475885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02b370b9-a102-421d-9d16-1a17b0cdd572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001601329A350>]}
[0m17:32:28.574827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02b370b9-a102-421d-9d16-1a17b0cdd572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016013A25D20>]}
[0m17:32:28.575827 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:32:28.602798 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:32:29.664357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m17:32:29.665356 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:32:29.666355 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_shipping.sql
[0m17:32:29.666355 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_customer.sql
[0m17:32:29.667355 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_order.sql
[0m17:32:29.884242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02b370b9-a102-421d-9d16-1a17b0cdd572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016013C516F0>]}
[0m17:32:29.909215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02b370b9-a102-421d-9d16-1a17b0cdd572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016013C0BD90>]}
[0m17:32:29.910214 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:32:29.911215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02b370b9-a102-421d-9d16-1a17b0cdd572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016013C0BDF0>]}
[0m17:32:29.913232 [info ] [MainThread]: 
[0m17:32:29.914232 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:32:29.916211 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:32:29.931202 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:32:29.932201 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:32:29.932201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:29.933201 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:32:29.998654 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:32:30.000790 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:32:30.002791 [debug] [ThreadPool]: On list_online: Close
[0m17:32:30.003791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:32:30.004804 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:32:30.010799 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:32:30.010799 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:32:30.011799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:32:30.011799 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:32:30.012799 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:32:30.014797 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:32:30.015798 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:32:30.016796 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:32:30.018789 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:32:30.027131 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:32:30.027131 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:32:30.028130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:30.028130 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:32:30.029130 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:32:30.038608 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:32:30.039594 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:32:30.040594 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:32:30.041593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:32:30.045591 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:32:30.045591 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:32:30.045591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:32:30.046590 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:32:30.046590 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:32:30.054811 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:32:30.055797 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:32:30.056796 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:32:30.057795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02b370b9-a102-421d-9d16-1a17b0cdd572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001601329A140>]}
[0m17:32:30.057795 [debug] [MainThread]: On master: COMMIT
[0m17:32:30.058809 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:32:30.059799 [info ] [MainThread]: 
[0m17:32:30.063624 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:32:30.063624 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:32:30.064621 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:32:30.065631 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:32:30.074621 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:32:30.077622 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:32:30.065631 => 17:32:30.076601
[0m17:32:30.078621 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:32:30.107604 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:32:30.108602 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:32:30.108602 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:32:30.109603 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:32:30.110599 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:32:30.111599 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.115591 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:32:30.115591 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:32:30.125692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.145683 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:32:30.145683 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:32:30.159656 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.163667 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:32:30.163667 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:32:30.164667 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.170651 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:32:30.170651 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:32:30.172207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.173209 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:32:30.175208 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:32:30.175208 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:32:30.183748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.199751 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:32:30.203749 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:32:30.204748 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:32:30.273016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.279015 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:32:30.279015 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:32:30.280014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.285011 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:32:30.078621 => 17:32:30.284012
[0m17:32:30.285011 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:32:30.286011 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:32:30.286011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02b370b9-a102-421d-9d16-1a17b0cdd572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016013DDF5E0>]}
[0m17:32:30.287010 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.22s]
[0m17:32:30.288011 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:32:30.289028 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:32:30.289028 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:32:30.290009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:32:30.291022 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:32:30.295024 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:32:30.296023 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:32:30.291022 => 17:32:30.296023
[0m17:32:30.297009 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:32:30.303019 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:32:30.304003 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:32:30.304003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:30.305013 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:32:30.305013 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:32:30.306019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.307999 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:32:30.309011 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:32:30.317007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.319991 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:32:30.320997 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:32:30.332986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.334996 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:32:30.335996 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:32:30.336989 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.339982 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:32:30.339982 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:32:30.340981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.342993 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:32:30.344978 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:32:30.344978 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales
        CAST(discount AS Decimal(10,4)) AS Discount,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Decimal(10,4)) as Profit,
        cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:32:30.346989 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.347975 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:32:30.297009 => 17:32:30.347975
[0m17:32:30.347975 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:32:30.348975 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:32:30.349974 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'CAST'. (102) (SQLMoreResults)")
[0m17:32:30.428563 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'CAST'. (102) (SQLMoreResults)")

[0m17:32:30.429551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02b370b9-a102-421d-9d16-1a17b0cdd572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001601388FCD0>]}
[0m17:32:30.430562 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.14s]
[0m17:32:30.431562 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:32:30.431562 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:32:30.432576 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:32:30.433560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:32:30.433560 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:32:30.439543 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:32:30.440553 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:32:30.434560 => 17:32:30.440553
[0m17:32:30.441543 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:32:30.447553 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:32:30.447553 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:32:30.448552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:30.448552 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:32:30.449557 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:32:30.450537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.452549 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:32:30.452549 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:32:30.462545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.465542 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:32:30.467546 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:32:30.480011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.483015 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:32:30.484009 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:32:30.484995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.487012 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:32:30.487995 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:32:30.489994 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.491006 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:32:30.493008 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:32:30.493008 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:32:30.504975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.507975 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:32:30.507975 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:32:30.508974 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:32:30.575748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.579730 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:32:30.580730 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:32:30.581777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.582779 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:32:30.441543 => 17:32:30.582779
[0m17:32:30.583778 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:32:30.583778 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:32:30.584777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02b370b9-a102-421d-9d16-1a17b0cdd572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160138FFB20>]}
[0m17:32:30.585777 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.15s]
[0m17:32:30.586776 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:32:30.586776 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:32:30.587776 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:32:30.588775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:32:30.588775 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:32:30.592773 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:32:30.594772 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:32:30.588775 => 17:32:30.593772
[0m17:32:30.594772 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:32:30.599769 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:32:30.600768 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:32:30.600768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:30.601767 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:32:30.601767 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:32:30.602767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.604766 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:32:30.604766 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:32:30.613774 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.616759 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:32:30.617758 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:32:30.629922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.630922 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:32:30.631922 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:32:30.632906 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.633921 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:32:30.634919 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:32:30.635792 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.636793 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:32:30.638792 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:32:30.639792 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:32:30.646166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.648167 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:32:30.649166 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:32:30.649166 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:32:30.717779 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.722778 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:32:30.722778 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:32:30.723792 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.725777 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:32:30.594772 => 17:32:30.724778
[0m17:32:30.725777 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:32:30.725777 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:32:30.726776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02b370b9-a102-421d-9d16-1a17b0cdd572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160138FC3D0>]}
[0m17:32:30.727776 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.14s]
[0m17:32:30.728777 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:32:30.728777 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:32:30.729789 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:32:30.730776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:32:30.731787 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:32:30.734790 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:32:30.736771 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:32:30.731787 => 17:32:30.735789
[0m17:32:30.736771 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:32:30.743785 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:32:30.743785 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:32:30.744785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:30.744785 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:32:30.745784 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:32:30.746779 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.748765 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:32:30.749782 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:32:30.759758 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.762756 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:32:30.763755 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:32:30.774434 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.777434 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:32:30.778441 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:32:30.780439 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.782444 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:32:30.783445 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:32:30.784443 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.786442 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:32:30.788431 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:32:30.789426 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:32:30.804796 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.808805 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:32:30.809805 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:32:30.809805 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:32:30.881749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.886746 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:32:30.886746 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:32:30.888746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:32:30.891743 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:32:30.736771 => 17:32:30.890743
[0m17:32:30.892742 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:32:30.893742 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:32:30.895740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02b370b9-a102-421d-9d16-1a17b0cdd572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160141796F0>]}
[0m17:32:30.896740 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.16s]
[0m17:32:30.897739 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:32:30.899740 [debug] [MainThread]: On master: COMMIT
[0m17:32:30.900739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:30.900739 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:32:30.901739 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:32:30.901739 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:32:30.902738 [info ] [MainThread]: 
[0m17:32:30.903737 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m17:32:30.906734 [debug] [MainThread]: Command end result
[0m17:32:30.927723 [info ] [MainThread]: 
[0m17:32:30.928724 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:32:30.929722 [info ] [MainThread]: 
[0m17:32:30.930721 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'CAST'. (102) (SQLMoreResults)")
[0m17:32:30.931720 [info ] [MainThread]: 
[0m17:32:30.932720 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:32:30.934719 [debug] [MainThread]: Command `dbt run` failed at 17:32:30.933720 after 3.12 seconds
[0m17:32:30.934719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160109AB940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016013C0BF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016013C570A0>]}
[0m17:32:30.935718 [debug] [MainThread]: Flushing usage events
[0m17:32:59.533155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAAD6CF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAAFFAA350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAAFFAA170>]}


============================== 17:32:59.539152 | c27b1ffb-a80c-4b06-8fae-ad32d993869f ==============================
[0m17:32:59.539152 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:32:59.540151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:32:59.939286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c27b1ffb-a80c-4b06-8fae-ad32d993869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAAFFAA410>]}
[0m17:33:00.043229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c27b1ffb-a80c-4b06-8fae-ad32d993869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB059FEE0>]}
[0m17:33:00.043229 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:33:00.057646 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:33:00.183555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:33:00.183555 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:33:00.392449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c27b1ffb-a80c-4b06-8fae-ad32d993869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB096C250>]}
[0m17:33:00.408429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c27b1ffb-a80c-4b06-8fae-ad32d993869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB091BE50>]}
[0m17:33:00.408429 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:33:00.409427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c27b1ffb-a80c-4b06-8fae-ad32d993869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB091BDC0>]}
[0m17:33:00.411439 [info ] [MainThread]: 
[0m17:33:00.412425 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:33:00.415424 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:33:00.430416 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:33:00.430416 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:33:00.431415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:00.431415 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:33:00.477781 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:33:00.478780 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:33:00.480779 [debug] [ThreadPool]: On list_online: Close
[0m17:33:00.482232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:33:00.483234 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:33:00.488231 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:33:00.489230 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:33:00.489230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:00.489230 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:33:00.490230 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:33:00.494232 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:33:00.495228 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:33:00.496226 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:33:00.498385 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m17:33:00.505383 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:33:00.505383 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:33:00.506382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:00.506382 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:33:00.507382 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:33:00.509380 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:33:00.510380 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:33:00.510380 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:33:00.511379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m17:33:00.514378 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:33:00.515377 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:33:00.515377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:00.516376 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:33:00.516376 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:33:00.517442 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:33:00.518457 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:33:00.519457 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:33:00.520460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c27b1ffb-a80c-4b06-8fae-ad32d993869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB0A96B00>]}
[0m17:33:00.520460 [debug] [MainThread]: On master: COMMIT
[0m17:33:00.521460 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:33:00.522440 [info ] [MainThread]: 
[0m17:33:00.526970 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:33:00.526970 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:33:00.528991 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:33:00.528991 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:33:00.537985 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:33:00.539966 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:33:00.529985 => 17:33:00.538984
[0m17:33:00.540964 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:33:00.571946 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:33:00.572946 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:33:00.572946 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:33:00.573945 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:33:00.574945 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:33:00.575944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.584953 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:33:00.585940 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:33:00.586951 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.594936 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:33:00.595933 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:33:00.779244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.797254 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:33:00.798249 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:33:00.799253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.802252 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:33:00.802252 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:33:00.803251 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.808248 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:33:00.809248 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:33:00.809248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.812246 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:33:00.814226 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:33:00.814226 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:33:00.820751 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.835763 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:33:00.839761 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:33:00.840760 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:33:00.841524 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.845542 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:33:00.846541 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:33:00.848566 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.852566 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:33:00.540964 => 17:33:00.852566
[0m17:33:00.853565 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:33:00.853565 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:33:00.854564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c27b1ffb-a80c-4b06-8fae-ad32d993869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB0AEB790>]}
[0m17:33:00.854564 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.33s]
[0m17:33:00.855755 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:33:00.856771 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:33:00.857769 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:33:00.858770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:33:00.858770 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:33:00.862771 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:33:00.863771 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:33:00.859773 => 17:33:00.863771
[0m17:33:00.864771 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:33:00.870750 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:33:00.871749 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:33:00.871749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:00.872749 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:33:00.873787 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:33:00.874747 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.876747 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:33:00.877753 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:33:00.878763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.881744 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:33:00.882743 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:33:00.883759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.884757 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:33:00.885754 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:33:00.886434 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.888449 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:33:00.888449 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:33:00.889449 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.890448 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:33:00.891448 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:33:00.892433 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        CAST(discount AS Decimal(10,4)) AS Discount,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Decimal(10,4)) as Profit,
        cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:33:00.898430 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.899443 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:33:00.864771 => 17:33:00.899443
[0m17:33:00.900442 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:33:00.900442 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:33:00.901442 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')
[0m17:33:00.905425 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')

[0m17:33:00.905425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c27b1ffb-a80c-4b06-8fae-ad32d993869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB0964F70>]}
[0m17:33:00.906425 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.05s]
[0m17:33:00.907424 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:33:00.909423 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:33:00.910424 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:33:00.911422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:33:00.911422 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:33:00.916420 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:33:00.919417 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:33:00.912422 => 17:33:00.918419
[0m17:33:00.919417 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:33:00.927414 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:33:00.928413 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:33:00.929431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:00.929431 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:33:00.930430 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:33:00.931419 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.933430 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:33:00.933430 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:33:00.934429 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.939420 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:33:00.939420 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:33:00.942022 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.945041 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:33:00.945041 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:33:00.957015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.960018 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:33:00.960018 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:33:00.962013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.964025 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:33:00.965025 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:33:00.965946 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.966948 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:33:00.968946 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:33:00.968946 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:33:00.981117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.983118 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:33:00.984117 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:33:00.984117 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:33:00.985633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.989632 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:33:00.990632 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:33:00.992574 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:00.994575 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:33:00.919417 => 17:33:00.994575
[0m17:33:00.994575 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:33:00.995574 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:33:00.996573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c27b1ffb-a80c-4b06-8fae-ad32d993869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB096C100>]}
[0m17:33:00.996573 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.09s]
[0m17:33:00.997573 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:33:00.998586 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:33:00.999572 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:33:01.000002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:33:01.001018 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:33:01.005015 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:33:01.006019 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:33:01.001018 => 17:33:01.006019
[0m17:33:01.007002 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:33:01.015013 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:33:01.015013 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:33:01.016009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:01.016009 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:33:01.017009 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:33:01.018008 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.018995 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:33:01.019994 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:33:01.021007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.025004 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:33:01.026004 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:33:01.029693 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.032694 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:33:01.032694 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:33:01.045941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.047940 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:33:01.047940 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:33:01.048925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.050938 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:33:01.051937 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:33:01.052989 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.053991 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:33:01.054990 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:33:01.055989 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:33:01.061555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.064568 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:33:01.065565 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:33:01.065565 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:33:01.066555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.072561 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:33:01.073561 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:33:01.075669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.078676 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:33:01.007002 => 17:33:01.077671
[0m17:33:01.078676 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:33:01.079669 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:33:01.080668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c27b1ffb-a80c-4b06-8fae-ad32d993869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB0E9C130>]}
[0m17:33:01.080668 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.08s]
[0m17:33:01.082681 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:33:01.082681 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:33:01.083680 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:33:01.084460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:33:01.085477 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:33:01.089473 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:33:01.090459 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:33:01.085477 => 17:33:01.090459
[0m17:33:01.090459 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:33:01.098468 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:33:01.098468 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:33:01.099467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:01.099467 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:33:01.100467 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:33:01.101466 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.103453 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:33:01.103453 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:33:01.104786 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.108786 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:33:01.108786 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:33:01.111814 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.115805 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:33:01.116799 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:33:01.129793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.131794 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:33:01.132791 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:33:01.134157 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.136159 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:33:01.137158 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:33:01.137999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.139001 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:33:01.141000 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:33:01.141000 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:33:01.154953 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.156967 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:33:01.157967 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:33:01.157967 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:33:01.158966 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.164963 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:33:01.165962 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:33:01.167910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:01.169910 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:33:01.091472 => 17:33:01.168911
[0m17:33:01.169910 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:33:01.169910 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:33:01.170909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c27b1ffb-a80c-4b06-8fae-ad32d993869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB0966350>]}
[0m17:33:01.171909 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.09s]
[0m17:33:01.172708 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:33:01.174722 [debug] [MainThread]: On master: COMMIT
[0m17:33:01.175722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:01.175722 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:33:01.175722 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m17:33:01.176721 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:33:01.177723 [info ] [MainThread]: 
[0m17:33:01.178706 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m17:33:01.179720 [debug] [MainThread]: Command end result
[0m17:33:01.194717 [info ] [MainThread]: 
[0m17:33:01.195716 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:33:01.196703 [info ] [MainThread]: 
[0m17:33:01.197698 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')
[0m17:33:01.198696 [info ] [MainThread]: 
[0m17:33:01.198696 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:33:01.200708 [debug] [MainThread]: Command `dbt run` failed at 17:33:01.200708 after 1.74 seconds
[0m17:33:01.201707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAAD6CF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB0EBCDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAB0EBC3A0>]}
[0m17:33:01.202708 [debug] [MainThread]: Flushing usage events
[0m17:37:51.013531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78FB4ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E79242A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E79242A0B0>]}


============================== 17:37:51.021521 | dd97bb25-e7e0-4522-80c2-fcdf2dae80a4 ==============================
[0m17:37:51.021521 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:37:51.022514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:37:51.564968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd97bb25-e7e0-4522-80c2-fcdf2dae80a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E79242A350>]}
[0m17:37:51.666905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd97bb25-e7e0-4522-80c2-fcdf2dae80a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E792BB1D20>]}
[0m17:37:51.667904 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:37:51.682389 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:37:51.827983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:37:51.828982 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:37:52.043859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd97bb25-e7e0-4522-80c2-fcdf2dae80a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E792DEC100>]}
[0m17:37:52.061181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd97bb25-e7e0-4522-80c2-fcdf2dae80a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E792D9BD00>]}
[0m17:37:52.062180 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:37:52.064179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd97bb25-e7e0-4522-80c2-fcdf2dae80a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E792D9BD90>]}
[0m17:37:52.066179 [info ] [MainThread]: 
[0m17:37:52.067178 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:37:52.069177 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:37:52.083168 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:37:52.083168 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:37:52.084167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:52.084167 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:37:52.191489 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:37:52.192484 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:37:52.194483 [debug] [ThreadPool]: On list_online: Close
[0m17:37:52.195482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:37:52.196482 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:37:52.201479 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:37:52.202478 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:37:52.202478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:52.203478 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:37:52.203478 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:37:52.206476 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:37:52.207476 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:37:52.207476 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:37:52.210474 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m17:37:52.217470 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:37:52.217470 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:37:52.218469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:52.218469 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:37:52.218469 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:37:52.220469 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:37:52.221467 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:37:52.222467 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:37:52.223466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m17:37:52.226465 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:37:52.226465 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:37:52.226465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:52.227464 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:37:52.227464 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:37:52.228463 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:37:52.230462 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:37:52.230462 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:37:52.231462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd97bb25-e7e0-4522-80c2-fcdf2dae80a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E792F17580>]}
[0m17:37:52.231462 [debug] [MainThread]: On master: COMMIT
[0m17:37:52.232461 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:37:52.233461 [info ] [MainThread]: 
[0m17:37:52.238458 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:37:52.239457 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:37:52.240466 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:37:52.241457 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:37:52.251450 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:37:52.253450 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:37:52.241457 => 17:37:52.252451
[0m17:37:52.253450 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:37:52.285431 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:37:52.285431 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:37:52.286430 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:37:52.286430 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:37:52.287429 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:37:52.288234 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.293252 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:37:52.293252 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:37:52.294254 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.302242 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:37:52.303241 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:37:52.305351 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.325687 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:37:52.325687 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:37:52.336990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.341001 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:37:52.342001 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:37:52.342987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.347998 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:37:52.347998 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:37:52.348998 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.351995 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:37:52.352988 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:37:52.353980 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:37:52.360661 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.374652 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:37:52.378651 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:37:52.379650 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:37:52.380654 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.384648 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:37:52.385647 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:37:52.387253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.391266 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:37:52.254449 => 17:37:52.391266
[0m17:37:52.392266 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:37:52.392266 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:37:52.393265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd97bb25-e7e0-4522-80c2-fcdf2dae80a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E792F6F6D0>]}
[0m17:37:52.394252 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.15s]
[0m17:37:52.396250 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:37:52.396250 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:37:52.397249 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:37:52.398249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:37:52.399266 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:37:52.403264 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:37:52.405263 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:37:52.399266 => 17:37:52.404264
[0m17:37:52.405263 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:37:52.412241 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:37:52.413240 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:37:52.413240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:52.414239 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:37:52.415238 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:37:52.416238 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.418258 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:37:52.419256 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:37:52.420255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.424236 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:37:52.425235 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:37:52.428253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.431248 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:37:52.432248 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:37:52.444224 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.446221 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:37:52.447241 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:37:52.449220 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.451236 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:37:52.452236 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:37:52.453217 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.454235 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:37:52.456231 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:37:52.457233 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        CAST(try_cast(discount AS Decimal(10,4)) AS Discount,
        -- CAST(discount AS Decimal(10,4)) AS Discount,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Decimal(10,4)) as Profit,
        cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin


       

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:37:52.459233 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.462212 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:37:52.406262 => 17:37:52.461213
[0m17:37:52.462212 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:37:52.463211 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:37:52.464211 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102) (SQLMoreResults)")
[0m17:37:52.473205 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102) (SQLMoreResults)")

[0m17:37:52.474205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd97bb25-e7e0-4522-80c2-fcdf2dae80a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E792A89030>]}
[0m17:37:52.476204 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.08s]
[0m17:37:52.479211 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:37:52.480201 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:37:52.481202 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:37:52.482201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:37:52.482201 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:37:52.488197 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:37:52.490197 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:37:52.483200 => 17:37:52.490197
[0m17:37:52.492214 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:37:52.503206 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:37:52.504206 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:37:52.505206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:52.505206 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:37:52.506205 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:37:52.507186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.509204 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:37:52.509204 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:37:52.510203 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.516182 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:37:52.516182 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:37:52.519199 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.522178 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:37:52.522178 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:37:52.523177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.525210 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:37:52.526194 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:37:52.527194 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.529193 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:37:52.530192 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:37:52.531191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.532190 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:37:52.533184 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:37:52.534170 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:37:52.546582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.548586 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:37:52.549585 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:37:52.549585 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:37:52.550585 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.555582 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:37:52.555582 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:37:52.557548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.559567 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:37:52.492214 => 17:37:52.559567
[0m17:37:52.559567 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:37:52.560567 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:37:52.561566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd97bb25-e7e0-4522-80c2-fcdf2dae80a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E792A1CD00>]}
[0m17:37:52.561566 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.08s]
[0m17:37:52.562548 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:37:52.563565 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:37:52.564560 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:37:52.565546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:37:52.565546 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:37:52.569543 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:37:52.571542 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:37:52.566545 => 17:37:52.570542
[0m17:37:52.571542 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:37:52.577538 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:37:52.578538 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:37:52.578538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:52.578538 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:37:52.579537 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:37:52.581537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.582550 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:37:52.583549 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:37:52.584416 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.589415 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:37:52.590414 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:37:52.592427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.596412 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:37:52.597410 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:37:52.599410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.601408 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:37:52.601408 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:37:52.602892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.603894 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:37:52.604892 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:37:52.605905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.606891 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:37:52.608891 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:37:52.608891 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:37:52.614889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.617887 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:37:52.617887 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:37:52.618886 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:37:52.620212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.624212 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:37:52.625211 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:37:52.627222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.630222 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:37:52.571542 => 17:37:52.630222
[0m17:37:52.631222 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:37:52.631222 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:37:52.632222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd97bb25-e7e0-4522-80c2-fcdf2dae80a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E79330CD60>]}
[0m17:37:52.633221 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.07s]
[0m17:37:52.634222 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:37:52.634222 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:37:52.635236 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:37:52.635930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:37:52.636946 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:37:52.640943 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:37:52.642930 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:37:52.636946 => 17:37:52.642930
[0m17:37:52.643931 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:37:52.650937 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:37:52.650937 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:37:52.651937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:52.651937 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:37:52.652936 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:37:52.653936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.654923 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:37:52.655922 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:37:52.655922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.662919 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:37:52.663931 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:37:52.666922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.669915 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:37:52.669915 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:37:52.670914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.672913 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:37:52.672913 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:37:52.673912 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.675914 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:37:52.676911 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:37:52.678908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.679931 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:37:52.681906 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:37:52.682911 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:37:52.701895 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.704893 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:37:52.705893 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:37:52.705893 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:37:52.706892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.712888 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:37:52.712888 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:37:52.715887 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:52.717885 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:37:52.644948 => 17:37:52.716886
[0m17:37:52.717885 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:37:52.718885 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:37:52.719884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd97bb25-e7e0-4522-80c2-fcdf2dae80a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E792FC5930>]}
[0m17:37:52.719884 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.08s]
[0m17:37:52.721883 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:37:52.723884 [debug] [MainThread]: On master: COMMIT
[0m17:37:52.725882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:52.725882 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:37:52.726880 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m17:37:52.726880 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:37:52.727881 [info ] [MainThread]: 
[0m17:37:52.728881 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m17:37:52.730877 [debug] [MainThread]: Command end result
[0m17:37:52.746869 [info ] [MainThread]: 
[0m17:37:52.748868 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:37:52.750871 [info ] [MainThread]: 
[0m17:37:52.751867 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102) (SQLMoreResults)")
[0m17:37:52.752866 [info ] [MainThread]: 
[0m17:37:52.752866 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:37:52.754865 [debug] [MainThread]: Command `dbt run` failed at 17:37:52.754865 after 1.84 seconds
[0m17:37:52.755863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78FB4ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E792B484C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E79331BE50>]}
[0m17:37:52.755863 [debug] [MainThread]: Flushing usage events
[0m17:38:24.246622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFC3CED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFECAA2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFECAA0E0>]}


============================== 17:38:24.253618 | f14f605d-91db-4424-983b-8b4125d64e9f ==============================
[0m17:38:24.253618 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:38:24.254617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:38:24.680390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f14f605d-91db-4424-983b-8b4125d64e9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFECAA380>]}
[0m17:38:24.806300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f14f605d-91db-4424-983b-8b4125d64e9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFF2A3E50>]}
[0m17:38:24.807299 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:38:24.831285 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:38:24.960211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:38:24.961229 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:38:25.196085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f14f605d-91db-4424-983b-8b4125d64e9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFF66C130>]}
[0m17:38:25.219065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f14f605d-91db-4424-983b-8b4125d64e9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFF61BD30>]}
[0m17:38:25.220065 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:38:25.222062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14f605d-91db-4424-983b-8b4125d64e9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFF61BE20>]}
[0m17:38:25.226079 [info ] [MainThread]: 
[0m17:38:25.228071 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:38:25.231056 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:38:25.254042 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:38:25.255043 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:38:25.256044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:25.256044 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:38:25.308013 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:38:25.308013 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:25.311010 [debug] [ThreadPool]: On list_online: Close
[0m17:38:25.313010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:38:25.314010 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:38:25.320006 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:38:25.321006 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:38:25.321006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:25.322005 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:38:25.322005 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:38:25.325004 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:25.327002 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:38:25.328002 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:38:25.331999 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m17:38:25.342994 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:38:25.342994 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:38:25.343993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:25.343993 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:38:25.344994 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:38:25.345992 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:25.346991 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:38:25.347991 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:38:25.348991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m17:38:25.351987 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:38:25.352987 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:38:25.352987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:25.352987 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:38:25.353986 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:38:25.354986 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:25.356986 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:38:25.356986 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:38:25.357985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14f605d-91db-4424-983b-8b4125d64e9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFF79AB30>]}
[0m17:38:25.358984 [debug] [MainThread]: On master: COMMIT
[0m17:38:25.359982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:25.359982 [info ] [MainThread]: 
[0m17:38:25.363982 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:38:25.364980 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:38:25.365979 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:38:25.366978 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:38:25.379970 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:38:25.380970 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:38:25.366978 => 17:38:25.380970
[0m17:38:25.381970 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:38:25.420950 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:38:25.420950 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:38:25.421949 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:38:25.422952 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:38:25.424948 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:38:25.425947 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.429944 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:38:25.430943 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:38:25.431942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.439937 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:38:25.439937 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:38:25.442935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.463923 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:38:25.464923 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:38:25.465923 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.469920 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:38:25.469920 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:38:25.470919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.476917 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:38:25.476917 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:38:25.477916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.481912 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:38:25.483911 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:38:25.483911 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:38:25.512899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.529904 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:38:25.534901 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:38:25.534901 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:38:25.535900 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.540878 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:38:25.540878 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:38:25.542879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.547874 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:38:25.381970 => 17:38:25.546875
[0m17:38:25.547874 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:38:25.548874 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:38:25.549873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14f605d-91db-4424-983b-8b4125d64e9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFF7F3700>]}
[0m17:38:25.549873 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.18s]
[0m17:38:25.550892 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:38:25.551886 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:38:25.551886 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:38:25.552872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:38:25.553885 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:38:25.557871 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:38:25.559867 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:38:25.553885 => 17:38:25.558887
[0m17:38:25.559867 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:38:25.567882 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:38:25.567882 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:38:25.568881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:25.568881 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:38:25.569881 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:38:25.571879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.573864 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:38:25.574862 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:38:25.575860 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.578857 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:38:25.579856 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:38:25.580856 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.581855 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:38:25.581855 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:38:25.582854 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.584853 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:38:25.585852 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:38:25.585852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.587851 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:38:25.588851 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:38:25.589851 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (

    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        CAST(try_cast(discount AS Decimal(10,4)) AS Discount,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Decimal(10,4)) as Profit,
        cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin


       

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:38:25.591852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.593849 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:38:25.560886 => 17:38:25.592867
[0m17:38:25.593849 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:38:25.594871 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:38:25.595861 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102) (SQLMoreResults)")
[0m17:38:25.599845 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102) (SQLMoreResults)")

[0m17:38:25.600854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14f605d-91db-4424-983b-8b4125d64e9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFF66C1C0>]}
[0m17:38:25.600854 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.05s]
[0m17:38:25.602845 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:38:25.602845 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:38:25.603843 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:38:25.604848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:38:25.605851 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:38:25.610840 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:38:25.612848 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:38:25.605851 => 17:38:25.611838
[0m17:38:25.613857 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:38:25.622831 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:38:25.623832 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:38:25.623832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:25.624832 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:38:25.625832 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:38:25.626830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.628830 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:38:25.629841 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:38:25.630850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.636823 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:38:25.637825 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:38:25.641821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.646820 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:38:25.647829 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:38:25.649816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.651815 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:38:25.652814 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:38:25.653813 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.655813 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:38:25.656818 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:38:25.657812 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.659811 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:38:25.661809 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:38:25.662809 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:38:25.677806 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.679799 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:38:25.680798 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:38:25.681804 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:38:25.682797 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.687794 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:38:25.688794 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:38:25.690797 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.692791 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:38:25.613857 => 17:38:25.692791
[0m17:38:25.693791 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:38:25.693791 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:38:25.694790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14f605d-91db-4424-983b-8b4125d64e9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFFB682E0>]}
[0m17:38:25.695790 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.09s]
[0m17:38:25.696797 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:38:25.697789 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:38:25.698789 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:38:25.699788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:38:25.700787 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:38:25.704785 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:38:25.706783 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:38:25.700787 => 17:38:25.706783
[0m17:38:25.707802 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:38:25.717778 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:38:25.718777 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:38:25.719778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:25.719778 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:38:25.720776 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:38:25.721775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.723775 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:38:25.724774 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:38:25.726772 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.735767 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:38:25.735767 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:38:25.738765 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.742763 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:38:25.742763 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:38:25.743762 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.745761 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:38:25.746760 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:38:25.747761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.749759 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:38:25.750758 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:38:25.751758 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.753757 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:38:25.754755 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:38:25.754755 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:38:25.761751 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.763751 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:38:25.764750 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:38:25.765749 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:38:25.766748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.772745 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:38:25.774750 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:38:25.777742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.779741 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:38:25.708801 => 17:38:25.779741
[0m17:38:25.780740 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:38:25.780740 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:38:25.781740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14f605d-91db-4424-983b-8b4125d64e9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFFB7C8B0>]}
[0m17:38:25.782739 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.08s]
[0m17:38:25.784738 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:38:25.785738 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:38:25.785738 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:38:25.786738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:38:25.787738 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:38:25.792735 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:38:25.793735 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:38:25.787738 => 17:38:25.793735
[0m17:38:25.794733 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:38:25.800729 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:38:25.801729 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:38:25.801729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:25.802728 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:38:25.802728 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:38:25.803728 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.805726 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:38:25.806726 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:38:25.807726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.811723 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:38:25.811723 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:38:25.815721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.817720 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:38:25.818719 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:38:25.820720 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.822718 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:38:25.822718 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:38:25.824717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.827715 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:38:25.827715 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:38:25.828714 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.830713 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:38:25.831713 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:38:25.832711 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:38:25.846829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.848849 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:38:25.849844 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:38:25.849844 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:38:25.851847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.855839 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:38:25.856840 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:38:25.860824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:25.862823 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:38:25.794733 => 17:38:25.862823
[0m17:38:25.863822 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:38:25.863822 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:38:25.864821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14f605d-91db-4424-983b-8b4125d64e9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFF6415A0>]}
[0m17:38:25.865821 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.08s]
[0m17:38:25.866820 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:38:25.868838 [debug] [MainThread]: On master: COMMIT
[0m17:38:25.869837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:25.869837 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:38:25.870837 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m17:38:25.870837 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:38:25.870837 [info ] [MainThread]: 
[0m17:38:25.871836 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m17:38:25.874817 [debug] [MainThread]: Command end result
[0m17:38:25.890807 [info ] [MainThread]: 
[0m17:38:25.892811 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:38:25.893806 [info ] [MainThread]: 
[0m17:38:25.894805 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102) (SQLMoreResults)")
[0m17:38:25.895804 [info ] [MainThread]: 
[0m17:38:25.895804 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:38:25.898802 [debug] [MainThread]: Command `dbt run` failed at 17:38:25.898802 after 1.75 seconds
[0m17:38:25.899801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFC3CED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFFB5F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFFB5FD90>]}
[0m17:38:25.899801 [debug] [MainThread]: Flushing usage events
[0m17:39:46.659182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6D1C8CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6FABA2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6FABA110>]}


============================== 17:39:46.665177 | 2dda68db-30d4-44ef-9cbd-10224b3cdcd0 ==============================
[0m17:39:46.665177 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:39:46.666177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:39:47.101674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dda68db-30d4-44ef-9cbd-10224b3cdcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6FABA3B0>]}
[0m17:39:47.204614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2dda68db-30d4-44ef-9cbd-10224b3cdcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE700AFE80>]}
[0m17:39:47.205614 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:39:47.221592 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:39:47.401494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:39:47.402488 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:39:47.626373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dda68db-30d4-44ef-9cbd-10224b3cdcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7047C1F0>]}
[0m17:39:47.641350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dda68db-30d4-44ef-9cbd-10224b3cdcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7042BD00>]}
[0m17:39:47.642351 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:39:47.643351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dda68db-30d4-44ef-9cbd-10224b3cdcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7042BD60>]}
[0m17:39:47.644351 [info ] [MainThread]: 
[0m17:39:47.646349 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:39:47.648346 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:39:47.669349 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:39:47.669349 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:39:47.670349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:47.670349 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:39:47.719325 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:39:47.720307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:39:47.721319 [debug] [ThreadPool]: On list_online: Close
[0m17:39:47.722318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:39:47.723318 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:39:47.731318 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:39:47.732318 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:39:47.732318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:47.732318 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:39:47.733317 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:39:47.736315 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:39:47.737315 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:39:47.737315 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:39:47.740313 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m17:39:47.748308 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:39:47.748308 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:39:47.749308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:47.749308 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:39:47.750307 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:39:47.751290 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:39:47.752306 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:39:47.752306 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:39:47.754305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m17:39:47.756304 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:39:47.757303 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:39:47.757303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:47.758303 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:39:47.759285 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:39:47.760284 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:39:47.761296 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:39:47.762301 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:39:47.763300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dda68db-30d4-44ef-9cbd-10224b3cdcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE705A76A0>]}
[0m17:39:47.763300 [debug] [MainThread]: On master: COMMIT
[0m17:39:47.764294 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:39:47.765281 [info ] [MainThread]: 
[0m17:39:47.768279 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:39:47.769291 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:39:47.770289 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:39:47.771291 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:39:47.781289 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:39:47.783269 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:39:47.771291 => 17:39:47.783269
[0m17:39:47.783269 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:39:47.812272 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:39:47.812272 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:39:47.813271 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:39:47.813271 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:39:47.814254 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:39:47.815608 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:47.818609 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:39:47.819608 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:39:47.820621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:47.828623 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:39:47.829618 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:39:47.832616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:47.851605 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:39:47.852605 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:39:47.853622 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:47.856602 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:39:47.857601 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:39:47.858344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:47.864362 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:39:47.864362 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:39:47.865361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:47.868359 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:39:47.869359 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:39:47.870341 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:39:47.879335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:47.896325 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:39:47.901322 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:39:47.901322 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:39:47.903320 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:47.908336 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:39:47.909337 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:39:47.911317 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:47.916333 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:39:47.784288 => 17:39:47.916333
[0m17:39:47.916333 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:39:47.917333 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:39:47.918317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dda68db-30d4-44ef-9cbd-10224b3cdcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE705FF730>]}
[0m17:39:47.919332 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.15s]
[0m17:39:47.920313 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:39:47.921311 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:39:47.922310 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:39:47.923309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:39:47.923309 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:39:47.927321 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:39:47.929306 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:39:47.924330 => 17:39:47.929306
[0m17:39:47.930324 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:39:47.937320 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:39:47.938320 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:39:47.938320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:47.939308 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:39:47.940319 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:39:47.942299 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:47.944298 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:39:47.945297 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:39:47.946297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:47.950308 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:39:47.950308 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:39:47.951307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:47.953292 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:39:47.953292 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:39:47.954292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:47.956304 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:39:47.956304 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:39:47.957304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:47.959288 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:39:47.960288 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:39:47.961288 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        CAST(try_cast(discount AS Decimal(10,4))) AS Discount,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Decimal(10,4)) as Profit,
        cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:39:47.964286 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:47.966285 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:39:47.930324 => 17:39:47.965286
[0m17:39:47.966285 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:39:47.967285 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:39:47.968284 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'CAST', expected 'AS'. (1035) (SQLMoreResults)")
[0m17:39:47.972639 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'CAST', expected 'AS'. (1035) (SQLMoreResults)")

[0m17:39:47.973653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dda68db-30d4-44ef-9cbd-10224b3cdcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE70458B50>]}
[0m17:39:47.973653 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.05s]
[0m17:39:47.975637 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:39:47.975637 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:39:47.976638 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:39:47.978637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:39:47.978637 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:39:47.983647 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:39:47.985634 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:39:47.979636 => 17:39:47.985634
[0m17:39:47.986644 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:39:47.995628 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:39:47.995628 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:39:47.996626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:47.997643 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:39:47.997643 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:39:47.998631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.000641 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:39:48.000641 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:39:48.001640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.005633 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:39:48.005633 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:39:48.008633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.012617 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:39:48.013617 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:39:48.014616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.016628 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:39:48.016628 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:39:48.018627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.020625 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:39:48.020625 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:39:48.021625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.022624 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:39:48.024609 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:39:48.024609 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:39:48.037668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.039684 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:39:48.040675 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:39:48.040675 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:39:48.041987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.046999 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:39:48.047999 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:39:48.049820 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.051834 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:39:47.986644 => 17:39:48.050836
[0m17:39:48.051834 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:39:48.052834 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:39:48.052834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dda68db-30d4-44ef-9cbd-10224b3cdcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE70964310>]}
[0m17:39:48.053833 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.08s]
[0m17:39:48.054824 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:39:48.055832 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:39:48.055832 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:39:48.056837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:39:48.057836 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:39:48.061834 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:39:48.062833 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:39:48.057836 => 17:39:48.062833
[0m17:39:48.063815 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:39:48.068830 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:39:48.069829 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:39:48.069829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:48.070828 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:39:48.071828 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:39:48.072809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.074808 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:39:48.074808 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:39:48.075807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.080819 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:39:48.081818 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:39:48.084543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.086557 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:39:48.087557 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:39:48.088920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.089922 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:39:48.090921 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:39:48.091822 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.093825 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:39:48.094824 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:39:48.095821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.096820 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:39:48.098819 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:39:48.098819 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:39:48.104367 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.106382 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:39:48.107382 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:39:48.107382 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:39:48.108381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.117375 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:39:48.118375 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:39:48.120453 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.122467 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:39:48.063815 => 17:39:48.121468
[0m17:39:48.122467 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:39:48.123466 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:39:48.123466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dda68db-30d4-44ef-9cbd-10224b3cdcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE70978160>]}
[0m17:39:48.124466 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.07s]
[0m17:39:48.125451 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:39:48.126451 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:39:48.127475 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:39:48.129450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:39:48.129450 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:39:48.133447 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:39:48.136446 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:39:48.130449 => 17:39:48.135446
[0m17:39:48.137445 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:39:48.147458 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:39:48.148439 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:39:48.149439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:48.149439 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:39:48.150457 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:39:48.151438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.154435 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:39:48.155443 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:39:48.156453 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.165430 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:39:48.166429 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:39:48.169428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.173424 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:39:48.174423 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:39:48.175423 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.178422 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:39:48.178422 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:39:48.180425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.183418 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:39:48.184420 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:39:48.185423 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.187416 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:39:48.188415 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:39:48.189415 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:39:48.203748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.205767 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:39:48.206767 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:39:48.207766 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:39:48.208762 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.216762 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:39:48.216762 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:39:48.218741 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:48.221740 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:39:48.138445 => 17:39:48.220740
[0m17:39:48.221740 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:39:48.222758 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:39:48.223758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dda68db-30d4-44ef-9cbd-10224b3cdcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE70663BB0>]}
[0m17:39:48.224752 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.10s]
[0m17:39:48.225737 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:39:48.227740 [debug] [MainThread]: On master: COMMIT
[0m17:39:48.228755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:48.228755 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:39:48.229755 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m17:39:48.229755 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:39:48.229755 [info ] [MainThread]: 
[0m17:39:48.230754 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m17:39:48.232733 [debug] [MainThread]: Command end result
[0m17:39:48.251723 [info ] [MainThread]: 
[0m17:39:48.253722 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:39:48.254726 [info ] [MainThread]: 
[0m17:39:48.255725 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'CAST', expected 'AS'. (1035) (SQLMoreResults)")
[0m17:39:48.256734 [info ] [MainThread]: 
[0m17:39:48.257719 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:39:48.260718 [debug] [MainThread]: Command `dbt run` failed at 17:39:48.259718 after 1.68 seconds
[0m17:39:48.261719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6D1C8CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7099FFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7099FA90>]}
[0m17:39:48.262718 [debug] [MainThread]: Flushing usage events
[0m17:40:25.961623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885639ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018858C7A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018858C7A0B0>]}


============================== 17:40:25.967619 | e08c19fb-0327-4b06-9b09-ae127d2295c3 ==============================
[0m17:40:25.967619 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:40:25.968619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:40:26.367756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e08c19fb-0327-4b06-9b09-ae127d2295c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018858C7A350>]}
[0m17:40:26.472682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e08c19fb-0327-4b06-9b09-ae127d2295c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018859405D20>]}
[0m17:40:26.472682 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:40:26.487676 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:40:26.611575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:40:26.612575 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:40:26.825436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e08c19fb-0327-4b06-9b09-ae127d2295c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885963C100>]}
[0m17:40:26.840426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e08c19fb-0327-4b06-9b09-ae127d2295c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188595EBD00>]}
[0m17:40:26.841426 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:40:26.842426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e08c19fb-0327-4b06-9b09-ae127d2295c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188595EBD90>]}
[0m17:40:26.844424 [info ] [MainThread]: 
[0m17:40:26.846422 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:40:26.848370 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:40:26.861361 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:40:26.862380 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:40:26.862380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:26.863379 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:26.908357 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:40:26.909358 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:26.910358 [debug] [ThreadPool]: On list_online: Close
[0m17:40:26.912371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:40:26.913358 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:40:26.919367 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:40:26.920367 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:40:26.920367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:26.921365 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:26.921365 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:40:26.924365 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:26.925349 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:40:26.926348 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:40:26.928347 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:40:26.935772 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:40:26.935772 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:40:26.936772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:26.936772 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:26.937771 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:40:26.938785 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:26.940780 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:40:26.940780 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:40:26.941770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:40:26.944769 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:40:26.945769 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:40:26.945769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:26.946768 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:26.946768 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:40:26.948247 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:26.949249 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:40:26.949249 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:40:26.950248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e08c19fb-0327-4b06-9b09-ae127d2295c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018858C7A380>]}
[0m17:40:26.951261 [debug] [MainThread]: On master: COMMIT
[0m17:40:26.952261 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:26.952702 [info ] [MainThread]: 
[0m17:40:26.956711 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:40:26.957702 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:40:26.958342 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:40:26.959353 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:40:26.969348 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:40:26.972350 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:40:26.959353 => 17:40:26.971337
[0m17:40:26.972350 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:40:27.001321 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:27.002332 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:40:27.002332 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:40:27.003339 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:27.003339 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:40:27.004317 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.009316 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:27.009316 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:40:27.010612 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.018610 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:27.019609 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:40:27.022458 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.041448 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:27.042448 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:27.043462 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.047445 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:27.047445 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:40:27.048453 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.053442 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:27.053442 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:27.054818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.056833 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:40:27.058818 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:27.058818 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:40:27.067169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.082176 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:40:27.086173 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:27.086173 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:40:27.087173 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.091170 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:27.092170 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:40:27.094242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.102240 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:40:26.972350 => 17:40:27.101241
[0m17:40:27.103239 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:40:27.104239 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:40:27.106237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e08c19fb-0327-4b06-9b09-ae127d2295c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188597C76D0>]}
[0m17:40:27.107237 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.15s]
[0m17:40:27.108236 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:40:27.109255 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:40:27.109255 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:40:27.110253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:40:27.111235 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:40:27.115232 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:40:27.117231 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:40:27.111235 => 17:40:27.117231
[0m17:40:27.117231 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:40:27.124227 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:27.124227 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:40:27.125226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:27.125226 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:27.126226 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:40:27.127244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.129243 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:27.130242 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:40:27.131223 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.134235 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:27.134235 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:27.135234 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.136234 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:27.137233 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:40:27.138219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.140231 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:27.140231 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:27.141217 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.142230 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:40:27.144234 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:27.144234 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        -- CAST(try_cast(discount AS Decimal(10,4))) AS Discount,
        cast(try_cast(order_quantity as float) as float) as OrderQuantity,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Decimal(10,4)) as Profit,
        cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:40:27.147214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.149237 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:40:27.118231 => 17:40:27.149237
[0m17:40:27.150214 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:40:27.151219 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:40:27.151219 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The column 'OrderQuantity' was specified multiple times for 'datatype_conversion'. (8156) (SQLMoreResults)")
[0m17:40:27.156210 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The column 'OrderQuantity' was specified multiple times for 'datatype_conversion'. (8156) (SQLMoreResults)")

[0m17:40:27.156210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e08c19fb-0327-4b06-9b09-ae127d2295c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188592D9030>]}
[0m17:40:27.157209 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.05s]
[0m17:40:27.158218 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:40:27.159206 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:40:27.160208 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:40:27.161208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:40:27.162219 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:40:27.167204 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:40:27.169202 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:40:27.162219 => 17:40:27.168204
[0m17:40:27.170202 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:40:27.178197 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:27.179205 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:40:27.179205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:27.180196 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:27.181197 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:40:27.182196 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.184212 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:27.185192 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:40:27.186206 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.191202 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:27.191202 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:40:27.245773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.248796 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:27.249796 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:27.250796 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.251795 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:27.252795 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:40:27.253816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.255817 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:27.255817 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:27.256928 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.257929 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:40:27.258928 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:27.259928 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:40:27.271832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.273847 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:40:27.274846 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:27.275845 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:40:27.276652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.280652 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:27.281651 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:40:27.283750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.285764 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:40:27.170202 => 17:40:27.284766
[0m17:40:27.285764 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:40:27.286763 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:40:27.286763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e08c19fb-0327-4b06-9b09-ae127d2295c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885926C460>]}
[0m17:40:27.287764 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.13s]
[0m17:40:27.288749 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:40:27.289749 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:40:27.289749 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:40:27.291761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:40:27.291761 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:40:27.295758 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:40:27.296759 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:40:27.291761 => 17:40:27.296759
[0m17:40:27.297758 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:40:27.305753 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:27.306753 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:40:27.307752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:27.307752 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:27.308752 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:40:27.309784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.310786 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:27.311785 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:40:27.312784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.317782 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:27.317782 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:40:27.321348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.324363 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:27.324363 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:27.325366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.326361 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:27.327360 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:40:27.328371 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.330366 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:27.330366 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:27.331346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.333344 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:40:27.334342 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:27.336357 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:40:27.341917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.343927 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:40:27.344926 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:27.345926 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:40:27.346915 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.353921 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:27.353921 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:40:27.356241 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.358256 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:40:27.298746 => 17:40:27.357257
[0m17:40:27.358256 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:40:27.359255 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:40:27.359255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e08c19fb-0327-4b06-9b09-ae127d2295c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018859B3C880>]}
[0m17:40:27.360255 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.07s]
[0m17:40:27.361254 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:40:27.362254 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:40:27.363247 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:40:27.364239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:40:27.365239 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:40:27.369236 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:40:27.370235 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:40:27.365239 => 17:40:27.370235
[0m17:40:27.371241 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:40:27.377232 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:27.378230 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:40:27.378230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:27.379230 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:27.379230 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:40:27.381229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.382228 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:27.383228 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:40:27.384243 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.389224 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:27.389224 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:40:27.392236 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.394235 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:27.395234 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:27.395234 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.397223 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:27.398219 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:40:27.399219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.401221 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:27.402219 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:27.403038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.404040 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:40:27.406047 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:27.406047 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:40:27.422029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.424042 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:40:27.425042 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:27.425042 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:40:27.426029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.431025 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:27.432025 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:40:27.435024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:27.437021 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:40:27.371241 => 17:40:27.437021
[0m17:40:27.438020 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:40:27.438020 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:40:27.439020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e08c19fb-0327-4b06-9b09-ae127d2295c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018859637AC0>]}
[0m17:40:27.440019 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.08s]
[0m17:40:27.441029 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:40:27.442037 [debug] [MainThread]: On master: COMMIT
[0m17:40:27.443017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:27.444017 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:40:27.444017 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:40:27.444017 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:40:27.445016 [info ] [MainThread]: 
[0m17:40:27.446017 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m17:40:27.448017 [debug] [MainThread]: Command end result
[0m17:40:27.470003 [info ] [MainThread]: 
[0m17:40:27.472003 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:40:27.473000 [info ] [MainThread]: 
[0m17:40:27.475001 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The column 'OrderQuantity' was specified multiple times for 'datatype_conversion'. (8156) (SQLMoreResults)")
[0m17:40:27.476009 [info ] [MainThread]: 
[0m17:40:27.476998 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:40:27.479016 [debug] [MainThread]: Command `dbt run` failed at 17:40:27.477997 after 1.59 seconds
[0m17:40:27.479016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885639ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018859B04490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018859B17D60>]}
[0m17:40:27.479996 [debug] [MainThread]: Flushing usage events
[0m17:40:42.810758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA55158CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA57A4A2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA57A4A110>]}


============================== 17:40:42.816750 | 4baf6e59-02fc-4d22-ad7b-8dae75a06b7c ==============================
[0m17:40:42.816750 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:40:42.817741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:40:43.211617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4baf6e59-02fc-4d22-ad7b-8dae75a06b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA57A4A3B0>]}
[0m17:40:43.314558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4baf6e59-02fc-4d22-ad7b-8dae75a06b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA5803FE80>]}
[0m17:40:43.314558 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:40:43.329550 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:40:43.456980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:40:43.457979 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:40:43.666841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4baf6e59-02fc-4d22-ad7b-8dae75a06b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA5840C1F0>]}
[0m17:40:43.681832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4baf6e59-02fc-4d22-ad7b-8dae75a06b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA583BBD00>]}
[0m17:40:43.682832 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:40:43.683831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4baf6e59-02fc-4d22-ad7b-8dae75a06b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA583BBD60>]}
[0m17:40:43.685831 [info ] [MainThread]: 
[0m17:40:43.686830 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:40:43.689444 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:40:43.702436 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:40:43.702436 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:40:43.703436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:43.703436 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:43.747798 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:40:43.748815 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:43.751808 [debug] [ThreadPool]: On list_online: Close
[0m17:40:43.752965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:40:43.753967 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:40:43.759963 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:40:43.760962 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:40:43.760962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:43.761961 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:43.761961 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:40:43.765370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:43.766369 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:40:43.766369 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:40:43.769074 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:40:43.778070 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:40:43.778070 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:40:43.779070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:43.779070 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:43.780069 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:40:43.781335 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:43.782336 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:40:43.782336 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:40:43.783335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:40:43.786334 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:40:43.787338 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:40:43.787338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:43.788332 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:43.788332 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:40:43.789345 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:43.791331 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:40:43.791331 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:40:43.792330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4baf6e59-02fc-4d22-ad7b-8dae75a06b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA57A4A3E0>]}
[0m17:40:43.792330 [debug] [MainThread]: On master: COMMIT
[0m17:40:43.793344 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:43.794425 [info ] [MainThread]: 
[0m17:40:43.798764 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:40:43.798764 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:40:43.800036 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:40:43.801053 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:40:43.812044 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:40:43.814030 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:40:43.801053 => 17:40:43.813045
[0m17:40:43.814030 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:40:43.845026 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:43.845026 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:40:43.846026 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:40:43.846026 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:43.847025 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:40:43.848024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:43.852010 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:43.853009 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:40:43.853824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:43.863835 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:43.863835 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:40:43.867233 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:43.887223 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:43.887223 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:43.889238 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:43.893220 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:43.894219 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:40:43.895183 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:43.900182 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:43.900182 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:43.901506 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:43.904506 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:40:43.906504 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:43.906504 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:40:43.914543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:43.929550 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:40:43.933548 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:43.934547 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:40:43.935551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:43.940530 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:43.940530 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:40:43.942529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:43.947525 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:40:43.815030 => 17:40:43.947525
[0m17:40:43.947525 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:40:43.948528 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:40:43.949543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4baf6e59-02fc-4d22-ad7b-8dae75a06b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA58593730>]}
[0m17:40:43.949543 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.15s]
[0m17:40:43.951538 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:40:43.951538 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:40:43.952542 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:40:43.953522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:40:43.954541 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:40:43.957539 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:40:43.959520 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:40:43.954541 => 17:40:43.959520
[0m17:40:43.960537 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:40:43.966534 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:43.966534 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:40:43.967514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:43.967514 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:43.968514 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:40:43.969514 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:43.971513 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:43.971513 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:40:43.973528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:43.976524 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:43.977523 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:43.978527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:43.979522 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:43.980521 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:40:43.981525 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:43.983519 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:43.984518 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:43.985017 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:43.986033 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:40:43.988018 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:43.989017 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        -- CAST(try_cast(discount AS Decimal(10,4))) AS Discount,
        cast(try_cast(order_quantity as float) as float) as OrderQuantity,
        cast(profit as Decimal(10,4)) as Profit,
        cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:40:43.995032 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:43.997026 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:40:43.960537 => 17:40:43.997026
[0m17:40:43.997026 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:40:43.998030 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:40:43.999030 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')
[0m17:40:44.002009 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')

[0m17:40:44.003008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4baf6e59-02fc-4d22-ad7b-8dae75a06b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA583EB190>]}
[0m17:40:44.004008 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.05s]
[0m17:40:44.006008 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:40:44.007029 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:40:44.008008 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:40:44.009007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:40:44.010020 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:40:44.014016 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:40:44.016001 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:40:44.010020 => 17:40:44.016001
[0m17:40:44.016001 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:40:44.026015 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:44.026015 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:40:44.026997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:44.028013 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:44.028013 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:40:44.029013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.031012 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:44.032011 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:40:44.032011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.036008 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:44.037008 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:40:44.041001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.044021 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:44.044021 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:44.045998 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.046998 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:44.047997 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:40:44.048984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.050995 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:44.050995 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:44.052007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.052995 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:40:44.054998 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:44.055979 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:40:44.068283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.070297 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:40:44.071299 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:44.072283 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:40:44.074296 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.079293 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:44.079293 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:40:44.081692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.083712 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:40:44.017019 => 17:40:44.082712
[0m17:40:44.083712 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:40:44.084711 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:40:44.084711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4baf6e59-02fc-4d22-ad7b-8dae75a06b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA58900310>]}
[0m17:40:44.085710 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.08s]
[0m17:40:44.086710 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:40:44.087691 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:40:44.088692 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:40:44.090689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:40:44.090689 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:40:44.095686 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:40:44.096686 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:40:44.090689 => 17:40:44.096686
[0m17:40:44.097685 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:40:44.103681 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:44.103681 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:40:44.104681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:44.104681 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:44.105681 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:40:44.107679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.109678 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:44.109678 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:40:44.110678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.116693 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:44.116693 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:40:44.118927 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.122925 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:44.122925 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:44.124927 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.126922 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:44.126922 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:40:44.128120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.130135 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:44.130135 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:44.131627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.132629 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:40:44.133628 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:44.134628 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:40:44.140564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.143563 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:40:44.144562 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:44.144562 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:40:44.146136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.153148 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:44.154149 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:40:44.156133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.160146 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:40:44.097685 => 17:40:44.159147
[0m17:40:44.160146 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:40:44.161147 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:40:44.162145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4baf6e59-02fc-4d22-ad7b-8dae75a06b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA5891C160>]}
[0m17:40:44.162145 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.07s]
[0m17:40:44.163133 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:40:44.164150 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:40:44.165130 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:40:44.165689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:40:44.166705 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:40:44.170702 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:40:44.172689 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:40:44.166705 => 17:40:44.172689
[0m17:40:44.173704 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:40:44.180696 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:44.180696 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:40:44.181696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:44.181696 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:44.182696 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:40:44.183683 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.185694 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:44.186692 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:40:44.187432 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.192431 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:44.193432 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:40:44.195924 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.198938 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:44.198938 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:44.199925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.201936 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:44.201936 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:40:44.202923 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.204934 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:44.204934 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:44.205931 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.207937 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:40:44.208937 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:44.209937 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:40:44.224631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.227643 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:40:44.228643 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:44.228643 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:40:44.229642 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.234639 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:44.234639 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:40:44.237159 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:44.239160 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:40:44.173704 => 17:40:44.239160
[0m17:40:44.240178 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:40:44.240178 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:40:44.241159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4baf6e59-02fc-4d22-ad7b-8dae75a06b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA585F3BB0>]}
[0m17:40:44.242172 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.08s]
[0m17:40:44.243165 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:40:44.245156 [debug] [MainThread]: On master: COMMIT
[0m17:40:44.246170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:44.247173 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:40:44.247173 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:40:44.247173 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:40:44.248168 [info ] [MainThread]: 
[0m17:40:44.248168 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m17:40:44.250167 [debug] [MainThread]: Command end result
[0m17:40:44.267155 [info ] [MainThread]: 
[0m17:40:44.268143 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:40:44.269462 [info ] [MainThread]: 
[0m17:40:44.270480 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')
[0m17:40:44.270480 [info ] [MainThread]: 
[0m17:40:44.271477 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:40:44.273462 [debug] [MainThread]: Command `dbt run` failed at 17:40:44.273462 after 1.54 seconds
[0m17:40:44.274461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA55158CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA5893EF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA5893DC90>]}
[0m17:40:44.274461 [debug] [MainThread]: Flushing usage events
[0m17:40:58.442614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233ECD3CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233EF61A2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233EF61A110>]}


============================== 17:40:58.448611 | 70105361-c990-4c50-95a5-96bbc721f4d4 ==============================
[0m17:40:58.448611 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:40:58.449610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:40:58.843124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70105361-c990-4c50-95a5-96bbc721f4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233EF61A3B0>]}
[0m17:40:58.945065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70105361-c990-4c50-95a5-96bbc721f4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233EFC0FE80>]}
[0m17:40:58.946065 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:40:58.959653 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:40:59.084577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:40:59.085576 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:40:59.306437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70105361-c990-4c50-95a5-96bbc721f4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233EFFE01F0>]}
[0m17:40:59.324425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70105361-c990-4c50-95a5-96bbc721f4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233EFF8BD60>]}
[0m17:40:59.324425 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:40:59.326443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70105361-c990-4c50-95a5-96bbc721f4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233EFF8BE50>]}
[0m17:40:59.327437 [info ] [MainThread]: 
[0m17:40:59.329441 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:40:59.331421 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:40:59.347427 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:40:59.347427 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:40:59.348427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:59.348427 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:59.394387 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:40:59.395387 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:59.397385 [debug] [ThreadPool]: On list_online: Close
[0m17:40:59.399383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:40:59.400383 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:40:59.405380 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:40:59.406380 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:40:59.406380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:59.407379 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:59.407379 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:40:59.410378 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:59.411377 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:40:59.412377 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:40:59.415375 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:40:59.423389 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:40:59.423389 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:40:59.424389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:59.424389 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:59.425387 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:40:59.426387 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:59.427367 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:40:59.428366 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:40:59.429365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:40:59.432363 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:40:59.433363 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:40:59.433363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:59.433363 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:59.434362 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:40:59.435371 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:59.436362 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:40:59.437380 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:40:59.438379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70105361-c990-4c50-95a5-96bbc721f4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233EF61A3E0>]}
[0m17:40:59.439361 [debug] [MainThread]: On master: COMMIT
[0m17:40:59.439361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:59.440361 [info ] [MainThread]: 
[0m17:40:59.444357 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:40:59.446357 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:40:59.447357 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:40:59.448356 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:40:59.460350 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:40:59.463346 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:40:59.448356 => 17:40:59.462354
[0m17:40:59.464345 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:40:59.494328 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:59.494328 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:40:59.495327 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:40:59.495327 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:59.496343 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:40:59.497327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.501342 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:59.502342 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:40:59.503323 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.511320 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:59.512332 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:40:59.515135 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.534126 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:59.535125 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:59.535965 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.539964 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:59.539964 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:40:59.541290 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.546289 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:59.547288 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:59.547684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.549700 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:40:59.551686 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:59.551686 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:40:59.559369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.574376 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:40:59.577374 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:59.578373 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:40:59.579359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.583370 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:40:59.584370 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:40:59.586277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.590290 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:40:59.464345 => 17:40:59.590290
[0m17:40:59.591290 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:40:59.591290 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:40:59.592289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70105361-c990-4c50-95a5-96bbc721f4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F015F730>]}
[0m17:40:59.593288 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.15s]
[0m17:40:59.594275 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:40:59.594275 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:40:59.595274 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:40:59.596274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:40:59.596274 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:40:59.600285 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:40:59.602271 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:40:59.597286 => 17:40:59.602271
[0m17:40:59.602271 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:40:59.609271 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:59.610266 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:40:59.611265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:59.612264 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:59.612264 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:40:59.614278 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.616275 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:59.616275 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:40:59.617307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.621320 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:59.621320 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:40:59.623698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.626716 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:59.626716 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:59.627697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.629707 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:59.630710 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:40:59.632876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.634892 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:59.634892 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:59.635817 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.636833 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:40:59.638818 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:40:59.638818 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        cast(profit as Decimal(10,4)) as Profit,
        cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:40:59.643983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.644983 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:40:59.603269 => 17:40:59.644983
[0m17:40:59.645974 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:40:59.645974 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:40:59.647977 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')
[0m17:40:59.651968 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')

[0m17:40:59.651968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70105361-c990-4c50-95a5-96bbc721f4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233EFFE00D0>]}
[0m17:40:59.652971 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.06s]
[0m17:40:59.653965 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:40:59.654964 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:40:59.654964 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:40:59.656963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:40:59.656963 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:40:59.661961 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:40:59.663950 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:40:59.656963 => 17:40:59.663950
[0m17:40:59.664949 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:40:59.672958 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:59.672958 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:40:59.673963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:59.673963 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:59.674962 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:40:59.675942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.679958 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:59.680957 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:40:59.681958 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.686936 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:59.686936 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:40:59.689934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.692932 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:59.693932 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:59.694930 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.696930 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:59.697929 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:40:59.698949 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.700941 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:59.700941 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:59.701940 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.703940 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:40:59.704925 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:59.704925 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:40:59.717729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.719730 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:40:59.720729 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:59.720729 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:40:59.795059 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.801073 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:40:59.801073 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:40:59.803259 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.805281 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:40:59.665969 => 17:40:59.804278
[0m17:40:59.805281 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:40:59.806279 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:40:59.806279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70105361-c990-4c50-95a5-96bbc721f4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233EFFE1810>]}
[0m17:40:59.807279 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.15s]
[0m17:40:59.808292 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:40:59.809309 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:40:59.809309 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:40:59.811309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:40:59.811309 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:40:59.815309 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:40:59.816292 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:40:59.811309 => 17:40:59.816292
[0m17:40:59.817289 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:40:59.824285 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:59.825286 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:40:59.826283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:59.826283 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:59.827283 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:40:59.828282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.831299 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:59.831299 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:40:59.832298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.839277 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:59.839277 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:40:59.841965 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.844966 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:59.844966 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:59.845965 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.847963 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:59.848984 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:40:59.849976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.851980 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:59.851980 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:40:59.852979 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.854959 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:40:59.855959 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:59.855959 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:40:59.862458 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.864438 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:40:59.865449 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:59.865449 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:40:59.932412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.937409 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:40:59.937409 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:40:59.940408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.941407 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:40:59.817289 => 17:40:59.941407
[0m17:40:59.942406 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:40:59.943405 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:40:59.943405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70105361-c990-4c50-95a5-96bbc721f4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F055CDC0>]}
[0m17:40:59.944405 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.13s]
[0m17:40:59.945391 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:40:59.946390 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:40:59.947403 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:40:59.948403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:40:59.948403 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:40:59.952400 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:40:59.953400 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:40:59.948403 => 17:40:59.953400
[0m17:40:59.954386 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:40:59.960401 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:59.961400 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:40:59.961400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:59.962400 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:40:59.963399 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:40:59.964493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.965494 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:59.966493 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:40:59.967408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:59.971407 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:40:59.971407 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:41:00.021512 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:41:00.023493 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:41:00.024493 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:41:00.025492 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:41:00.027491 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:41:00.028492 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:41:00.029490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:41:00.031489 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:41:00.031489 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:41:00.032488 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:41:00.034488 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:41:00.035486 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:41:00.036487 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:41:00.198379 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:41:00.208373 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:41:00.211369 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:41:00.214368 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:41:00.310309 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:41:00.315306 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:41:00.316306 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:41:00.318305 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:41:00.320303 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:40:59.954386 => 17:41:00.320303
[0m17:41:00.320303 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:41:00.321303 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:41:00.322303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70105361-c990-4c50-95a5-96bbc721f4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F01AF970>]}
[0m17:41:00.322303 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.37s]
[0m17:41:00.324302 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:41:00.326300 [debug] [MainThread]: On master: COMMIT
[0m17:41:00.326300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:00.327300 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:41:00.327300 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:41:00.328299 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:41:00.328299 [info ] [MainThread]: 
[0m17:41:00.329298 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m17:41:00.331298 [debug] [MainThread]: Command end result
[0m17:41:00.346289 [info ] [MainThread]: 
[0m17:41:00.348288 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:41:00.349289 [info ] [MainThread]: 
[0m17:41:00.349289 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')
[0m17:41:00.350286 [info ] [MainThread]: 
[0m17:41:00.351286 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:41:00.353284 [debug] [MainThread]: Command `dbt run` failed at 17:41:00.353284 after 1.99 seconds
[0m17:41:00.354284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233ECD3CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233EFD66680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F056D630>]}
[0m17:41:00.354284 [debug] [MainThread]: Flushing usage events
[0m17:42:03.772715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB8ADF5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABB3BA350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABB3BA170>]}


============================== 17:42:03.778712 | 95adf537-7f2d-4762-8bb0-f2e06e5b9040 ==============================
[0m17:42:03.778712 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:42:03.779710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:42:04.177135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95adf537-7f2d-4762-8bb0-f2e06e5b9040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABB3BA410>]}
[0m17:42:04.280089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95adf537-7f2d-4762-8bb0-f2e06e5b9040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABB9AFEE0>]}
[0m17:42:04.281088 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:42:04.295080 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:42:04.422473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:42:04.423472 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:42:04.648343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95adf537-7f2d-4762-8bb0-f2e06e5b9040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABBD7C250>]}
[0m17:42:04.664354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95adf537-7f2d-4762-8bb0-f2e06e5b9040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABBD2BDF0>]}
[0m17:42:04.665336 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:42:04.666343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95adf537-7f2d-4762-8bb0-f2e06e5b9040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABBD2BE50>]}
[0m17:42:04.668332 [info ] [MainThread]: 
[0m17:42:04.669341 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:42:04.671332 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:42:04.689341 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:42:04.689341 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:42:04.690339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:04.690339 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:42:04.736440 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:42:04.737432 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:42:04.739431 [debug] [ThreadPool]: On list_online: Close
[0m17:42:04.742431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:42:04.742431 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:42:04.748440 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:42:04.748440 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:42:04.749439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:04.749439 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:42:04.750439 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:42:04.754442 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:42:04.755458 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:42:04.756436 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:42:04.759433 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m17:42:04.765430 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:42:04.766429 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:42:04.766429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:04.767429 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:42:04.767429 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:42:04.768531 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:42:04.770545 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:42:04.770545 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:42:04.771545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m17:42:04.774543 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:42:04.774543 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:42:04.775543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:04.775543 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:42:04.776542 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:42:04.777528 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:42:04.778541 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:42:04.778541 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:42:04.779540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95adf537-7f2d-4762-8bb0-f2e06e5b9040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABBEA6B00>]}
[0m17:42:04.780540 [debug] [MainThread]: On master: COMMIT
[0m17:42:04.781544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:42:04.781544 [info ] [MainThread]: 
[0m17:42:04.785849 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:42:04.786850 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:42:04.787846 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:42:04.787846 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:42:04.796860 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:42:04.798841 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:42:04.788865 => 17:42:04.797859
[0m17:42:04.799859 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:42:04.828841 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:42:04.829841 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:42:04.829841 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:42:04.830841 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:42:04.831840 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:42:04.832823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:04.836821 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:42:04.837820 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:42:04.838818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:04.846815 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:42:04.847814 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:42:04.850390 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:04.870398 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:42:04.870398 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:42:04.871398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:04.875395 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:42:04.875395 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:42:04.876394 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:04.881392 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:42:04.882392 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:42:04.883372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:04.886373 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:42:04.887381 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:42:04.888383 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:42:04.895964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:04.910971 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:42:04.914968 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:42:04.915968 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:42:04.981930 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:04.985927 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:42:04.986927 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:42:04.989188 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:04.994187 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:42:04.799859 => 17:42:04.993187
[0m17:42:04.994187 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:42:04.994187 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:42:04.995187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95adf537-7f2d-4762-8bb0-f2e06e5b9040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABBEFF790>]}
[0m17:42:04.996186 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.21s]
[0m17:42:04.996927 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:42:04.997943 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:42:04.998929 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:42:04.999419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:42:05.000435 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:42:05.004436 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:42:05.005419 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:42:05.000435 => 17:42:05.005419
[0m17:42:05.005419 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:42:05.011427 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:42:05.012427 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:42:05.012427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:05.013426 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:42:05.013426 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:42:05.016413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.018411 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:42:05.018411 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:42:05.019411 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.024408 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:42:05.025407 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:42:05.028127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.030127 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:42:05.031126 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:42:05.031126 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.033125 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:42:05.034124 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:42:05.035693 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.037708 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:42:05.037708 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:42:05.040695 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.042702 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:42:05.044691 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:42:05.045709 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS FLOAT)                  AS sales
        , CAST(discount AS FLOAT)               AS discount
        , CAST(order_quantity AS INT)           AS order_quantity
        , CAST(profit AS FLOAT)                 AS profit
        , CAST(shipping_cost AS FLOAT)          AS shipping_cost
        , CAST(product_base_margin AS FLOAT)    AS product_base_margin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:42:05.051710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.052709 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:42:05.006431 => 17:42:05.052709
[0m17:42:05.053695 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:42:05.054702 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:42:05.055714 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to float. (8114) (SQLMoreResults)')
[0m17:42:05.059701 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to float. (8114) (SQLMoreResults)')

[0m17:42:05.060701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95adf537-7f2d-4762-8bb0-f2e06e5b9040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABBD768C0>]}
[0m17:42:05.061700 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.06s]
[0m17:42:05.062689 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:42:05.063699 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:42:05.063699 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:42:05.065698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:42:05.065698 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:42:05.069695 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:42:05.072695 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:42:05.065698 => 17:42:05.071702
[0m17:42:05.073694 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:42:05.082691 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:42:05.082691 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:42:05.083691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:05.084690 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:42:05.084690 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:42:05.086108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.088110 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:42:05.089109 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:42:05.090109 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.094106 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:42:05.095105 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:42:05.097655 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.100655 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:42:05.100655 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:42:05.101805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.102806 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:42:05.103805 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:42:05.104806 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.107817 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:42:05.108821 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:42:05.109804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.112819 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:42:05.113800 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:42:05.114800 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:42:05.127318 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.129319 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:42:05.130318 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:42:05.130318 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:42:05.201509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.206505 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:42:05.207505 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:42:05.209339 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.211353 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:42:05.073694 => 17:42:05.210355
[0m17:42:05.211353 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:42:05.212353 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:42:05.212353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95adf537-7f2d-4762-8bb0-f2e06e5b9040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABBD7F7C0>]}
[0m17:42:05.213352 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.15s]
[0m17:42:05.214338 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:42:05.215337 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:42:05.215337 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:42:05.216354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:42:05.217351 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:42:05.221335 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:42:05.223335 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:42:05.217351 => 17:42:05.222336
[0m17:42:05.223335 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:42:05.230344 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:42:05.231343 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:42:05.231343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:05.231343 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:42:05.232343 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:42:05.233632 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.234634 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:42:05.235633 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:42:05.236649 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.242629 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:42:05.243628 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:42:05.246403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.249413 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:42:05.249413 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:42:05.250404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.252403 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:42:05.253402 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:42:05.254420 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.256401 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:42:05.256401 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:42:05.258399 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.261398 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:42:05.262395 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:42:05.263395 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:42:05.268853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.270853 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:42:05.271863 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:42:05.272852 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:42:05.340813 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.345829 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:42:05.345829 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:42:05.348383 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.350402 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:42:05.223335 => 17:42:05.349398
[0m17:42:05.350402 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:42:05.351401 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:42:05.351401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95adf537-7f2d-4762-8bb0-f2e06e5b9040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABC30CE20>]}
[0m17:42:05.352400 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.14s]
[0m17:42:05.353401 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:42:05.354381 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:42:05.354381 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:42:05.356394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:42:05.356394 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:42:05.360396 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:42:05.362376 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:42:05.356394 => 17:42:05.362376
[0m17:42:05.363376 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:42:05.370385 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:42:05.370385 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:42:05.371371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:05.372371 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:42:05.373370 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:42:05.374369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.376388 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:42:05.376388 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:42:05.377386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.381384 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:42:05.382383 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:42:05.384608 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.386628 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:42:05.387627 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:42:05.388614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.390608 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:42:05.391607 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:42:05.392620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.394619 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:42:05.394619 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:42:05.396603 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.397604 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:42:05.399605 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:42:05.399605 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:42:05.416127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.418143 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:42:05.419137 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:42:05.419137 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:42:05.420140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.426134 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:42:05.426134 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:42:05.428658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:42:05.430669 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:42:05.363376 => 17:42:05.429670
[0m17:42:05.430669 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:42:05.431668 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:42:05.431668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95adf537-7f2d-4762-8bb0-f2e06e5b9040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABBF90040>]}
[0m17:42:05.432668 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.08s]
[0m17:42:05.433681 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:42:05.435667 [debug] [MainThread]: On master: COMMIT
[0m17:42:05.436665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:05.436665 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:42:05.436665 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m17:42:05.437665 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:42:05.437665 [info ] [MainThread]: 
[0m17:42:05.438655 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m17:42:05.441662 [debug] [MainThread]: Command end result
[0m17:42:05.456645 [info ] [MainThread]: 
[0m17:42:05.457662 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:42:05.458662 [info ] [MainThread]: 
[0m17:42:05.459660 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to float. (8114) (SQLMoreResults)')
[0m17:42:05.460644 [info ] [MainThread]: 
[0m17:42:05.461655 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:42:05.463651 [debug] [MainThread]: Command `dbt run` failed at 17:42:05.463651 after 1.77 seconds
[0m17:42:05.463651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB8ADF5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABBAD1AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABC31BCD0>]}
[0m17:42:05.464649 [debug] [MainThread]: Flushing usage events
[0m17:43:38.291062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E00ABF940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E0336A260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E0336A080>]}


============================== 17:43:38.298077 | 1da5bb99-9863-461f-9c38-fcbbb59da6b2 ==============================
[0m17:43:38.298077 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:43:38.299076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:43:38.886219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1da5bb99-9863-461f-9c38-fcbbb59da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E0336A320>]}
[0m17:43:38.988161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1da5bb99-9863-461f-9c38-fcbbb59da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E03BF5CF0>]}
[0m17:43:38.989161 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:43:39.014165 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:43:40.108602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:43:40.109602 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:43:40.317478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1da5bb99-9863-461f-9c38-fcbbb59da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E03E2C100>]}
[0m17:43:40.345694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1da5bb99-9863-461f-9c38-fcbbb59da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E03DDBDF0>]}
[0m17:43:40.346695 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:43:40.346695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1da5bb99-9863-461f-9c38-fcbbb59da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E03DDBE50>]}
[0m17:43:40.348693 [info ] [MainThread]: 
[0m17:43:40.349700 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:43:40.352691 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:43:40.364696 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:43:40.365695 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:43:40.365695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:40.365695 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:43:40.415262 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:43:40.416422 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:40.417424 [debug] [ThreadPool]: On list_online: Close
[0m17:43:40.419424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:43:40.420432 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:43:40.426418 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:43:40.426418 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:43:40.427418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:40.427418 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:43:40.428417 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:43:40.430416 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:40.431416 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:43:40.432415 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:43:40.434427 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m17:43:40.442409 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:43:40.443408 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:43:40.443408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:40.443408 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:43:40.444408 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:43:40.446130 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:40.447132 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:43:40.447132 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:43:40.448132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m17:43:40.451130 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:43:40.452129 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:43:40.452129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:40.453128 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:43:40.453128 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:43:40.454275 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:40.455291 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:43:40.456289 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:43:40.457332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1da5bb99-9863-461f-9c38-fcbbb59da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E03F56B00>]}
[0m17:43:40.457332 [debug] [MainThread]: On master: COMMIT
[0m17:43:40.458348 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:43:40.459347 [info ] [MainThread]: 
[0m17:43:40.463820 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:43:40.463820 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:43:40.465141 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:43:40.466162 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:43:40.477137 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:43:40.479142 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:43:40.466162 => 17:43:40.478149
[0m17:43:40.479142 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:43:40.511119 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:43:40.511119 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:43:40.512118 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:43:40.513117 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:43:40.513117 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:43:40.514116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.519114 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:43:40.519114 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:43:40.521133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.530107 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:43:40.530107 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:43:40.533322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.552313 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:43:40.553314 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:43:40.554313 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.558310 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:43:40.558310 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:43:40.559478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.564491 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:43:40.564491 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:43:40.565651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.568651 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:43:40.570650 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:43:40.571663 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:43:40.579094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.594085 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:43:40.598083 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:43:40.598083 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:43:40.599082 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.604079 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:43:40.604079 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:43:40.606260 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.610273 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:43:40.480154 => 17:43:40.610273
[0m17:43:40.611272 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:43:40.611272 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:43:40.612272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1da5bb99-9863-461f-9c38-fcbbb59da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E03FB36A0>]}
[0m17:43:40.613271 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.15s]
[0m17:43:40.614257 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:43:40.614257 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:43:40.615257 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:43:40.616266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:43:40.617255 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:43:40.620267 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:43:40.622252 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:43:40.617255 => 17:43:40.622252
[0m17:43:40.622252 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:43:40.628267 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:43:40.629266 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:43:40.629266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:40.630266 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:43:40.630266 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:43:40.633247 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.635264 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:43:40.635264 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:43:40.636263 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.642241 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:43:40.642241 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:43:40.645254 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.648252 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:43:40.648252 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:43:40.649251 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.650250 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:43:40.651250 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:43:40.653235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.656247 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:43:40.656247 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:43:40.657246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.659232 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:43:40.661230 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:43:40.661230 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        cast(try_cast(sales as float) as float) as Sales,
        cast(try_cast(order_quantity as float) as float) as OrderQuantity,
        cast(try_cast(profit as float) as float) as Profit,
        cast(try_cast(shipping_cost as float) as float) as ShippingCost,
        cast(try_cast(product_base_margin as float) as float) as ProductBaseMargin
 
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:43:40.688551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.690557 [debug] [Thread-1 (]: On model.online_shopping.stg_market: COMMIT
[0m17:43:40.691556 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:43:40.691556 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_market__dbt_backup'
  
[0m17:43:40.760750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.765749 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:43:40.765749 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:43:40.768076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.770090 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:43:40.623251 => 17:43:40.769091
[0m17:43:40.770090 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:43:40.771090 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:43:40.771090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1da5bb99-9863-461f-9c38-fcbbb59da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E03FEF580>]}
[0m17:43:40.772094 [info ] [Thread-1 (]: 2 of 5 OK created sql table model online.dbt_staging.stg_market ................ [[32mOK[0m in 0.15s]
[0m17:43:40.773093 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:43:40.774074 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:43:40.774074 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:43:40.775074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:43:40.776092 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:43:40.781084 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:43:40.782088 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:43:40.776092 => 17:43:40.782088
[0m17:43:40.783069 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:43:40.789090 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:43:40.789090 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:43:40.790083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:40.790083 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:43:40.791083 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:43:40.792082 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.794065 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:43:40.795076 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:43:40.795841 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.799841 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:43:40.800840 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:43:40.803252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.806253 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:43:40.807250 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:43:40.808249 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.810263 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:43:40.811261 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:43:40.812188 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.813190 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:43:40.814189 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:43:40.815115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.816117 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:43:40.817116 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:43:40.818115 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:43:40.830429 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.832443 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:43:40.833442 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:43:40.834442 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:43:40.834442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.840428 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:43:40.841424 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:43:40.843266 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.845277 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:43:40.783069 => 17:43:40.844277
[0m17:43:40.845277 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:43:40.846276 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:43:40.846276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1da5bb99-9863-461f-9c38-fcbbb59da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E03FEF580>]}
[0m17:43:40.847275 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.07s]
[0m17:43:40.848275 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:43:40.849274 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:43:40.850274 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:43:40.851264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:43:40.851264 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:43:40.856275 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:43:40.858265 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:43:40.852273 => 17:43:40.857270
[0m17:43:40.858265 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:43:40.865269 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:43:40.866268 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:43:40.866268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:40.867268 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:43:40.867268 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:43:40.868267 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.870252 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:43:40.871275 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:43:40.872269 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.876263 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:43:40.877262 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:43:40.880260 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.882259 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:43:40.883258 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:43:40.883258 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.885257 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:43:40.885257 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:43:40.886408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.888410 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:43:40.888410 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:43:40.889409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.891408 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:43:40.892414 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:43:40.893407 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:43:40.899202 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.901220 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:43:40.902217 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:43:40.902217 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:43:40.903218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.909200 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:43:40.910200 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:43:40.912222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.914215 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:43:40.858265 => 17:43:40.914215
[0m17:43:40.914215 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:43:40.915215 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:43:40.916214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1da5bb99-9863-461f-9c38-fcbbb59da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E03FEF580>]}
[0m17:43:40.916214 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.06s]
[0m17:43:40.917198 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:43:40.918209 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:43:40.919208 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:43:40.920192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:43:40.920192 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:43:40.925200 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:43:40.927208 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:43:40.921210 => 17:43:40.927208
[0m17:43:40.928204 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:43:40.934198 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:43:40.934198 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:43:40.935197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:40.935197 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:43:40.936202 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:43:40.937182 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.939182 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:43:40.939182 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:43:40.940181 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.945192 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:43:40.946192 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:43:40.948427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.950441 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:43:40.951441 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:43:40.951441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.953439 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:43:40.953439 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:43:40.954427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.956443 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:43:40.957442 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:43:40.958442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.960443 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:43:40.961423 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:43:40.962428 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:43:40.976864 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.979876 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:43:40.979876 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:43:40.980876 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:43:40.981664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.987682 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:43:40.988681 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:43:40.990917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:40.992931 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:43:40.928204 => 17:43:40.992931
[0m17:43:40.992931 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:43:40.993931 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:43:40.994930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1da5bb99-9863-461f-9c38-fcbbb59da6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E042EEFB0>]}
[0m17:43:40.994930 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.08s]
[0m17:43:40.996915 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:43:40.998322 [debug] [MainThread]: On master: COMMIT
[0m17:43:40.998322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:40.999320 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:43:40.999320 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m17:43:40.999320 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:43:41.000319 [info ] [MainThread]: 
[0m17:43:41.001305 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m17:43:41.003314 [debug] [MainThread]: Command end result
[0m17:43:41.017298 [info ] [MainThread]: 
[0m17:43:41.018296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:43:41.019315 [info ] [MainThread]: 
[0m17:43:41.020311 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:43:41.022294 [debug] [MainThread]: Command `dbt run` succeeded at 17:43:41.022294 after 2.83 seconds
[0m17:43:41.023293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E00ABF940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E03FEF580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E042EF5E0>]}
[0m17:43:41.023293 [debug] [MainThread]: Flushing usage events
[0m17:45:12.992930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C66DDF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C696BA320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C696BA140>]}


============================== 17:45:12.999925 | d453477f-0479-4168-9515-5611b0ba38aa ==============================
[0m17:45:12.999925 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:45:13.000378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:45:13.423303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd453477f-0479-4168-9515-5611b0ba38aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C696BA3E0>]}
[0m17:45:13.525243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd453477f-0479-4168-9515-5611b0ba38aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C69CAFEB0>]}
[0m17:45:13.526242 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:45:13.539969 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:45:13.663915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:45:13.665909 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:45:13.875776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd453477f-0479-4168-9515-5611b0ba38aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C6A080220>]}
[0m17:45:13.891766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd453477f-0479-4168-9515-5611b0ba38aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C6A02BE20>]}
[0m17:45:13.892765 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:45:13.893766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd453477f-0479-4168-9515-5611b0ba38aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C6A02BD90>]}
[0m17:45:13.895764 [info ] [MainThread]: 
[0m17:45:13.896763 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:45:13.898761 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:45:13.913755 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:45:13.913755 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:45:13.914753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:13.915752 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:13.959780 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:45:13.960769 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:45:13.963767 [debug] [ThreadPool]: On list_online: Close
[0m17:45:13.966766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:45:13.967766 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:45:13.973775 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:45:13.974775 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:45:13.974775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:13.974775 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:13.975774 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:45:13.978761 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:45:13.980773 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:45:13.980773 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:45:13.983419 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:45:13.990417 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:45:13.991416 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:45:13.991416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:13.991416 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:13.992416 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:45:13.994416 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:45:13.996416 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:45:13.996416 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:45:13.997414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:45:14.001412 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:45:14.002410 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:45:14.002410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:14.002410 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:14.003415 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:45:14.004409 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:45:14.006421 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:45:14.006421 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:45:14.007425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd453477f-0479-4168-9515-5611b0ba38aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C69D5DB10>]}
[0m17:45:14.008408 [debug] [MainThread]: On master: COMMIT
[0m17:45:14.010406 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:14.011404 [info ] [MainThread]: 
[0m17:45:14.016152 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:45:14.016152 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:45:14.018526 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:45:14.018526 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:45:14.028506 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:45:14.029519 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:45:14.018526 => 17:45:14.029519
[0m17:45:14.030505 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:45:14.058503 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:14.059502 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:45:14.059502 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:45:14.060501 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:14.061489 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:45:14.062488 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.067497 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:14.067497 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:45:14.068510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.077480 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:14.077480 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:45:14.081377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.103368 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:14.104367 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:14.105342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.108356 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:14.109357 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:45:14.110356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.115353 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:14.115353 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:14.116337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.118351 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:45:14.120336 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:14.120336 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:45:14.128070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.142074 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:45:14.146072 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:14.147072 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:45:14.148070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.152069 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:14.152069 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:45:14.154678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.158692 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:45:14.030505 => 17:45:14.158692
[0m17:45:14.159691 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:45:14.159691 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:45:14.160690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd453477f-0479-4168-9515-5611b0ba38aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C6A1FF940>]}
[0m17:45:14.161690 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.14s]
[0m17:45:14.162676 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:45:14.162676 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:45:14.163675 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:45:14.164694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:45:14.165674 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:45:14.170672 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:45:14.171672 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:45:14.165674 => 17:45:14.171672
[0m17:45:14.172670 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:45:14.178685 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:14.179680 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:45:14.179680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:14.180684 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:14.181683 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:45:14.182678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.183666 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:14.184682 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:45:14.185681 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.190659 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:14.191659 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:45:14.193562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.197562 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:14.198561 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:14.199614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.201629 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:14.201629 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:45:14.202628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.204628 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:14.204628 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:14.205613 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.207625 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:45:14.208611 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:14.209612 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Decimal(10,4)) as Profit,
        cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:45:14.215626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.216626 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:45:14.173669 => 17:45:14.216626
[0m17:45:14.217609 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:45:14.218606 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:45:14.219621 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')
[0m17:45:14.300731 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')

[0m17:45:14.301731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd453477f-0479-4168-9515-5611b0ba38aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C69D5DB10>]}
[0m17:45:14.301731 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.14s]
[0m17:45:14.303725 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:45:14.303725 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:45:14.304729 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:45:14.305724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:45:14.306723 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:45:14.310721 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:45:14.312705 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:45:14.306723 => 17:45:14.311720
[0m17:45:14.312705 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:45:14.321701 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:14.322700 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:45:14.323699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:14.324699 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:14.326698 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:45:14.327698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.332695 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:14.333695 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:45:14.334693 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.339691 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:14.340691 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:45:14.342690 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.345687 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:14.346687 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:14.347687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.349685 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:14.350684 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:45:14.351683 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.353682 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:14.353682 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:14.354686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.355681 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:45:14.357681 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:14.357681 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:45:14.372672 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.374670 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:45:14.375669 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:14.376669 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:45:14.377669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.383665 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:14.383665 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:45:14.385663 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.387662 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:45:14.312705 => 17:45:14.387662
[0m17:45:14.388662 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:45:14.388662 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:45:14.389661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd453477f-0479-4168-9515-5611b0ba38aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C696BA410>]}
[0m17:45:14.390660 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.08s]
[0m17:45:14.391059 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:45:14.392076 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:45:14.392076 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:45:14.394074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:45:14.394074 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:45:14.399076 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:45:14.401057 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:45:14.394074 => 17:45:14.400076
[0m17:45:14.401057 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:45:14.407067 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:14.408066 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:45:14.408066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:14.409065 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:14.409065 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:45:14.410280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.412283 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:14.412283 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:45:14.413282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.421294 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:14.422283 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:45:14.424664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.426684 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:14.427683 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:14.428682 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.430663 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:14.431681 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:45:14.433662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.435675 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:14.435675 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:14.436675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.437669 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:45:14.439676 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:14.439676 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:45:14.444711 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.446718 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:45:14.447715 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:14.448714 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:45:14.449713 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.454706 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:14.455705 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:45:14.457407 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.459422 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:45:14.401057 => 17:45:14.459422
[0m17:45:14.459422 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:45:14.460421 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:45:14.461424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd453477f-0479-4168-9515-5611b0ba38aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C6A64CFD0>]}
[0m17:45:14.461424 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.07s]
[0m17:45:14.463409 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:45:14.463409 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:45:14.464423 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:45:14.466418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:45:14.466418 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:45:14.470415 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:45:14.472419 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:45:14.466418 => 17:45:14.471414
[0m17:45:14.472419 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:45:14.478410 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:14.479396 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:45:14.479396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:14.480409 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:14.480409 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:45:14.481413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.483412 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:14.484393 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:45:14.485393 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.489403 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:14.489403 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:45:14.492608 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.494622 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:14.495622 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:14.496621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.498626 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:14.498626 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:45:14.499625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.502625 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:14.502625 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:14.504067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.505084 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:45:14.507067 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:14.507067 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:45:14.521198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.523212 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:45:14.524212 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:14.524212 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:45:14.525595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.530595 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:14.530595 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:45:14.533437 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:14.535451 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:45:14.472419 => 17:45:14.535451
[0m17:45:14.535451 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:45:14.536450 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:45:14.537449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd453477f-0479-4168-9515-5611b0ba38aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C6A267DC0>]}
[0m17:45:14.537449 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.07s]
[0m17:45:14.539449 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:45:14.540435 [debug] [MainThread]: On master: COMMIT
[0m17:45:14.541448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:14.541448 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:45:14.542447 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:45:14.542447 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:45:14.542447 [info ] [MainThread]: 
[0m17:45:14.543446 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m17:45:14.545446 [debug] [MainThread]: Command end result
[0m17:45:14.561423 [info ] [MainThread]: 
[0m17:45:14.562422 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:45:14.563421 [info ] [MainThread]: 
[0m17:45:14.564422 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')
[0m17:45:14.564422 [info ] [MainThread]: 
[0m17:45:14.565422 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:45:14.567420 [debug] [MainThread]: Command `dbt run` failed at 17:45:14.567420 after 1.66 seconds
[0m17:45:14.568419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C66DDF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C6A080070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C6A65E8C0>]}
[0m17:45:14.569422 [debug] [MainThread]: Flushing usage events
[0m17:45:36.791604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024049BFCCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404C4DA2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404C4DA110>]}


============================== 17:45:36.799584 | f6e97135-823a-4b81-ad60-22a054d019a7 ==============================
[0m17:45:36.799584 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:45:36.800583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:45:37.199893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6e97135-823a-4b81-ad60-22a054d019a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404C4DA3B0>]}
[0m17:45:37.303829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6e97135-823a-4b81-ad60-22a054d019a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404CACFE80>]}
[0m17:45:37.304814 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:45:37.318806 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:45:37.439140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:45:37.440139 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:45:37.656034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6e97135-823a-4b81-ad60-22a054d019a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404CE9C1F0>]}
[0m17:45:37.672007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6e97135-823a-4b81-ad60-22a054d019a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404CE4BD60>]}
[0m17:45:37.672007 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:45:37.673006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6e97135-823a-4b81-ad60-22a054d019a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404CE4BE50>]}
[0m17:45:37.675005 [info ] [MainThread]: 
[0m17:45:37.676004 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:45:37.679004 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:45:37.693994 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:45:37.694995 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:45:37.694995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:37.695995 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:37.739376 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:45:37.740271 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:45:37.741273 [debug] [ThreadPool]: On list_online: Close
[0m17:45:37.742272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:45:37.743271 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:45:37.749268 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:45:37.749268 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:45:37.749268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:37.750267 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:37.750267 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:45:37.753587 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:45:37.754588 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:45:37.754588 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:45:37.757171 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m17:45:37.764169 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:45:37.765168 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:45:37.765168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:37.765168 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:37.766168 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:45:37.767181 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:45:37.769166 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:45:37.769166 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:45:37.770166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m17:45:37.773164 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:45:37.773164 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:45:37.774163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:37.774163 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:37.775163 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:45:37.776119 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:45:37.777121 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:45:37.777121 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:45:37.778120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6e97135-823a-4b81-ad60-22a054d019a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404CFC76A0>]}
[0m17:45:37.779134 [debug] [MainThread]: On master: COMMIT
[0m17:45:37.780132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:37.780594 [info ] [MainThread]: 
[0m17:45:37.784215 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:45:37.785214 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:45:37.786215 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:45:37.787214 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:45:37.798220 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:45:37.800205 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:45:37.787214 => 17:45:37.799220
[0m17:45:37.801207 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:45:37.835199 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:37.835199 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:45:37.836198 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:45:37.836198 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:37.837198 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:45:37.838197 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:37.842181 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:37.842181 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:45:37.843098 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:37.851109 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:37.851109 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:45:37.854577 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:37.876568 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:37.876568 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:37.877567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:37.881564 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:37.882564 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:45:37.883565 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:37.888564 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:37.888564 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:37.889460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:37.891475 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:45:37.893469 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:37.893469 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:45:37.901802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:37.916806 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:45:37.919804 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:37.920803 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:45:37.922067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:37.926067 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:37.927066 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:45:37.928958 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:37.932971 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:45:37.801207 => 17:45:37.932971
[0m17:45:37.933970 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:45:37.933970 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:45:37.934970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6e97135-823a-4b81-ad60-22a054d019a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404D01F730>]}
[0m17:45:37.935969 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.15s]
[0m17:45:37.936955 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:45:37.936955 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:45:37.937954 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:45:37.938957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:45:37.939972 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:45:37.943969 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:45:37.944951 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:45:37.939972 => 17:45:37.944951
[0m17:45:37.945968 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:45:37.951965 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:37.951965 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:45:37.952964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:37.952964 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:37.953964 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:45:37.955944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:37.957963 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:37.958962 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:45:37.959943 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:37.964954 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:37.965953 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:45:37.968137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:37.970151 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:37.971137 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:37.972138 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:37.974166 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:37.974166 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:45:37.976060 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:37.978060 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:37.979079 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:37.980074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:37.981074 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:45:37.983059 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:37.983059 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        -- cast(order_quantity as int) as OrderQuantity,
        -- cast(profit as Decimal(10,4)) as Profit,
        -- cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        -- cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:45:37.985056 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:37.987073 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:45:37.945968 => 17:45:37.986072
[0m17:45:37.987073 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:45:37.988070 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:45:37.988070 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'FROM'. (156) (SQLMoreResults)")
[0m17:45:37.992073 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'FROM'. (156) (SQLMoreResults)")

[0m17:45:37.993069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6e97135-823a-4b81-ad60-22a054d019a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404CE31ED0>]}
[0m17:45:37.994068 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.05s]
[0m17:45:37.995053 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:45:37.996055 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:45:37.997052 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:45:37.998064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:45:37.999064 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:45:38.003062 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:45:38.005049 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:45:37.999064 => 17:45:38.005049
[0m17:45:38.005049 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:45:38.013044 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:38.014043 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:45:38.015042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:38.015042 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:38.016059 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:45:38.017058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.019039 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:38.019039 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:45:38.020038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.024049 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:38.024049 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:45:38.026700 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.029700 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:38.030718 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:38.031700 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.033712 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:38.033712 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:45:38.034711 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.036710 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:38.036710 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:38.037858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.038874 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:45:38.039873 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:38.040877 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:45:38.052629 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.054645 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:45:38.055644 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:38.055644 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:45:38.056888 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.060901 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:38.061887 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:45:38.064899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.066897 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:45:38.006065 => 17:45:38.065899
[0m17:45:38.066897 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:45:38.067897 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:45:38.067897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6e97135-823a-4b81-ad60-22a054d019a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404CE729B0>]}
[0m17:45:38.068896 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.07s]
[0m17:45:38.069896 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:45:38.070882 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:45:38.070882 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:45:38.072895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:45:38.072895 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:45:38.076896 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:45:38.078878 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:45:38.072895 => 17:45:38.077896
[0m17:45:38.078878 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:45:38.086891 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:38.086891 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:45:38.087886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:38.087886 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:38.088890 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:45:38.089458 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.091473 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:38.091473 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:45:38.092500 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.099512 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:38.099512 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:45:38.101497 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.104509 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:38.104509 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:38.105508 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.107507 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:38.107507 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:45:38.108493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.109506 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:38.110505 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:38.111505 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.113509 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:45:38.115489 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:38.115489 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:45:38.120799 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.122817 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:45:38.123816 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:38.123816 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:45:38.124876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.129890 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:38.130874 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:45:38.132579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.134589 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:45:38.079895 => 17:45:38.133590
[0m17:45:38.134589 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:45:38.135589 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:45:38.135589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6e97135-823a-4b81-ad60-22a054d019a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404D46CDC0>]}
[0m17:45:38.136589 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.06s]
[0m17:45:38.137587 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:45:38.138577 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:45:38.138577 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:45:38.140586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:45:38.140586 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:45:38.144587 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:45:38.146588 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:45:38.140586 => 17:45:38.145577
[0m17:45:38.146588 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:45:38.152584 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:38.153583 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:45:38.153583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:38.154586 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:38.154586 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:45:38.155700 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.157715 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:38.157715 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:45:38.158701 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.164699 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:38.165698 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:45:38.167940 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.169955 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:38.170954 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:38.171953 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.172952 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:38.173952 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:45:38.174953 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.176963 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:38.177954 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:38.178935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.179955 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:45:38.181934 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:38.181934 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:45:38.195679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.198687 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:45:38.199687 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:38.199687 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:45:38.200685 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.204685 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:38.205683 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:45:38.207775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:38.209789 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:45:38.147587 => 17:45:38.208791
[0m17:45:38.209789 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:45:38.210789 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:45:38.210789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6e97135-823a-4b81-ad60-22a054d019a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404D06D8D0>]}
[0m17:45:38.211775 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.07s]
[0m17:45:38.213787 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:45:38.214773 [debug] [MainThread]: On master: COMMIT
[0m17:45:38.215787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:38.215787 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:45:38.216785 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m17:45:38.216785 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:45:38.217784 [info ] [MainThread]: 
[0m17:45:38.218770 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m17:45:38.220793 [debug] [MainThread]: Command end result
[0m17:45:38.236760 [info ] [MainThread]: 
[0m17:45:38.237760 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:45:38.238759 [info ] [MainThread]: 
[0m17:45:38.238759 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'FROM'. (156) (SQLMoreResults)")
[0m17:45:38.239769 [info ] [MainThread]: 
[0m17:45:38.240758 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:45:38.242768 [debug] [MainThread]: Command `dbt run` failed at 17:45:38.242768 after 1.53 seconds
[0m17:45:38.243766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024049BFCCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404CC2A680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404D47A740>]}
[0m17:45:38.243766 [debug] [MainThread]: Flushing usage events
[0m17:45:56.757538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB7F3ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBA81A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBA81A0B0>]}


============================== 17:45:56.764548 | a36c3633-0aa1-4695-b519-4568d0e455c9 ==============================
[0m17:45:56.764548 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:45:56.765698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:45:57.170854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a36c3633-0aa1-4695-b519-4568d0e455c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBA81A350>]}
[0m17:45:57.280796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a36c3633-0aa1-4695-b519-4568d0e455c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBAFA1D20>]}
[0m17:45:57.280796 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:45:57.295788 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:45:57.434707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:45:57.435706 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:45:57.667574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a36c3633-0aa1-4695-b519-4568d0e455c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBB1DC100>]}
[0m17:45:57.686544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a36c3633-0aa1-4695-b519-4568d0e455c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBB18BD00>]}
[0m17:45:57.687544 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:45:57.688544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a36c3633-0aa1-4695-b519-4568d0e455c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBB18BD90>]}
[0m17:45:57.689543 [info ] [MainThread]: 
[0m17:45:57.691541 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:45:57.693555 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:45:57.708546 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:45:57.709545 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:45:57.709545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:57.710544 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:57.755977 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:45:57.756967 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:45:57.757977 [debug] [ThreadPool]: On list_online: Close
[0m17:45:57.759975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:45:57.760975 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:45:57.765976 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:45:57.766974 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:45:57.766974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:57.767974 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:57.767974 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:45:57.770972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:45:57.771972 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:45:57.771972 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:45:57.774642 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m17:45:57.782639 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:45:57.782639 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:45:57.783638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:57.783638 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:57.784638 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:45:57.785638 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:45:57.786655 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:45:57.786655 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:45:57.787650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m17:45:57.790648 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:45:57.791647 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:45:57.791647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:57.792647 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:57.792647 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:45:57.794291 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:45:57.795293 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:45:57.795293 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:45:57.796292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a36c3633-0aa1-4695-b519-4568d0e455c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBB30B550>]}
[0m17:45:57.797305 [debug] [MainThread]: On master: COMMIT
[0m17:45:57.797305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:57.798305 [info ] [MainThread]: 
[0m17:45:57.802613 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:45:57.803625 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:45:57.804614 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:45:57.805624 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:45:57.815626 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:45:57.817606 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:45:57.805624 => 17:45:57.816622
[0m17:45:57.817606 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:45:57.846603 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:57.847591 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:45:57.848603 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:45:57.848603 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:57.849606 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:45:57.850588 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:57.855598 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:57.856598 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:45:57.857597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:57.864581 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:57.865580 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:45:57.868486 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:57.890477 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:57.891476 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:57.892476 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:57.895473 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:57.896474 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:45:57.897478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:57.902482 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:57.903482 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:57.904108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:57.907109 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:45:57.908108 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:57.909107 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:45:57.915481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:57.930467 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:45:57.934465 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:57.935464 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:45:57.936464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:57.940462 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:45:57.940462 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:45:57.942854 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:57.947872 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:45:57.817606 => 17:45:57.946854
[0m17:45:57.947872 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:45:57.948853 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:45:57.949852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a36c3633-0aa1-4695-b519-4568d0e455c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBB3636D0>]}
[0m17:45:57.949852 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.14s]
[0m17:45:57.950851 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:45:57.951851 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:45:57.952850 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:45:57.953868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:45:57.953868 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:45:57.957847 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:45:57.959848 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:45:57.954849 => 17:45:57.958847
[0m17:45:57.960864 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:45:57.969853 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:57.970854 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:45:57.971858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:57.971858 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:57.972857 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:45:57.974850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:57.976865 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:57.976865 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:45:57.977855 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:57.980849 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:57.981866 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:57.982866 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:57.983866 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:57.984866 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:45:57.985847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:57.987864 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:57.988863 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:57.989844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:57.990857 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:45:57.992841 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:45:57.992841 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        -- CAST(sales AS Decimal(10,4)) AS Sales,
        cast(order_quantity as int) as OrderQuantity,
        -- cast(profit as Decimal(10,4)) as Profit,
        -- cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        -- cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:45:57.994854 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:57.995854 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:45:57.960864 => 17:45:57.994854
[0m17:45:57.995854 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:45:57.996853 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:45:57.997839 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'FROM'. (156) (SQLMoreResults)")
[0m17:45:58.001838 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'FROM'. (156) (SQLMoreResults)")

[0m17:45:58.002837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a36c3633-0aa1-4695-b519-4568d0e455c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBAE79030>]}
[0m17:45:58.002837 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.05s]
[0m17:45:58.003837 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:45:58.004837 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:45:58.005835 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:45:58.006835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:45:58.007833 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:45:58.011831 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:45:58.012830 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:45:58.007833 => 17:45:58.012830
[0m17:45:58.013830 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:45:58.022825 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:58.023824 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:45:58.024823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:58.024823 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:58.025823 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:45:58.026822 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.028835 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:58.028835 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:45:58.029821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.034833 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:58.035831 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:45:58.037884 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.040898 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:58.040898 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:58.041898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.043897 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:58.043897 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:45:58.044871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.046886 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:58.046886 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:58.048871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.049874 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:45:58.051871 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:58.051871 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:45:58.063406 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.065420 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:45:58.066419 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:58.066419 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:45:58.067419 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.072416 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:45:58.072416 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:45:58.074534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.076549 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:45:58.013830 => 17:45:58.075550
[0m17:45:58.076549 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:45:58.076549 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:45:58.077548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a36c3633-0aa1-4695-b519-4568d0e455c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBB6E02B0>]}
[0m17:45:58.078533 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.07s]
[0m17:45:58.079539 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:45:58.080547 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:45:58.080547 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:45:58.081533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:45:58.082546 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:45:58.086548 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:45:58.088528 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:45:58.082546 => 17:45:58.087529
[0m17:45:58.088528 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:45:58.094538 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:58.095543 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:45:58.095543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:58.096542 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:58.096542 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:45:58.097541 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.099522 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:58.100542 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:45:58.101535 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.106532 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:58.106532 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:45:58.109166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.111181 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:58.112180 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:58.112180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.114179 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:58.115166 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:45:58.116163 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.118162 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:58.119162 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:58.120162 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.121175 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:45:58.123160 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:58.123160 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:45:58.128336 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.130351 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:45:58.131341 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:58.132354 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:45:58.133335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.140350 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:45:58.141350 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:45:58.143159 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.145174 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:45:58.089546 => 17:45:58.144174
[0m17:45:58.145174 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:45:58.146173 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:45:58.146173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a36c3633-0aa1-4695-b519-4568d0e455c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBB6F8880>]}
[0m17:45:58.147172 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.06s]
[0m17:45:58.149172 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:45:58.149172 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:45:58.150158 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:45:58.151173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:45:58.152170 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:45:58.156167 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:45:58.158152 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:45:58.152170 => 17:45:58.157166
[0m17:45:58.158152 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:45:58.165167 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:58.166166 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:45:58.166166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:58.167165 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:45:58.167165 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:45:58.169166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.171158 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:58.172158 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:45:58.173040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.177041 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:58.178040 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:45:58.180040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.184037 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:58.184037 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:58.185038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.187051 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:58.188048 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:45:58.189047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.191046 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:58.191046 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:45:58.192163 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.193164 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:45:58.194163 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:58.195163 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:45:58.209880 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.212868 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:45:58.212868 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:58.213867 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:45:58.214669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.219683 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:45:58.219683 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:45:58.222241 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:45:58.224255 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:45:58.158152 => 17:45:58.223256
[0m17:45:58.224255 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:45:58.225255 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:45:58.225255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a36c3633-0aa1-4695-b519-4568d0e455c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBB1D4F70>]}
[0m17:45:58.226254 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.07s]
[0m17:45:58.227286 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:45:58.229437 [debug] [MainThread]: On master: COMMIT
[0m17:45:58.229437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:58.230436 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:45:58.230436 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m17:45:58.231440 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:45:58.231440 [info ] [MainThread]: 
[0m17:45:58.232446 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m17:45:58.234466 [debug] [MainThread]: Command end result
[0m17:45:58.249440 [info ] [MainThread]: 
[0m17:45:58.251438 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:45:58.252446 [info ] [MainThread]: 
[0m17:45:58.253447 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'FROM'. (156) (SQLMoreResults)")
[0m17:45:58.254440 [info ] [MainThread]: 
[0m17:45:58.255436 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:45:58.257434 [debug] [MainThread]: Command `dbt run` failed at 17:45:58.257434 after 1.59 seconds
[0m17:45:58.258433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB7F3ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBB6D7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBB6D7C40>]}
[0m17:45:58.258433 [debug] [MainThread]: Flushing usage events
[0m17:46:34.215745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF326CECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF34FAA290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF34FAA0B0>]}


============================== 17:46:34.221743 | 2e05ecad-1f06-4ce0-b06a-169b03d1856d ==============================
[0m17:46:34.221743 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:46:34.223742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:46:34.620150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e05ecad-1f06-4ce0-b06a-169b03d1856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF34FAA350>]}
[0m17:46:34.724104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e05ecad-1f06-4ce0-b06a-169b03d1856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF35735D20>]}
[0m17:46:34.725104 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:46:34.739082 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:46:34.854017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:46:34.854017 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:46:35.069894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e05ecad-1f06-4ce0-b06a-169b03d1856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3596C100>]}
[0m17:46:35.085885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e05ecad-1f06-4ce0-b06a-169b03d1856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3591BF70>]}
[0m17:46:35.086883 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:46:35.087941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e05ecad-1f06-4ce0-b06a-169b03d1856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3559FCD0>]}
[0m17:46:35.089960 [info ] [MainThread]: 
[0m17:46:35.090941 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:46:35.092948 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:46:35.106932 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:46:35.107931 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:46:35.107931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:35.108930 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:35.153893 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:46:35.154839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:46:35.155841 [debug] [ThreadPool]: On list_online: Close
[0m17:46:35.157840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:46:35.157840 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:46:35.164835 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:46:35.164835 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:46:35.164835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:35.165835 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:35.165835 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:46:35.168833 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:46:35.169833 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:46:35.169833 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:46:35.172679 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:46:35.179675 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:46:35.180674 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:46:35.180674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:35.180674 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:35.181674 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:46:35.182674 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:46:35.183687 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:46:35.184686 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:46:35.185685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:46:35.187684 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:46:35.188684 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:46:35.188684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:35.188684 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:35.189683 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:46:35.190669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:46:35.191683 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:46:35.191683 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:46:35.192681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e05ecad-1f06-4ce0-b06a-169b03d1856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF34FAA380>]}
[0m17:46:35.193669 [debug] [MainThread]: On master: COMMIT
[0m17:46:35.194668 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:46:35.194668 [info ] [MainThread]: 
[0m17:46:35.199441 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:46:35.199441 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:46:35.201440 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:46:35.202439 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:46:35.216445 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:46:35.217432 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:46:35.202439 => 17:46:35.217432
[0m17:46:35.218444 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:46:35.256408 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:35.257407 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:46:35.257407 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:46:35.258407 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:35.258407 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:46:35.259407 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.264417 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:35.264417 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:46:35.266032 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.273030 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:35.273030 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:46:35.276803 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.298793 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:35.299793 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:35.300684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.303698 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:35.304698 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:46:35.305697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.310681 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:35.310681 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:35.311701 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.313693 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:46:35.315678 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:35.315678 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:46:35.323050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.338057 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:46:35.341056 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:35.342055 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:46:35.343041 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.347052 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:35.348051 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:46:35.349628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.354641 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:46:35.219443 => 17:46:35.353629
[0m17:46:35.354641 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:46:35.355640 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:46:35.355640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e05ecad-1f06-4ce0-b06a-169b03d1856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF35AF36D0>]}
[0m17:46:35.356640 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.16s]
[0m17:46:35.357627 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:46:35.358625 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:46:35.358625 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:46:35.359638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:46:35.360638 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:46:35.364640 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:46:35.365621 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:46:35.360638 => 17:46:35.365621
[0m17:46:35.366640 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:46:35.372617 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:46:35.373617 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:46:35.373617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:35.374635 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:35.374635 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:46:35.375635 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.378614 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:46:35.378614 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:46:35.379833 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.382847 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:46:35.382847 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:35.383846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.385850 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:46:35.385850 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:46:35.386850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.388843 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:46:35.389843 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:35.389843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.390842 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:46:35.392829 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:46:35.392829 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        -- cast(order_quantity as int) as OrderQuantity,
        -- cast(profit as Decimal(10,4)) as Profit,
        -- cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        -- cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:46:35.394827 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.396839 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:46:35.366640 => 17:46:35.396839
[0m17:46:35.396839 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:46:35.397843 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:46:35.398844 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'FROM'. (156) (SQLMoreResults)")
[0m17:46:35.401824 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'FROM'. (156) (SQLMoreResults)")

[0m17:46:35.402823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e05ecad-1f06-4ce0-b06a-169b03d1856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3594AC20>]}
[0m17:46:35.403822 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.04s]
[0m17:46:35.404821 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:46:35.405822 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:46:35.405822 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:46:35.406839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:46:35.407838 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:46:35.412833 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:46:35.414815 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:46:35.407838 => 17:46:35.414815
[0m17:46:35.415829 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:46:35.423823 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:35.423823 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:46:35.424823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:35.424823 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:35.425823 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:46:35.427032 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.429033 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:35.430033 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:46:35.431035 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.436029 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:35.436029 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:46:35.439067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.441080 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:35.442080 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:35.442976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.443978 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:35.444978 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:46:35.446979 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.449988 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:35.449988 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:35.450987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.451974 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:46:35.453972 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:35.453972 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:46:35.466352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.468355 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:46:35.469355 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:35.470354 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:46:35.471353 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.475351 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:35.475351 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:46:35.477692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.480703 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:46:35.415829 => 17:46:35.479703
[0m17:46:35.480703 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:46:35.481702 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:46:35.481702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e05ecad-1f06-4ce0-b06a-169b03d1856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF35F242B0>]}
[0m17:46:35.482701 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.07s]
[0m17:46:35.483699 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:46:35.484690 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:46:35.484690 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:46:35.485703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:46:35.486699 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:46:35.490696 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:46:35.492723 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:46:35.486699 => 17:46:35.491696
[0m17:46:35.492723 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:46:35.501690 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:35.501690 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:46:35.502690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:35.502690 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:35.503689 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:46:35.504678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.506691 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:35.506691 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:46:35.507691 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.513687 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:35.513687 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:46:35.517319 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.520334 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:35.520334 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:35.521328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.522335 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:35.523333 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:46:35.524331 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.526331 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:35.526331 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:35.527724 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.528727 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:46:35.530724 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:35.531723 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:46:35.537122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.539123 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:46:35.540122 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:35.540122 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:46:35.541122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.547118 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:35.548118 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:46:35.550124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.552138 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:46:35.493703 => 17:46:35.551139
[0m17:46:35.552138 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:46:35.553142 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:46:35.553142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e05ecad-1f06-4ce0-b06a-169b03d1856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF35F3C880>]}
[0m17:46:35.554141 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.07s]
[0m17:46:35.555133 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:46:35.556122 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:46:35.556122 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:46:35.558135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:46:35.558135 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:46:35.562123 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:46:35.564118 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:46:35.558135 => 17:46:35.564118
[0m17:46:35.565131 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:46:35.571127 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:35.571127 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:46:35.571127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:35.572126 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:35.573131 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:46:35.574131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.576124 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:35.576124 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:46:35.577096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.582114 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:35.582114 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:46:35.584876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.586905 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:35.587894 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:35.588876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.590874 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:35.590874 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:46:35.591873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.592873 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:35.593874 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:35.594873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.595872 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:46:35.597870 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:35.598883 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:46:35.612757 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.615759 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:46:35.615759 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:35.616758 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:46:35.617770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.622755 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:35.622755 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:46:35.624838 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:35.626835 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:46:35.565131 => 17:46:35.626835
[0m17:46:35.626835 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:46:35.627835 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:46:35.628839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e05ecad-1f06-4ce0-b06a-169b03d1856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF359678E0>]}
[0m17:46:35.629834 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.07s]
[0m17:46:35.630391 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:46:35.632406 [debug] [MainThread]: On master: COMMIT
[0m17:46:35.632406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:35.633405 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:46:35.633405 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:46:35.634405 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:46:35.634405 [info ] [MainThread]: 
[0m17:46:35.635391 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m17:46:35.637408 [debug] [MainThread]: Command end result
[0m17:46:35.654381 [info ] [MainThread]: 
[0m17:46:35.655381 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:46:35.656398 [info ] [MainThread]: 
[0m17:46:35.656398 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'FROM'. (156) (SQLMoreResults)")
[0m17:46:35.657392 [info ] [MainThread]: 
[0m17:46:35.658377 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:46:35.660387 [debug] [MainThread]: Command `dbt run` failed at 17:46:35.660387 after 1.52 seconds
[0m17:46:35.660387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF326CECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3599A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF35F1BC40>]}
[0m17:46:35.661389 [debug] [MainThread]: Flushing usage events
[0m17:46:46.789096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A0DDE8CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A106DA2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A106DA110>]}


============================== 17:46:46.796106 | 73a267a2-33e2-4e2b-8316-b546224e860d ==============================
[0m17:46:46.796106 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:46:46.797093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:46:47.184123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73a267a2-33e2-4e2b-8316-b546224e860d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A106DA3B0>]}
[0m17:46:47.285065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73a267a2-33e2-4e2b-8316-b546224e860d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A10CCFE80>]}
[0m17:46:47.286050 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:46:47.300061 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:46:47.424648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:46:47.425654 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:46:47.639523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73a267a2-33e2-4e2b-8316-b546224e860d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A1109C1F0>]}
[0m17:46:47.653515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73a267a2-33e2-4e2b-8316-b546224e860d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A1104BD00>]}
[0m17:46:47.653515 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:46:47.654515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73a267a2-33e2-4e2b-8316-b546224e860d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A1104BD60>]}
[0m17:46:47.656514 [info ] [MainThread]: 
[0m17:46:47.657513 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:46:47.659512 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:46:47.674854 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:46:47.674854 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:46:47.675852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:47.675852 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:47.722401 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:46:47.723401 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:46:47.724412 [debug] [ThreadPool]: On list_online: Close
[0m17:46:47.726409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:46:47.727408 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:46:47.732409 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:46:47.733409 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:46:47.733409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:47.734408 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:47.734408 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:46:47.737392 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:46:47.738406 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:46:47.738406 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:46:47.741230 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:46:47.748227 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:46:47.749227 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:46:47.749227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:47.749227 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:47.750226 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:46:47.751226 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:46:47.752239 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:46:47.753243 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:46:47.754225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:46:47.757241 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:46:47.757241 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:46:47.758240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:47.758240 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:47.759239 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:46:47.759239 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:46:47.761238 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:46:47.761238 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:46:47.762238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73a267a2-33e2-4e2b-8316-b546224e860d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A106DA3E0>]}
[0m17:46:47.763221 [debug] [MainThread]: On master: COMMIT
[0m17:46:47.763221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:46:47.764220 [info ] [MainThread]: 
[0m17:46:47.768696 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:46:47.768696 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:46:47.770711 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:46:47.770711 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:46:47.781705 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:46:47.783697 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:46:47.770711 => 17:46:47.782704
[0m17:46:47.783697 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:46:47.815671 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:47.816670 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:46:47.816670 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:46:47.817671 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:47.817671 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:46:47.819679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:47.824668 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:47.825674 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:46:47.826678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:47.834674 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:47.834674 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:46:47.837434 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:47.856440 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:47.856440 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:47.858098 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:47.861098 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:47.862097 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:46:47.862800 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:47.866799 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:47.867798 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:47.868811 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:47.871796 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:46:47.872795 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:47.872795 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:46:47.880804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:47.895811 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:46:47.899809 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:47.899809 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:46:47.900795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:47.904806 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:46:47.905805 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:46:47.907457 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:47.911470 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:46:47.784708 => 17:46:47.911470
[0m17:46:47.912470 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:46:47.912470 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:46:47.913469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a267a2-33e2-4e2b-8316-b546224e860d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A1121B730>]}
[0m17:46:47.914468 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.14s]
[0m17:46:47.915455 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:46:47.915455 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:46:47.916468 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:46:47.917463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:46:47.918467 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:46:47.922464 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:46:47.923450 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:46:47.918467 => 17:46:47.923450
[0m17:46:47.924468 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:46:47.930464 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:46:47.930464 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:46:47.931464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:47.931464 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:47.932463 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:46:47.933457 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:47.935456 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:46:47.936456 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:46:47.937456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:47.940459 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:46:47.941458 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:47.941458 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:47.944458 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:46:47.944458 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:46:47.945607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:47.947622 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:46:47.948638 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:47.949607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:47.950606 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:46:47.952625 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:46:47.952625 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales
        -- cast(order_quantity as int) as OrderQuantity,
        -- cast(profit as Decimal(10,4)) as Profit,
        -- cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        -- cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:46:47.968001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:47.970017 [debug] [Thread-1 (]: On model.online_shopping.stg_market: COMMIT
[0m17:46:47.971016 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:46:47.971016 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_market__dbt_backup'
  
[0m17:46:47.973001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:47.977012 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:46:47.978011 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:46:47.978011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:47.980010 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:46:47.924468 => 17:46:47.980010
[0m17:46:47.981010 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:46:47.981010 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:46:47.982008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a267a2-33e2-4e2b-8316-b546224e860d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A112538E0>]}
[0m17:46:47.983010 [info ] [Thread-1 (]: 2 of 5 OK created sql table model online.dbt_staging.stg_market ................ [[32mOK[0m in 0.06s]
[0m17:46:47.984008 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:46:47.984008 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:46:47.985006 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:46:47.986006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:46:47.986006 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:46:47.991007 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:46:47.991990 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:46:47.987005 => 17:46:47.991990
[0m17:46:47.993007 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:46:48.000985 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:48.001985 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:46:48.001985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:48.002984 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:48.003989 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:46:48.004990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.006982 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:48.007994 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:46:48.009088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.015087 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:48.016090 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:46:48.018877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.020892 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:48.021878 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:48.022896 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.024895 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:48.025877 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:46:48.026891 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.028888 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:48.029887 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:48.030836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.031838 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:46:48.032836 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:48.033836 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:46:48.045971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.047972 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:46:48.048971 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:48.048971 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:46:48.050348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.054348 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:46:48.055347 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:46:48.057008 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.059006 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:46:47.993007 => 17:46:48.059006
[0m17:46:48.059006 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:46:48.060006 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:46:48.061005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a267a2-33e2-4e2b-8316-b546224e860d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A11071660>]}
[0m17:46:48.061005 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.07s]
[0m17:46:48.062000 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:46:48.062992 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:46:48.064003 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:46:48.064991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:46:48.064991 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:46:48.069988 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:46:48.070987 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:46:48.064991 => 17:46:48.070987
[0m17:46:48.071997 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:46:48.078995 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:48.078995 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:46:48.079994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:48.079994 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:48.080994 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:46:48.081998 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.083992 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:48.083992 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:46:48.085247 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.092274 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:48.093263 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:46:48.095517 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.098519 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:48.098519 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:48.099842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.100844 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:48.101843 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:46:48.101843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.103842 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:48.104841 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:48.105844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.106840 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:46:48.108840 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:48.109838 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:46:48.115514 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.117515 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:46:48.118514 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:48.118514 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:46:48.119513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.125509 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:46:48.125509 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:46:48.128001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.130016 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:46:48.071997 => 17:46:48.130016
[0m17:46:48.130016 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:46:48.131015 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:46:48.132014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a267a2-33e2-4e2b-8316-b546224e860d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A1154FE80>]}
[0m17:46:48.132014 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.07s]
[0m17:46:48.133015 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:46:48.134014 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:46:48.135012 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:46:48.135999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:46:48.135999 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:46:48.139996 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:46:48.141996 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:46:48.136998 => 17:46:48.141996
[0m17:46:48.143008 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:46:48.149005 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:48.149005 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:46:48.150004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:48.150004 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:46:48.151004 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:46:48.152008 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.153988 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:48.153988 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:46:48.154988 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.159998 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:48.159998 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:46:48.162986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.166000 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:48.166000 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:48.166989 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.169998 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:48.170997 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:46:48.171983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.174995 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:48.174995 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:46:48.176195 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.177197 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:46:48.179196 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:48.180195 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:46:48.194586 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.196587 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:46:48.197586 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:48.197586 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:46:48.199108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.204107 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:46:48.205106 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:46:48.208119 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:46:48.210118 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:46:48.143008 => 17:46:48.210118
[0m17:46:48.210118 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:46:48.211117 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:46:48.212121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a267a2-33e2-4e2b-8316-b546224e860d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A11574E80>]}
[0m17:46:48.212121 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.08s]
[0m17:46:48.214115 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:46:48.215100 [debug] [MainThread]: On master: COMMIT
[0m17:46:48.216114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:48.216114 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:46:48.217113 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:46:48.217113 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:46:48.217113 [info ] [MainThread]: 
[0m17:46:48.218112 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m17:46:48.220116 [debug] [MainThread]: Command end result
[0m17:46:48.234091 [info ] [MainThread]: 
[0m17:46:48.235103 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:46:48.236107 [info ] [MainThread]: 
[0m17:46:48.237090 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:46:48.239087 [debug] [MainThread]: Command `dbt run` succeeded at 17:46:48.239087 after 1.53 seconds
[0m17:46:48.239087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A0DDE8CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A10E27E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A10D7C7C0>]}
[0m17:46:48.240086 [debug] [MainThread]: Flushing usage events
[0m17:47:05.820596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E4FECCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E78CA2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E78CA110>]}


============================== 17:47:05.826593 | cba2f05a-69fe-45f6-9e76-76cad88d9a40 ==============================
[0m17:47:05.826593 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:47:05.827592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:47:06.237560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cba2f05a-69fe-45f6-9e76-76cad88d9a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E78CA3B0>]}
[0m17:47:06.339500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cba2f05a-69fe-45f6-9e76-76cad88d9a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E7EBFE80>]}
[0m17:47:06.339500 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:47:06.352531 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:47:06.475447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:47:06.476446 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:47:06.706317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cba2f05a-69fe-45f6-9e76-76cad88d9a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E828C1F0>]}
[0m17:47:06.722307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cba2f05a-69fe-45f6-9e76-76cad88d9a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E823BD60>]}
[0m17:47:06.723307 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:47:06.725306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cba2f05a-69fe-45f6-9e76-76cad88d9a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E823BE50>]}
[0m17:47:06.728303 [info ] [MainThread]: 
[0m17:47:06.730302 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:47:06.734301 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:47:06.760285 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:47:06.761284 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:47:06.761284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:06.762283 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:06.814253 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:47:06.815253 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:47:06.817251 [debug] [ThreadPool]: On list_online: Close
[0m17:47:06.819261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:47:06.821255 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:47:06.827246 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:47:06.828245 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:47:06.828245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:06.829244 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:06.829244 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:47:06.832243 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:47:06.834241 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:47:06.834241 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:47:06.837240 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:47:06.845235 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:47:06.846234 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:47:06.846234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:06.846234 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:06.847234 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:47:06.848240 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:47:06.850232 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:47:06.850232 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:47:06.851231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:47:06.854217 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:47:06.855216 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:47:06.855216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:06.856216 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:06.856216 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:47:06.857234 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:47:06.858214 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:47:06.859214 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:47:06.860213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cba2f05a-69fe-45f6-9e76-76cad88d9a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E78CA3E0>]}
[0m17:47:06.860213 [debug] [MainThread]: On master: COMMIT
[0m17:47:06.861231 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:47:06.862212 [info ] [MainThread]: 
[0m17:47:06.866224 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:47:06.866224 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:47:06.868228 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:47:06.869222 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:47:06.881220 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:47:06.883200 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:47:06.869222 => 17:47:06.882220
[0m17:47:06.883200 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:47:06.913197 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:06.914196 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:47:06.914196 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:47:06.915196 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:06.916195 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:06.916991 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:06.920991 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:06.920991 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:47:06.921990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:06.929999 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:06.930998 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:47:06.933800 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:06.953790 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:06.954790 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:06.955807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:06.959787 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:06.959787 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:47:06.961007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:06.966025 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:06.966025 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:06.967024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:06.970023 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:47:06.971017 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:06.972021 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:47:06.979885 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:06.997860 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:47:07.003855 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:07.003855 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:47:07.005854 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.010850 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:07.010850 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:47:07.012849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.017846 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:47:06.883200 => 17:47:07.017846
[0m17:47:07.017846 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:47:07.018846 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:47:07.019845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba2f05a-69fe-45f6-9e76-76cad88d9a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E840F730>]}
[0m17:47:07.019845 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.15s]
[0m17:47:07.021845 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:47:07.021845 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:47:07.022844 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:47:07.023844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:47:07.024843 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:47:07.028840 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:47:07.029841 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:47:07.024843 => 17:47:07.029841
[0m17:47:07.030840 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:47:07.036854 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:07.036854 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:47:07.037854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:07.037854 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:07.038853 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:07.039834 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.041846 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:07.041846 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:47:07.042850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.047843 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:07.048842 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:47:07.051826 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.054834 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:07.055843 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:07.056824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.058842 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:07.058842 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:47:07.059852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.062822 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:07.062822 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:07.064503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.065505 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:47:07.067513 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:07.067513 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        cast(order_quantity as int) as OrderQuantity
        -- cast(profit as Decimal(10,4)) as Profit,
        -- cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        -- cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:47:07.133524 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.139547 [debug] [Thread-1 (]: On model.online_shopping.stg_market: COMMIT
[0m17:47:07.141546 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:07.143545 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_market__dbt_backup'
  
[0m17:47:07.146516 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.159536 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:07.160536 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:47:07.164975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.166990 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:47:07.030840 => 17:47:07.166990
[0m17:47:07.166990 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:47:07.167989 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:47:07.168989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba2f05a-69fe-45f6-9e76-76cad88d9a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E821DED0>]}
[0m17:47:07.169989 [info ] [Thread-1 (]: 2 of 5 OK created sql table model online.dbt_staging.stg_market ................ [[32mOK[0m in 0.15s]
[0m17:47:07.170974 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:47:07.170974 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:47:07.171973 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:47:07.172974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:47:07.173986 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:47:07.179968 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:47:07.181967 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:47:07.173986 => 17:47:07.180968
[0m17:47:07.182981 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:47:07.189962 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:07.189962 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:47:07.190962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:07.190962 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:07.191961 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:07.193491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.194493 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:07.195492 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:47:07.196680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.200680 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:07.201679 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:47:07.204145 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.207159 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:07.208144 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:07.209158 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.210158 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:07.211157 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:47:07.212149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.214156 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:07.215155 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:07.216142 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.217154 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:47:07.219140 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:07.219140 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:47:07.233031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.235047 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:47:07.236046 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:07.237046 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:47:07.238044 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.242043 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:07.243042 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:47:07.245354 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.247370 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:47:07.182981 => 17:47:07.246370
[0m17:47:07.247370 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:47:07.248369 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:47:07.249369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba2f05a-69fe-45f6-9e76-76cad88d9a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E8281210>]}
[0m17:47:07.250368 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.08s]
[0m17:47:07.251367 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:47:07.251367 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:47:07.252368 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:47:07.253353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:47:07.254365 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:47:07.258349 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:47:07.260347 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:47:07.254365 => 17:47:07.259348
[0m17:47:07.261347 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:47:07.270356 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:07.271356 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:47:07.271356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:07.272356 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:07.273343 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:07.274354 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.276353 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:07.277353 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:47:07.278297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.283296 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:07.283296 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:47:07.286294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.289297 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:07.289297 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:07.291310 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.293305 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:07.293305 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:47:07.294929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.295930 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:07.296929 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:07.297803 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.298820 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:47:07.300803 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:07.300803 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:47:07.306931 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.308943 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:47:07.309942 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:07.309942 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:47:07.311699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.315698 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:07.316698 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:47:07.318803 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.320818 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:47:07.261347 => 17:47:07.319819
[0m17:47:07.320818 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:47:07.320818 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:47:07.322816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba2f05a-69fe-45f6-9e76-76cad88d9a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E8418670>]}
[0m17:47:07.322816 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.07s]
[0m17:47:07.323803 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:47:07.324815 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:47:07.324815 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:47:07.326814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:47:07.326814 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:47:07.330812 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:47:07.332798 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:47:07.326814 => 17:47:07.331811
[0m17:47:07.332798 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:47:07.340808 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:07.341802 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:47:07.342802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:07.342802 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:07.343802 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:07.344793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.345805 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:07.346803 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:47:07.347799 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.351797 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:07.352796 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:47:07.354706 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.357716 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:07.357716 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:07.358715 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.359715 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:07.360715 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:47:07.361704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.363718 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:07.363718 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:07.364717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.365712 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:47:07.367702 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:07.368701 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:47:07.383173 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.385188 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:47:07.386187 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:07.386187 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:47:07.387780 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.392779 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:07.393778 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:47:07.396200 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:07.398203 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:47:07.333798 => 17:47:07.398203
[0m17:47:07.398203 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:47:07.399202 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:47:07.400201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba2f05a-69fe-45f6-9e76-76cad88d9a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E881F040>]}
[0m17:47:07.400201 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.07s]
[0m17:47:07.401455 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:47:07.403470 [debug] [MainThread]: On master: COMMIT
[0m17:47:07.404468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:07.404468 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:47:07.404468 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:47:07.405468 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:47:07.405468 [info ] [MainThread]: 
[0m17:47:07.406468 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m17:47:07.408468 [debug] [MainThread]: Command end result
[0m17:47:07.420464 [info ] [MainThread]: 
[0m17:47:07.421458 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:47:07.422445 [info ] [MainThread]: 
[0m17:47:07.423446 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:47:07.425444 [debug] [MainThread]: Command `dbt run` succeeded at 17:47:07.425444 after 1.68 seconds
[0m17:47:07.426444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E4FECCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E881F670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E83B78B0>]}
[0m17:47:07.426444 [debug] [MainThread]: Flushing usage events
[0m17:47:22.018591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAB079ACB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAB308A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAB308A0B0>]}


============================== 17:47:22.023589 | 5810aca5-71c2-4f8f-9893-bdf74f920c8c ==============================
[0m17:47:22.023589 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:47:22.024587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:47:22.428847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5810aca5-71c2-4f8f-9893-bdf74f920c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAB308A350>]}
[0m17:47:22.529801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5810aca5-71c2-4f8f-9893-bdf74f920c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAB3811D20>]}
[0m17:47:22.530800 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:47:22.544792 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:47:22.667707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:47:22.668706 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:47:22.882603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5810aca5-71c2-4f8f-9893-bdf74f920c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAB3A4C100>]}
[0m17:47:22.898574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5810aca5-71c2-4f8f-9893-bdf74f920c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAB39FBD90>]}
[0m17:47:22.899574 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:47:22.900575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5810aca5-71c2-4f8f-9893-bdf74f920c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAB39FBDF0>]}
[0m17:47:22.902574 [info ] [MainThread]: 
[0m17:47:22.903585 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:47:22.906589 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:47:22.922579 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:47:22.923560 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:47:22.923560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:22.924560 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:22.967978 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:47:22.968989 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:47:22.969988 [debug] [ThreadPool]: On list_online: Close
[0m17:47:22.971987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:47:22.972987 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:47:22.979979 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:47:22.979979 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:47:22.980978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:22.980978 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:22.981977 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:47:22.983977 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:47:22.984966 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:47:22.984966 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:47:22.987964 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:47:22.994960 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:47:22.994960 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:47:22.995959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:22.995959 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:22.996959 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:47:22.997958 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:47:22.998972 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:47:22.999971 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:47:23.000970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:47:23.002969 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:47:23.003976 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:47:23.003976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:23.004968 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:23.004968 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:47:23.005968 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:47:23.006967 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:47:23.007966 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:47:23.008953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5810aca5-71c2-4f8f-9893-bdf74f920c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAB308A380>]}
[0m17:47:23.008953 [debug] [MainThread]: On master: COMMIT
[0m17:47:23.009953 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:47:23.010951 [info ] [MainThread]: 
[0m17:47:23.014375 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:47:23.015390 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:47:23.017374 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:47:23.018393 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:47:23.031385 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:47:23.034368 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:47:23.018393 => 17:47:23.033366
[0m17:47:23.034368 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:47:23.066360 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:23.067360 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:47:23.067360 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:47:23.068359 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:23.068359 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:23.069572 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.073612 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:23.073612 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:47:23.074590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.082585 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:23.082585 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:47:23.085192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.103197 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:23.104196 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:23.104196 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.108195 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:23.108195 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:47:23.109193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.114191 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:23.115190 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:23.116016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.118017 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:47:23.120017 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:23.120017 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:47:23.129030 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.144002 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:47:23.147999 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:23.148999 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:47:23.149999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.154996 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:23.154996 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:47:23.157415 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.162428 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:47:23.035383 => 17:47:23.161428
[0m17:47:23.162428 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:47:23.162428 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:47:23.163427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5810aca5-71c2-4f8f-9893-bdf74f920c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAB3BCF6D0>]}
[0m17:47:23.164426 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.15s]
[0m17:47:23.165412 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:47:23.166425 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:47:23.166425 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:47:23.168411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:47:23.168411 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:47:23.172408 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:47:23.174407 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:47:23.169410 => 17:47:23.173407
[0m17:47:23.174407 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:47:23.180403 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:23.180403 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:47:23.181403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:23.181403 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:23.182402 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:23.183402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.185419 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:23.186419 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:47:23.187419 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.191397 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:23.192429 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:47:23.195396 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.199393 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:23.199393 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:23.200392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.202391 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:23.203390 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:47:23.203390 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.205389 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:23.206389 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:23.207199 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.208201 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:47:23.209199 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:23.210199 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Decimal(10,4)) as Profit
        -- cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        -- cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:47:23.229252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.231261 [debug] [Thread-1 (]: On model.online_shopping.stg_market: COMMIT
[0m17:47:23.232260 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:23.233259 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_market__dbt_backup'
  
[0m17:47:23.234259 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.238256 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:23.239255 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:47:23.241099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.243110 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:47:23.174407 => 17:47:23.242111
[0m17:47:23.243110 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:47:23.244099 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:47:23.245112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5810aca5-71c2-4f8f-9893-bdf74f920c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAB3C27430>]}
[0m17:47:23.246112 [info ] [Thread-1 (]: 2 of 5 OK created sql table model online.dbt_staging.stg_market ................ [[32mOK[0m in 0.08s]
[0m17:47:23.247098 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:47:23.247098 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:47:23.248097 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:47:23.249098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:47:23.250110 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:47:23.255107 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:47:23.257092 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:47:23.250110 => 17:47:23.256106
[0m17:47:23.257092 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:47:23.264106 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:23.265106 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:47:23.265106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:23.266101 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:23.266101 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:23.267100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.269099 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:23.269099 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:47:23.270658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.274658 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:23.274658 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:47:23.326382 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.329395 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:23.329395 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:23.331019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.332020 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:23.333019 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:47:23.333863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.334864 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:23.335863 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:23.336863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.337862 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:47:23.338861 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:23.339861 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:47:23.351346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.353335 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:47:23.354344 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:23.355343 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:47:23.356333 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.360345 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:23.360345 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:47:23.362976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.364991 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:47:23.258092 => 17:47:23.363992
[0m17:47:23.364991 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:47:23.364991 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:47:23.365990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5810aca5-71c2-4f8f-9893-bdf74f920c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAB3A426B0>]}
[0m17:47:23.366989 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.12s]
[0m17:47:23.367976 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:47:23.368989 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:47:23.368989 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:47:23.369988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:47:23.370984 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:47:23.374981 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:47:23.375980 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:47:23.370984 => 17:47:23.375980
[0m17:47:23.376983 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:47:23.383979 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:23.383979 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:47:23.384979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:23.384979 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:23.385979 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:23.386964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.388982 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:23.388982 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:47:23.389981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.395959 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:23.396973 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:47:23.399254 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.402272 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:23.402272 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:23.403272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.405271 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:23.405271 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:47:23.406767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.407769 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:23.408768 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:23.409657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.410658 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:47:23.412657 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:23.413656 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:47:23.419580 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.421581 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:47:23.422580 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:23.422580 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:47:23.424054 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.429053 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:23.429053 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:47:23.432053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.434064 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:47:23.376983 => 17:47:23.434064
[0m17:47:23.434064 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:47:23.435063 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:47:23.436063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5810aca5-71c2-4f8f-9893-bdf74f920c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAB3BDB520>]}
[0m17:47:23.436063 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.07s]
[0m17:47:23.438062 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:47:23.438062 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:47:23.439066 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:47:23.439726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:47:23.440730 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:47:23.444726 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:47:23.446726 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:47:23.440730 => 17:47:23.446726
[0m17:47:23.447725 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:47:23.454734 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:23.455732 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:47:23.455732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:23.456725 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:23.457731 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:23.458731 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.459719 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:23.460718 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:47:23.461382 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.467383 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:23.467383 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:47:23.470357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.473367 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:23.473367 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:23.474359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.475358 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:23.476357 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:47:23.477170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.479177 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:23.480189 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:23.481172 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.483183 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:47:23.484182 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:23.485186 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:47:23.499943 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.501944 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:47:23.502943 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:23.502943 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:47:23.504287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.510285 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:23.510285 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:47:23.513284 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:23.514283 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:47:23.448736 => 17:47:23.514283
[0m17:47:23.515283 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:47:23.515283 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:47:23.516282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5810aca5-71c2-4f8f-9893-bdf74f920c8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAB3C603D0>]}
[0m17:47:23.517281 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.08s]
[0m17:47:23.518267 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:47:23.519281 [debug] [MainThread]: On master: COMMIT
[0m17:47:23.520281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:23.521267 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:47:23.521267 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:47:23.521267 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:47:23.522279 [info ] [MainThread]: 
[0m17:47:23.522822 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m17:47:23.524826 [debug] [MainThread]: Command end result
[0m17:47:23.538818 [info ] [MainThread]: 
[0m17:47:23.539815 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:47:23.540816 [info ] [MainThread]: 
[0m17:47:23.541815 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:47:23.542814 [debug] [MainThread]: Command `dbt run` succeeded at 17:47:23.542814 after 1.60 seconds
[0m17:47:23.543814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAB079ACB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAB3F7F730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAB3B776A0>]}
[0m17:47:23.543814 [debug] [MainThread]: Flushing usage events
[0m17:47:36.164467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8A3F7ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8A685A2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8A685A0E0>]}


============================== 17:47:36.170464 | 1134be8c-7614-47b1-8917-b259d8407964 ==============================
[0m17:47:36.170464 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:47:36.171463 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:47:36.572436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1134be8c-7614-47b1-8917-b259d8407964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8A685A380>]}
[0m17:47:36.677371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1134be8c-7614-47b1-8917-b259d8407964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8A6E53E50>]}
[0m17:47:36.677371 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:47:36.694350 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:47:36.836268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:47:36.836268 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:47:37.061151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1134be8c-7614-47b1-8917-b259d8407964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8A721C130>]}
[0m17:47:37.077129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1134be8c-7614-47b1-8917-b259d8407964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8A71CBD30>]}
[0m17:47:37.077129 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:47:37.078128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1134be8c-7614-47b1-8917-b259d8407964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8A71CBE20>]}
[0m17:47:37.080127 [info ] [MainThread]: 
[0m17:47:37.081126 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:47:37.084125 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:47:37.097117 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:47:37.098117 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:47:37.098117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:37.099116 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:37.143880 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:47:37.144789 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:47:37.145791 [debug] [ThreadPool]: On list_online: Close
[0m17:47:37.146790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:47:37.147790 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:47:37.153786 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:47:37.154786 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:47:37.154786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:37.155785 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:37.156784 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:47:37.160782 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:47:37.161781 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:47:37.162783 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:47:37.165369 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:47:37.173366 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:47:37.173366 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:47:37.174365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:37.174365 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:37.175365 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:47:37.176365 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:47:37.178382 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:47:37.178382 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:47:37.179381 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:47:37.183374 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:47:37.183374 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:47:37.183374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:37.184373 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:37.184373 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:47:37.186372 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:47:37.187358 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:47:37.187358 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:47:37.188357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1134be8c-7614-47b1-8917-b259d8407964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8A721C1C0>]}
[0m17:47:37.189370 [debug] [MainThread]: On master: COMMIT
[0m17:47:37.190371 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:47:37.190875 [info ] [MainThread]: 
[0m17:47:37.195214 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:47:37.195214 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:47:37.196472 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:47:37.197492 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:47:37.206482 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:47:37.208469 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:47:37.197492 => 17:47:37.208469
[0m17:47:37.208469 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:47:37.238463 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:37.239463 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:47:37.239463 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:47:37.240462 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:37.240462 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:37.242450 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.246447 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:37.247446 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:47:37.248462 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.256441 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:37.256441 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:47:37.259443 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.277448 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:37.278448 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:37.279234 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.283252 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:37.283252 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:47:37.284233 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.289248 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:37.290248 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:37.290248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.293246 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:47:37.295246 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:37.295246 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:47:37.303036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.318031 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:47:37.322029 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:37.322029 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:47:37.323024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.327026 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:37.328026 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:47:37.330015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.334023 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:47:37.209468 => 17:47:37.334023
[0m17:47:37.335022 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:47:37.335022 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:47:37.336021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1134be8c-7614-47b1-8917-b259d8407964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8A73A7700>]}
[0m17:47:37.337020 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.14s]
[0m17:47:37.337662 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:47:37.338678 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:47:37.338678 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:47:37.339881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:47:37.340896 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:47:37.344898 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:47:37.346897 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:47:37.340896 => 17:47:37.345897
[0m17:47:37.346897 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:47:37.354874 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:37.354874 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:47:37.355874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:37.355874 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:37.356873 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:37.357873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.359873 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:37.360872 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:47:37.361871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.365868 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:37.366867 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:47:37.369379 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.371394 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:37.372393 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:37.372393 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.374392 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:37.375379 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:47:37.375379 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.377381 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:37.378377 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:37.379377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.380377 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:47:37.382374 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:37.382374 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Decimal(10,4)) as Profit,
        cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        -- cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:47:37.385386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.386386 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:47:37.347896 => 17:47:37.386386
[0m17:47:37.386386 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:47:37.387384 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:47:37.388383 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'FROM'. (156) (SQLMoreResults)")
[0m17:47:37.391379 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'FROM'. (156) (SQLMoreResults)")

[0m17:47:37.392368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1134be8c-7614-47b1-8917-b259d8407964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8A721C190>]}
[0m17:47:37.393367 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.05s]
[0m17:47:37.394366 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:47:37.395366 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:47:37.396381 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:47:37.397365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:47:37.397365 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:47:37.402362 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:47:37.403361 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:47:37.398365 => 17:47:37.403361
[0m17:47:37.403361 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:47:37.413357 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:37.414357 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:47:37.414357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:37.415357 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:37.416356 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:37.417367 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.418367 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:37.419366 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:47:37.419366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.424368 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:37.424368 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:47:37.427356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.430348 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:37.431346 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:37.432346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.434357 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:37.434357 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:47:37.435343 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.436356 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:37.437356 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:37.438341 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.439355 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:47:37.440354 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:37.441358 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:47:37.453014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.455028 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:47:37.456027 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:37.457027 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:47:37.457688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.462701 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:37.462701 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:47:37.464847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.466861 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:47:37.404361 => 17:47:37.465863
[0m17:47:37.466861 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:47:37.466861 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:47:37.467861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1134be8c-7614-47b1-8917-b259d8407964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8A7404640>]}
[0m17:47:37.468866 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.07s]
[0m17:47:37.469865 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:47:37.470846 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:47:37.471845 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:47:37.472858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:47:37.472858 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:47:37.476856 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:47:37.477855 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:47:37.472858 => 17:47:37.477855
[0m17:47:37.478841 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:47:37.483851 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:37.484851 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:47:37.485855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:37.485855 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:37.486855 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:37.487854 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.488844 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:37.489848 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:47:37.489848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.495832 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:37.496831 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:47:37.498830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.501846 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:37.502828 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:37.503827 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.505839 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:37.505839 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:47:37.506825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.508837 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:37.508837 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:37.509823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.510824 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:47:37.512822 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:37.513822 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:47:37.519602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.521616 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:47:37.522616 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:37.522616 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:47:37.523615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.528608 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:37.529617 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:47:37.531612 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.533610 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:47:37.478841 => 17:47:37.533610
[0m17:47:37.534609 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:47:37.534609 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:47:37.535608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1134be8c-7614-47b1-8917-b259d8407964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8A772CD90>]}
[0m17:47:37.535608 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.06s]
[0m17:47:37.537608 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:47:37.537608 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:47:37.538593 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:47:37.539607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:47:37.539607 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:47:37.543608 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:47:37.545597 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:47:37.540605 => 17:47:37.545597
[0m17:47:37.546608 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:47:37.552603 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:37.553603 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:47:37.553603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:37.554602 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:37.554602 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:37.555602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.557597 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:37.557597 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:47:37.558595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.563581 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:37.564614 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:47:37.567214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.569214 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:37.570228 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:37.571232 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.572228 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:37.573226 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:47:37.573810 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.575825 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:37.575825 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:37.576830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.578828 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:47:37.580809 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:37.581821 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:47:37.594901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.598904 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:47:37.599903 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:37.599903 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:47:37.601903 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.605900 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:37.606900 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:47:37.608899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:37.610887 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:47:37.546608 => 17:47:37.609898
[0m17:47:37.610887 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:47:37.611902 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:47:37.612896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1134be8c-7614-47b1-8917-b259d8407964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8A74324D0>]}
[0m17:47:37.612896 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.07s]
[0m17:47:37.613895 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:47:37.615337 [debug] [MainThread]: On master: COMMIT
[0m17:47:37.616340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:37.617339 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:47:37.617339 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:47:37.617339 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:47:37.618339 [info ] [MainThread]: 
[0m17:47:37.619040 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m17:47:37.621059 [debug] [MainThread]: Command end result
[0m17:47:37.638031 [info ] [MainThread]: 
[0m17:47:37.639030 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:47:37.640030 [info ] [MainThread]: 
[0m17:47:37.641048 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'FROM'. (156) (SQLMoreResults)")
[0m17:47:37.642030 [info ] [MainThread]: 
[0m17:47:37.643042 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:47:37.645032 [debug] [MainThread]: Command `dbt run` failed at 17:47:37.645032 after 1.56 seconds
[0m17:47:37.646028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8A3F7ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8A6FAD4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8A773A9E0>]}
[0m17:47:37.646028 [debug] [MainThread]: Flushing usage events
[0m17:47:53.314603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B86D4F940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B8962A260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B8962A080>]}


============================== 17:47:53.320600 | 92ed4e6d-87bf-4886-a6a3-2cd0558fa44d ==============================
[0m17:47:53.320600 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:47:53.321599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:47:53.724599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92ed4e6d-87bf-4886-a6a3-2cd0558fa44d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B8962A320>]}
[0m17:47:53.825542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92ed4e6d-87bf-4886-a6a3-2cd0558fa44d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B89DB5CF0>]}
[0m17:47:53.825542 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:47:53.842537 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:47:53.964448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:47:53.965448 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:47:54.181326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92ed4e6d-87bf-4886-a6a3-2cd0558fa44d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B89FF0100>]}
[0m17:47:54.197333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92ed4e6d-87bf-4886-a6a3-2cd0558fa44d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B89F9BEB0>]}
[0m17:47:54.199333 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:47:54.200315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92ed4e6d-87bf-4886-a6a3-2cd0558fa44d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B89F9AC20>]}
[0m17:47:54.201332 [info ] [MainThread]: 
[0m17:47:54.202331 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:47:54.205311 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:47:54.219303 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:47:54.220303 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:47:54.220303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:54.221316 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:54.263858 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:47:54.265106 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:47:54.266108 [debug] [ThreadPool]: On list_online: Close
[0m17:47:54.268106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:47:54.269106 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:47:54.275102 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:47:54.275102 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:47:54.276102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:54.276102 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:54.277101 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:47:54.279293 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:47:54.280295 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:47:54.280295 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:47:54.283045 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:47:54.290043 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:47:54.291042 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:47:54.291042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:54.292042 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:54.292042 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:47:54.293594 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:47:54.294596 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:47:54.294596 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:47:54.295595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:47:54.298593 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:47:54.299593 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:47:54.299593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:54.299593 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:54.300592 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:47:54.301606 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:47:54.302591 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:47:54.303591 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:47:54.304598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92ed4e6d-87bf-4886-a6a3-2cd0558fa44d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B89DEA740>]}
[0m17:47:54.304598 [debug] [MainThread]: On master: COMMIT
[0m17:47:54.305603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:47:54.306341 [info ] [MainThread]: 
[0m17:47:54.310631 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:47:54.310631 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:47:54.312895 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:47:54.312895 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:47:54.327887 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:47:54.329886 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:47:54.312895 => 17:47:54.329886
[0m17:47:54.330887 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:47:54.361881 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:54.361881 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:47:54.362880 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:47:54.362880 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:54.363880 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:54.364879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.368865 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:54.370864 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:47:54.371630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.378628 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:54.379627 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:47:54.382626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.418605 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:54.419604 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:54.420604 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.423602 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:54.423602 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:47:54.424602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.430598 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:54.430598 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:54.431732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.434746 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:47:54.435733 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:54.436749 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:47:54.443646 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.458641 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:47:54.462639 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:54.463638 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:47:54.464642 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.468635 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:47:54.469635 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:47:54.471686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.475699 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:47:54.330887 => 17:47:54.475699
[0m17:47:54.476698 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:47:54.476698 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:47:54.477698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed4e6d-87bf-4886-a6a3-2cd0558fa44d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B8A1736A0>]}
[0m17:47:54.478697 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.17s]
[0m17:47:54.479684 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:47:54.479684 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:47:54.480683 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:47:54.481697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:47:54.482696 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:47:54.485698 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:47:54.487679 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:47:54.482696 => 17:47:54.487679
[0m17:47:54.487679 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:47:54.495693 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:54.495693 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:47:54.496676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:54.497674 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:54.497674 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:54.500690 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.502704 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:54.502704 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:47:54.503695 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.507703 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:54.507703 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:54.509155 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.511171 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:54.511171 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:47:54.512156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.514168 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:54.514168 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:54.515168 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.516168 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:47:54.518152 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:47:54.518152 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Decimal(10,4)) as Profit,
        -- cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:47:54.526150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.528149 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:47:54.488697 => 17:47:54.527151
[0m17:47:54.529158 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:47:54.529158 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:47:54.530147 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')
[0m17:47:54.534143 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')

[0m17:47:54.535142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed4e6d-87bf-4886-a6a3-2cd0558fa44d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B89FF0070>]}
[0m17:47:54.536142 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.05s]
[0m17:47:54.537145 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:47:54.538144 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:47:54.539141 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:47:54.540140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:47:54.541153 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:47:54.545151 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:47:54.546150 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:47:54.541153 => 17:47:54.546150
[0m17:47:54.547150 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:47:54.556149 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:54.556149 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:47:54.557148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:54.558148 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:54.558148 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:54.560142 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.561142 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:54.562141 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:47:54.563127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.567138 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:54.567138 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:47:54.570124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.574121 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:54.574121 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:54.575134 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.577133 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:54.578131 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:47:54.578131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.580131 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:54.581130 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:54.582129 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.583129 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:47:54.584128 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:54.585133 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:47:54.596884 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.598900 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:47:54.599899 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:54.600898 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:47:54.601897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.605895 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:47:54.606896 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:47:54.608895 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.609894 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:47:54.547150 => 17:47:54.609894
[0m17:47:54.610893 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:47:54.610893 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:47:54.611892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed4e6d-87bf-4886-a6a3-2cd0558fa44d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B8A4E4280>]}
[0m17:47:54.612892 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.07s]
[0m17:47:54.613877 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:47:54.613877 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:47:54.614896 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:47:54.615877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:47:54.616895 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:47:54.620892 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:47:54.621892 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:47:54.616895 => 17:47:54.621892
[0m17:47:54.622892 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:47:54.628888 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:54.628888 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:47:54.629886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:54.629886 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:54.630888 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:54.631886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.633884 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:54.633884 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:47:54.634883 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.639882 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:54.640880 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:47:54.643139 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.645154 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:54.646159 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:54.647157 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.649151 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:54.649151 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:47:54.650138 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.652150 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:54.652150 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:54.653137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.655152 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:47:54.656143 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:54.657135 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:47:54.662895 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.664910 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:47:54.665909 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:54.666909 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:47:54.667428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.674440 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:47:54.675440 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:47:54.677438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.679425 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:47:54.622892 => 17:47:54.678439
[0m17:47:54.679425 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:47:54.680436 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:47:54.680436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed4e6d-87bf-4886-a6a3-2cd0558fa44d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B8A4FC850>]}
[0m17:47:54.681436 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.06s]
[0m17:47:54.682421 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:47:54.683436 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:47:54.683436 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:47:54.685434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:47:54.685434 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:47:54.689431 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:47:54.691435 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:47:54.685434 => 17:47:54.690431
[0m17:47:54.691435 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:47:54.697413 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:54.698453 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:47:54.699414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:54.699414 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:47:54.700431 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:47:54.701411 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.703423 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:54.703423 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:47:54.704415 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.710408 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:54.710408 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:47:54.713103 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.715118 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:54.716118 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:54.717117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.718117 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:54.719117 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:47:54.719117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.721120 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:54.722107 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:47:54.724114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.725113 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:47:54.727116 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:54.727116 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:47:54.741413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.743412 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:47:54.744425 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:54.744425 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:47:54.745424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.750421 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:47:54.750421 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:47:54.753011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:47:54.755026 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:47:54.691435 => 17:47:54.755026
[0m17:47:54.756021 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:47:54.756021 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:47:54.757021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed4e6d-87bf-4886-a6a3-2cd0558fa44d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B89FC6440>]}
[0m17:47:54.757021 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.07s]
[0m17:47:54.759020 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:47:54.760009 [debug] [MainThread]: On master: COMMIT
[0m17:47:54.761019 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:54.761019 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:47:54.762018 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:47:54.762018 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:47:54.763017 [info ] [MainThread]: 
[0m17:47:54.763017 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m17:47:54.765016 [debug] [MainThread]: Command end result
[0m17:47:54.781997 [info ] [MainThread]: 
[0m17:47:54.782996 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:47:54.783995 [info ] [MainThread]: 
[0m17:47:54.783995 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')
[0m17:47:54.785013 [info ] [MainThread]: 
[0m17:47:54.786008 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:47:54.788041 [debug] [MainThread]: Command `dbt run` failed at 17:47:54.788041 after 1.55 seconds
[0m17:47:54.789035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B86D4F940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B8A4DBC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B8A4DBC40>]}
[0m17:47:54.790022 [debug] [MainThread]: Flushing usage events
[0m17:48:34.030224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3F926CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3FBB4A2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3FBB4A110>]}


============================== 17:48:34.037220 | 408274a4-84e5-4a2f-923d-ac41dede1d52 ==============================
[0m17:48:34.037220 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:48:34.038221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:48:34.431673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '408274a4-84e5-4a2f-923d-ac41dede1d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3FBB4A3B0>]}
[0m17:48:34.534628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '408274a4-84e5-4a2f-923d-ac41dede1d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3FC14BE80>]}
[0m17:48:34.534628 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:48:34.549846 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:48:34.672762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:48:34.673761 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:48:34.882653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '408274a4-84e5-4a2f-923d-ac41dede1d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3FC51C1F0>]}
[0m17:48:34.898635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '408274a4-84e5-4a2f-923d-ac41dede1d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3FC4CBD60>]}
[0m17:48:34.898635 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:48:34.899631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '408274a4-84e5-4a2f-923d-ac41dede1d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3FC4CBE50>]}
[0m17:48:34.901648 [info ] [MainThread]: 
[0m17:48:34.902637 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:48:34.905645 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:48:34.917633 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:48:34.918633 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:48:34.918633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:34.918633 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:34.965187 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:48:34.966436 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:34.967438 [debug] [ThreadPool]: On list_online: Close
[0m17:48:34.968437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:48:34.969437 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:48:34.975433 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:48:34.975433 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:48:34.975433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:34.976432 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:34.976432 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:48:34.979445 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:34.981429 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:48:34.981429 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:48:34.983929 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:48:34.990926 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:48:34.990926 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:48:34.991926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:34.991926 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:34.992925 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:48:34.993925 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:34.995923 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:48:34.995923 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:48:34.996923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:48:35.000181 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:48:35.001180 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:48:35.001180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:35.002180 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:35.002180 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:48:35.003013 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:35.005028 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:48:35.005028 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:48:35.006032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '408274a4-84e5-4a2f-923d-ac41dede1d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3FBB4A3E0>]}
[0m17:48:35.006032 [debug] [MainThread]: On master: COMMIT
[0m17:48:35.007027 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:48:35.008013 [info ] [MainThread]: 
[0m17:48:35.012024 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:48:35.012024 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:48:35.014023 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:48:35.014023 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:48:35.023017 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:48:35.025003 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:48:35.014023 => 17:48:35.024022
[0m17:48:35.025003 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:48:35.055004 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:35.055004 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:48:35.056003 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:48:35.056003 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:35.057002 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:48:35.057993 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.061992 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:35.062981 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:48:35.063999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.070995 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:35.071994 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:48:35.074358 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.093348 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:35.094347 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:35.095347 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.099344 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:35.099344 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:48:35.100344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.105360 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:35.106361 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:35.106361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.109358 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:48:35.110358 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:35.111338 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:48:35.118571 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.133577 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:48:35.137575 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:35.137575 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:48:35.138575 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.142572 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:35.143571 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:48:35.145606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.149620 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:48:35.025003 => 17:48:35.149620
[0m17:48:35.149620 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:48:35.150619 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:48:35.151619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '408274a4-84e5-4a2f-923d-ac41dede1d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3FC6A3730>]}
[0m17:48:35.151619 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.14s]
[0m17:48:35.153603 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:48:35.153603 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:48:35.154605 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:48:35.155616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:48:35.155616 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:48:35.159618 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:48:35.160618 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:48:35.156616 => 17:48:35.160618
[0m17:48:35.161618 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:48:35.167614 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:48:35.168614 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:48:35.168614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:35.169613 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:35.170612 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:48:35.171593 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.172611 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:48:35.173610 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:48:35.174591 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.179594 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:48:35.180607 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:48:35.182387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.185395 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:48:35.186399 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:35.187398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.188397 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:48:35.188397 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:48:35.190807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.191823 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:48:35.192821 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:35.193808 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.194807 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:48:35.196806 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:48:35.196806 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Decimal(10,4)) as Profit,
        cast(shipping_cost as Decimal(10,4)) as ShippingCost
        -- cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:48:35.216794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.219792 [debug] [Thread-1 (]: On model.online_shopping.stg_market: COMMIT
[0m17:48:35.219792 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:48:35.220802 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_market__dbt_backup'
  
[0m17:48:35.221954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.225954 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:48:35.226953 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:48:35.228665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.230660 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:48:35.161618 => 17:48:35.230660
[0m17:48:35.231659 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:48:35.231659 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:48:35.232659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '408274a4-84e5-4a2f-923d-ac41dede1d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3FC51C220>]}
[0m17:48:35.233658 [info ] [Thread-1 (]: 2 of 5 OK created sql table model online.dbt_staging.stg_market ................ [[32mOK[0m in 0.08s]
[0m17:48:35.234319 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:48:35.235335 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:48:35.236321 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:48:35.236710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:48:35.237726 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:48:35.242722 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:48:35.244708 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:48:35.237726 => 17:48:35.243722
[0m17:48:35.245721 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:48:35.251719 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:35.252717 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:48:35.252717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:35.253716 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:35.253716 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:48:35.255135 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.256137 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:35.257136 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:48:35.258026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.262026 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:35.263025 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:48:35.265043 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.269040 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:35.270035 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:35.271022 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.272034 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:35.273033 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:48:35.274085 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.275087 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:35.276086 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:35.277085 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.278086 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:48:35.280084 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:35.280084 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:48:35.292214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.295202 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:48:35.296202 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:35.297201 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:48:35.297764 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.302787 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:35.302787 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:48:35.305151 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.307165 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:48:35.245721 => 17:48:35.306167
[0m17:48:35.307165 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:48:35.308165 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:48:35.308165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '408274a4-84e5-4a2f-923d-ac41dede1d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3FC51C220>]}
[0m17:48:35.309164 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.07s]
[0m17:48:35.310164 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:48:35.311163 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:48:35.311163 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:48:35.312467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:48:35.313483 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:48:35.317480 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:48:35.318469 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:48:35.313483 => 17:48:35.318469
[0m17:48:35.318469 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:48:35.326463 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:35.327473 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:48:35.328460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:35.328460 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:35.329469 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:48:35.331460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.332459 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:35.333459 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:48:35.334466 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.338466 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:35.339465 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:48:35.341613 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.343627 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:35.344627 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:35.345616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.347612 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:35.348625 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:48:35.349570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.351571 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:35.351571 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:35.352571 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.353570 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:48:35.355573 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:35.356568 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:48:35.361987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.363999 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:48:35.364999 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:35.365998 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:48:35.366839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.370839 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:35.371838 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:48:35.373767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.375782 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:48:35.319478 => 17:48:35.374783
[0m17:48:35.375782 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:48:35.376781 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:48:35.376781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '408274a4-84e5-4a2f-923d-ac41dede1d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3FC6AD810>]}
[0m17:48:35.377781 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.06s]
[0m17:48:35.378767 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:48:35.379780 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:48:35.380779 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:48:35.381779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:48:35.381779 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:48:35.385776 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:48:35.387763 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:48:35.381779 => 17:48:35.386763
[0m17:48:35.387763 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:48:35.394771 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:35.395765 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:48:35.395765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:35.396774 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:35.396774 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:48:35.398783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.399768 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:35.400768 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:48:35.401951 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.405951 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:35.405951 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:48:35.408648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.410663 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:35.411662 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:35.412648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.413661 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:35.414660 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:48:35.415646 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.417663 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:35.417663 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:35.418663 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.420657 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:48:35.421665 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:35.422661 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:48:35.437236 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.439247 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:48:35.440246 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:35.440246 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:48:35.441855 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.447853 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:35.447853 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:48:35.450581 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:35.452595 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:48:35.387763 => 17:48:35.451596
[0m17:48:35.452595 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:48:35.453594 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:48:35.453594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '408274a4-84e5-4a2f-923d-ac41dede1d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3FC9CF040>]}
[0m17:48:35.454594 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.07s]
[0m17:48:35.455596 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:48:35.457653 [debug] [MainThread]: On master: COMMIT
[0m17:48:35.458653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:35.458653 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:48:35.458653 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:48:35.459652 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:48:35.459652 [info ] [MainThread]: 
[0m17:48:35.460559 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m17:48:35.462569 [debug] [MainThread]: Command end result
[0m17:48:35.474555 [info ] [MainThread]: 
[0m17:48:35.475552 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:48:35.476552 [info ] [MainThread]: 
[0m17:48:35.477569 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:48:35.479564 [debug] [MainThread]: Command `dbt run` succeeded at 17:48:35.479564 after 1.52 seconds
[0m17:48:35.480566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3F926CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3FC9CF670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3FC64BCA0>]}
[0m17:48:35.480566 [debug] [MainThread]: Flushing usage events
[0m17:48:51.422003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021433A7F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002143635A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002143635A140>]}


============================== 17:48:51.428001 | 793790de-63ea-4624-872d-f8b3d32fd1ca ==============================
[0m17:48:51.428001 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:48:51.429000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:48:51.835347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '793790de-63ea-4624-872d-f8b3d32fd1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002143635A3E0>]}
[0m17:48:51.946284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '793790de-63ea-4624-872d-f8b3d32fd1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002143694FEB0>]}
[0m17:48:51.947284 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:48:51.961255 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:48:52.082200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:48:52.083200 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:48:52.294078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '793790de-63ea-4624-872d-f8b3d32fd1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021436D1C220>]}
[0m17:48:52.310055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '793790de-63ea-4624-872d-f8b3d32fd1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021436CCBE20>]}
[0m17:48:52.311055 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:48:52.312055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '793790de-63ea-4624-872d-f8b3d32fd1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021436CCBD90>]}
[0m17:48:52.315052 [info ] [MainThread]: 
[0m17:48:52.316052 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:48:52.318053 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:48:52.333046 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:48:52.334052 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:48:52.334052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:52.335056 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:52.378086 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:48:52.379028 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:52.380029 [debug] [ThreadPool]: On list_online: Close
[0m17:48:52.382028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:48:52.382028 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:48:52.388032 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:48:52.389024 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:48:52.389024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:52.390023 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:52.390023 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:48:52.393139 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:52.394139 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:48:52.394139 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:48:52.397137 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:48:52.404132 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:48:52.404132 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:48:52.405132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:52.405132 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:52.406131 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:48:52.407117 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:52.408131 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:48:52.409130 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:48:52.410129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:48:52.412128 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:48:52.413127 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:48:52.413127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:52.414127 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:52.414127 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:48:52.415473 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:52.416475 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:48:52.416475 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:48:52.417474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '793790de-63ea-4624-872d-f8b3d32fd1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021436E47EB0>]}
[0m17:48:52.418473 [debug] [MainThread]: On master: COMMIT
[0m17:48:52.419473 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:48:52.420038 [info ] [MainThread]: 
[0m17:48:52.424040 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:48:52.424040 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:48:52.426056 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:48:52.426056 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:48:52.435050 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:48:52.437031 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:48:52.426056 => 17:48:52.437031
[0m17:48:52.437031 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:48:52.466033 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:52.467027 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:48:52.467027 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:48:52.468026 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:52.468026 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:48:52.469026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.474011 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:52.475011 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:48:52.476027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.484005 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:52.485005 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:48:52.487489 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.505499 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:52.506499 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:52.507496 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.510497 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:52.510497 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:48:52.511497 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.517492 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:52.517492 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:52.518489 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.521472 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:48:52.522473 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:52.522473 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:48:52.531307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.546300 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:48:52.550297 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:52.551297 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:48:52.552310 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.556308 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:48:52.556308 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:48:52.558307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.563303 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:48:52.438050 => 17:48:52.562304
[0m17:48:52.563303 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:48:52.563303 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:48:52.564303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793790de-63ea-4624-872d-f8b3d32fd1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021436E9F760>]}
[0m17:48:52.565303 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.14s]
[0m17:48:52.566307 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:48:52.566307 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:48:52.567306 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:48:52.568287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:48:52.569287 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:48:52.572285 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:48:52.574284 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:48:52.569287 => 17:48:52.574284
[0m17:48:52.574284 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:48:52.582280 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:48:52.583279 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:48:52.583279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:52.584278 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:52.584278 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:48:52.585278 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.587291 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:48:52.587291 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:48:52.589285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.593287 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:48:52.594286 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:48:52.596285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.599287 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:48:52.599287 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:52.600286 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.602297 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:48:52.602297 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:48:52.603192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.605195 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:48:52.605195 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:52.606211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.608210 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:48:52.609210 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:48:52.610191 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Decimal(10,4)) as Profit,
        cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        cast(product_base_margin as Decimal(10,4)) as ProductBaseMargin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:48:52.616704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.617703 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:48:52.575283 => 17:48:52.617703
[0m17:48:52.617703 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:48:52.618702 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:48:52.619701 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\staging\stg_market.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')
[0m17:48:52.623687 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')

[0m17:48:52.624686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793790de-63ea-4624-872d-f8b3d32fd1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021436CF2FE0>]}
[0m17:48:52.624686 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model online.dbt_staging.stg_market ............ [[31mERROR[0m in 0.06s]
[0m17:48:52.626685 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:48:52.626685 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:48:52.627685 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:48:52.628683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:48:52.629682 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:48:52.633680 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:48:52.634679 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:48:52.629682 => 17:48:52.634679
[0m17:48:52.635678 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:48:52.646692 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:52.647686 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:48:52.648685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:52.648685 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:52.649684 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:48:52.650684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.651686 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:52.652684 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:48:52.652684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.661680 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:52.662679 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:48:52.665691 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.668675 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:52.669676 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:52.670674 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.672678 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:52.672678 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:48:52.674673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.676671 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:52.677671 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:52.678684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.679669 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:48:52.681668 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:52.681668 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:48:52.694660 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.696659 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:48:52.697659 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:52.697659 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:48:52.698658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.703655 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:48:52.704655 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:48:52.706654 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.708653 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:48:52.635678 => 17:48:52.708653
[0m17:48:52.709652 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:48:52.709652 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:48:52.710651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793790de-63ea-4624-872d-f8b3d32fd1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021436E77340>]}
[0m17:48:52.711656 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.08s]
[0m17:48:52.712563 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:48:52.713579 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:48:52.714582 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:48:52.715577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:48:52.715577 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:48:52.719574 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:48:52.721562 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:48:52.715577 => 17:48:52.721562
[0m17:48:52.721562 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:48:52.727570 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:52.728569 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:48:52.728569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:52.729569 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:52.729569 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:48:52.731554 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.733555 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:52.733555 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:48:52.735554 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.742566 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:52.743566 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:48:52.745560 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.748562 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:52.748562 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:52.749562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.751556 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:52.751556 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:48:52.752560 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.754555 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:52.755559 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:52.756546 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.758541 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:48:52.759553 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:52.760537 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:48:52.766154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.768168 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:48:52.769153 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:52.769153 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:48:52.770168 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.776164 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:48:52.776164 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:48:52.778705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.780720 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:48:52.722573 => 17:48:52.780720
[0m17:48:52.780720 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:48:52.781719 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:48:52.782718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793790de-63ea-4624-872d-f8b3d32fd1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002143722CDF0>]}
[0m17:48:52.782718 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.07s]
[0m17:48:52.783718 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:48:52.784704 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:48:52.785716 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:48:52.786716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:48:52.786716 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:48:52.790718 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:48:52.792700 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:48:52.786716 => 17:48:52.791718
[0m17:48:52.793718 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:48:52.800708 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:52.801708 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:48:52.801708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:52.802707 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:48:52.802707 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:48:52.803706 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.805706 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:52.806705 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:48:52.807701 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.812688 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:52.812688 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:48:52.815414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.817429 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:52.818428 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:52.819428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.820427 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:52.821427 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:48:52.821427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.824412 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:52.824412 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:48:52.826430 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.827424 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:48:52.829408 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:52.829408 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:48:52.844050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.846065 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:48:52.847064 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:52.848064 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:48:52.848064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.853060 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:48:52.853060 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:48:52.855874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:52.857889 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:48:52.793718 => 17:48:52.857889
[0m17:48:52.858888 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:48:52.858888 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:48:52.859888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793790de-63ea-4624-872d-f8b3d32fd1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021436EEF670>]}
[0m17:48:52.860887 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.07s]
[0m17:48:52.861873 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:48:52.863635 [debug] [MainThread]: On master: COMMIT
[0m17:48:52.864633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:52.864633 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:48:52.864633 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:48:52.865633 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:48:52.865633 [info ] [MainThread]: 
[0m17:48:52.866537 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m17:48:52.868540 [debug] [MainThread]: Command end result
[0m17:48:52.883531 [info ] [MainThread]: 
[0m17:48:52.885528 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:48:52.886536 [info ] [MainThread]: 
[0m17:48:52.886536 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error converting data type varchar to numeric. (8114) (SQLMoreResults)')
[0m17:48:52.887541 [info ] [MainThread]: 
[0m17:48:52.888554 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:48:52.890526 [debug] [MainThread]: Command `dbt run` failed at 17:48:52.890526 after 1.55 seconds
[0m17:48:52.891541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021433A7F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214369FFA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002143723E860>]}
[0m17:48:52.892535 [debug] [MainThread]: Flushing usage events
[0m17:49:21.931706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016365F7ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001636885A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001636885A0B0>]}


============================== 17:49:21.937703 | f8a81f5f-2be9-4362-92f6-a97839785817 ==============================
[0m17:49:21.937703 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:49:21.938702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:49:22.540282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8a81f5f-2be9-4362-92f6-a97839785817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001636885A350>]}
[0m17:49:22.641224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8a81f5f-2be9-4362-92f6-a97839785817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016368FE1D20>]}
[0m17:49:22.641224 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:49:22.656218 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:49:23.312499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:49:23.313498 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:49:23.525358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8a81f5f-2be9-4362-92f6-a97839785817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001636921C100>]}
[0m17:49:23.550257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8a81f5f-2be9-4362-92f6-a97839785817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163691CBD00>]}
[0m17:49:23.551269 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:49:23.552257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8a81f5f-2be9-4362-92f6-a97839785817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163691CBD90>]}
[0m17:49:23.554268 [info ] [MainThread]: 
[0m17:49:23.555267 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:49:23.557573 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:49:23.571566 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:49:23.571566 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:49:23.572578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:23.573577 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:49:23.621426 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:49:23.622331 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:49:23.623333 [debug] [ThreadPool]: On list_online: Close
[0m17:49:23.624332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:49:23.625332 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:49:23.631328 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:49:23.631328 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:49:23.632327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:23.632327 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:49:23.632327 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:49:23.635651 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:49:23.636650 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:49:23.636650 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:49:23.639648 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:49:23.646631 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:49:23.646631 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:49:23.647644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:23.647644 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:49:23.647644 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:49:23.649564 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:49:23.650565 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:49:23.650565 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:49:23.651565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:49:23.654563 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:49:23.655562 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:49:23.655562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:23.655562 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:49:23.656562 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:49:23.657575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:49:23.658563 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:49:23.659561 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:49:23.660561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8a81f5f-2be9-4362-92f6-a97839785817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016369346CE0>]}
[0m17:49:23.661561 [debug] [MainThread]: On master: COMMIT
[0m17:49:23.662560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:49:23.663561 [info ] [MainThread]: 
[0m17:49:23.667557 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:49:23.667557 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:49:23.669557 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:49:23.669557 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:49:23.681549 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:49:23.684547 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:49:23.670565 => 17:49:23.683547
[0m17:49:23.684547 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:49:23.718526 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:49:23.719526 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:49:23.719526 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:49:23.720525 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:49:23.720525 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:49:23.721525 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.726541 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:49:23.727541 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:49:23.728536 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.736516 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:49:23.737516 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:49:23.739515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.758504 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:49:23.758504 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:49:23.759503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.764502 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:49:23.764502 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:49:23.765501 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.771511 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:49:23.771511 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:49:23.772496 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.775494 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:49:23.776494 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:49:23.777494 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:49:23.784489 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.800479 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:49:23.805477 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:49:23.805477 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:49:23.806477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.811473 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:49:23.812472 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:49:23.815472 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.820487 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:49:23.685545 => 17:49:23.820487
[0m17:49:23.821486 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:49:23.821486 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:49:23.822486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8a81f5f-2be9-4362-92f6-a97839785817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163693A76D0>]}
[0m17:49:23.823485 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.15s]
[0m17:49:23.824465 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:49:23.825480 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:49:23.826483 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:49:23.827478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:49:23.827478 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:49:23.832463 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:49:23.834461 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:49:23.828473 => 17:49:23.833462
[0m17:49:23.834461 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:49:23.842469 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:49:23.842469 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:49:23.843468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:23.843468 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:49:23.844468 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:49:23.847081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.850081 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:49:23.850081 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:49:23.851080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.856077 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:49:23.856077 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:49:23.858431 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.860451 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:49:23.861450 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:49:23.862450 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.864430 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:49:23.865429 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:49:23.866429 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.869427 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:49:23.869427 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:49:23.871444 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.872439 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:49:23.873438 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:49:23.874424 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Decimal(10,4)) as Profit,
        cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        cast(try_cast(product_base_margin as float) as float) as product_base_margin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:49:23.895302 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.897301 [debug] [Thread-1 (]: On model.online_shopping.stg_market: COMMIT
[0m17:49:23.898316 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:49:23.899316 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_market__dbt_backup'
  
[0m17:49:23.899874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.903892 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:49:23.904891 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:49:23.906905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.908924 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:49:23.834461 => 17:49:23.907921
[0m17:49:23.908924 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:49:23.909906 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:49:23.910918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8a81f5f-2be9-4362-92f6-a97839785817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016368EB8040>]}
[0m17:49:23.910918 [info ] [Thread-1 (]: 2 of 5 OK created sql table model online.dbt_staging.stg_market ................ [[32mOK[0m in 0.08s]
[0m17:49:23.912903 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:49:23.912903 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:49:23.913922 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:49:23.914902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:49:23.914902 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:49:23.920898 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:49:23.922897 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:49:23.915901 => 17:49:23.921898
[0m17:49:23.922897 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:49:23.929893 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:49:23.929893 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:49:23.930893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:23.930893 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:49:23.931892 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:49:23.932899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.934890 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:49:23.935910 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:49:23.936827 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.940827 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:49:23.941826 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:49:23.944322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.946337 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:49:23.947336 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:49:23.948327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.950339 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:49:23.950339 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:49:23.951339 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.954332 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:49:23.954332 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:49:23.956088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.957089 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:49:23.959089 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:49:23.959089 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:49:23.971741 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.973750 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:49:23.974749 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:49:23.974749 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:49:23.976045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.980045 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:49:23.980045 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:49:23.982860 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:23.984873 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:49:23.922897 => 17:49:23.984873
[0m17:49:23.984873 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:49:23.985872 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:49:23.986872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8a81f5f-2be9-4362-92f6-a97839785817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016369212320>]}
[0m17:49:23.987871 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.07s]
[0m17:49:23.988538 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:49:23.989553 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:49:23.989553 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:49:23.990867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:49:23.991883 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:49:23.995879 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:49:23.997865 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:49:23.991883 => 17:49:23.996867
[0m17:49:23.997865 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:49:24.006860 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:49:24.007859 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:49:24.007859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:24.008858 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:49:24.008858 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:49:24.010673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.011675 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:49:24.012674 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:49:24.013551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.018564 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:49:24.018564 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:49:24.021570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.023585 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:49:24.024584 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:49:24.025570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.026583 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:49:24.027582 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:49:24.027582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.029582 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:49:24.030581 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:49:24.030581 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.032580 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:49:24.034566 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:49:24.035578 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:49:24.042663 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.044664 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:49:24.045663 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:49:24.045663 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:49:24.046662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.052659 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:49:24.052659 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:49:24.055146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.057170 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:49:23.997865 => 17:49:24.056172
[0m17:49:24.057170 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:49:24.058170 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:49:24.058170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8a81f5f-2be9-4362-92f6-a97839785817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163693E5750>]}
[0m17:49:24.059169 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.07s]
[0m17:49:24.060163 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:49:24.061169 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:49:24.061169 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:49:24.062168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:49:24.063154 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:49:24.067151 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:49:24.069150 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:49:24.063154 => 17:49:24.069150
[0m17:49:24.070163 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:49:24.075160 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:49:24.076159 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:49:24.076159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:24.077159 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:49:24.077159 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:49:24.078159 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.080158 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:49:24.081162 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:49:24.082153 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.086154 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:49:24.086154 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:49:24.089068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.091083 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:49:24.092082 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:49:24.092082 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.094081 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:49:24.094081 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:49:24.095080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.097084 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:49:24.098066 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:49:24.099082 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.101077 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:49:24.102065 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:49:24.103076 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:49:24.117339 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.119338 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:49:24.120337 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:49:24.120337 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:49:24.121622 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.126621 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:49:24.127621 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:49:24.129606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:24.131607 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:49:24.070163 => 17:49:24.131607
[0m17:49:24.132621 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:49:24.132621 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:49:24.133620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8a81f5f-2be9-4362-92f6-a97839785817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016369431F90>]}
[0m17:49:24.134619 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.07s]
[0m17:49:24.135605 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:49:24.136606 [debug] [MainThread]: On master: COMMIT
[0m17:49:24.137618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:24.137618 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:49:24.138617 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:49:24.138617 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:49:24.138617 [info ] [MainThread]: 
[0m17:49:24.139616 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m17:49:24.141603 [debug] [MainThread]: Command end result
[0m17:49:24.155603 [info ] [MainThread]: 
[0m17:49:24.156592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:49:24.157593 [info ] [MainThread]: 
[0m17:49:24.158611 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:49:24.160590 [debug] [MainThread]: Command `dbt run` succeeded at 17:49:24.159591 after 2.33 seconds
[0m17:49:24.160590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016365F7ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016369431F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001636972F670>]}
[0m17:49:24.161589 [debug] [MainThread]: Flushing usage events
[0m17:50:18.225234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7559F940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E77E7A260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E77E7A080>]}


============================== 17:50:18.231230 | cbea733b-64b3-49fe-9ec7-177101dbb028 ==============================
[0m17:50:18.231230 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:50:18.232230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:50:18.621325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbea733b-64b3-49fe-9ec7-177101dbb028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E77E7A320>]}
[0m17:50:18.722266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbea733b-64b3-49fe-9ec7-177101dbb028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E78605CF0>]}
[0m17:50:18.722266 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:50:18.738244 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:50:18.860186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:50:18.860186 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\staging\stg_market.sql
[0m17:50:19.067068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbea733b-64b3-49fe-9ec7-177101dbb028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7883C100>]}
[0m17:50:19.083045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbea733b-64b3-49fe-9ec7-177101dbb028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E787D1EA0>]}
[0m17:50:19.084058 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:50:19.085062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbea733b-64b3-49fe-9ec7-177101dbb028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E787EBE80>]}
[0m17:50:19.087061 [info ] [MainThread]: 
[0m17:50:19.088043 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:50:19.091043 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:50:19.104035 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:50:19.105034 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:50:19.106032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:19.106032 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:50:19.152206 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:50:19.153142 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:19.154144 [debug] [ThreadPool]: On list_online: Close
[0m17:50:19.155143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:50:19.156142 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:50:19.162139 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:50:19.162139 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:50:19.163138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:19.163138 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:50:19.163138 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:50:19.165500 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:19.167498 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:50:19.167498 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:50:19.169897 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m17:50:19.176894 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:50:19.177894 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:50:19.177894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:19.177894 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:50:19.178893 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:50:19.179670 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:19.181686 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:50:19.181686 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:50:19.182684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m17:50:19.185682 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:50:19.185682 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:50:19.185682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:19.186682 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:50:19.186682 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:50:19.188273 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:19.189275 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:50:19.189275 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:50:19.190274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbea733b-64b3-49fe-9ec7-177101dbb028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E78966B00>]}
[0m17:50:19.191287 [debug] [MainThread]: On master: COMMIT
[0m17:50:19.191287 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:19.192575 [info ] [MainThread]: 
[0m17:50:19.196739 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:50:19.197737 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:50:19.198724 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:50:19.199723 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:50:19.209727 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:50:19.211723 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:50:19.199723 => 17:50:19.210725
[0m17:50:19.211723 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:50:19.241719 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:50:19.241719 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:50:19.242717 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:50:19.242717 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:50:19.243715 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:50:19.244715 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.248707 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:50:19.249706 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:50:19.250800 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.257798 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:50:19.258801 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_customer', 'stg_customer__dbt_backup'
[0m17:50:19.261830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.280800 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:50:19.281799 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:50:19.282797 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.285781 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:50:19.286781 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:50:19.287733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.293731 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:50:19.293731 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:50:19.294724 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.297738 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:50:19.298726 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:50:19.299737 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:50:19.306738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.321742 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:50:19.325740 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:50:19.326740 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:50:19.327743 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.331736 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:50:19.332735 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:50:19.334318 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.338331 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:50:19.211723 => 17:50:19.338331
[0m17:50:19.339337 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:50:19.339337 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:50:19.340317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbea733b-64b3-49fe-9ec7-177101dbb028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E789C36A0>]}
[0m17:50:19.341329 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.14s]
[0m17:50:19.342315 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:50:19.342315 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:50:19.343315 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:50:19.344328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:50:19.344328 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:50:19.348326 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:50:19.350311 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:50:19.345328 => 17:50:19.349329
[0m17:50:19.350311 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:50:19.357320 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:50:19.358325 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:50:19.358325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:19.359324 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:50:19.359324 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:50:19.360323 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.362322 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:50:19.363324 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:50:19.364317 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.368319 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:50:19.369318 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_market', 'stg_market__dbt_backup'
[0m17:50:19.371312 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.374298 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:50:19.374298 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:50:19.375315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.377314 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:50:19.378295 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:50:19.379295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.381306 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:50:19.381306 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:50:19.382306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.383305 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:50:19.385290 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:50:19.385290 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Decimal(10,4)) as Profit,
        cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        cast(discount as Decimal(10,4)) as Discount,
        cast(try_cast(product_base_margin as float) as float) as product_base_margin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:50:19.408984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.410994 [debug] [Thread-1 (]: On model.online_shopping.stg_market: COMMIT
[0m17:50:19.411993 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:50:19.411993 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_market__dbt_backup'
  
[0m17:50:19.412993 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.416990 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:50:19.417990 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:50:19.420068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.422082 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:50:19.350311 => 17:50:19.421084
[0m17:50:19.422082 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:50:19.422082 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:50:19.423082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbea733b-64b3-49fe-9ec7-177101dbb028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7883C190>]}
[0m17:50:19.424067 [info ] [Thread-1 (]: 2 of 5 OK created sql table model online.dbt_staging.stg_market ................ [[32mOK[0m in 0.08s]
[0m17:50:19.425081 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:50:19.426066 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:50:19.426066 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:50:19.427097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:50:19.428119 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:50:19.433114 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:50:19.435094 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:50:19.428119 => 17:50:19.435094
[0m17:50:19.436112 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:50:19.441093 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:50:19.442092 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:50:19.442092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:19.443091 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:50:19.444092 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:50:19.445108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.447101 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:50:19.447101 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:50:19.448100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.452099 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:50:19.453098 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_order', 'stg_order__dbt_backup'
[0m17:50:19.455027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.457041 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:50:19.458027 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:50:19.459026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.461039 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:50:19.462038 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:50:19.463037 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.464037 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:50:19.465023 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:50:19.466036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.467035 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:50:19.468035 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:50:19.469034 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:50:19.480772 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.482770 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:50:19.482770 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:50:19.483769 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:50:19.484774 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.488770 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:50:19.489770 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:50:19.491755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.493768 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:50:19.436112 => 17:50:19.493768
[0m17:50:19.494767 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:50:19.494767 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:50:19.495772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbea733b-64b3-49fe-9ec7-177101dbb028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E78997160>]}
[0m17:50:19.496753 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.07s]
[0m17:50:19.498751 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:50:19.498751 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:50:19.499750 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:50:19.500623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:50:19.501644 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:50:19.505641 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:50:19.507623 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:50:19.501644 => 17:50:19.506636
[0m17:50:19.507623 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:50:19.516620 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:50:19.516620 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:50:19.517617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:19.517617 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:50:19.518616 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:50:19.519614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.520627 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:50:19.521627 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:50:19.521627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.526612 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:50:19.527612 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_product', 'stg_product__dbt_backup'
[0m17:50:19.530018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.532032 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:50:19.533031 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:50:19.534031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.535030 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:50:19.535030 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:50:19.536279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.538293 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:50:19.538293 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:50:19.539282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.540292 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:50:19.542277 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:50:19.543279 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:50:19.548359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.550373 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:50:19.551372 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:50:19.551372 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:50:19.552371 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.556369 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:50:19.557369 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:50:19.560373 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.562366 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:50:19.508635 => 17:50:19.562366
[0m17:50:19.562366 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:50:19.563370 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:50:19.564370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbea733b-64b3-49fe-9ec7-177101dbb028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E789CFE50>]}
[0m17:50:19.564370 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.06s]
[0m17:50:19.565369 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:50:19.566364 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:50:19.567364 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:50:19.568363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:50:19.568363 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:50:19.572360 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:50:19.574346 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:50:19.568363 => 17:50:19.573346
[0m17:50:19.575347 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:50:19.582340 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:50:19.583340 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:50:19.583340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:19.584339 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:50:19.584339 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:50:19.585339 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.587338 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:50:19.588345 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:50:19.588345 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.594349 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:50:19.595348 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
USE [online];
      EXEC sp_rename 'dbt_staging.stg_shipping', 'stg_shipping__dbt_backup'
[0m17:50:19.597440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.599455 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:50:19.600454 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:50:19.601151 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.602166 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:50:19.603166 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:50:19.603166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.605169 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:50:19.606163 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:50:19.606163 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.608150 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:50:19.610148 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:50:19.610148 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:50:19.623702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.625717 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:50:19.626716 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:50:19.626716 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:50:19.628115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.634128 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:50:19.634128 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:50:19.636113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:19.638125 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:50:19.576345 => 17:50:19.638125
[0m17:50:19.638125 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:50:19.639124 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:50:19.640124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbea733b-64b3-49fe-9ec7-177101dbb028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E78CFEFB0>]}
[0m17:50:19.640124 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.07s]
[0m17:50:19.641109 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:50:19.643108 [debug] [MainThread]: On master: COMMIT
[0m17:50:19.643108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:19.644108 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:50:19.644108 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m17:50:19.645107 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:50:19.645107 [info ] [MainThread]: 
[0m17:50:19.646108 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m17:50:19.648125 [debug] [MainThread]: Command end result
[0m17:50:19.659101 [info ] [MainThread]: 
[0m17:50:19.661098 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:19.662098 [info ] [MainThread]: 
[0m17:50:19.663099 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:50:19.664110 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:19.664110 after 1.51 seconds
[0m17:50:19.665110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7559F940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E784D8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E78CFEFB0>]}
[0m17:50:19.665110 [debug] [MainThread]: Flushing usage events
[0m17:51:13.849169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E595ACCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E5BE8A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E5BE8A140>]}


============================== 17:51:13.857165 | caea8919-eb28-4c21-872c-69e85269fd92 ==============================
[0m17:51:13.857165 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:51:13.858165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:51:14.271398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caea8919-eb28-4c21-872c-69e85269fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E5BE8A3E0>]}
[0m17:51:14.374339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'caea8919-eb28-4c21-872c-69e85269fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E5C47BEB0>]}
[0m17:51:14.374339 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m17:51:14.389327 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:51:14.509262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:51:14.509262 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:51:14.515259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caea8919-eb28-4c21-872c-69e85269fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E5C8414E0>]}
[0m17:51:14.531242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caea8919-eb28-4c21-872c-69e85269fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E5C813310>]}
[0m17:51:14.531242 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m17:51:14.532236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caea8919-eb28-4c21-872c-69e85269fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E5C8132E0>]}
[0m17:51:14.534253 [info ] [MainThread]: 
[0m17:51:14.535234 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m17:51:14.537232 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m17:51:14.551226 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m17:51:14.551226 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m17:51:14.552226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:14.552226 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:51:14.596266 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:51:14.597545 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:51:14.598547 [debug] [ThreadPool]: On list_online: Close
[0m17:51:14.600560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_staging)
[0m17:51:14.601560 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_staging"
"
[0m17:51:14.607556 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_staging"
[0m17:51:14.607556 [debug] [ThreadPool]: On create_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_staging"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_staging')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_staging]')
    END
  
[0m17:51:14.608556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:14.608556 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:51:14.609556 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:51:14.611554 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:51:14.613539 [debug] [ThreadPool]: On create_online_dbt_staging: COMMIT
[0m17:51:14.613539 [debug] [ThreadPool]: On create_online_dbt_staging: Close
[0m17:51:14.616552 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m17:51:14.623717 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m17:51:14.623717 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m17:51:14.624716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:14.624716 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:51:14.624716 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:51:14.626144 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:51:14.628159 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m17:51:14.628159 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m17:51:14.629158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m17:51:14.632156 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m17:51:14.633145 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m17:51:14.633145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:14.634155 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:51:14.634155 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m17:51:14.635141 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:51:14.636154 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m17:51:14.637154 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m17:51:14.638157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caea8919-eb28-4c21-872c-69e85269fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E5C883310>]}
[0m17:51:14.638157 [debug] [MainThread]: On master: COMMIT
[0m17:51:14.639152 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:14.640138 [info ] [MainThread]: 
[0m17:51:14.644174 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m17:51:14.644174 [info ] [Thread-1 (]: 1 of 5 START sql table model online.dbt_staging.stg_customer ................... [RUN]
[0m17:51:14.645471 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.stg_customer'
[0m17:51:14.646491 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m17:51:14.656481 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m17:51:14.658467 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 17:51:14.646491 => 17:51:14.657480
[0m17:51:14.659483 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m17:51:14.748413 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:51:14.748413 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:51:14.749413 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:51:14.749413 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:51:14.753287 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:51:14.754302 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.758300 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:51:14.759299 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_customer'
  
[0m17:51:14.760285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.778288 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:51:14.779287 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:51:14.780110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.783110 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:51:14.784110 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');

  
[0m17:51:14.785091 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.790090 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:51:14.790090 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:51:14.791437 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.792438 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_customer"
[0m17:51:14.794437 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:51:14.794437 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_customer_temp_view" as 


WITH

required_fields AS (

    SELECT

        Cust_id, 
        Customer_Name , 
        province, region, 
        customer_segment

    FROM "online"."dbo"."customer"

),

datatype_conversion AS (

    SELECT 

        Cust_id as CustomerID,
        province as Province,
        region as Region,
        customer_segment  as CustomerSegment,
        Customer_Name as CustomerName

    FROM required_fields

)


SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_customer] FROM [online].[dbt_staging].[stg_customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_customer_temp_view";');



  
[0m17:51:14.802832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.818836 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: COMMIT
[0m17:51:14.822833 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:51:14.822833 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_customer__dbt_backup'
  
[0m17:51:14.823829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.828816 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_customer"
[0m17:51:14.829818 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_customer__dbt_backup";');

[0m17:51:14.830824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.836812 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 17:51:14.659483 => 17:51:14.836812
[0m17:51:14.836812 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: ROLLBACK
[0m17:51:14.837811 [debug] [Thread-1 (]: On model.online_shopping.stg_customer: Close
[0m17:51:14.838810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caea8919-eb28-4c21-872c-69e85269fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E5C87CD30>]}
[0m17:51:14.838810 [info ] [Thread-1 (]: 1 of 5 OK created sql table model online.dbt_staging.stg_customer .............. [[32mOK[0m in 0.19s]
[0m17:51:14.840824 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m17:51:14.840824 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m17:51:14.841825 [info ] [Thread-1 (]: 2 of 5 START sql table model online.dbt_staging.stg_market ..................... [RUN]
[0m17:51:14.842816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m17:51:14.843826 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m17:51:14.847825 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m17:51:14.848824 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 17:51:14.843826 => 17:51:14.848824
[0m17:51:14.849806 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m17:51:14.855802 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:51:14.856819 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:51:14.856819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:14.857818 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:51:14.858817 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:51:14.859817 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.860812 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:51:14.861816 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_market'
  
[0m17:51:14.862810 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.865813 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:51:14.866794 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:51:14.867794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.869794 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:51:14.870792 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');

  
[0m17:51:14.871791 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.873790 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:51:14.873790 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:51:14.874790 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.878788 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_market"
[0m17:51:14.879787 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:51:14.880787 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_market_temp_view" as 

with required_fields as(
    SELECT *
  FROM "online"."dbo"."market"
),

datatype_conversion AS (
    SELECT 
        ord_id as Ord,
        prod_id as ProductID,
        cust_id as CustomerId,
        ship_id as ShipID,
        CAST(sales AS Decimal(10,4)) AS Sales,
        cast(order_quantity as int) as OrderQuantity,
        cast(profit as Decimal(10,4)) as Profit,
        cast(shipping_cost as Decimal(10,4)) as ShippingCost,
        cast(discount as Decimal(10,4)) as Discount,
        cast(try_cast(product_base_margin as float) as float) as product_base_margin
    FROM required_fields
)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_market] FROM [online].[dbt_staging].[stg_market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_market_temp_view";');



  
[0m17:51:14.904793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.906809 [debug] [Thread-1 (]: On model.online_shopping.stg_market: COMMIT
[0m17:51:14.907808 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:51:14.908807 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_market__dbt_backup'
  
[0m17:51:14.909806 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.913803 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_market"
[0m17:51:14.914804 [debug] [Thread-1 (]: On model.online_shopping.stg_market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_market__dbt_backup";');

[0m17:51:14.915802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.917790 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 17:51:14.849806 => 17:51:14.916803
[0m17:51:14.917790 [debug] [Thread-1 (]: On model.online_shopping.stg_market: ROLLBACK
[0m17:51:14.918802 [debug] [Thread-1 (]: On model.online_shopping.stg_market: Close
[0m17:51:14.919800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caea8919-eb28-4c21-872c-69e85269fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E5C921270>]}
[0m17:51:14.919800 [info ] [Thread-1 (]: 2 of 5 OK created sql table model online.dbt_staging.stg_market ................ [[32mOK[0m in 0.08s]
[0m17:51:14.920799 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m17:51:14.921804 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m17:51:14.922803 [info ] [Thread-1 (]: 3 of 5 START sql table model online.dbt_staging.stg_order ...................... [RUN]
[0m17:51:14.923142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m17:51:14.924158 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m17:51:14.929160 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m17:51:14.931139 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 17:51:14.924158 => 17:51:14.930142
[0m17:51:14.931139 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m17:51:14.937150 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:51:14.938149 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:51:14.938149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:14.939148 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:51:14.939148 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:51:14.940149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.943146 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:51:14.944146 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_order'
  
[0m17:51:14.946131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.949149 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:51:14.950151 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:51:14.952128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.954126 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:51:14.954126 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');

  
[0m17:51:14.955126 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.957124 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:51:14.958124 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_order_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:51:14.959124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.960123 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_order"
[0m17:51:14.961122 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:51:14.962122 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_order_temp_view" as 

with required_fields as(
    SELECT Order_ID
      ,Order_Date
      ,Order_Priority
      ,Ord_id
  FROM "online"."dbo"."order"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderID,
        CONVERT(date, order_date,105) AS OrderDate,
        Order_Priority as Order_Priority,
        Ord_id as OrdID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_order] FROM [online].[dbt_staging].[stg_order_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_order_temp_view";');



  
[0m17:51:14.974134 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.976148 [debug] [Thread-1 (]: On model.online_shopping.stg_order: COMMIT
[0m17:51:14.977148 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:51:14.978147 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_order__dbt_backup'
  
[0m17:51:14.979147 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.983145 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_order"
[0m17:51:14.983145 [debug] [Thread-1 (]: On model.online_shopping.stg_order: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_order"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_order__dbt_backup";');

[0m17:51:14.985148 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:14.987146 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 17:51:14.931139 => 17:51:14.987146
[0m17:51:14.988146 [debug] [Thread-1 (]: On model.online_shopping.stg_order: ROLLBACK
[0m17:51:14.988146 [debug] [Thread-1 (]: On model.online_shopping.stg_order: Close
[0m17:51:14.989145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caea8919-eb28-4c21-872c-69e85269fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E5C94FB50>]}
[0m17:51:14.990145 [info ] [Thread-1 (]: 3 of 5 OK created sql table model online.dbt_staging.stg_order ................. [[32mOK[0m in 0.07s]
[0m17:51:14.991129 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m17:51:14.991129 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m17:51:14.992139 [info ] [Thread-1 (]: 4 of 5 START sql table model online.dbt_staging.stg_product .................... [RUN]
[0m17:51:14.993126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m17:51:14.994138 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m17:51:14.997141 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m17:51:14.999121 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 17:51:14.994138 => 17:51:14.999121
[0m17:51:14.999121 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m17:51:15.010129 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:51:15.010129 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:51:15.011128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:15.011128 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:51:15.012127 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:51:15.013113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:15.014127 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:51:15.015126 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_product'
  
[0m17:51:15.016112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:15.020133 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:51:15.021111 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:51:15.023110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:15.025108 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:51:15.025108 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');

  
[0m17:51:15.026368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:15.027370 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:51:15.028369 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_product_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:51:15.029411 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:15.030412 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_product"
[0m17:51:15.031411 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:51:15.032411 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_product_temp_view" as 

with required_fields as (
    
    SELECT

        prod_id as ProductID, 
        product_category as ProductCategory,
        product_sub_category as ProductSubCategory

    FROM "online"."dbo"."product"
)

SELECT * FROM required_fields;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_product] FROM [online].[dbt_staging].[stg_product_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_product_temp_view";');



  
[0m17:51:15.039414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:15.041417 [debug] [Thread-1 (]: On model.online_shopping.stg_product: COMMIT
[0m17:51:15.042414 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:51:15.043414 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_product__dbt_backup'
  
[0m17:51:15.045414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:15.050402 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_product"
[0m17:51:15.051413 [debug] [Thread-1 (]: On model.online_shopping.stg_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_product"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_product__dbt_backup";');

[0m17:51:15.053400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:15.055408 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 17:51:15.000139 => 17:51:15.054408
[0m17:51:15.055408 [debug] [Thread-1 (]: On model.online_shopping.stg_product: ROLLBACK
[0m17:51:15.056402 [debug] [Thread-1 (]: On model.online_shopping.stg_product: Close
[0m17:51:15.057407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caea8919-eb28-4c21-872c-69e85269fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E5C97DD20>]}
[0m17:51:15.057407 [info ] [Thread-1 (]: 4 of 5 OK created sql table model online.dbt_staging.stg_product ............... [[32mOK[0m in 0.06s]
[0m17:51:15.058396 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m17:51:15.059406 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m17:51:15.060395 [info ] [Thread-1 (]: 5 of 5 START sql table model online.dbt_staging.stg_shipping ................... [RUN]
[0m17:51:15.060751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m17:51:15.061763 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m17:51:15.065765 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m17:51:15.067749 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 17:51:15.061763 => 17:51:15.066752
[0m17:51:15.067749 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m17:51:15.074755 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:51:15.075755 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:51:15.075755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:15.076754 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m17:51:15.077754 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m17:51:15.077754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:15.079752 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:51:15.080752 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
    and table_name like 'stg_shipping'
  
[0m17:51:15.081741 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:15.084739 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:51:15.085739 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:51:15.086744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:15.088752 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:51:15.089755 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');

  
[0m17:51:15.090736 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:15.092753 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:51:15.092753 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_staging'
      and refs.referenced_entity_name = 'stg_shipping_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m17:51:15.093748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:15.094735 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.stg_shipping"
[0m17:51:15.096734 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:51:15.096734 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_staging"."stg_shipping_temp_view" as 

with required_fields as(
    SELECT Order_ID,
       Ship_mode
      ,Ship_Date
      ,ship_id
  FROM "online"."dbo"."shipping"
),

datatype_conversion AS (

    SELECT 

        CAST(order_id AS INT) AS OrderId,
        CONVERT(date, ship_date,105) AS ShipDate,
        Ship_mode as ShipMode,
        ship_id as ShipID

    FROM required_fields

)

SELECT * FROM datatype_conversion;');



    
      EXEC('SELECT * INTO [online].[dbt_staging].[stg_shipping] FROM [online].[dbt_staging].[stg_shipping_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_staging"."stg_shipping_temp_view";');



  
[0m17:51:15.110629 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:15.113628 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: COMMIT
[0m17:51:15.114628 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:51:15.114628 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_staging' and tab2.name = 'stg_shipping__dbt_backup'
  
[0m17:51:15.115627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:15.121624 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.stg_shipping"
[0m17:51:15.121624 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.stg_shipping"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_staging"."stg_shipping__dbt_backup";');

[0m17:51:15.123623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:15.125622 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 17:51:15.068756 => 17:51:15.124623
[0m17:51:15.125622 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: ROLLBACK
[0m17:51:15.126621 [debug] [Thread-1 (]: On model.online_shopping.stg_shipping: Close
[0m17:51:15.126621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caea8919-eb28-4c21-872c-69e85269fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E5C89F8B0>]}
[0m17:51:15.127620 [info ] [Thread-1 (]: 5 of 5 OK created sql table model online.dbt_staging.stg_shipping .............. [[32mOK[0m in 0.07s]
[0m17:51:15.128717 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m17:51:15.130733 [debug] [MainThread]: On master: COMMIT
[0m17:51:15.130733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:15.131733 [debug] [MainThread]: Connection 'create_online_dbt_staging' was properly closed.
[0m17:51:15.131733 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m17:51:15.132731 [debug] [MainThread]: Connection 'model.online_shopping.stg_shipping' was properly closed.
[0m17:51:15.132731 [info ] [MainThread]: 
[0m17:51:15.133565 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m17:51:15.135584 [debug] [MainThread]: Command end result
[0m17:51:15.150558 [info ] [MainThread]: 
[0m17:51:15.152557 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:51:15.153556 [info ] [MainThread]: 
[0m17:51:15.154558 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:51:15.156557 [debug] [MainThread]: Command `dbt run` succeeded at 17:51:15.156557 after 1.39 seconds
[0m17:51:15.157567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E595ACCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E5CC63F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E5CC63A00>]}
[0m17:51:15.158567 [debug] [MainThread]: Flushing usage events
[0m18:05:45.138152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201DE22B910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E0B22350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E0B22170>]}


============================== 18:05:45.144163 | eac2ee3e-a498-469b-af67-8d6c0dbbba30 ==============================
[0m18:05:45.144163 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:05:45.145162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:mart --select tag:customer', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:05:45.737467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eac2ee3e-a498-469b-af67-8d6c0dbbba30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E0B22410>]}
[0m18:05:45.840408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eac2ee3e-a498-469b-af67-8d6c0dbbba30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E110FEE0>]}
[0m18:05:45.840408 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m18:05:45.864382 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:05:46.936896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:05:46.937885 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\customer.sql
[0m18:05:47.147777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eac2ee3e-a498-469b-af67-8d6c0dbbba30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E14DC250>]}
[0m18:05:47.170767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eac2ee3e-a498-469b-af67-8d6c0dbbba30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E148BD60>]}
[0m18:05:47.171766 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m18:05:47.173765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eac2ee3e-a498-469b-af67-8d6c0dbbba30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E148BEE0>]}
[0m18:05:47.176759 [info ] [MainThread]: 
[0m18:05:47.177747 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m18:05:47.179762 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m18:05:47.193754 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m18:05:47.193754 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m18:05:47.194754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:47.195762 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:05:47.244325 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:05:47.245241 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:05:47.246242 [debug] [ThreadPool]: On list_online: Close
[0m18:05:47.248242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m18:05:47.249255 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m18:05:47.256236 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m18:05:47.257250 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m18:05:47.257250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:47.257250 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:05:47.258249 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:05:47.261994 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:05:47.263011 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m18:05:47.263996 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m18:05:47.266007 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m18:05:47.273989 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m18:05:47.274989 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m18:05:47.274989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:47.275988 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:05:47.275988 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:05:47.277014 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:05:47.278986 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m18:05:47.278986 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m18:05:47.279986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m18:05:47.282984 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m18:05:47.282984 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m18:05:47.283984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:47.283984 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:05:47.284983 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:05:47.285665 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:05:47.286681 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m18:05:47.287666 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m18:05:47.288850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eac2ee3e-a498-469b-af67-8d6c0dbbba30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E11BF280>]}
[0m18:05:47.288850 [debug] [MainThread]: On master: COMMIT
[0m18:05:47.289866 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:05:47.290672 [info ] [MainThread]: 
[0m18:05:47.294941 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m18:05:47.294941 [info ] [Thread-1 (]: 1 of 1 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m18:05:47.296960 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m18:05:47.296960 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m18:05:47.307937 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m18:05:47.310933 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 18:05:47.296960 => 18:05:47.309934
[0m18:05:47.310933 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m18:05:47.341916 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:05:47.342915 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m18:05:47.342915 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:05:47.343916 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:05:47.344914 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m18:05:47.345914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:05:47.349910 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:05:47.349910 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m18:05:47.360128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:05:47.380133 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:05:47.381128 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m18:05:47.392109 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:05:47.396119 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:05:47.396119 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m18:05:47.397736 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:05:47.402735 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:05:47.403735 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m18:05:47.404734 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:05:47.405734 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m18:05:47.407732 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:05:47.408732 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.customer_id,
        cu.customer_name,
        cu.province,
        cu.customer_segment,
        ma.order_id,
        ma.sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.customer_id = ma.customer_id
),
 
joincustorder AS (
    SELECT
        cus.customer_id,
        cus.customer_name,
        cus.province,
        cus.customer_segment,
        ord.order_id,
        cus.sales,
        ord.order_date
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.order_id = ord.order_id
),
 
finalcustorder AS (
    SELECT
        customer_id,
        customer_name,
        province,
        customer_segment,
        MIN(order_date) AS FirstOrderDate,
        MAX(order_date) AS RecentOrderDate,
        COUNT(order_id) AS TotalOrders,
        SUM(cast(sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY customer_id, customer_name, province, customer_segment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m18:05:47.410732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:05:47.412822 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 18:05:47.311933 => 18:05:47.412822
[0m18:05:47.412822 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m18:05:47.413823 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m18:05:47.414822 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\customer.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_id'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_id'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_id'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_name'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_segment'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'order_id'. (207)")
[0m18:05:47.494939 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_id'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_id'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_id'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_name'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_segment'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'order_id'. (207)")

[0m18:05:47.496926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eac2ee3e-a498-469b-af67-8d6c0dbbba30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E14D4D90>]}
[0m18:05:47.496926 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model online.dbt_mart.customer ................. [[31mERROR[0m in 0.20s]
[0m18:05:47.498223 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m18:05:47.500238 [debug] [MainThread]: On master: COMMIT
[0m18:05:47.501237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:47.501237 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m18:05:47.502236 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m18:05:47.502236 [debug] [MainThread]: Connection 'model.online_shopping.customer' was properly closed.
[0m18:05:47.503236 [info ] [MainThread]: 
[0m18:05:47.503667 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m18:05:47.504668 [debug] [MainThread]: Command end result
[0m18:05:47.519660 [info ] [MainThread]: 
[0m18:05:47.520660 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:05:47.521659 [info ] [MainThread]: 
[0m18:05:47.522659 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_id'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_id'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_id'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_name'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'customer_segment'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'order_id'. (207)")
[0m18:05:47.524658 [info ] [MainThread]: 
[0m18:05:47.525374 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:05:47.527389 [debug] [MainThread]: Command `dbt run` failed at 18:05:47.527389 after 2.50 seconds
[0m18:05:47.527389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201DE22B910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E1666F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E1665450>]}
[0m18:05:47.528387 [debug] [MainThread]: Flushing usage events
[0m18:14:49.152631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340B3F7A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340DD02380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340DD021A0>]}


============================== 18:14:49.159614 | 79c43116-42bc-4dd7-a887-50d1a03d7c9f ==============================
[0m18:14:49.159614 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:14:49.160613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:mart --select tag:customer', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:14:49.739003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79c43116-42bc-4dd7-a887-50d1a03d7c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340DD02440>]}
[0m18:14:49.841944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79c43116-42bc-4dd7-a887-50d1a03d7c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340E2EFF10>]}
[0m18:14:49.842944 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m18:14:49.867929 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:14:50.959166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:14:50.960166 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\customer.sql
[0m18:14:51.171059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79c43116-42bc-4dd7-a887-50d1a03d7c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340E6C02B0>]}
[0m18:14:51.196030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79c43116-42bc-4dd7-a887-50d1a03d7c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340E66F760>]}
[0m18:14:51.196030 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m18:14:51.197031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79c43116-42bc-4dd7-a887-50d1a03d7c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340E66FD60>]}
[0m18:14:51.199030 [info ] [MainThread]: 
[0m18:14:51.200031 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m18:14:51.202029 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m18:14:51.214057 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m18:14:51.215057 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m18:14:51.216056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:51.216056 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:14:51.265639 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:14:51.266641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:14:51.268639 [debug] [ThreadPool]: On list_online: Close
[0m18:14:51.269640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m18:14:51.270637 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m18:14:51.276634 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m18:14:51.276634 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m18:14:51.277633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:14:51.277633 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:14:51.278633 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:14:51.281553 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:14:51.282555 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m18:14:51.282555 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m18:14:51.285400 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m18:14:51.292398 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m18:14:51.292398 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m18:14:51.293397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:51.293397 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:14:51.294397 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:14:51.295606 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:14:51.296608 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m18:14:51.296608 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m18:14:51.297607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m18:14:51.300605 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m18:14:51.301605 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m18:14:51.301605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:14:51.302604 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:14:51.302604 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:14:51.303958 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:14:51.304960 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m18:14:51.304960 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m18:14:51.305959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79c43116-42bc-4dd7-a887-50d1a03d7c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340E4B7AC0>]}
[0m18:14:51.306974 [debug] [MainThread]: On master: COMMIT
[0m18:14:51.306974 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:14:51.307973 [info ] [MainThread]: 
[0m18:14:51.311954 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m18:14:51.312971 [info ] [Thread-1 (]: 1 of 1 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m18:14:51.313969 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m18:14:51.313969 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m18:14:51.322963 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m18:14:51.324948 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 18:14:51.314969 => 18:14:51.324948
[0m18:14:51.325963 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m18:14:51.357942 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:14:51.358942 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m18:14:51.358942 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:14:51.359941 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:14:51.359941 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m18:14:51.360941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:14:51.365938 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:14:51.365938 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m18:14:51.367386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:14:51.385378 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:14:51.386378 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m18:14:51.387377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:14:51.390375 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:14:51.391375 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m18:14:51.392323 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:14:51.397322 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:14:51.397322 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m18:14:51.398505 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:14:51.399520 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m18:14:51.400520 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:14:51.401524 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrderID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Order = ord.OrderID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrderId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m18:14:51.403266 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:14:51.405281 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 18:14:51.326965 => 18:14:51.404282
[0m18:14:51.405281 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m18:14:51.406280 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m18:14:51.406280 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\customer.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'Order'. (156) (SQLMoreResults)")
[0m18:14:51.481635 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'Order'. (156) (SQLMoreResults)")

[0m18:14:51.482621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79c43116-42bc-4dd7-a887-50d1a03d7c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340E6BB340>]}
[0m18:14:51.483620 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model online.dbt_mart.customer ................. [[31mERROR[0m in 0.17s]
[0m18:14:51.484550 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m18:14:51.486565 [debug] [MainThread]: On master: COMMIT
[0m18:14:51.486565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:51.487565 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m18:14:51.487565 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m18:14:51.488563 [debug] [MainThread]: Connection 'model.online_shopping.customer' was properly closed.
[0m18:14:51.488563 [info ] [MainThread]: 
[0m18:14:51.488563 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m18:14:51.489563 [debug] [MainThread]: Command end result
[0m18:14:51.503561 [info ] [MainThread]: 
[0m18:14:51.504546 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:14:51.504546 [info ] [MainThread]: 
[0m18:14:51.505559 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'Order'. (156) (SQLMoreResults)")
[0m18:14:51.506275 [info ] [MainThread]: 
[0m18:14:51.507277 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:14:51.508290 [debug] [MainThread]: Command `dbt run` failed at 18:14:51.508290 after 2.46 seconds
[0m18:14:51.509294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340B3F7A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340E84AF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340E84AE00>]}
[0m18:14:51.509294 [debug] [MainThread]: Flushing usage events
[0m18:16:59.300050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B8DABF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B903A2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B903A2170>]}


============================== 18:16:59.306050 | bc4cc926-6ff5-4b9e-a1b8-6196a047b705 ==============================
[0m18:16:59.306050 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:16:59.307049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:mart --select tag:customer', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:16:59.707381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc4cc926-6ff5-4b9e-a1b8-6196a047b705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B903A2410>]}
[0m18:16:59.808322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc4cc926-6ff5-4b9e-a1b8-6196a047b705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B90993EE0>]}
[0m18:16:59.809321 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m18:16:59.822313 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:16:59.952388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:16:59.954388 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\customer.sql
[0m18:17:00.173276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc4cc926-6ff5-4b9e-a1b8-6196a047b705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B90D60250>]}
[0m18:17:00.189255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc4cc926-6ff5-4b9e-a1b8-6196a047b705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B90D0FDF0>]}
[0m18:17:00.190254 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m18:17:00.190254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc4cc926-6ff5-4b9e-a1b8-6196a047b705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B90D0FD00>]}
[0m18:17:00.192271 [info ] [MainThread]: 
[0m18:17:00.193251 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m18:17:00.195268 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m18:17:00.209262 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m18:17:00.210259 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m18:17:00.210259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:00.211259 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:17:00.256637 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:17:00.258038 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:17:00.259040 [debug] [ThreadPool]: On list_online: Close
[0m18:17:00.260039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m18:17:00.261039 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m18:17:00.267035 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m18:17:00.267035 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m18:17:00.268034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:00.268034 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:17:00.269034 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:17:00.270555 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:17:00.271567 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m18:17:00.272567 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m18:17:00.274941 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m18:17:00.282940 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m18:17:00.282940 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m18:17:00.282940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:00.283940 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:17:00.283940 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:17:00.285897 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:17:00.286899 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m18:17:00.286899 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m18:17:00.287898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m18:17:00.290896 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m18:17:00.291896 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m18:17:00.291896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:00.291896 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:17:00.292895 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:17:00.294474 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:17:00.296489 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m18:17:00.296489 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m18:17:00.298474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc4cc926-6ff5-4b9e-a1b8-6196a047b705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B90A3F280>]}
[0m18:17:00.298474 [debug] [MainThread]: On master: COMMIT
[0m18:17:00.299473 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:00.300473 [info ] [MainThread]: 
[0m18:17:00.304485 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m18:17:00.305486 [info ] [Thread-1 (]: 1 of 1 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m18:17:00.306477 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m18:17:00.307470 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m18:17:00.318464 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m18:17:00.320462 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 18:17:00.307470 => 18:17:00.319476
[0m18:17:00.320462 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m18:17:00.352458 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:17:00.353457 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m18:17:00.353457 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:17:00.354456 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:17:00.354456 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m18:17:00.355884 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:17:00.359898 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:17:00.359898 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m18:17:00.360899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:17:00.379879 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:17:00.380886 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m18:17:00.381885 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:17:00.384884 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:17:00.384884 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m18:17:00.386475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:17:00.391474 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:17:00.391474 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m18:17:00.392786 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:17:00.393787 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m18:17:00.394786 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:17:00.395786 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Order = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m18:17:00.397798 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:17:00.398798 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 18:17:00.321475 => 18:17:00.398798
[0m18:17:00.398798 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m18:17:00.399802 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m18:17:00.400797 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\customer.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'Order'. (156) (SQLMoreResults)")
[0m18:17:00.404782 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'Order'. (156) (SQLMoreResults)")

[0m18:17:00.404782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc4cc926-6ff5-4b9e-a1b8-6196a047b705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B90D5B160>]}
[0m18:17:00.405781 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model online.dbt_mart.customer ................. [[31mERROR[0m in 0.10s]
[0m18:17:00.406781 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m18:17:00.408783 [debug] [MainThread]: On master: COMMIT
[0m18:17:00.409797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:00.410779 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m18:17:00.410779 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m18:17:00.411788 [debug] [MainThread]: Connection 'model.online_shopping.customer' was properly closed.
[0m18:17:00.411788 [info ] [MainThread]: 
[0m18:17:00.412791 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m18:17:00.414775 [debug] [MainThread]: Command end result
[0m18:17:00.428786 [info ] [MainThread]: 
[0m18:17:00.429766 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:17:00.430768 [info ] [MainThread]: 
[0m18:17:00.431780 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'Order'. (156) (SQLMoreResults)")
[0m18:17:00.433775 [info ] [MainThread]: 
[0m18:17:00.434766 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:17:00.436764 [debug] [MainThread]: Command `dbt run` failed at 18:17:00.436764 after 1.22 seconds
[0m18:17:00.436764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B8DABF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B90EEC7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B90EEC760>]}
[0m18:17:00.437763 [debug] [MainThread]: Flushing usage events
[0m18:17:31.987852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF45BED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF6EA22F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF6EA2110>]}


============================== 18:17:31.993849 | 6d675bf9-d1ab-417d-85fb-e9b19e4a000b ==============================
[0m18:17:31.993849 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:17:31.994840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:mart --select tag:customer', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:17:32.381207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d675bf9-d1ab-417d-85fb-e9b19e4a000b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF6EA23B0>]}
[0m18:17:32.484148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d675bf9-d1ab-417d-85fb-e9b19e4a000b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF749FE80>]}
[0m18:17:32.484148 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m18:17:32.498145 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:17:32.621745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:17:32.621745 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\customer.sql
[0m18:17:32.830640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d675bf9-d1ab-417d-85fb-e9b19e4a000b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF7870FA0>]}
[0m18:17:32.846628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d675bf9-d1ab-417d-85fb-e9b19e4a000b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF781FDF0>]}
[0m18:17:32.847618 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m18:17:32.847618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d675bf9-d1ab-417d-85fb-e9b19e4a000b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF781FD30>]}
[0m18:17:32.849634 [info ] [MainThread]: 
[0m18:17:32.850621 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m18:17:32.852614 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m18:17:32.866607 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m18:17:32.867623 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m18:17:32.867623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:32.868623 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:17:32.912206 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:17:32.913145 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:17:32.914147 [debug] [ThreadPool]: On list_online: Close
[0m18:17:32.915808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m18:17:32.916809 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m18:17:32.921806 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m18:17:32.922805 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m18:17:32.922805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:32.923805 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:17:32.923805 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:17:32.925864 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:17:32.927862 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m18:17:32.927862 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m18:17:32.930860 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m18:17:32.936856 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m18:17:32.937855 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m18:17:32.937855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:32.938855 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:17:32.938855 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:17:32.939859 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:17:32.941854 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m18:17:32.941854 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m18:17:32.942857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m18:17:32.945856 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m18:17:32.946855 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m18:17:32.946855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:32.946855 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:17:32.947855 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:17:32.948849 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:17:32.949849 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m18:17:32.949849 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m18:17:32.950853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d675bf9-d1ab-417d-85fb-e9b19e4a000b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF766A3B0>]}
[0m18:17:32.951848 [debug] [MainThread]: On master: COMMIT
[0m18:17:32.951848 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:32.952847 [info ] [MainThread]: 
[0m18:17:32.956992 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m18:17:32.956992 [info ] [Thread-1 (]: 1 of 1 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m18:17:32.958994 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m18:17:32.958994 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m18:17:32.970005 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m18:17:32.971985 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 18:17:32.959993 => 18:17:32.971985
[0m18:17:32.973004 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m18:17:33.002986 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:17:33.003985 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m18:17:33.004966 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:17:33.004966 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:17:33.005965 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m18:17:33.006971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:17:33.010964 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:17:33.011963 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m18:17:33.012962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:17:33.031951 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:17:33.032950 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m18:17:33.033823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:17:33.036823 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:17:33.037822 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m18:17:33.038495 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:17:33.043494 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:17:33.043494 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m18:17:33.044907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:17:33.045908 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m18:17:33.046907 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:17:33.047907 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m18:17:33.128829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:17:33.143822 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m18:17:33.147820 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:17:33.148820 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m18:17:33.239339 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:17:33.247345 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:17:33.247345 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m18:17:33.248345 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:17:33.253342 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 18:17:32.973004 => 18:17:33.253342
[0m18:17:33.254341 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m18:17:33.254341 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m18:17:33.255341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d675bf9-d1ab-417d-85fb-e9b19e4a000b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF7A140D0>]}
[0m18:17:33.256340 [info ] [Thread-1 (]: 1 of 1 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.30s]
[0m18:17:33.256754 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m18:17:33.258769 [debug] [MainThread]: On master: COMMIT
[0m18:17:33.259768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:33.259768 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m18:17:33.259768 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m18:17:33.260767 [debug] [MainThread]: Connection 'model.online_shopping.customer' was properly closed.
[0m18:17:33.260767 [info ] [MainThread]: 
[0m18:17:33.261766 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m18:17:33.262752 [debug] [MainThread]: Command end result
[0m18:17:33.275745 [info ] [MainThread]: 
[0m18:17:33.276744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:33.277744 [info ] [MainThread]: 
[0m18:17:33.278744 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:17:33.281744 [debug] [MainThread]: Command `dbt run` succeeded at 18:17:33.281744 after 1.37 seconds
[0m18:17:33.282742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF45BED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF7488EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF7A143D0>]}
[0m18:17:33.282742 [debug] [MainThread]: Flushing usage events
[0m18:31:41.349866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B3705B910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B39952350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B39952170>]}


============================== 18:31:41.356875 | be20801d-1ab6-4a0d-ac59-87701137362d ==============================
[0m18:31:41.356875 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:31:41.356875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:mart --select tag:market', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:31:41.948863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be20801d-1ab6-4a0d-ac59-87701137362d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B39952410>]}
[0m18:31:42.051802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be20801d-1ab6-4a0d-ac59-87701137362d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B39F3FEE0>]}
[0m18:31:42.051802 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m18:31:42.077789 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:31:43.185530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:31:43.186529 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\market.sql
[0m18:31:43.186529 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m18:31:43.398422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be20801d-1ab6-4a0d-ac59-87701137362d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B3A30C190>]}
[0m18:31:43.424054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be20801d-1ab6-4a0d-ac59-87701137362d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B3A2BFDF0>]}
[0m18:31:43.425054 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m18:31:43.426055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be20801d-1ab6-4a0d-ac59-87701137362d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B3A2BFD00>]}
[0m18:31:43.428054 [info ] [MainThread]: 
[0m18:31:43.429053 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m18:31:43.431052 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m18:31:43.445056 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m18:31:43.446055 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m18:31:43.446055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:43.447055 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:31:43.495694 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:31:43.496438 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:43.497440 [debug] [ThreadPool]: On list_online: Close
[0m18:31:43.499438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m18:31:43.500437 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m18:31:43.505435 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m18:31:43.506434 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m18:31:43.506434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:43.507433 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:31:43.507433 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:31:43.511425 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:43.512428 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m18:31:43.512428 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m18:31:43.515439 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m18:31:43.522435 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m18:31:43.523434 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m18:31:43.523434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:43.524433 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:31:43.524433 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:31:43.525433 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:43.527431 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m18:31:43.527431 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m18:31:43.528431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m18:31:43.531429 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m18:31:43.531429 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m18:31:43.532429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:43.532429 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:31:43.533428 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:31:43.534560 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:43.535561 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m18:31:43.535561 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m18:31:43.536560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be20801d-1ab6-4a0d-ac59-87701137362d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B3A0DBB80>]}
[0m18:31:43.537575 [debug] [MainThread]: On master: COMMIT
[0m18:31:43.538573 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:43.538573 [info ] [MainThread]: 
[0m18:31:43.543096 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m18:31:43.543096 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m18:31:43.544336 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m18:31:43.545338 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m18:31:43.556332 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m18:31:43.558330 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 18:31:43.545338 => 18:31:43.558330
[0m18:31:43.559330 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m18:31:43.589314 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:31:43.590326 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m18:31:43.590326 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:31:43.591325 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:31:43.591325 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m18:31:43.593310 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.597308 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:31:43.597308 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m18:31:43.598412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.605410 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:31:43.606410 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m18:31:43.609099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.627085 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:31:43.628085 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m18:31:43.629085 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.632087 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:31:43.633087 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m18:31:43.633087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.638084 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:31:43.639084 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m18:31:43.640083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.642078 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m18:31:43.644062 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:31:43.644062 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m18:31:43.681673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.696666 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m18:31:43.700664 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:31:43.701663 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m18:31:43.702662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.706660 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m18:31:43.707659 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m18:31:43.709425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.713443 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 18:31:43.559330 => 18:31:43.713443
[0m18:31:43.714443 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m18:31:43.714443 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m18:31:43.715437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be20801d-1ab6-4a0d-ac59-87701137362d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B3A4977C0>]}
[0m18:31:43.716442 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.17s]
[0m18:31:43.717423 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m18:31:43.717423 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m18:31:43.718437 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m18:31:43.719440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m18:31:43.720435 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m18:31:43.724437 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m18:31:43.725418 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 18:31:43.720435 => 18:31:43.725418
[0m18:31:43.726435 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m18:31:43.733432 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m18:31:43.734413 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m18:31:43.735430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:43.735430 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:31:43.736430 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m18:31:43.737413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.740428 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m18:31:43.740428 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m18:31:43.749406 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.752416 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m18:31:43.752416 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m18:31:43.764406 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.766408 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m18:31:43.767407 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m18:31:43.768321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.770335 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m18:31:43.770335 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m18:31:43.771322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.774337 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m18:31:43.775318 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m18:31:43.776319 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m18:31:43.817217 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.819217 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m18:31:43.820216 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m18:31:43.820216 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m18:31:43.885179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.890179 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m18:31:43.890179 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m18:31:43.891192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.893177 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 18:31:43.727435 => 18:31:43.892178
[0m18:31:43.893177 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m18:31:43.894176 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m18:31:43.894176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be20801d-1ab6-4a0d-ac59-87701137362d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B3A5284F0>]}
[0m18:31:43.895176 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.17s]
[0m18:31:43.896175 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m18:31:43.897175 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m18:31:43.897175 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m18:31:43.898174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m18:31:43.898174 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m18:31:43.903171 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m18:31:43.904170 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 18:31:43.899173 => 18:31:43.904170
[0m18:31:43.905171 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m18:31:43.913165 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m18:31:43.914165 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m18:31:43.914165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:43.915164 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:31:43.915164 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m18:31:43.916164 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.918163 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m18:31:43.918163 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m18:31:43.928171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.931155 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m18:31:43.931155 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m18:31:43.943504 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.945514 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m18:31:43.946513 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m18:31:43.946513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.948513 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m18:31:43.949511 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m18:31:43.949511 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.951510 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m18:31:43.952496 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m18:31:43.953495 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),


 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m18:31:43.991476 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:43.993496 [debug] [Thread-1 (]: On model.online_shopping.orders: COMMIT
[0m18:31:43.994495 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m18:31:43.994495 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'orders__dbt_backup'
  
[0m18:31:44.059441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:44.064437 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m18:31:44.064437 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m18:31:44.066078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:44.067081 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 18:31:43.905171 => 18:31:44.067081
[0m18:31:44.068080 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m18:31:44.068080 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m18:31:44.069079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be20801d-1ab6-4a0d-ac59-87701137362d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B3A43B4F0>]}
[0m18:31:44.070078 [info ] [Thread-1 (]: 3 of 3 OK created sql table model online.dbt_mart.orders ....................... [[32mOK[0m in 0.17s]
[0m18:31:44.071116 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m18:31:44.072080 [debug] [MainThread]: On master: COMMIT
[0m18:31:44.073091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:44.073091 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m18:31:44.074090 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m18:31:44.074090 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m18:31:44.074090 [info ] [MainThread]: 
[0m18:31:44.075089 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m18:31:44.077076 [debug] [MainThread]: Command end result
[0m18:31:44.091067 [info ] [MainThread]: 
[0m18:31:44.093078 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:31:44.093078 [info ] [MainThread]: 
[0m18:31:44.094066 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:31:44.097064 [debug] [MainThread]: Command `dbt run` succeeded at 18:31:44.096065 after 2.86 seconds
[0m18:31:44.097064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B3705B910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B3A30C2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B3A2E5510>]}
[0m18:31:44.098064 [debug] [MainThread]: Flushing usage events
[0m18:35:02.373582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027722C1F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277255059F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027725505810>]}


============================== 18:35:02.381586 | 6bc361e3-51b2-4380-ba0b-04b937f8c261 ==============================
[0m18:35:02.381586 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:35:02.382567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:35:02.804276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bc361e3-51b2-4380-ba0b-04b937f8c261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027725505AB0>]}
[0m18:35:02.906223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bc361e3-51b2-4380-ba0b-04b937f8c261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027725BA31C0>]}
[0m18:35:02.906223 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m18:35:02.921215 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:35:03.064134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:35:03.064134 [debug] [MainThread]: Partial parsing: added file: online_shopping://models\mart\customer.yaml
[0m18:35:03.301015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bc361e3-51b2-4380-ba0b-04b937f8c261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277260595D0>]}
[0m18:35:03.305355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bc361e3-51b2-4380-ba0b-04b937f8c261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027725E6BA90>]}
[0m18:35:03.305355 [info ] [MainThread]: Found 10 models, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m18:35:03.306353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bc361e3-51b2-4380-ba0b-04b937f8c261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027725E6BA60>]}
[0m18:35:03.308367 [info ] [MainThread]: 
[0m18:35:03.309394 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m18:35:03.312415 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m18:35:03.325388 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m18:35:03.326406 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m18:35:03.326406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:03.327405 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:35:03.373571 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:35:03.374755 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:35:03.375757 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m18:35:03.376756 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m18:35:03.377755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m18:35:03.380754 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m18:35:03.380754 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m18:35:03.381753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:03.381753 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:35:03.382761 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:35:03.383766 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:35:03.384756 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m18:35:03.385751 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m18:35:03.385751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bc361e3-51b2-4380-ba0b-04b937f8c261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027725BA0FD0>]}
[0m18:35:03.386750 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:03.387928 [info ] [MainThread]: 
[0m18:35:03.392105 [debug] [Thread-1 (]: Began running node model.online_shopping.product
[0m18:35:03.393107 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.product'
[0m18:35:03.393107 [debug] [Thread-1 (]: Began compiling node model.online_shopping.product
[0m18:35:03.403101 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.product"
[0m18:35:03.404101 [debug] [Thread-1 (]: Timing info for model.online_shopping.product (compile): 18:35:03.393107 => 18:35:03.403101
[0m18:35:03.405101 [debug] [Thread-1 (]: Began executing node model.online_shopping.product
[0m18:35:03.405101 [debug] [Thread-1 (]: Timing info for model.online_shopping.product (execute): 18:35:03.405101 => 18:35:03.405101
[0m18:35:03.406101 [debug] [Thread-1 (]: Finished running node model.online_shopping.product
[0m18:35:03.407100 [debug] [Thread-1 (]: Began running node model.online_shopping.shipping
[0m18:35:03.408098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.product, now model.online_shopping.shipping)
[0m18:35:03.408098 [debug] [Thread-1 (]: Began compiling node model.online_shopping.shipping
[0m18:35:03.411096 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.shipping"
[0m18:35:03.411096 [debug] [Thread-1 (]: Timing info for model.online_shopping.shipping (compile): 18:35:03.409097 => 18:35:03.411096
[0m18:35:03.412096 [debug] [Thread-1 (]: Began executing node model.online_shopping.shipping
[0m18:35:03.412096 [debug] [Thread-1 (]: Timing info for model.online_shopping.shipping (execute): 18:35:03.412096 => 18:35:03.412096
[0m18:35:03.413095 [debug] [Thread-1 (]: Finished running node model.online_shopping.shipping
[0m18:35:03.414094 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_customer
[0m18:35:03.415094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.shipping, now model.online_shopping.stg_customer)
[0m18:35:03.415094 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_customer
[0m18:35:03.420092 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_customer"
[0m18:35:03.422090 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (compile): 18:35:03.415094 => 18:35:03.421091
[0m18:35:03.423090 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_customer
[0m18:35:03.424089 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_customer (execute): 18:35:03.424089 => 18:35:03.424089
[0m18:35:03.425090 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_customer
[0m18:35:03.426088 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_market
[0m18:35:03.426088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_customer, now model.online_shopping.stg_market)
[0m18:35:03.427087 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_market
[0m18:35:03.431085 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_market"
[0m18:35:03.433084 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (compile): 18:35:03.427087 => 18:35:03.433084
[0m18:35:03.434084 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_market
[0m18:35:03.435084 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_market (execute): 18:35:03.435084 => 18:35:03.435084
[0m18:35:03.437081 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_market
[0m18:35:03.437081 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_order
[0m18:35:03.438081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_market, now model.online_shopping.stg_order)
[0m18:35:03.439081 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_order
[0m18:35:03.443078 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_order"
[0m18:35:03.444078 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (compile): 18:35:03.439081 => 18:35:03.444078
[0m18:35:03.445077 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_order
[0m18:35:03.445077 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_order (execute): 18:35:03.445077 => 18:35:03.445077
[0m18:35:03.446077 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_order
[0m18:35:03.447076 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_product
[0m18:35:03.448075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_order, now model.online_shopping.stg_product)
[0m18:35:03.449074 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_product
[0m18:35:03.453072 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_product"
[0m18:35:03.455071 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (compile): 18:35:03.449074 => 18:35:03.455071
[0m18:35:03.456070 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_product
[0m18:35:03.456070 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_product (execute): 18:35:03.456070 => 18:35:03.456070
[0m18:35:03.457070 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_product
[0m18:35:03.458069 [debug] [Thread-1 (]: Began running node model.online_shopping.stg_shipping
[0m18:35:03.459069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_product, now model.online_shopping.stg_shipping)
[0m18:35:03.459069 [debug] [Thread-1 (]: Began compiling node model.online_shopping.stg_shipping
[0m18:35:03.463066 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.stg_shipping"
[0m18:35:03.465066 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (compile): 18:35:03.459069 => 18:35:03.464066
[0m18:35:03.465066 [debug] [Thread-1 (]: Began executing node model.online_shopping.stg_shipping
[0m18:35:03.466065 [debug] [Thread-1 (]: Timing info for model.online_shopping.stg_shipping (execute): 18:35:03.466065 => 18:35:03.466065
[0m18:35:03.467064 [debug] [Thread-1 (]: Finished running node model.online_shopping.stg_shipping
[0m18:35:03.468063 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m18:35:03.468063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.stg_shipping, now model.online_shopping.customer)
[0m18:35:03.469063 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m18:35:03.475060 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m18:35:03.476059 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 18:35:03.469063 => 18:35:03.476059
[0m18:35:03.477059 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m18:35:03.477059 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 18:35:03.477059 => 18:35:03.477059
[0m18:35:03.479057 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m18:35:03.479057 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m18:35:03.480057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.orders)
[0m18:35:03.481056 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m18:35:03.485054 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m18:35:03.487054 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 18:35:03.481056 => 18:35:03.486055
[0m18:35:03.487054 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m18:35:03.488052 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 18:35:03.487054 => 18:35:03.487054
[0m18:35:03.489052 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m18:35:03.489052 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m18:35:03.490051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.orders, now model.online_shopping.market)
[0m18:35:03.490051 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m18:35:03.496048 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m18:35:03.497047 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 18:35:03.491051 => 18:35:03.497047
[0m18:35:03.498046 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m18:35:03.498046 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 18:35:03.498046 => 18:35:03.498046
[0m18:35:03.499046 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m18:35:03.500045 [debug] [Thread-1 (]: Began running node test.online_shopping.not_null_customer_CustomerID.e46d1b2976
[0m18:35:03.501046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now test.online_shopping.not_null_customer_CustomerID.e46d1b2976)
[0m18:35:03.502045 [debug] [Thread-1 (]: Began compiling node test.online_shopping.not_null_customer_CustomerID.e46d1b2976
[0m18:35:03.515036 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shopping.not_null_customer_CustomerID.e46d1b2976"
[0m18:35:03.517041 [debug] [Thread-1 (]: Timing info for test.online_shopping.not_null_customer_CustomerID.e46d1b2976 (compile): 18:35:03.502045 => 18:35:03.517041
[0m18:35:03.518036 [debug] [Thread-1 (]: Began executing node test.online_shopping.not_null_customer_CustomerID.e46d1b2976
[0m18:35:03.519035 [debug] [Thread-1 (]: Timing info for test.online_shopping.not_null_customer_CustomerID.e46d1b2976 (execute): 18:35:03.518036 => 18:35:03.518036
[0m18:35:03.520035 [debug] [Thread-1 (]: Finished running node test.online_shopping.not_null_customer_CustomerID.e46d1b2976
[0m18:35:03.521034 [debug] [Thread-1 (]: Began running node test.online_shopping.unique_customer_CustomerID.886776c331
[0m18:35:03.521034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shopping.not_null_customer_CustomerID.e46d1b2976, now test.online_shopping.unique_customer_CustomerID.886776c331)
[0m18:35:03.522032 [debug] [Thread-1 (]: Began compiling node test.online_shopping.unique_customer_CustomerID.886776c331
[0m18:35:03.530028 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shopping.unique_customer_CustomerID.886776c331"
[0m18:35:03.531028 [debug] [Thread-1 (]: Timing info for test.online_shopping.unique_customer_CustomerID.886776c331 (compile): 18:35:03.522032 => 18:35:03.531028
[0m18:35:03.532027 [debug] [Thread-1 (]: Began executing node test.online_shopping.unique_customer_CustomerID.886776c331
[0m18:35:03.532027 [debug] [Thread-1 (]: Timing info for test.online_shopping.unique_customer_CustomerID.886776c331 (execute): 18:35:03.532027 => 18:35:03.532027
[0m18:35:03.534029 [debug] [Thread-1 (]: Finished running node test.online_shopping.unique_customer_CustomerID.886776c331
[0m18:35:03.535026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:03.536025 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m18:35:03.536025 [debug] [MainThread]: Connection 'test.online_shopping.unique_customer_CustomerID.886776c331' was properly closed.
[0m18:35:03.539023 [debug] [MainThread]: Command end result
[0m18:35:03.571518 [debug] [MainThread]: Acquiring new sqlserver connection 'generate_catalog'
[0m18:35:03.572536 [info ] [MainThread]: Building catalog
[0m18:35:03.577514 [debug] [ThreadPool]: Acquiring new sqlserver connection 'online.information_schema'
[0m18:35:03.588508 [debug] [ThreadPool]: Using sqlserver connection "online.information_schema"
[0m18:35:03.589508 [debug] [ThreadPool]: On online.information_schema: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "online.information_schema"} */
with
    principals as (
        select
            name as principal_name,
            principal_id as principal_id
        from
            sys.database_principals 
    ),

    schemas as (
        select
            name as schema_name,
            schema_id as schema_id,
            principal_id as principal_id
        from
            sys.schemas 
    ),

    tables as (
        select
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'BASE TABLE' as table_type
        from
            sys.tables 
    ),

    tables_with_metadata as (
        select
            table_name,
            schema_name,
            coalesce(tables.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            tables
        join schemas on tables.schema_id = schemas.schema_id
    ),

    views as (
        select
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'VIEW' as table_type
        from
            sys.views 
    ),

    views_with_metadata as (
        select
            table_name,
            schema_name,
            coalesce(views.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            views
        join schemas on views.schema_id = schemas.schema_id
    ),

    tables_and_views as (
        select
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            tables_with_metadata
        join principals on tables_with_metadata.owner_principal_id = principals.principal_id
        union all
        select
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            views_with_metadata
        join principals on views_with_metadata.owner_principal_id = principals.principal_id
    ),

    cols as (

        select
            table_catalog as table_database,
            table_schema,
            table_name,
            column_name,
            ordinal_position as column_index,
            data_type as column_type
        from INFORMATION_SCHEMA.COLUMNS 

    )

    select
        cols.table_database,
        tv.schema_name as table_schema,
        tv.table_name,
        tv.table_type,
        null as table_comment,
        tv.principal_name as table_owner,
        cols.column_name,
        cols.column_index,
        cols.column_type,
        null as column_comment
    from tables_and_views tv
    join cols on tv.schema_name = cols.table_schema and tv.table_name = cols.table_name
    where (
                (
                    upper(tv.schema_name) = upper('dbt_staging')
                    and upper(tv.table_name) = upper('stg_customer')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('market')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbt_staging')
                    and upper(tv.table_name) = upper('stg_product')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbt_staging')
                    and upper(tv.table_name) = upper('stg_order')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbt_mart')
                    and upper(tv.table_name) = upper('orders')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbt_staging')
                    and upper(tv.table_name) = upper('stg_market')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbt_mart')
                    and upper(tv.table_name) = upper('customer')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbt_mart')
                    and upper(tv.table_name) = upper('product')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('shipping')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('customer')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbt_mart')
                    and upper(tv.table_name) = upper('shipping')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('order')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbo')
                    and upper(tv.table_name) = upper('product')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbt_mart')
                    and upper(tv.table_name) = upper('market')
                )
             or 
                (
                    upper(tv.schema_name) = upper('dbt_staging')
                    and upper(tv.table_name) = upper('stg_shipping')
                )
            )

    order by column_index
[0m18:35:03.589508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:03.590507 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m18:35:03.591506 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m18:35:03.711061 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:35:03.719059 [debug] [ThreadPool]: On online.information_schema: ROLLBACK
[0m18:35:03.719059 [debug] [ThreadPool]: On online.information_schema: Close
[0m18:35:03.733051 [info ] [MainThread]: Catalog written to C:\Users\NadimintiDeepthi\Desktop\online_dbt\online_shopping\target\catalog.json
[0m18:35:03.735050 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:35:03.735050 after 1.44 seconds
[0m18:35:03.736049 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:35:03.736049 [debug] [MainThread]: Connection 'online.information_schema' was properly closed.
[0m18:35:03.737049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027722C1F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027725B5FD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027725C44730>]}
[0m18:35:03.737049 [debug] [MainThread]: Flushing usage events
[0m18:35:15.660618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CCB58ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CCDE6A2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CCDE6A0E0>]}


============================== 18:35:15.666619 | 2f991b5f-42ff-4b7a-9d73-12dd56d365ee ==============================
[0m18:35:15.666619 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:35:15.667618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m18:35:16.061460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f991b5f-42ff-4b7a-9d73-12dd56d365ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CCDE6A380>]}
[0m18:35:16.164415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f991b5f-42ff-4b7a-9d73-12dd56d365ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CCE45FE50>]}
[0m08:49:41.923400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E63D998CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E64028A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E64028A140>]}


============================== 08:49:41.932391 | b22afa2f-ea6b-4f2d-a474-d2be5a8abf11 ==============================
[0m08:49:41.932391 [info ] [MainThread]: Running with dbt=1.7.9
[0m08:49:41.933390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:49:42.707366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b22afa2f-ea6b-4f2d-a474-d2be5a8abf11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E64028A3E0>]}
[0m08:49:42.809307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b22afa2f-ea6b-4f2d-a474-d2be5a8abf11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E64087FEB0>]}
[0m08:49:42.810307 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m08:49:42.836293 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m08:49:42.867275 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:49:42.867275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b22afa2f-ea6b-4f2d-a474-d2be5a8abf11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E640209C00>]}
[0m08:49:45.642684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b22afa2f-ea6b-4f2d-a474-d2be5a8abf11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E64106A230>]}
[0m08:49:45.671668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b22afa2f-ea6b-4f2d-a474-d2be5a8abf11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6409D4490>]}
[0m08:49:45.672667 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m08:49:45.673666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b22afa2f-ea6b-4f2d-a474-d2be5a8abf11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6409D6860>]}
[0m08:49:45.675664 [info ] [MainThread]: 
[0m08:49:45.676664 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m08:49:45.678665 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m08:49:45.693654 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m08:49:45.693654 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m08:49:45.694655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:45.696674 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m08:49:45.859585 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m08:49:45.865570 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:49:45.867573 [debug] [ThreadPool]: On list_online: Close
[0m08:49:45.869572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m08:49:45.870571 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m08:49:45.877549 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m08:49:45.878567 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m08:49:45.878567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:49:45.879566 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m08:49:45.879566 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m08:49:45.924524 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:49:45.925523 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m08:49:45.925523 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m08:49:45.928540 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m08:49:45.996482 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m08:49:45.997482 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m08:49:45.997482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:45.998482 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m08:49:45.998482 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m08:49:46.026464 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:49:46.028463 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m08:49:46.029462 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m08:49:46.030462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m08:49:46.035459 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m08:49:46.036458 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m08:49:46.037458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:49:46.038457 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m08:49:46.039456 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m08:49:46.048452 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:49:46.050451 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m08:49:46.050451 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m08:49:46.051450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b22afa2f-ea6b-4f2d-a474-d2be5a8abf11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6410DCA60>]}
[0m08:49:46.052451 [debug] [MainThread]: On master: COMMIT
[0m08:49:46.053450 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:49:46.053450 [info ] [MainThread]: 
[0m08:49:46.058446 [debug] [Thread-1 (]: Began running node seed.online_shopping.product
[0m08:49:46.059463 [info ] [Thread-1 (]: 1 of 1 START seed file online.dbt_mart.product ................................. [RUN]
[0m08:49:46.060463 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'seed.online_shopping.product'
[0m08:49:46.060463 [debug] [Thread-1 (]: Began compiling node seed.online_shopping.product
[0m08:49:46.061462 [debug] [Thread-1 (]: Timing info for seed.online_shopping.product (compile): 08:49:46.060463 => 08:49:46.060463
[0m08:49:46.061462 [debug] [Thread-1 (]: Began executing node seed.online_shopping.product
[0m08:49:46.103421 [debug] [Thread-1 (]: Using sqlserver connection "seed.online_shopping.product"
[0m08:49:46.103421 [debug] [Thread-1 (]: On seed.online_shopping.product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "seed.online_shopping.product"} */

    create table "online"."dbt_mart"."product" ("PRODUCT_CATEGORY" varchar(26),"PRODUCT_SUB_CATEGORY" varchar(30),"PROD_ID" varchar(16))
  
[0m08:49:46.104421 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:49:46.105420 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m08:49:46.105420 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m08:49:46.146397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:49:46.168384 [debug] [Thread-1 (]: Inserting batches of 400 records
[0m08:49:46.193368 [debug] [Thread-1 (]: Using sqlserver connection "seed.online_shopping.product"
[0m08:49:46.193368 [debug] [Thread-1 (]: On seed.online_shopping.product: 
          insert into "online"."dbt_mart"."product" ("PRODUCT_CATEGORY", "PRODUCT_SUB_CATEGORY", "PROD_ID") values
          (?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?)
      ...
[0m08:49:46.222352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:49:46.229348 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.online_shopping.product"
[0m08:49:46.255332 [debug] [Thread-1 (]: On seed.online_shopping.product: COMMIT
[0m08:49:46.257332 [debug] [Thread-1 (]: Timing info for seed.online_shopping.product (execute): 08:49:46.061462 => 08:49:46.257332
[0m08:49:46.258330 [debug] [Thread-1 (]: On seed.online_shopping.product: Close
[0m08:49:46.259332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b22afa2f-ea6b-4f2d-a474-d2be5a8abf11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E640ABAAD0>]}
[0m08:49:46.260330 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt_mart.product .................................... [[32mINSERT 17[0m in 0.20s]
[0m08:49:46.262330 [debug] [Thread-1 (]: Finished running node seed.online_shopping.product
[0m08:49:46.265342 [debug] [MainThread]: On master: COMMIT
[0m08:49:46.266347 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:49:46.267327 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m08:49:46.268327 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m08:49:46.269342 [debug] [MainThread]: Connection 'seed.online_shopping.product' was properly closed.
[0m08:49:46.270325 [info ] [MainThread]: 
[0m08:49:46.271339 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m08:49:46.272323 [debug] [MainThread]: Command end result
[0m08:49:46.293312 [info ] [MainThread]: 
[0m08:49:46.294310 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:49:46.295310 [info ] [MainThread]: 
[0m08:49:46.295310 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:49:46.298311 [debug] [MainThread]: Command `dbt seed` succeeded at 08:49:46.298311 after 4.48 seconds
[0m08:49:46.299307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E63D998CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6410A7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6410A4820>]}
[0m08:49:46.299307 [debug] [MainThread]: Flushing usage events
[0m09:09:38.435618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267737C7A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267760D23B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267760D21D0>]}


============================== 09:09:38.441614 | 4e701345-f006-40da-b120-04c5141d4504 ==============================
[0m09:09:38.441614 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:09:38.442614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:09:39.098420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e701345-f006-40da-b120-04c5141d4504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026776048EE0>]}
[0m09:09:39.217351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e701345-f006-40da-b120-04c5141d4504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267766BFF40>]}
[0m09:09:39.218352 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:09:39.247335 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:09:40.375802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:09:40.376806 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:09:40.582683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e701345-f006-40da-b120-04c5141d4504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026776A73130>]}
[0m09:09:40.607655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e701345-f006-40da-b120-04c5141d4504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026776A4FDF0>]}
[0m09:09:40.608655 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:09:40.609654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e701345-f006-40da-b120-04c5141d4504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026776A4FEE0>]}
[0m09:09:40.611655 [info ] [MainThread]: 
[0m09:09:40.612653 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:09:40.615653 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:09:40.629645 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:09:40.629645 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:09:40.630642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:09:40.630642 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:09:40.721832 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:09:40.727377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:09:40.728388 [debug] [ThreadPool]: On list_online: Close
[0m09:09:40.730392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:09:40.731391 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:09:40.737390 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:09:40.737390 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:09:40.738391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:09:40.738391 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:09:40.739386 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:09:40.754120 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:09:40.755122 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:09:40.755122 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:09:40.758156 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m09:09:40.765129 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:09:40.766129 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:09:40.766129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:09:40.767128 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:09:40.768133 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:09:40.790027 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:09:40.792041 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:09:40.792041 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:09:40.793041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m09:09:40.796039 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:09:40.796039 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:09:40.797038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:09:40.797038 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:09:40.798038 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:09:40.806019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:09:40.807033 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:09:40.808032 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:09:40.808770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e701345-f006-40da-b120-04c5141d4504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026776BD42B0>]}
[0m09:09:40.808770 [debug] [MainThread]: On master: COMMIT
[0m09:09:40.809786 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:09:40.810771 [info ] [MainThread]: 
[0m09:09:40.814150 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:09:40.815141 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:09:40.816062 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:09:40.817063 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:09:40.826058 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:09:40.827058 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:09:40.817063 => 09:09:40.827058
[0m09:09:40.828057 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:09:40.856041 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:09:40.856041 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:09:40.857041 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:09:40.857041 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:09:40.858040 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:09:40.862039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:40.866050 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:09:40.867050 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:09:40.880144 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:40.888865 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:09:40.888865 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:09:41.145501 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:41.166364 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:09:41.166364 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:09:41.215337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:41.219335 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:09:41.220334 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:09:41.222333 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:41.228329 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:09:41.228329 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:09:41.262311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:41.266309 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:09:41.268306 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:09:41.269306 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:09:41.354270 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:41.369282 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:09:41.373279 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:09:41.374274 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:09:41.542751 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:41.548748 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:09:41.548748 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:09:41.553745 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:41.559742 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:09:40.828057 => 09:09:41.559742
[0m09:09:41.560742 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:09:41.561741 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:09:41.562741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e701345-f006-40da-b120-04c5141d4504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026776C2BAC0>]}
[0m09:09:41.563739 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.75s]
[0m09:09:41.564739 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:09:41.565738 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:09:41.566737 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:09:41.567737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:09:41.568736 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:09:41.575733 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:09:41.577732 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:09:41.568736 => 09:09:41.576733
[0m09:09:41.577732 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:09:41.587726 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:09:41.587726 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:09:41.588726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:41.589725 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:09:41.589725 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:09:41.590724 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:41.592722 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:09:41.593723 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:09:41.621856 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:41.626855 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:09:41.626855 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:09:41.934495 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:41.937522 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:09:41.937522 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:09:41.957002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:41.959001 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:09:41.960000 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:09:41.961006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:41.962999 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:09:41.962999 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:09:41.976990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:41.977990 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:09:41.979987 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:09:41.979987 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:09:42.020964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:42.022963 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:09:42.023962 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:09:42.024962 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:09:42.118908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:42.122924 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:09:42.123925 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:09:42.127659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:42.129678 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:09:41.578731 => 09:09:42.129678
[0m09:09:42.129678 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:09:42.130678 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:09:42.131673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e701345-f006-40da-b120-04c5141d4504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026776A8B1C0>]}
[0m09:09:42.131673 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.56s]
[0m09:09:42.132677 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:09:42.133671 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:09:42.133671 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:09:42.134676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:09:42.135676 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:09:42.141672 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:09:42.143652 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:09:42.135676 => 09:09:42.142654
[0m09:09:42.143652 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:09:42.151647 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:09:42.151647 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:09:42.152647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:42.152647 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:09:42.153646 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:09:42.154647 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:42.157644 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:09:42.157644 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:09:42.193188 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:42.198198 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:09:42.199202 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
USE [online];
      EXEC sp_rename 'dbt_mart.orders', 'orders__dbt_backup'
[0m09:09:42.484082 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:42.488094 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:09:42.489093 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:09:42.511069 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:42.513085 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:09:42.515065 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:09:42.516063 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:42.518063 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:09:42.519062 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:09:42.538053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:42.540069 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:09:42.541049 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:09:42.542068 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),

Cust AS (
    SELECT
        *
    FROM Customers
    WHERE Region != ''NUNAVUT''
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost
    from Cust as cu
    JOIN markets as mark
    on cu.CustomerID=mark.CustomerId
)
custmarkord as (
    select cm.*,ord.OrderID,ord.OrderDate,ord.Order_Priority
    from custmarket as cm
    JOIN order as ord
    on cm.ord=ord.OrdID
)
custmarkordprod as (
    select cmo.*,pr.ProductID,pr.ProductSubCategory
    from custmarkord as cmo
    JOIN product as pr
    on cmo.ProductID=pr.ProductID
)
custmarkordprodship as (
    select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
    from custmarkordprod as cmop
    JOIN shipping as sh
    on cmop.ShippingID=sh.ShippingID
)

SELECT * FROM custmarkordprodship;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:09:42.546048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:09:42.548045 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:09:42.143652 => 09:09:42.547046
[0m09:09:42.548045 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:09:42.549046 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:09:42.550045 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'custmarkord'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'order'. (156); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'custmarkordprodship'. (102)")
[0m09:09:42.643990 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'custmarkord'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'order'. (156); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'custmarkordprodship'. (102)")

[0m09:09:42.644990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e701345-f006-40da-b120-04c5141d4504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026776C7F640>]}
[0m09:09:42.645989 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.51s]
[0m09:09:42.646990 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:09:42.648988 [debug] [MainThread]: On master: COMMIT
[0m09:09:42.649987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:09:42.649987 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:09:42.650987 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m09:09:42.650987 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:09:42.651986 [info ] [MainThread]: 
[0m09:09:42.651986 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m09:09:42.653985 [debug] [MainThread]: Command end result
[0m09:09:42.665980 [info ] [MainThread]: 
[0m09:09:42.665980 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:09:42.666978 [info ] [MainThread]: 
[0m09:09:42.667977 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'custmarkord'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'order'. (156); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'custmarkordprodship'. (102)")
[0m09:09:42.669975 [info ] [MainThread]: 
[0m09:09:42.669975 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:09:42.673974 [debug] [MainThread]: Command `dbt run` failed at 09:09:42.672975 after 4.36 seconds
[0m09:09:42.673974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267737C7A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677672C7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026776C7FB50>]}
[0m09:09:42.674973 [debug] [MainThread]: Flushing usage events
[0m09:10:27.243875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93156ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F933E522F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F933E52110>]}


============================== 09:10:27.250871 | e8bcc9f0-6883-460a-84c6-a459b488f17d ==============================
[0m09:10:27.250871 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:10:27.251857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:10:27.644559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8bcc9f0-6883-460a-84c6-a459b488f17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F933E523B0>]}
[0m09:10:27.745500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8bcc9f0-6883-460a-84c6-a459b488f17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F934443E80>]}
[0m09:10:27.746499 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:10:27.758493 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:10:27.887437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:10:27.888437 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:10:28.100296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8bcc9f0-6883-460a-84c6-a459b488f17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9347F3070>]}
[0m09:10:28.117287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8bcc9f0-6883-460a-84c6-a459b488f17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9347CFD30>]}
[0m09:10:28.118286 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:10:28.119293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8bcc9f0-6883-460a-84c6-a459b488f17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9347CFEE0>]}
[0m09:10:28.121286 [info ] [MainThread]: 
[0m09:10:28.122285 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:10:28.125282 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:10:28.141273 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:10:28.142272 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:10:28.142272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:28.143271 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:10:28.214202 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:10:28.217202 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:10:28.219219 [debug] [ThreadPool]: On list_online: Close
[0m09:10:28.221218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:10:28.223220 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:10:28.234213 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:10:28.235213 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:10:28.236212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:28.237191 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:10:28.238191 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:10:28.244208 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:10:28.246206 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:10:28.247206 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:10:28.252183 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m09:10:28.260191 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:10:28.260191 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:10:28.260191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:28.261190 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:10:28.261190 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:10:28.275525 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:10:28.276527 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:10:28.277526 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:10:28.278525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m09:10:28.281523 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:10:28.281523 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:10:28.282523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:28.282523 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:10:28.283522 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:10:28.291236 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:10:28.292235 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:10:28.293235 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:10:28.294235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8bcc9f0-6883-460a-84c6-a459b488f17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93496C8E0>]}
[0m09:10:28.294235 [debug] [MainThread]: On master: COMMIT
[0m09:10:28.295239 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:10:28.296251 [info ] [MainThread]: 
[0m09:10:28.300154 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:10:28.300154 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:10:28.301399 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:10:28.302400 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:10:28.311395 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:10:28.313395 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:10:28.302400 => 09:10:28.313395
[0m09:10:28.314395 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:10:28.342380 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:10:28.343379 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:10:28.344376 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:10:28.344376 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:10:28.345391 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:10:28.346389 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.350373 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:10:28.350373 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:10:28.361692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.369686 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:10:28.370686 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:10:28.569523 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.589523 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:10:28.589523 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:10:28.603524 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.606522 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:10:28.607518 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:10:28.608516 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.613518 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:10:28.613518 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:10:28.614513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.617511 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:10:28.618515 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:10:28.619515 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:10:28.660878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.675885 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:10:28.679883 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:10:28.680883 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:10:28.751827 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.756825 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:10:28.756825 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:10:28.759824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.764821 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:10:28.314395 => 09:10:28.764821
[0m09:10:28.765824 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:10:28.765824 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:10:28.766819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8bcc9f0-6883-460a-84c6-a459b488f17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9349ABFA0>]}
[0m09:10:28.767819 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.47s]
[0m09:10:28.768818 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:10:28.769818 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:10:28.770817 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:10:28.771817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:10:28.771817 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:10:28.776814 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:10:28.777813 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:10:28.772816 => 09:10:28.777813
[0m09:10:28.777813 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:10:28.785809 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:10:28.786808 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:10:28.787807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:28.787807 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:10:28.788807 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:10:28.789807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.790805 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:10:28.791805 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:10:28.800694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.805694 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:10:28.805694 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:10:28.808711 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.812690 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:10:28.813689 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:10:28.825689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.828681 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:10:28.829688 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:10:28.830681 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.832679 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:10:28.833678 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:10:28.834310 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.835330 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:10:28.837313 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:10:28.837313 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:10:28.869929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.871943 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:10:28.872942 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:10:28.872942 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:10:28.938905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.942902 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:10:28.943901 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:10:28.947158 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.949173 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:10:28.778812 => 09:10:28.949173
[0m09:10:28.950172 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:10:28.950172 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:10:28.951171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8bcc9f0-6883-460a-84c6-a459b488f17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F934808CD0>]}
[0m09:10:28.951171 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.18s]
[0m09:10:28.953157 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:10:28.953157 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:10:28.954156 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:10:28.955156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:10:28.955156 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:10:28.961166 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:10:28.963150 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:10:28.956169 => 09:10:28.962165
[0m09:10:28.963150 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:10:28.970165 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:10:28.970165 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:10:28.971165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:28.971165 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:10:28.972159 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:10:28.974988 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.977989 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:10:28.977989 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:10:28.987074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:28.990074 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:10:28.990074 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:10:29.002057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:29.004056 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:10:29.004056 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:10:29.005645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:29.006647 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:10:29.007646 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:10:29.008425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:29.009428 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:10:29.011425 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:10:29.012425 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),

Cust AS (
    SELECT
        *
    FROM Customers
    WHERE Region != ''NUNAVUT''
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost
    from Cust as cu
    JOIN markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*,ord.OrderID,ord.OrderDate,ord.Order_Priority
    from custmarket as cm
    JOIN order as ord
    on cm.ord=ord.OrdID
),
custmarkordprod as (
    select cmo.*,pr.ProductID,pr.ProductSubCategory
    from custmarkord as cmo
    JOIN product as pr
    on cmo.ProductID=pr.ProductID
),
custmarkordprodship as (
    select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
    from custmarkordprod as cmop
    JOIN shipping as sh
    on cmop.ShippingID=sh.ShippingID
)

SELECT * FROM custmarkordprodship;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:10:29.016568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:10:29.017566 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:10:28.963150 => 09:10:29.017566
[0m09:10:29.017566 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:10:29.018565 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:10:29.019564 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'order'. (156) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102)")
[0m09:10:29.023549 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'order'. (156) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102)")

[0m09:10:29.023549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8bcc9f0-6883-460a-84c6-a459b488f17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9349FFE80>]}
[0m09:10:29.024548 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.07s]
[0m09:10:29.026547 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:10:29.028560 [debug] [MainThread]: On master: COMMIT
[0m09:10:29.029549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:10:29.029549 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:10:29.030559 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m09:10:29.030559 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:10:29.031558 [info ] [MainThread]: 
[0m09:10:29.031558 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m09:10:29.033557 [debug] [MainThread]: Command end result
[0m09:10:29.048535 [info ] [MainThread]: 
[0m09:10:29.050534 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:10:29.051534 [info ] [MainThread]: 
[0m09:10:29.053531 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'order'. (156) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102)")
[0m09:10:29.054531 [info ] [MainThread]: 
[0m09:10:29.055530 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:10:29.058528 [debug] [MainThread]: Command `dbt run` failed at 09:10:29.057529 after 1.91 seconds
[0m09:10:29.059533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93156ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9345D96C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9349FD1E0>]}
[0m09:10:29.060528 [debug] [MainThread]: Flushing usage events
[0m09:11:56.642425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236617CF5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236640C2380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236640C21A0>]}


============================== 09:11:56.649422 | 03e5b9d5-4bff-4894-af3d-39bd22729fa4 ==============================
[0m09:11:56.649422 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:11:56.650421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:11:57.080363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03e5b9d5-4bff-4894-af3d-39bd22729fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236640C2440>]}
[0m09:11:57.185312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03e5b9d5-4bff-4894-af3d-39bd22729fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236646B3F10>]}
[0m09:11:57.185312 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:11:57.200477 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:11:57.332400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:11:57.333398 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:11:57.563269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03e5b9d5-4bff-4894-af3d-39bd22729fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023664A63100>]}
[0m09:11:57.579259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03e5b9d5-4bff-4894-af3d-39bd22729fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023664A3FDC0>]}
[0m09:11:57.580259 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:11:57.581257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03e5b9d5-4bff-4894-af3d-39bd22729fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023664A3FEB0>]}
[0m09:11:57.583256 [info ] [MainThread]: 
[0m09:11:57.584257 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:11:57.586255 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:11:57.601246 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:11:57.602250 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:11:57.603247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:57.604248 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:11:57.685295 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:11:57.690041 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:11:57.691043 [debug] [ThreadPool]: On list_online: Close
[0m09:11:57.693041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:11:57.693041 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:11:57.699038 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:11:57.699038 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:11:57.700037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:11:57.700037 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:11:57.701037 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:11:57.718840 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:11:57.719829 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:11:57.720839 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:11:57.722847 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m09:11:57.729834 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:11:57.729834 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:11:57.730834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:57.730834 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:11:57.731833 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:11:57.751493 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:11:57.752495 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:11:57.753494 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:11:57.754493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m09:11:57.757492 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:11:57.757492 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:11:57.758491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:11:57.758491 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:11:57.759490 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:11:57.766938 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:11:57.767938 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:11:57.767938 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:11:57.768937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03e5b9d5-4bff-4894-af3d-39bd22729fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366466BDC0>]}
[0m09:11:57.769936 [debug] [MainThread]: On master: COMMIT
[0m09:11:57.770936 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:11:57.771922 [info ] [MainThread]: 
[0m09:11:57.775740 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:11:57.775740 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:11:57.777012 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:11:57.778028 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:11:57.788026 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:11:57.790006 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:11:57.778028 => 09:11:57.790006
[0m09:11:57.791024 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:11:57.821007 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:11:57.822007 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:11:57.822007 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:11:57.823006 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:11:57.823006 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:11:57.825987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:57.829985 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:11:57.830984 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:11:57.846214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:57.855229 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:11:57.855229 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:11:58.101261 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.119245 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:11:58.119245 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:11:58.135590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.139608 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:11:58.139608 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:11:58.140607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.145604 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:11:58.146604 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:11:58.147598 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.149597 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:11:58.151587 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:11:58.151587 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:11:58.201556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.217567 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:11:58.221565 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:11:58.221565 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:11:58.293618 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.298619 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:11:58.299618 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:11:58.301486 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.305485 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:11:57.791024 => 09:11:58.305485
[0m09:11:58.306485 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:11:58.306485 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:11:58.307484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e5b9d5-4bff-4894-af3d-39bd22729fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023664C13A90>]}
[0m09:11:58.308484 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.53s]
[0m09:11:58.309321 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:11:58.310339 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:11:58.311324 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:11:58.312336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:11:58.312336 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:11:58.317338 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:11:58.318320 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:11:58.313336 => 09:11:58.318320
[0m09:11:58.319337 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:11:58.328325 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:11:58.328325 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:11:58.329325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:58.330325 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:11:58.330325 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:11:58.331311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.333311 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:11:58.333311 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:11:58.343317 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.348302 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:11:58.349302 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:11:58.351987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.355009 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:11:58.356006 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:11:58.366980 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.368995 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:11:58.369978 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:11:58.370979 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.373977 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:11:58.373977 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:11:58.374990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.375989 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:11:58.377974 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:11:58.377974 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:11:58.408441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.411440 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:11:58.412439 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:11:58.413451 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:11:58.478998 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.482996 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:11:58.483995 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:11:58.486980 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.488998 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:11:58.320337 => 09:11:58.488998
[0m09:11:58.489997 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:11:58.489997 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:11:58.490996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e5b9d5-4bff-4894-af3d-39bd22729fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023664A7B100>]}
[0m09:11:58.491996 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.18s]
[0m09:11:58.492985 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:11:58.492985 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:11:58.493976 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:11:58.494977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:11:58.495993 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:11:58.502984 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:11:58.504972 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:11:58.495993 => 09:11:58.503972
[0m09:11:58.505989 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:11:58.511965 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:11:58.512985 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:11:58.513985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:58.513985 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:11:58.514985 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:11:58.515982 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.517981 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:11:58.517981 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:11:58.527975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.530974 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:11:58.531973 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:11:58.543969 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.545965 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:11:58.545965 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:11:58.546964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.548963 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:11:58.549962 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:11:58.549962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.551961 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:11:58.552942 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:11:58.553941 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),

Cust AS (
    SELECT
        *
    FROM Customers
    WHERE Region != ''NUNAVUT''
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost
    from Cust as cu
    JOIN markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*,ord.OrderID,ord.OrderDate,ord.Order_Priority
    from custmarket as cm
    JOIN orders as ord
    on cm.ord=ord.OrdID
),
custmarkordprod as (
    select cmo.*,pr.ProductID,pr.ProductSubCategory
    from custmarkord as cmo
    JOIN products as pr
    on cmo.ProductID=pr.ProductID
),
custmarkordprodship as (
    select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
    from custmarkordprod as cmop
    JOIN shippings as sh
    on cmop.ShippingID=sh.ShippingID
)

SELECT * FROM custmarkordprodship;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:11:58.561956 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:11:58.563956 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:11:58.505989 => 09:11:58.562955
[0m09:11:58.563956 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:11:58.564954 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:11:58.565955 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ord'. (207) (SQLMoreResults)")
[0m09:11:58.568934 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ord'. (207) (SQLMoreResults)")

[0m09:11:58.569933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e5b9d5-4bff-4894-af3d-39bd22729fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023664C6DFF0>]}
[0m09:11:58.570932 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.07s]
[0m09:11:58.572933 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:11:58.574929 [debug] [MainThread]: On master: COMMIT
[0m09:11:58.575929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:11:58.575929 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:11:58.576928 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m09:11:58.576928 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:11:58.576928 [info ] [MainThread]: 
[0m09:11:58.577928 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m09:11:58.579942 [debug] [MainThread]: Command end result
[0m09:11:58.594939 [info ] [MainThread]: 
[0m09:11:58.596919 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:11:58.597916 [info ] [MainThread]: 
[0m09:11:58.597916 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ord'. (207) (SQLMoreResults)")
[0m09:11:58.598935 [info ] [MainThread]: 
[0m09:11:58.599916 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:11:58.601914 [debug] [MainThread]: Command `dbt run` failed at 09:11:58.601914 after 2.04 seconds
[0m09:11:58.602914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236617CF5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023664C7EDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023664C6D600>]}
[0m09:11:58.602914 [debug] [MainThread]: Flushing usage events
[0m09:16:23.601787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BACB0F940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BAF402290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BAF4020B0>]}


============================== 09:16:23.607772 | b8eedd25-b297-4b56-8562-922182e999de ==============================
[0m09:16:23.607772 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:16:23.608772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:16:24.008183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8eedd25-b297-4b56-8562-922182e999de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BAF402350>]}
[0m09:16:24.108112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8eedd25-b297-4b56-8562-922182e999de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BAFB8DD20>]}
[0m09:16:24.109111 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:16:24.121452 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:16:24.247368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:16:24.248368 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:16:24.457264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8eedd25-b297-4b56-8562-922182e999de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BAFDA3010>]}
[0m09:16:24.473237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8eedd25-b297-4b56-8562-922182e999de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BAFD7FFD0>]}
[0m09:16:24.473237 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:16:24.474236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8eedd25-b297-4b56-8562-922182e999de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BAFD7FE80>]}
[0m09:16:24.476235 [info ] [MainThread]: 
[0m09:16:24.477234 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:16:24.479233 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:16:24.498244 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:16:24.498244 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:16:24.499241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:24.499241 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:16:24.601626 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:16:24.606621 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:16:24.608621 [debug] [ThreadPool]: On list_online: Close
[0m09:16:24.610618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:16:24.611619 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:16:24.617628 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:16:24.617628 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:16:24.618628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:16:24.618628 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:16:24.619627 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:16:24.639371 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:16:24.640387 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:16:24.641386 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:16:24.643854 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m09:16:24.650852 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:16:24.650852 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:16:24.651851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:24.651851 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:16:24.652850 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:16:24.673739 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:16:24.675718 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:16:24.675718 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:16:24.676718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m09:16:24.679716 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:16:24.679716 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:16:24.680715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:16:24.680715 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:16:24.681715 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:16:24.689274 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:16:24.690273 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:16:24.691272 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:16:24.692271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8eedd25-b297-4b56-8562-922182e999de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BAFF1CD60>]}
[0m09:16:24.692271 [debug] [MainThread]: On master: COMMIT
[0m09:16:24.693288 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:16:24.694271 [info ] [MainThread]: 
[0m09:16:24.698101 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:16:24.698101 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:16:24.699356 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:16:24.700357 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:16:24.710365 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:16:24.712353 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:16:24.700357 => 09:16:24.712353
[0m09:16:24.713351 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:16:24.746332 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:16:24.746332 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:16:24.747332 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:16:24.748336 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:16:24.749331 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:16:24.750932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:24.754926 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:16:24.755925 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:16:24.768248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:24.776259 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:16:24.776259 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:16:25.010063 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.030072 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:16:25.030072 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:16:25.046058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.051042 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:16:25.051042 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:16:25.052059 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.058056 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:16:25.058056 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:16:25.059055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.062054 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:16:25.063053 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:16:25.064052 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:16:25.114691 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.134678 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:16:25.139675 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:16:25.140675 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:16:25.216643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.221640 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:16:25.221640 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:16:25.224624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.228636 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:16:24.713351 => 09:16:25.228636
[0m09:16:25.229635 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:16:25.229635 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:16:25.230635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8eedd25-b297-4b56-8562-922182e999de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BAFF57F40>]}
[0m09:16:25.231634 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.53s]
[0m09:16:25.232639 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:16:25.232639 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:16:25.233634 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:16:25.234637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:16:25.234637 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:16:25.239635 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:16:25.240616 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:16:25.235637 => 09:16:25.240616
[0m09:16:25.241617 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:16:25.249625 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:16:25.249625 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:16:25.250617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:25.250617 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:16:25.251624 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:16:25.252622 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.254621 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:16:25.254621 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:16:25.263617 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.268619 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:16:25.268619 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:16:25.272598 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.275607 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:16:25.275607 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:16:25.287602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.289602 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:16:25.289602 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:16:25.290732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.291734 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:16:25.292733 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:16:25.293635 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.294636 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:16:25.295635 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:16:25.296635 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:16:25.328944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.330959 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:16:25.331958 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:16:25.331958 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:16:25.397907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.402904 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:16:25.403903 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:16:25.405793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.407807 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:16:25.241617 => 09:16:25.407807
[0m09:16:25.407807 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:16:25.408807 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:16:25.409806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8eedd25-b297-4b56-8562-922182e999de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BAFDB9990>]}
[0m09:16:25.409806 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.17s]
[0m09:16:25.410833 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:16:25.411805 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:16:25.412805 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:16:25.413791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:16:25.413791 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:16:25.419787 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:16:25.421786 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:16:25.413791 => 09:16:25.420786
[0m09:16:25.421786 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:16:25.427782 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:16:25.428817 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:16:25.429782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:25.430781 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:16:25.431780 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:16:25.433780 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.435797 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:16:25.436796 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:16:25.444792 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.447789 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:16:25.448789 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:16:25.463762 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.466770 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:16:25.467760 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:16:25.469758 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.472756 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:16:25.472756 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:16:25.473756 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.474755 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:16:25.476754 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:16:25.477754 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),

Cust AS (
    SELECT
        *
    FROM Customers
    WHERE Region != ''NUNAVUT''
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost
    from Cust as cu
    JOIN markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*,ord.OrderID,ord.OrderDate,ord.Order_Priority
    from custmarket as cm
    JOIN orders as ord
    on cm.Ord=ord.OrdID
),
custmarkordprod as (
    select cmo.*,pr.ProductID,pr.ProductSubCategory
    from custmarkord as cmo
    JOIN products as pr
    on cmo.ProductID=pr.ProductID
),
custmarkordprodship as (
    select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
    from custmarkordprod as cmop
    JOIN shippings as sh
    on cmop.ShippingID=sh.ShippingID
)

SELECT * FROM custmarkordprodship;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:16:25.480752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:16:25.482751 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:16:25.421786 => 09:16:25.481751
[0m09:16:25.482751 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:16:25.483752 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:16:25.484750 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Ord'. (207) (SQLMoreResults)")
[0m09:16:25.488747 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Ord'. (207) (SQLMoreResults)")

[0m09:16:25.489747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8eedd25-b297-4b56-8562-922182e999de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BAFFAFBE0>]}
[0m09:16:25.490746 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.08s]
[0m09:16:25.491746 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:16:25.493744 [debug] [MainThread]: On master: COMMIT
[0m09:16:25.494744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:16:25.495743 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:16:25.495743 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m09:16:25.495743 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:16:25.496743 [info ] [MainThread]: 
[0m09:16:25.497742 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m09:16:25.498742 [debug] [MainThread]: Command end result
[0m09:16:25.514732 [info ] [MainThread]: 
[0m09:16:25.516732 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:16:25.517733 [info ] [MainThread]: 
[0m09:16:25.519730 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Ord'. (207) (SQLMoreResults)")
[0m09:16:25.520731 [info ] [MainThread]: 
[0m09:16:25.521729 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:16:25.523728 [debug] [MainThread]: Command `dbt run` failed at 09:16:25.523728 after 2.01 seconds
[0m09:16:25.524727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BACB0F940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB0260E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BAFFAED40>]}
[0m09:16:25.525726 [debug] [MainThread]: Flushing usage events
[0m09:17:52.969068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001619F36F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161A1C62350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161A1C62170>]}


============================== 09:17:52.976043 | eed753cb-b133-4c4c-bcb7-04f9900fc12d ==============================
[0m09:17:52.976043 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:17:52.977043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:17:53.580098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eed753cb-b133-4c4c-bcb7-04f9900fc12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161A1C62410>]}
[0m09:17:53.682040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eed753cb-b133-4c4c-bcb7-04f9900fc12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161A224FEE0>]}
[0m09:17:53.683039 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:17:53.708770 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:17:54.836237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:17:54.837236 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:17:55.045113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eed753cb-b133-4c4c-bcb7-04f9900fc12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161A26030D0>]}
[0m09:17:55.071098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eed753cb-b133-4c4c-bcb7-04f9900fc12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161A25DFD90>]}
[0m09:17:55.072083 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:17:55.073083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eed753cb-b133-4c4c-bcb7-04f9900fc12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161A25DFD00>]}
[0m09:17:55.075081 [info ] [MainThread]: 
[0m09:17:55.076081 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:17:55.078080 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:17:55.094084 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:17:55.095070 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:17:55.096070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:17:55.096070 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:17:55.191363 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:17:55.197420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:17:55.199436 [debug] [ThreadPool]: On list_online: Close
[0m09:17:55.200444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:17:55.201446 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:17:55.207442 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:17:55.207442 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:17:55.208442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:17:55.208442 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:17:55.208442 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:17:55.227162 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:17:55.228164 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:17:55.229163 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:17:55.231047 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m09:17:55.238044 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:17:55.239044 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:17:55.239044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:17:55.240043 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:17:55.240043 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:17:55.260948 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:17:55.261948 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:17:55.262948 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:17:55.263948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m09:17:55.266945 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:17:55.267930 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:17:55.267930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:17:55.268944 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:17:55.268944 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:17:55.276939 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:17:55.277938 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:17:55.278937 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:17:55.279943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eed753cb-b133-4c4c-bcb7-04f9900fc12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161A27741F0>]}
[0m09:17:55.279943 [debug] [MainThread]: On master: COMMIT
[0m09:17:55.280937 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:17:55.281941 [info ] [MainThread]: 
[0m09:17:55.286079 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:17:55.286079 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:17:55.287382 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:17:55.288400 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:17:55.299395 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:17:55.301378 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:17:55.288400 => 09:17:55.300378
[0m09:17:55.301378 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:17:55.335358 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:17:55.335358 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:17:55.336358 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:17:55.336358 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:17:55.337357 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:17:55.340147 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.344161 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:17:55.345161 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:17:55.357669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.366687 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:17:55.367684 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:17:55.595971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.613976 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:17:55.614975 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:17:55.630391 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.634390 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:17:55.634390 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:17:55.635692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.640691 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:17:55.640691 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:17:55.641825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.643826 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:17:55.645824 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:17:55.645824 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:17:55.699651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.714658 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:17:55.718655 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:17:55.718655 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:17:55.790614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.794612 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:17:55.795613 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:17:55.797743 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.801756 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:17:55.302377 => 09:17:55.801756
[0m09:17:55.802755 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:17:55.802755 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:17:55.803755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eed753cb-b133-4c4c-bcb7-04f9900fc12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161A27B3FD0>]}
[0m09:17:55.804754 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.52s]
[0m09:17:55.805747 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:17:55.806740 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:17:55.806740 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:17:55.807750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:17:55.808752 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:17:55.812750 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:17:55.813737 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:17:55.808752 => 09:17:55.813737
[0m09:17:55.813737 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:17:55.821745 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:17:55.821745 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:17:55.822744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:17:55.822744 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:17:55.823743 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:17:55.824729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.826742 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:17:55.826742 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:17:55.836738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.840734 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:17:55.840734 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:17:55.844005 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.847006 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:17:55.847006 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:17:55.858199 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.860203 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:17:55.861193 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:17:55.862198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.863193 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:17:55.864184 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:17:55.865177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.867176 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:17:55.869177 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:17:55.869177 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:17:55.900648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.902662 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:17:55.903662 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:17:55.904647 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:17:55.970628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.975620 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:17:55.975620 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:17:55.979226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:55.981227 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:17:55.814748 => 09:17:55.981227
[0m09:17:55.981227 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:17:55.982226 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:17:55.983226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eed753cb-b133-4c4c-bcb7-04f9900fc12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161A26194E0>]}
[0m09:17:55.984225 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.17s]
[0m09:17:55.985225 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:17:55.986228 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:17:55.986228 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:17:55.987236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:17:55.988223 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:17:55.995219 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:17:55.996218 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:17:55.988223 => 09:17:55.996218
[0m09:17:55.997218 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:17:56.005232 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:17:56.006232 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:17:56.007215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:17:56.007215 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:17:56.008213 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:17:56.009213 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:56.011211 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:17:56.011211 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:17:56.021206 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:56.024204 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:17:56.024204 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:17:56.042192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:56.044193 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:17:56.045190 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:17:56.047189 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:56.049201 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:17:56.050191 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:17:56.052189 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:56.055185 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:17:56.057184 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:17:56.057184 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),

Cust AS (
    SELECT
        *
    FROM Customers
    WHERE Region != ''NUNAVUT''
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost
    from Cust as cu
    JOIN markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*,ord.OrderID,ord.OrderDate,ord.Order_Priority
    from custmarket as cm
    JOIN Orders as ord
    on cm.Ord=ord.OrdID
),
custmarkordprod as (
    select cmo.*,pr.ProductID,pr.ProductSubCategory
    from custmarkord as cmo
    JOIN products as pr
    on cmo.ProductID=pr.ProductID
),
custmarkordprodship as (
    select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
    from custmarkordprod as cmop
    JOIN shippings as sh
    on cmop.ShippingID=sh.ShippingID
)

SELECT * FROM custmarkordprodship;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:17:56.061184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:17:56.063181 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:17:55.998218 => 09:17:56.062182
[0m09:17:56.064180 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:17:56.065179 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:17:56.069179 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Ord'. (207) (SQLMoreResults)")
[0m09:17:56.160124 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Ord'. (207) (SQLMoreResults)")

[0m09:17:56.160124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eed753cb-b133-4c4c-bcb7-04f9900fc12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161A28125F0>]}
[0m09:17:56.161124 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.17s]
[0m09:17:56.162124 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:17:56.164122 [debug] [MainThread]: On master: COMMIT
[0m09:17:56.165121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:17:56.165121 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:17:56.165121 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m09:17:56.166121 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:17:56.166121 [info ] [MainThread]: 
[0m09:17:56.167120 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m09:17:56.168121 [debug] [MainThread]: Command end result
[0m09:17:56.182112 [info ] [MainThread]: 
[0m09:17:56.184111 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:17:56.185110 [info ] [MainThread]: 
[0m09:17:56.186110 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Ord'. (207) (SQLMoreResults)")
[0m09:17:56.187109 [info ] [MainThread]: 
[0m09:17:56.188113 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:17:56.191127 [debug] [MainThread]: Command `dbt run` failed at 09:17:56.191127 after 3.33 seconds
[0m09:17:56.192106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001619F36F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161A1BDA6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161A2ACCEE0>]}
[0m09:17:56.192106 [debug] [MainThread]: Flushing usage events
[0m09:21:58.590049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B6FBF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B98A2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B98A2170>]}


============================== 09:21:58.597045 | 9848ba4f-605e-4294-907c-f7b90f3b77b1 ==============================
[0m09:21:58.597045 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:21:58.598042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:21:59.130096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9848ba4f-605e-4294-907c-f7b90f3b77b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B98A2410>]}
[0m09:21:59.230054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9848ba4f-605e-4294-907c-f7b90f3b77b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B9E8FEE0>]}
[0m09:21:59.230054 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:21:59.244613 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:21:59.436019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:21:59.437018 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:21:59.658773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9848ba4f-605e-4294-907c-f7b90f3b77b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BA2430D0>]}
[0m09:21:59.675614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9848ba4f-605e-4294-907c-f7b90f3b77b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BA21FD90>]}
[0m09:21:59.675614 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:21:59.676630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9848ba4f-605e-4294-907c-f7b90f3b77b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BA21FD00>]}
[0m09:21:59.679621 [info ] [MainThread]: 
[0m09:21:59.680610 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:21:59.682616 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:21:59.696600 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:21:59.697600 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:21:59.697600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:21:59.698599 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:21:59.853642 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:21:59.859116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:21:59.861143 [debug] [ThreadPool]: On list_online: Close
[0m09:21:59.863122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:21:59.864121 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:21:59.869118 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:21:59.869118 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:21:59.870117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:59.870117 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:21:59.871116 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:21:59.884060 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:21:59.885061 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:21:59.886060 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:21:59.888060 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m09:21:59.895075 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:21:59.896075 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:21:59.896075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:21:59.897074 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:21:59.897074 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:21:59.914078 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:21:59.915094 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:21:59.916731 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:21:59.917747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m09:21:59.920744 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:21:59.920744 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:21:59.920744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:59.921744 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:21:59.921744 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:21:59.929744 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:21:59.930739 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:21:59.931739 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:21:59.932731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9848ba4f-605e-4294-907c-f7b90f3b77b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BA3A41F0>]}
[0m09:21:59.932731 [debug] [MainThread]: On master: COMMIT
[0m09:21:59.933736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:21:59.934732 [info ] [MainThread]: 
[0m09:21:59.939981 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:21:59.940983 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:21:59.941435 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:21:59.942451 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:21:59.953440 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:21:59.955430 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:21:59.942451 => 09:21:59.954440
[0m09:21:59.955430 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:21:59.985412 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:21:59.985412 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:21:59.986411 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:21:59.987425 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:21:59.987425 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:21:59.990475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:21:59.994485 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:21:59.994485 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:22:00.010627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.018640 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:22:00.018640 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:22:00.262697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.281645 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:22:00.281645 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:22:00.297664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.301677 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:22:00.301677 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:22:00.302682 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.307674 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:22:00.308673 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:22:00.308673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.311671 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:22:00.312671 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:22:00.313675 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:22:00.366220 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.381225 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:22:00.385225 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:22:00.386224 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:22:00.456622 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.461619 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:22:00.462619 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:22:00.464842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.469855 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:21:59.955430 => 09:22:00.468860
[0m09:22:00.469855 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:22:00.470855 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:22:00.470855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9848ba4f-605e-4294-907c-f7b90f3b77b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BA3FBFD0>]}
[0m09:22:00.471859 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.53s]
[0m09:22:00.472839 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:22:00.473854 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:22:00.473854 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:22:00.474857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:22:00.475852 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:22:00.479854 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:22:00.481836 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:22:00.475852 => 09:22:00.480854
[0m09:22:00.481836 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:22:00.488832 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:00.488832 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:22:00.489831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:00.489831 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:22:00.490831 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:22:00.491843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.493842 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:00.493842 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:22:00.504835 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.508826 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:00.509832 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:22:00.512531 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.515545 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:00.515545 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:22:00.527540 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.529538 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:00.529538 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:22:00.530537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.532521 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:00.532521 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:22:00.533540 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.535520 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:22:00.537540 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:00.537540 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:22:00.568954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.571964 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:22:00.571964 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:00.572964 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:22:00.638133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.643130 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:00.644130 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:22:00.646109 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.648127 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:22:00.481836 => 09:22:00.647128
[0m09:22:00.648127 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:22:00.649127 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:22:00.650127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9848ba4f-605e-4294-907c-f7b90f3b77b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BA25AA10>]}
[0m09:22:00.650127 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.18s]
[0m09:22:00.652125 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:22:00.652125 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:22:00.653124 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:22:00.654107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:22:00.654107 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:22:00.661103 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:22:00.663102 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:22:00.654107 => 09:22:00.662111
[0m09:22:00.664100 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:22:00.672114 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:22:00.673112 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:22:00.673112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:00.674113 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:22:00.674113 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:22:00.675112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.677110 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:22:00.678110 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:22:00.690103 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.693101 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:22:00.693101 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:22:00.710091 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.712072 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:22:00.713071 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:22:00.714089 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.715084 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:22:00.716083 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:22:00.717074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.719068 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:22:00.721066 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:22:00.721066 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),

Cust AS (
    SELECT
        *
    FROM Customers
    WHERE Region != ''NUNAVUT''
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost
    from Cust as cu
    JOIN markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*,ord.OrderID,ord.OrderDate,ord.Order_Priority
    from custmarket as cm
    JOIN Orders as ord
    on cm.Ord = ord.OrdID
),
custmarkordprod as (
    select cmo.*,pr.ProductID,pr.ProductSubCategory
    from custmarkord as cmo
    JOIN products as pr
    on cmo.ProductID=pr.ProductID
),
custmarkordprodship as (
    select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
    from custmarkordprod as cmop
    JOIN shippings as sh
    on cmop.ShippingID=sh.ShippingID
)

SELECT * FROM custmarkordprodship;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:22:00.723080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:00.725082 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:22:00.664100 => 09:22:00.724083
[0m09:22:00.725082 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:22:00.726078 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:22:00.727077 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Ord'. (207) (SQLMoreResults)")
[0m09:22:00.734126 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Ord'. (207) (SQLMoreResults)")

[0m09:22:00.735141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9848ba4f-605e-4294-907c-f7b90f3b77b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BA44E5F0>]}
[0m09:22:00.736140 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.08s]
[0m09:22:00.737123 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:22:00.739122 [debug] [MainThread]: On master: COMMIT
[0m09:22:00.740136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:22:00.740136 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:22:00.741135 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m09:22:00.741135 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:22:00.742134 [info ] [MainThread]: 
[0m09:22:00.743120 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m09:22:00.744118 [debug] [MainThread]: Command end result
[0m09:22:00.759112 [info ] [MainThread]: 
[0m09:22:00.760109 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:22:00.761109 [info ] [MainThread]: 
[0m09:22:00.762110 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Ord'. (207) (SQLMoreResults)")
[0m09:22:00.762110 [info ] [MainThread]: 
[0m09:22:00.763109 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:22:00.765113 [debug] [MainThread]: Command `dbt run` failed at 09:22:00.765113 after 2.27 seconds
[0m09:22:00.766126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B6FBF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BA3A6590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BA3B5DE0>]}
[0m09:22:00.766126 [debug] [MainThread]: Flushing usage events
[0m09:22:42.974082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278734FF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027875DE2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027875DE2170>]}


============================== 09:22:42.980079 | 25e5e509-ca52-4f79-85b3-b55c2fd29b5a ==============================
[0m09:22:42.980079 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:22:42.981077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:22:43.380498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25e5e509-ca52-4f79-85b3-b55c2fd29b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027875DE2410>]}
[0m09:22:43.480441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25e5e509-ca52-4f79-85b3-b55c2fd29b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278763CFEE0>]}
[0m09:22:43.481441 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:22:43.495438 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:22:43.628874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:22:43.629874 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:22:43.847754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25e5e509-ca52-4f79-85b3-b55c2fd29b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278767830D0>]}
[0m09:22:43.865725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25e5e509-ca52-4f79-85b3-b55c2fd29b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787675FD90>]}
[0m09:22:43.866724 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:22:43.867725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25e5e509-ca52-4f79-85b3-b55c2fd29b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787675FD00>]}
[0m09:22:43.870735 [info ] [MainThread]: 
[0m09:22:43.871734 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:22:43.873734 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:22:43.890724 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:22:43.891724 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:22:43.891724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:22:43.892723 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:22:43.941700 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:22:43.942682 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:22:43.944683 [debug] [ThreadPool]: On list_online: Close
[0m09:22:43.945698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:22:43.946698 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:22:43.954674 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:22:43.954674 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:22:43.955673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:22:43.955673 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:22:43.956686 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:22:43.957673 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:22:43.958691 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:22:43.959685 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:22:43.961684 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m09:22:43.969684 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:22:43.970664 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:22:43.971682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:22:43.971682 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:22:43.972675 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:22:43.973682 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:22:43.975680 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:22:43.975680 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:22:43.976661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m09:22:43.979678 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:22:43.980677 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:22:43.980677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:22:43.981676 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:22:43.981676 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:22:43.982676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:22:43.984675 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:22:43.984675 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:22:43.985675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25e5e509-ca52-4f79-85b3-b55c2fd29b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278768E41F0>]}
[0m09:22:43.986669 [debug] [MainThread]: On master: COMMIT
[0m09:22:43.987662 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:22:43.988654 [info ] [MainThread]: 
[0m09:22:43.991672 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:22:43.992652 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:22:43.993651 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:22:43.994651 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:22:44.004646 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:22:44.008646 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:22:43.994651 => 09:22:44.007644
[0m09:22:44.009645 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:22:44.044624 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:22:44.044624 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:22:44.045623 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:22:44.045623 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:22:44.046623 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:22:44.047640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.052620 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:22:44.053621 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:22:44.054619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.062631 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:22:44.062631 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:22:44.065959 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.084969 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:22:44.085963 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:22:44.087261 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.090261 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:22:44.091260 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:22:44.092212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.096211 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:22:44.097210 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:22:44.098074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.101083 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:22:44.102075 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:22:44.103091 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:22:44.141702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.159683 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:22:44.164680 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:22:44.165680 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:22:44.166692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.171676 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:22:44.171676 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:22:44.174105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.179105 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:22:44.010643 => 09:22:44.178127
[0m09:22:44.179105 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:22:44.179105 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:22:44.180121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e5e509-ca52-4f79-85b3-b55c2fd29b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787693FFD0>]}
[0m09:22:44.181116 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.19s]
[0m09:22:44.182110 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:22:44.183102 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:22:44.183102 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:22:44.184120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:22:44.185114 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:22:44.189117 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:22:44.191116 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:22:44.185114 => 09:22:44.190111
[0m09:22:44.191116 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:22:44.198093 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:44.198093 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:22:44.199113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:44.199113 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:22:44.200113 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:22:44.201099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.203109 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:44.204104 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:22:44.205101 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.209100 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:44.209100 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:22:44.212293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.214307 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:44.215306 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:22:44.216306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.217305 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:44.218291 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:22:44.219290 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.220290 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:44.221289 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:22:44.222316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.224288 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:22:44.226289 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:44.227305 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:22:44.257151 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.260163 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:22:44.260163 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:44.261163 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:22:44.262187 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.266186 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:22:44.266186 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:22:44.268422 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.270434 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:22:44.191116 => 09:22:44.270434
[0m09:22:44.271433 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:22:44.271433 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:22:44.272432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e5e509-ca52-4f79-85b3-b55c2fd29b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787679B670>]}
[0m09:22:44.273436 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.09s]
[0m09:22:44.274331 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:22:44.275347 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:22:44.276334 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:22:44.276808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:22:44.277824 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:22:44.283819 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:22:44.285806 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:22:44.277824 => 09:22:44.285806
[0m09:22:44.285806 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:22:44.291814 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:22:44.292814 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:22:44.293814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:44.293814 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:22:44.294813 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:22:44.295801 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.296800 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:22:44.297799 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:22:44.298810 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.300797 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:22:44.301797 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:22:44.302795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.304812 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:22:44.304812 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:22:44.306793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.308806 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:22:44.309805 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:22:44.310792 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.311791 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:22:44.313789 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:22:44.314788 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),

Cust AS (
    SELECT
        *
    FROM Customers
    WHERE Region != ''NUNAVUT''
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost
    from Cust as cu
    JOIN markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*
    -- ,ord.OrderID,ord.OrderDate,ord.Order_Priority
    from custmarket as cm
    -- JOIN Orders as ord
    -- on cm.Ord = ord.OrdID
),
custmarkordprod as (
    select cmo.*,pr.ProductID,pr.ProductSubCategory
    from custmarkord as cmo
    JOIN products as pr
    on cmo.ProductID=pr.ProductID
),
custmarkordprodship as (
    select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
    from custmarkordprod as cmop
    JOIN shippings as sh
    on cmop.ShippingID=sh.ShippingID
)

SELECT * FROM custmarkordprodship;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:22:44.318810 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:22:44.319810 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:22:44.286818 => 09:22:44.319810
[0m09:22:44.320809 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:22:44.320809 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:22:44.321808 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ProductID'. (207) (SQLMoreResults)")
[0m09:22:44.326806 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ProductID'. (207) (SQLMoreResults)")

[0m09:22:44.327805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e5e509-ca52-4f79-85b3-b55c2fd29b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027876993E80>]}
[0m09:22:44.327805 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.05s]
[0m09:22:44.329802 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:22:44.330804 [debug] [MainThread]: On master: COMMIT
[0m09:22:44.331815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:22:44.331815 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:22:44.332814 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m09:22:44.332814 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:22:44.333813 [info ] [MainThread]: 
[0m09:22:44.334799 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m09:22:44.336800 [debug] [MainThread]: Command end result
[0m09:22:44.349792 [info ] [MainThread]: 
[0m09:22:44.350790 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:22:44.351789 [info ] [MainThread]: 
[0m09:22:44.352791 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ProductID'. (207) (SQLMoreResults)")
[0m09:22:44.353788 [info ] [MainThread]: 
[0m09:22:44.353788 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:22:44.355788 [debug] [MainThread]: Command `dbt run` failed at 09:22:44.355788 after 1.46 seconds
[0m09:22:44.356787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278734FF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278769ACB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027876990850>]}
[0m09:22:44.357787 [debug] [MainThread]: Flushing usage events
[0m09:23:06.083239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA08B7A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA31C23B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA31C21D0>]}


============================== 09:23:06.089234 | b1b6f711-c741-4d01-8817-3e522700c568 ==============================
[0m09:23:06.089234 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:23:06.090234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:23:06.485042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1b6f711-c741-4d01-8817-3e522700c568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA3138EE0>]}
[0m09:23:06.584985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1b6f711-c741-4d01-8817-3e522700c568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA37AFF40>]}
[0m09:23:06.584985 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:23:06.599963 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:23:06.727900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:23:06.728913 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:23:06.935781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1b6f711-c741-4d01-8817-3e522700c568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA3B63130>]}
[0m09:23:06.952772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1b6f711-c741-4d01-8817-3e522700c568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA3B3FDF0>]}
[0m09:23:06.953771 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:23:06.954771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1b6f711-c741-4d01-8817-3e522700c568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA3B3FEE0>]}
[0m09:23:06.956769 [info ] [MainThread]: 
[0m09:23:06.957769 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:23:06.960413 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:23:06.973399 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:23:06.973399 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:23:06.974391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:06.974391 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:07.065814 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:23:07.072310 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:23:07.073313 [debug] [ThreadPool]: On list_online: Close
[0m09:23:07.075311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:23:07.075311 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:23:07.081307 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:23:07.081307 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:23:07.082307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:07.083307 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:07.083307 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:23:07.099111 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:23:07.100113 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:23:07.100113 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:23:07.103130 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m09:23:07.110120 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:23:07.110120 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:23:07.111120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:07.111120 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:07.112119 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:23:07.133552 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:23:07.134554 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:23:07.135553 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:23:07.136552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m09:23:07.139551 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:23:07.139551 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:23:07.140550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:07.140550 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:07.140550 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:23:07.149902 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:23:07.150901 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:23:07.150901 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:23:07.151901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1b6f711-c741-4d01-8817-3e522700c568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA3CC82B0>]}
[0m09:23:07.152901 [debug] [MainThread]: On master: COMMIT
[0m09:23:07.153914 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:23:07.154398 [info ] [MainThread]: 
[0m09:23:07.158286 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:23:07.159295 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:23:07.161287 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:23:07.161287 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:23:07.173290 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:23:07.175277 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:23:07.162284 => 09:23:07.174290
[0m09:23:07.176290 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:23:07.213256 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:07.213256 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:23:07.214255 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:23:07.215258 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:07.215258 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:23:07.218253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.222263 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:07.223262 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:23:07.235759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.242755 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:07.243754 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:23:07.476528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.494538 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:07.495533 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:07.509641 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.513639 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:07.514639 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:23:07.514639 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.519640 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:07.520639 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:07.521634 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.524632 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:23:07.525618 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:07.525618 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:23:07.563486 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.578498 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:23:07.582496 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:07.582496 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:23:07.666249 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.671264 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:07.671264 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:23:07.673246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.679243 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:23:07.177288 => 09:23:07.678244
[0m09:23:07.679243 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:23:07.680242 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:23:07.680242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1b6f711-c741-4d01-8817-3e522700c568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA3D1BAC0>]}
[0m09:23:07.681242 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.52s]
[0m09:23:07.682241 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:23:07.683258 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:23:07.683258 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:23:07.684240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:23:07.685240 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:23:07.690237 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:23:07.692236 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:23:07.685240 => 09:23:07.691237
[0m09:23:07.692236 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:23:07.700231 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:07.701231 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:23:07.702233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:07.702233 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:07.703230 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:23:07.704241 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.706228 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:07.706228 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:23:07.715223 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.720219 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:07.721219 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:23:07.723906 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.726920 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:07.726920 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:07.738972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.740984 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:07.740984 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:23:07.741968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.743962 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:07.744961 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:07.744961 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.746960 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:23:07.747946 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:07.747946 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:23:07.778204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.780220 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:23:07.781215 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:07.781215 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:23:07.847167 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.852164 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:07.852164 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:23:07.854966 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.856967 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:23:07.693236 => 09:23:07.856967
[0m09:23:07.856967 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:23:07.857966 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:23:07.858966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1b6f711-c741-4d01-8817-3e522700c568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA3B7ACB0>]}
[0m09:23:07.858966 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.17s]
[0m09:23:07.859952 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:23:07.860970 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:23:07.861968 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:23:07.862562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:23:07.863578 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:23:07.869574 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:23:07.870561 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:23:07.863578 => 09:23:07.870561
[0m09:23:07.870561 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:23:07.876570 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:07.876570 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:23:07.877568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:07.878557 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:07.878557 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:23:07.879555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.881554 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:07.882554 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:23:07.892548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.895546 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:07.895546 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:07.909539 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.911537 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:07.912536 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:23:07.912536 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.914535 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:07.914535 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:07.915535 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.917534 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:23:07.920532 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:07.921532 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),

Cust AS (
    SELECT
        *
    FROM Customers
    WHERE Region != ''NUNAVUT''
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost
    from Cust as cu
    JOIN markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*
    -- ,ord.OrderID,ord.OrderDate,ord.Order_Priority
    from custmarket as cm
    -- JOIN Orders as ord
    -- on cm.Ord = ord.OrdID
),

-- custmarkordprod as (
--     select cmo.*,pr.ProductID,pr.ProductSubCategory
--     from custmarkord as cmo
--     JOIN products as pr
--     on cmo.ProductID=pr.ProductID
-- ),
-- custmarkordprodship as (
--     select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
--     from custmarkordprod as cmop
--     JOIN shippings as sh
--     on cmop.ShippingID=sh.ShippingID
-- )

SELECT * FROM custmarkord;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:23:07.922531 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:07.925529 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:23:07.871573 => 09:23:07.924530
[0m09:23:07.925529 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:23:07.926529 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:23:07.926529 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'SELECT'. (156) (SQLMoreResults)")
[0m09:23:07.930526 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'SELECT'. (156) (SQLMoreResults)")

[0m09:23:07.931525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1b6f711-c741-4d01-8817-3e522700c568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA3D73640>]}
[0m09:23:07.932525 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.07s]
[0m09:23:07.933524 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:23:07.936523 [debug] [MainThread]: On master: COMMIT
[0m09:23:07.937523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:07.937523 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:23:07.937523 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m09:23:07.938522 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:23:07.938522 [info ] [MainThread]: 
[0m09:23:07.940519 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m09:23:07.942517 [debug] [MainThread]: Command end result
[0m09:23:07.958509 [info ] [MainThread]: 
[0m09:23:07.959508 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:23:07.960511 [info ] [MainThread]: 
[0m09:23:07.961507 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'SELECT'. (156) (SQLMoreResults)")
[0m09:23:07.962506 [info ] [MainThread]: 
[0m09:23:07.963506 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:23:07.965505 [debug] [MainThread]: Command `dbt run` failed at 09:23:07.965505 after 1.96 seconds
[0m09:23:07.966504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA08B7A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA3D8FBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA3CD6C50>]}
[0m09:23:07.966504 [debug] [MainThread]: Flushing usage events
[0m09:23:20.817215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186C963F5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CBF32380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CBF321A0>]}


============================== 09:23:20.823197 | fc001194-a9df-4cc6-9e5d-758d2644d294 ==============================
[0m09:23:20.823197 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:23:20.824196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:23:21.220246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc001194-a9df-4cc6-9e5d-758d2644d294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CBF32440>]}
[0m09:23:21.320189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc001194-a9df-4cc6-9e5d-758d2644d294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC51FF10>]}
[0m09:23:21.320189 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:23:21.333182 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:23:21.461804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:23:21.462803 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:23:21.673668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc001194-a9df-4cc6-9e5d-758d2644d294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC8D3100>]}
[0m09:23:21.689660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc001194-a9df-4cc6-9e5d-758d2644d294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC8AFDC0>]}
[0m09:23:21.690660 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:23:21.690660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc001194-a9df-4cc6-9e5d-758d2644d294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC8AFEB0>]}
[0m09:23:21.692659 [info ] [MainThread]: 
[0m09:23:21.693659 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:23:21.696656 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:23:21.709220 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:23:21.710220 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:23:21.710220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:21.710220 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:21.758663 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:23:21.759784 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:23:21.760799 [debug] [ThreadPool]: On list_online: Close
[0m09:23:21.762798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:23:21.762798 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:23:21.769794 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:23:21.770793 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:23:21.770793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:21.771779 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:21.771779 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:23:21.772792 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:23:21.773791 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:23:21.774791 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:23:21.777789 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m09:23:21.785785 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:23:21.785785 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:23:21.786784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:21.786784 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:21.787783 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:23:21.788769 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:23:21.789783 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:23:21.790781 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:23:21.791781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m09:23:21.794779 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:23:21.794779 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:23:21.794779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:21.795779 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:21.795779 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:23:21.796778 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:23:21.798764 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:23:21.798764 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:23:21.799776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc001194-a9df-4cc6-9e5d-758d2644d294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC4DBDC0>]}
[0m09:23:21.800777 [debug] [MainThread]: On master: COMMIT
[0m09:23:21.800777 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:23:21.801776 [info ] [MainThread]: 
[0m09:23:21.805854 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:23:21.805854 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:23:21.807858 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:23:21.807858 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:23:21.819869 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:23:21.821848 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:23:21.807858 => 09:23:21.820847
[0m09:23:21.822847 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:23:21.859825 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:21.860825 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:23:21.860825 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:23:21.861824 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:21.861824 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:23:21.862824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:21.867830 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:21.869821 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:23:21.872819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:21.889809 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:21.890808 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:23:21.901801 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:21.922789 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:21.923788 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:21.924788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:21.927786 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:21.928786 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:23:21.929785 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:21.934782 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:21.934782 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:21.935781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:21.938780 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:23:21.939779 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:21.940779 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:23:21.979834 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:21.994844 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:23:21.998842 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:21.999841 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:23:22.000823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.004839 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:22.005838 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:23:22.007710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.012727 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:23:21.823848 => 09:23:22.011728
[0m09:23:22.012727 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:23:22.012727 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:23:22.013727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc001194-a9df-4cc6-9e5d-758d2644d294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CCA83A90>]}
[0m09:23:22.014727 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.21s]
[0m09:23:22.015707 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:23:22.016722 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:23:22.016722 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:23:22.017720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:23:22.018720 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:23:22.022722 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:23:22.024722 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:23:22.018720 => 09:23:22.023722
[0m09:23:22.024722 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:23:22.031699 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:22.032709 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:23:22.033713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:22.034696 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:22.035697 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:23:22.036697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.038710 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:22.039709 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:23:22.039709 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.044706 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:22.044706 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:23:22.047140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.050142 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:22.050142 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:22.051158 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.053157 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:22.053157 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:23:22.054169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.057157 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:22.057157 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:22.058476 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.059492 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:23:22.061495 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:22.061495 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:23:22.093552 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.095562 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:23:22.096562 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:22.097561 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:23:22.097561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.102562 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:22.103561 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:23:22.105343 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.107358 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:23:22.024722 => 09:23:22.106359
[0m09:23:22.107358 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:23:22.108357 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:23:22.108357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc001194-a9df-4cc6-9e5d-758d2644d294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC8E84F0>]}
[0m09:23:22.109357 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.09s]
[0m09:23:22.110342 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:23:22.111342 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:23:22.111342 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:23:22.112359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:23:22.113355 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:23:22.119355 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:23:22.121337 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:23:22.113355 => 09:23:22.121337
[0m09:23:22.122353 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:23:22.128350 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:22.128350 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:23:22.128350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:22.129345 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:22.130344 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:23:22.131344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.133331 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:22.133331 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:23:22.134332 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.137326 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:22.137326 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:22.138326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.141326 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:22.142342 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:23:22.143343 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.145341 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:22.145341 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:22.146328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.147345 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:23:22.149330 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:22.150340 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),

Cust AS (
    SELECT
        *
    FROM Customers
    WHERE Region != ''NUNAVUT''
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost
    from Cust as cu
    JOIN markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*
    -- ,ord.OrderID,ord.OrderDate,ord.Order_Priority
    from custmarket as cm
    -- JOIN Orders as ord
    -- on cm.Ord = ord.OrdID
)

-- custmarkordprod as (
--     select cmo.*,pr.ProductID,pr.ProductSubCategory
--     from custmarkord as cmo
--     JOIN products as pr
--     on cmo.ProductID=pr.ProductID
-- ),
-- custmarkordprodship as (
--     select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
--     from custmarkordprod as cmop
--     JOIN shippings as sh
--     on cmop.ShippingID=sh.ShippingID
-- )

SELECT * FROM custmarkord;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:23:22.177015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.179028 [debug] [Thread-1 (]: On model.online_shopping.orders: COMMIT
[0m09:23:22.180027 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:22.181027 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'orders__dbt_backup'
  
[0m09:23:22.250988 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.255985 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:22.255985 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:23:22.256985 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:22.258970 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:23:22.122353 => 09:23:22.258970
[0m09:23:22.258970 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:23:22.259969 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:23:22.260968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc001194-a9df-4cc6-9e5d-758d2644d294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CCB0DD80>]}
[0m09:23:22.260968 [info ] [Thread-1 (]: 3 of 3 OK created sql table model online.dbt_mart.orders ....................... [[32mOK[0m in 0.15s]
[0m09:23:22.262208 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:23:22.264225 [debug] [MainThread]: On master: COMMIT
[0m09:23:22.265224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:22.265224 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:23:22.265224 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m09:23:22.266223 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:23:22.266223 [info ] [MainThread]: 
[0m09:23:22.267194 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m09:23:22.269196 [debug] [MainThread]: Command end result
[0m09:23:22.283188 [info ] [MainThread]: 
[0m09:23:22.285187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:23:22.286186 [info ] [MainThread]: 
[0m09:23:22.287203 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:23:22.289197 [debug] [MainThread]: Command `dbt run` succeeded at 09:23:22.288202 after 1.55 seconds
[0m09:23:22.289197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186C963F5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CCD90F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC6BDBD0>]}
[0m09:23:22.290185 [debug] [MainThread]: Flushing usage events
[0m09:23:35.517433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB56628CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB58F22320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB58F22140>]}


============================== 09:23:35.523430 | f87cfca6-467f-4d39-b9c4-3283ee0b78b7 ==============================
[0m09:23:35.523430 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:23:35.524430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:23:35.922806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f87cfca6-467f-4d39-b9c4-3283ee0b78b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB58F223E0>]}
[0m09:23:36.028759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f87cfca6-467f-4d39-b9c4-3283ee0b78b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB5950FEB0>]}
[0m09:23:36.029762 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:23:36.044738 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:23:36.174557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:23:36.175557 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:23:36.387435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f87cfca6-467f-4d39-b9c4-3283ee0b78b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB598C30A0>]}
[0m09:23:36.403431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f87cfca6-467f-4d39-b9c4-3283ee0b78b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB5989FD60>]}
[0m09:23:36.404431 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:23:36.405413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f87cfca6-467f-4d39-b9c4-3283ee0b78b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB5989FEE0>]}
[0m09:23:36.406430 [info ] [MainThread]: 
[0m09:23:36.408411 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:23:36.410428 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:23:36.423419 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:23:36.424402 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:23:36.425400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:36.425400 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:36.470545 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:23:36.471551 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:23:36.472554 [debug] [ThreadPool]: On list_online: Close
[0m09:23:36.474119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:23:36.475120 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:23:36.480117 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:23:36.480117 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:23:36.481117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:36.481117 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:36.482116 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:23:36.482933 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:23:36.483938 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:23:36.484934 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:23:36.487446 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m09:23:36.494444 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:23:36.495443 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:23:36.495443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:36.495443 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:36.496443 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:23:36.497897 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:23:36.498898 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:23:36.498898 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:23:36.500897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m09:23:36.503895 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:23:36.503895 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:23:36.504894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:36.504894 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:36.505894 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:23:36.506905 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:23:36.507906 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:23:36.507906 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:23:36.508906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f87cfca6-467f-4d39-b9c4-3283ee0b78b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB599E3670>]}
[0m09:23:36.509919 [debug] [MainThread]: On master: COMMIT
[0m09:23:36.509919 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:23:36.511261 [info ] [MainThread]: 
[0m09:23:36.515585 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:23:36.515585 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:23:36.517586 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:23:36.517586 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:23:36.527580 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:23:36.529579 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:23:36.517586 => 09:23:36.528579
[0m09:23:36.529579 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:23:36.560561 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:36.560561 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:23:36.561560 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:23:36.561560 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:36.562560 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:23:36.563524 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.567525 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:36.568523 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:23:36.568523 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.579530 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:36.580529 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:23:36.631883 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.649888 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:36.650888 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:36.652118 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.655119 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:36.656118 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:23:36.656527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.661540 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:36.662539 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:36.663207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.665208 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:23:36.667206 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:36.667206 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:23:36.709927 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.724920 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:23:36.728917 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:36.728917 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:23:36.730687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.734687 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:23:36.735686 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:23:36.737837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.741850 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:23:36.529579 => 09:23:36.741850
[0m09:23:36.742849 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:23:36.742849 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:23:36.743848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87cfca6-467f-4d39-b9c4-3283ee0b78b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB59A77C10>]}
[0m09:23:36.744848 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.23s]
[0m09:23:36.745834 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:23:36.746833 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:23:36.746833 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:23:36.747833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:23:36.748847 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:23:36.752848 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:23:36.754829 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:23:36.748847 => 09:23:36.754829
[0m09:23:36.755828 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:23:36.761838 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:36.762838 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:23:36.762838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:36.763837 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:36.763837 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:23:36.764836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.766836 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:36.767823 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:23:36.768821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.773831 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:36.773831 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:23:36.776706 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.778722 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:36.779721 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:36.780721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.781720 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:36.782718 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:23:36.782718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.785716 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:36.785716 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:36.786720 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.788701 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:23:36.790699 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:36.790699 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:23:36.819704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.821720 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:23:36.822719 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:36.823718 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:23:36.824713 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.828711 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:23:36.828711 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:23:36.831400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.833414 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:23:36.755828 => 09:23:36.832416
[0m09:23:36.833414 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:23:36.834402 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:23:36.835413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87cfca6-467f-4d39-b9c4-3283ee0b78b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB59A2A3B0>]}
[0m09:23:36.835413 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.09s]
[0m09:23:36.836412 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:23:36.837399 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:23:36.838411 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:23:36.839411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:23:36.839411 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:23:36.846412 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:23:36.847393 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:23:36.839411 => 09:23:36.847393
[0m09:23:36.848392 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:23:36.856401 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:36.856401 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:23:36.857401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:36.857401 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:23:36.858400 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:23:36.859400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.861399 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:36.861399 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:23:36.862384 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.866395 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:36.866395 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
USE [online];
      EXEC sp_rename 'dbt_mart.orders', 'orders__dbt_backup'
[0m09:23:36.869379 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.872378 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:36.873378 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:36.874390 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.875390 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:36.876389 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:23:36.877128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.878130 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:36.879129 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:23:36.880079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.881081 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:23:36.882080 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:23:36.883080 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),

Cust AS (
    SELECT
        *
    FROM Customers
    WHERE Region != ''NUNAVUT''
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost
    from Cust as cu
    JOIN markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*
    -- ,ord.OrderID,ord.OrderDate,ord.Order_Priority
    from custmarket as cm
    JOIN Orders as ord
    on cm.Ord = ord.OrdID
)

-- custmarkordprod as (
--     select cmo.*,pr.ProductID,pr.ProductSubCategory
--     from custmarkord as cmo
--     JOIN products as pr
--     on cmo.ProductID=pr.ProductID
-- ),
-- custmarkordprodship as (
--     select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
--     from custmarkordprod as cmop
--     JOIN shippings as sh
--     on cmop.ShippingID=sh.ShippingID
-- )

SELECT * FROM custmarkord;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:23:36.885417 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:23:36.887435 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:23:36.848392 => 09:23:36.886435
[0m09:23:36.887435 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:23:36.888416 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:23:36.889433 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Ord'. (207) (SQLMoreResults)")
[0m09:23:36.893412 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Ord'. (207) (SQLMoreResults)")

[0m09:23:36.894411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87cfca6-467f-4d39-b9c4-3283ee0b78b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB59B01720>]}
[0m09:23:36.895411 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.06s]
[0m09:23:36.896410 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:23:36.897410 [debug] [MainThread]: On master: COMMIT
[0m09:23:36.898420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:36.898420 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:23:36.899419 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m09:23:36.899419 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:23:36.900418 [info ] [MainThread]: 
[0m09:23:36.900418 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m09:23:36.902407 [debug] [MainThread]: Command end result
[0m09:23:36.915413 [info ] [MainThread]: 
[0m09:23:36.916423 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:23:36.917398 [info ] [MainThread]: 
[0m09:23:36.918398 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Ord'. (207) (SQLMoreResults)")
[0m09:23:36.919397 [info ] [MainThread]: 
[0m09:23:36.919397 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:23:36.921396 [debug] [MainThread]: Command `dbt run` failed at 09:23:36.921396 after 1.49 seconds
[0m09:23:36.922396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB56628CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB5989FDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB59AD9690>]}
[0m09:23:36.923397 [debug] [MainThread]: Flushing usage events
[0m09:24:19.233506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022090B5F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022093442350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022093442170>]}


============================== 09:24:19.239522 | 6fb17da5-30d6-4405-aa0e-6e93bef8b436 ==============================
[0m09:24:19.239522 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:24:19.240526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:24:19.634103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fb17da5-30d6-4405-aa0e-6e93bef8b436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022093442410>]}
[0m09:24:19.737044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fb17da5-30d6-4405-aa0e-6e93bef8b436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022093A2FEE0>]}
[0m09:24:19.738044 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:24:19.755039 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:24:19.884519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:24:19.884519 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:24:20.089406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fb17da5-30d6-4405-aa0e-6e93bef8b436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022093DE30D0>]}
[0m09:24:20.105397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fb17da5-30d6-4405-aa0e-6e93bef8b436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022093DBFD90>]}
[0m09:24:20.106379 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:24:20.107395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fb17da5-30d6-4405-aa0e-6e93bef8b436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022093DBFD00>]}
[0m09:24:20.109394 [info ] [MainThread]: 
[0m09:24:20.110377 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:24:20.113387 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:24:20.126385 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:24:20.127384 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:24:20.127384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:20.128384 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:24:20.218269 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:24:20.225265 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:24:20.228266 [debug] [ThreadPool]: On list_online: Close
[0m09:24:20.231261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:24:20.233260 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:24:20.243255 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:24:20.244268 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:24:20.244268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:20.245267 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:24:20.246267 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:24:20.256829 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:24:20.258828 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:24:20.258828 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:24:20.261933 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m09:24:20.270944 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:24:20.270944 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:24:20.271944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:20.271944 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:24:20.272943 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:24:20.295028 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:24:20.297026 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:24:20.298011 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:24:20.300011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m09:24:20.304009 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:24:20.305022 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:24:20.305022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:20.306022 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:24:20.306022 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:24:20.316016 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:24:20.318015 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:24:20.319014 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:24:20.320014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fb17da5-30d6-4405-aa0e-6e93bef8b436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022093F441F0>]}
[0m09:24:20.320014 [debug] [MainThread]: On master: COMMIT
[0m09:24:20.321013 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:24:20.322013 [info ] [MainThread]: 
[0m09:24:20.327013 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:24:20.328016 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:24:20.329017 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:24:20.330027 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:24:20.341021 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:24:20.342007 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:24:20.330027 => 09:24:20.342007
[0m09:24:20.343025 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:24:20.373989 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:24:20.375003 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:24:20.375003 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:24:20.376001 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:24:20.376001 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:24:20.378542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.382556 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:24:20.383556 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:24:20.395053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.402051 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:24:20.403051 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:24:20.631036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.649043 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:24:20.650047 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:24:20.664040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.668032 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:24:20.668032 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:24:20.669032 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.674027 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:24:20.675027 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:24:20.675027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.678026 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:24:20.680010 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:24:20.680010 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:24:20.718984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.732989 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:24:20.737987 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:24:20.737987 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:24:20.807699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.812698 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:24:20.812698 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:24:20.815630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.820630 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:24:20.343025 => 09:24:20.820630
[0m09:24:20.821629 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:24:20.821629 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:24:20.822629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fb17da5-30d6-4405-aa0e-6e93bef8b436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022093F9FFD0>]}
[0m09:24:20.823628 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.49s]
[0m09:24:20.824628 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:24:20.825627 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:24:20.825627 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:24:20.827639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:24:20.827639 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:24:20.831636 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:24:20.833621 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:24:20.827639 => 09:24:20.832658
[0m09:24:20.833621 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:24:20.839631 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:24:20.839631 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:24:20.840630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:20.840630 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:24:20.841630 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:24:20.842629 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.844616 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:24:20.844616 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:24:20.854610 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.860607 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:24:20.861607 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:24:20.864304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.866298 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:24:20.867298 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:24:20.879562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.881559 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:24:20.881559 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:24:20.882665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.883667 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:24:20.884666 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:24:20.885600 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.886602 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:24:20.888602 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:24:20.889600 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:24:20.919292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.921293 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:24:20.922306 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:24:20.923305 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:24:20.988180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.993179 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:24:20.993179 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:24:20.995616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:20.997618 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:24:20.833621 => 09:24:20.997618
[0m09:24:20.998618 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:24:20.998618 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:24:20.999617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fb17da5-30d6-4405-aa0e-6e93bef8b436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022093DFAF20>]}
[0m09:24:21.000617 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.17s]
[0m09:24:21.001334 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:24:21.002350 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:24:21.003348 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:24:21.004348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:24:21.004348 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:24:21.010344 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:24:21.012348 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:24:21.004348 => 09:24:21.011344
[0m09:24:21.012348 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:24:21.019344 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:24:21.019344 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:24:21.020344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:21.021327 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:24:21.021327 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:24:21.025339 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:21.027335 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:24:21.027335 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:24:21.036330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:21.039333 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:24:21.040332 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:24:21.051326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:21.053324 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:24:21.054324 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:24:21.055324 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:21.057305 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:24:21.058304 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:24:21.059323 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:21.061320 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:24:21.062301 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:24:21.063302 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),

Cust AS (
    SELECT
        *
    FROM Customers
    WHERE Region != ''NUNAVUT''
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost
    from Customers as cu
    JOIN Markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*
    -- ,ord.OrderID,ord.OrderDate,ord.Order_Priority
    from custmarket as cm
    JOIN Orders as ord
    on cm.Ord = ord.OrdID
)

-- custmarkordprod as (
--     select cmo.*,pr.ProductID,pr.ProductSubCategory
--     from custmarkord as cmo
--     JOIN products as pr
--     on cmo.ProductID=pr.ProductID
-- ),
-- custmarkordprodship as (
--     select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
--     from custmarkordprod as cmop
--     JOIN shippings as sh
--     on cmop.ShippingID=sh.ShippingID
-- )

SELECT * FROM custmarkord;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:24:21.065301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:24:21.066317 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:24:21.013343 => 09:24:21.066317
[0m09:24:21.066317 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:24:21.067317 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:24:21.068316 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Ord'. (207) (SQLMoreResults)")
[0m09:24:21.072297 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Ord'. (207) (SQLMoreResults)")

[0m09:24:21.073297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fb17da5-30d6-4405-aa0e-6e93bef8b436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022093FF2110>]}
[0m09:24:21.074294 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.07s]
[0m09:24:21.076295 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:24:21.077292 [debug] [MainThread]: On master: COMMIT
[0m09:24:21.078293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:21.079293 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:24:21.079293 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m09:24:21.079293 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:24:21.080292 [info ] [MainThread]: 
[0m09:24:21.081292 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m09:24:21.082308 [debug] [MainThread]: Command end result
[0m09:24:21.097282 [info ] [MainThread]: 
[0m09:24:21.098280 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:24:21.099294 [info ] [MainThread]: 
[0m09:24:21.100280 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'Ord'. (207) (SQLMoreResults)")
[0m09:24:21.100280 [info ] [MainThread]: 
[0m09:24:21.101292 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:24:21.103279 [debug] [MainThread]: Command `dbt run` failed at 09:24:21.103279 after 1.95 seconds
[0m09:24:21.103279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022090B5F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022094299600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022093F47B50>]}
[0m09:24:21.104279 [debug] [MainThread]: Flushing usage events
[0m09:27:19.853855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6D1167A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6D3A723B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6D3A721D0>]}


============================== 09:27:19.859851 | bbc7c3c1-e18e-4a10-960e-4c71a62849ef ==============================
[0m09:27:19.859851 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:27:19.860850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:27:20.298143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbc7c3c1-e18e-4a10-960e-4c71a62849ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6D39E8EE0>]}
[0m09:27:20.408078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbc7c3c1-e18e-4a10-960e-4c71a62849ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6D405FF40>]}
[0m09:27:20.408078 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:27:20.424332 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:27:20.549009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:27:20.550008 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:27:20.756890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbc7c3c1-e18e-4a10-960e-4c71a62849ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6D4413130>]}
[0m09:27:20.771870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbc7c3c1-e18e-4a10-960e-4c71a62849ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6D43EFDF0>]}
[0m09:27:20.772885 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:27:20.773883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbc7c3c1-e18e-4a10-960e-4c71a62849ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6D43EFEE0>]}
[0m09:27:20.775865 [info ] [MainThread]: 
[0m09:27:20.776865 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:27:20.778863 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:27:20.791875 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:27:20.791875 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:27:20.792875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:20.792875 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:27:20.865001 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:27:20.869932 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:27:20.871947 [debug] [ThreadPool]: On list_online: Close
[0m09:27:20.873074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:27:20.874076 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:27:20.879073 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:27:20.879073 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:27:20.880072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:27:20.880072 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:27:20.881072 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:27:20.884929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:27:20.886739 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:27:20.886739 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:27:20.889138 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m09:27:20.896136 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:27:20.896136 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:27:20.897136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:20.897136 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:27:20.898135 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:27:20.915671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:27:20.916671 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:27:20.917670 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:27:20.918669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m09:27:20.921205 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:27:20.921205 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:27:20.922204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:27:20.922204 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:27:20.923203 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:27:20.930539 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:27:20.931553 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:27:20.932553 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:27:20.933552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbc7c3c1-e18e-4a10-960e-4c71a62849ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6D45782B0>]}
[0m09:27:20.933552 [debug] [MainThread]: On master: COMMIT
[0m09:27:20.934551 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:27:20.935569 [info ] [MainThread]: 
[0m09:27:20.939856 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:27:20.939856 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:27:20.941173 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:27:20.942190 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:27:20.953181 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:27:20.955167 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:27:20.942190 => 09:27:20.954180
[0m09:27:20.955167 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:27:20.984169 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:27:20.985168 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:27:20.985168 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:27:20.986148 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:27:20.987167 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:27:20.988161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:20.992147 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:27:20.993146 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:27:21.005906 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.013911 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:27:21.014903 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:27:21.238042 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.256052 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:27:21.256052 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:27:21.271792 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.275810 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:27:21.275810 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:27:21.276809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.281801 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:27:21.282806 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:27:21.282806 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.285804 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:27:21.286795 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:27:21.287807 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:27:21.335381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.351386 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:27:21.355388 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:27:21.355388 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:27:21.432325 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.437322 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:27:21.438342 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:27:21.440322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.445337 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:27:20.956184 => 09:27:21.445337
[0m09:27:21.445337 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:27:21.446337 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:27:21.447336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbc7c3c1-e18e-4a10-960e-4c71a62849ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6D45CBAC0>]}
[0m09:27:21.447336 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.51s]
[0m09:27:21.449335 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:27:21.449335 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:27:21.450334 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:27:21.451315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:27:21.451315 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:27:21.456313 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:27:21.457313 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:27:21.452316 => 09:27:21.457313
[0m09:27:21.457313 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:27:21.464326 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:27:21.464326 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:27:21.465326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:21.465326 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:27:21.466306 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:27:21.467306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.469304 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:27:21.469304 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:27:21.479299 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.484315 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:27:21.484315 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:27:21.487294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.492291 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:27:21.493290 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:27:21.505283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.507282 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:27:21.507282 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:27:21.508282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.510281 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:27:21.510281 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:27:21.511299 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.512279 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:27:21.514279 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:27:21.514279 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:27:21.544514 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.546515 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:27:21.547514 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:27:21.547514 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:27:21.614880 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.619876 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:27:21.619876 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:27:21.622681 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.624701 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:27:21.458312 => 09:27:21.623696
[0m09:27:21.624701 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:27:21.625695 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:27:21.625695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbc7c3c1-e18e-4a10-960e-4c71a62849ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6D4429AE0>]}
[0m09:27:21.626699 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.18s]
[0m09:27:21.627713 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:27:21.628679 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:27:21.628679 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:27:21.629698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:27:21.630693 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:27:21.636693 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:27:21.638676 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:27:21.630693 => 09:27:21.638676
[0m09:27:21.639694 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:27:21.645688 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:27:21.645688 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:27:21.646688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:21.646688 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:27:21.647682 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:27:21.648682 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.650677 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:27:21.651684 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:27:21.659662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.662673 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:27:21.663673 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:27:21.675652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.677665 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:27:21.677665 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:27:21.678664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.680650 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:27:21.681663 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:27:21.681663 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.683648 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:27:21.685647 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:27:21.685647 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE Region != ''NUNAVUT''
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost, mark.Ord
    from Customers as cu
    JOIN Markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*
    -- ,ord.OrderID,ord.OrderDate,ord.Order_Priority
    from custmarket as cm
    JOIN Orders as o
    on cm.Ord = o.OrdID
)

-- custmarkordprod as (
--     select cmo.*,pr.ProductID,pr.ProductSubCategory
--     from custmarkord as cmo
--     JOIN products as pr
--     on cmo.ProductID=pr.ProductID
-- ),
-- custmarkordprodship as (
--     select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
--     from custmarkordprod as cmop
--     JOIN shippings as sh
--     on cmop.ShippingID=sh.ShippingID
-- )

SELECT * FROM custmarkord;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:27:21.730513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.732512 [debug] [Thread-1 (]: On model.online_shopping.orders: COMMIT
[0m09:27:21.732512 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:27:21.733512 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'orders__dbt_backup'
  
[0m09:27:21.838451 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.844448 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:27:21.846447 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:27:21.847446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:27:21.849446 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:27:21.639694 => 09:27:21.849446
[0m09:27:21.850444 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:27:21.850444 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:27:21.852444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbc7c3c1-e18e-4a10-960e-4c71a62849ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6D464CDF0>]}
[0m09:27:21.853442 [info ] [Thread-1 (]: 3 of 3 OK created sql table model online.dbt_mart.orders ....................... [[32mOK[0m in 0.22s]
[0m09:27:21.854442 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:27:21.856442 [debug] [MainThread]: On master: COMMIT
[0m09:27:21.857441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:27:21.857441 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:27:21.857441 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m09:27:21.858441 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:27:21.858441 [info ] [MainThread]: 
[0m09:27:21.859441 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m09:27:21.861439 [debug] [MainThread]: Command end result
[0m09:27:21.877429 [info ] [MainThread]: 
[0m09:27:21.878429 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:27:21.879429 [info ] [MainThread]: 
[0m09:27:21.880429 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:27:21.881427 [debug] [MainThread]: Command `dbt run` succeeded at 09:27:21.881427 after 2.11 seconds
[0m09:27:21.882426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6D1167A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6D463FBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6D458A9B0>]}
[0m09:27:21.883426 [debug] [MainThread]: Flushing usage events
[0m09:28:02.997941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200DA3F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022010322350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022010322170>]}


============================== 09:28:03.003948 | 7697873d-7dda-401c-8fe5-6721e0cff3bb ==============================
[0m09:28:03.003948 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:28:03.004937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:28:03.407474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7697873d-7dda-401c-8fe5-6721e0cff3bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022010322410>]}
[0m09:28:03.509398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7697873d-7dda-401c-8fe5-6721e0cff3bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201090FEE0>]}
[0m09:28:03.510410 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:28:03.523408 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:28:03.653314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:28:03.654328 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:28:03.868193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7697873d-7dda-401c-8fe5-6721e0cff3bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022010CC30D0>]}
[0m09:28:03.886195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7697873d-7dda-401c-8fe5-6721e0cff3bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022010C9FD90>]}
[0m09:28:03.887191 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:28:03.888179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7697873d-7dda-401c-8fe5-6721e0cff3bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022010C9FD00>]}
[0m09:28:03.890180 [info ] [MainThread]: 
[0m09:28:03.891197 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:28:03.893177 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:28:03.906171 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:28:03.907183 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:28:03.908169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:03.908169 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:28:04.025739 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:28:04.034496 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:28:04.038523 [debug] [ThreadPool]: On list_online: Close
[0m09:28:04.042520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:28:04.044519 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:28:04.058511 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:28:04.060510 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:28:04.061490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:04.062509 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:28:04.063508 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:28:04.083712 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:28:04.085711 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:28:04.085711 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:28:04.089708 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m09:28:04.100705 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:28:04.101701 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:28:04.101701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:04.102700 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:28:04.102700 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:28:04.122504 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:28:04.123498 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:28:04.124498 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:28:04.125502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m09:28:04.128495 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:28:04.128495 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:28:04.129495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:04.129495 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:28:04.130494 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:28:04.139475 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:28:04.141478 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:28:04.141478 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:28:04.142487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7697873d-7dda-401c-8fe5-6721e0cff3bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022010E281F0>]}
[0m09:28:04.143487 [debug] [MainThread]: On master: COMMIT
[0m09:28:04.144486 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:28:04.144486 [info ] [MainThread]: 
[0m09:28:04.148290 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:28:04.149309 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:28:04.150289 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:28:04.151288 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:28:04.160283 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:28:04.161283 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:28:04.151288 => 09:28:04.161283
[0m09:28:04.162301 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:28:04.190266 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:04.190266 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:28:04.191266 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:28:04.191266 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:28:04.192265 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:28:04.194072 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.199078 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:04.199078 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:28:04.211076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.219075 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:04.220074 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:28:04.480127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.501117 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:04.502116 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:28:04.518955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.523966 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:04.523966 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:28:04.525463 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.530462 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:04.530462 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:28:04.531824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.534828 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:28:04.536824 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:04.538822 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:28:04.590155 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.607166 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:28:04.611159 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:04.611159 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:28:04.691125 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.696115 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:04.697095 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:28:04.699364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.705382 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:28:04.162301 => 09:28:04.704383
[0m09:28:04.705382 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:28:04.706380 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:28:04.707379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7697873d-7dda-401c-8fe5-6721e0cff3bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022010E77FD0>]}
[0m09:28:04.707379 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.56s]
[0m09:28:04.709361 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:28:04.709361 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:28:04.710359 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:28:04.711373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:28:04.711373 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:28:04.716374 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:28:04.718354 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:28:04.712377 => 09:28:04.718354
[0m09:28:04.719355 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:28:04.725364 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:04.726363 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:28:04.726363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:04.727363 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:28:04.728349 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:28:04.729631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.730633 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:04.731632 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:28:04.741310 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.746324 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:04.746324 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:28:04.749047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.752066 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:04.753066 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:28:04.765053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.767039 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:04.767039 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:28:04.768054 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.770056 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:04.771037 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:28:04.772045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.774049 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:28:04.775034 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:04.776048 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:28:04.807509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.809519 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:28:04.810518 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:04.810518 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:28:04.888464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.894459 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:04.895473 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:28:04.897562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.899577 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:28:04.719355 => 09:28:04.899577
[0m09:28:04.900576 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:28:04.900576 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:28:04.901566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7697873d-7dda-401c-8fe5-6721e0cff3bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022010CD9690>]}
[0m09:28:04.902574 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.19s]
[0m09:28:04.903562 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:28:04.904561 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:28:04.905579 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:28:04.906560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:28:04.907573 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:28:04.914573 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:28:04.916554 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:28:04.907573 => 09:28:04.916554
[0m09:28:04.918569 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:28:04.926561 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:28:04.926561 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:28:04.927560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:04.927560 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:28:04.928560 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:28:04.929550 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.931558 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:28:04.932557 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:28:04.942539 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.946554 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:28:04.947553 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
USE [online];
      EXEC sp_rename 'dbt_mart.orders', 'orders__dbt_backup'
[0m09:28:04.950602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.953602 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:28:04.954620 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:28:04.965609 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.967594 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:28:04.968601 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:28:04.969600 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.971606 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:28:04.972605 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:28:04.973732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.974734 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:28:04.975733 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:28:04.976732 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE Region != ''NUNAVUT''
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost, mark.Ord
    from Customers as cu
    JOIN Markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*,ord.OrderID,ord.OrderDate,ord.Order_Priority
    from custmarket as cm
    JOIN Orders as o
    on cm.Ord = o.OrdID
)

custmarkordprod as (
    select cmo.*,pr.ProductID,pr.ProductSubCategory
    from custmarkord as cmo
    JOIN products as pr
    on cmo.ProductID=pr.ProductID
),
custmarkordprodship as (
    select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
    from custmarkordprod as cmop
    JOIN shippings as sh
    on cmop.ShippingID=sh.ShippingID
)

SELECT * FROM custmarkordprodship;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:28:04.978746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:04.980730 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:28:04.918569 => 09:28:04.979731
[0m09:28:04.980730 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:28:04.981729 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:28:04.982729 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'custmarkordprod'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102)")
[0m09:28:04.986219 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'custmarkordprod'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102)")

[0m09:28:04.987248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7697873d-7dda-401c-8fe5-6721e0cff3bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022010ECA110>]}
[0m09:28:04.988235 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.08s]
[0m09:28:04.990228 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:28:04.991213 [debug] [MainThread]: On master: COMMIT
[0m09:28:04.992227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:28:04.993226 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:28:04.993226 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m09:28:04.993226 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:28:04.994226 [info ] [MainThread]: 
[0m09:28:04.995211 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m09:28:04.996799 [debug] [MainThread]: Command end result
[0m09:28:05.010797 [info ] [MainThread]: 
[0m09:28:05.011795 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:28:05.012794 [info ] [MainThread]: 
[0m09:28:05.013930 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near 'custmarkordprod'. (102) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near ','. (102)")
[0m09:28:05.014685 [info ] [MainThread]: 
[0m09:28:05.015700 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:28:05.016697 [debug] [MainThread]: Command `dbt run` failed at 09:28:05.016697 after 2.10 seconds
[0m09:28:05.017702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200DA3F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201117CEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022010E3E770>]}
[0m09:28:05.018687 [debug] [MainThread]: Flushing usage events
[0m09:28:52.316721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EACFB910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217ED5F2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217ED5F2170>]}


============================== 09:28:52.323735 | ef73fbf0-9d89-4c37-93a5-36efd86e78c7 ==============================
[0m09:28:52.323735 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:28:52.324723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:28:52.711981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef73fbf0-9d89-4c37-93a5-36efd86e78c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217ED5F2410>]}
[0m09:28:52.812923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef73fbf0-9d89-4c37-93a5-36efd86e78c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EDBDFEE0>]}
[0m09:28:52.813922 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:28:52.827902 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:28:52.947832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:28:52.948832 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:28:53.156726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef73fbf0-9d89-4c37-93a5-36efd86e78c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EDF930D0>]}
[0m09:28:53.171703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef73fbf0-9d89-4c37-93a5-36efd86e78c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EDF6FD90>]}
[0m09:28:53.172722 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:28:53.173722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef73fbf0-9d89-4c37-93a5-36efd86e78c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EDF6FD00>]}
[0m09:28:53.175720 [info ] [MainThread]: 
[0m09:28:53.176703 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:28:53.178718 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:28:53.192706 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:28:53.193705 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:28:53.193705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:53.194704 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:28:53.288201 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:28:53.294397 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:28:53.295400 [debug] [ThreadPool]: On list_online: Close
[0m09:28:53.297397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:28:53.298397 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:28:53.303394 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:28:53.303394 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:28:53.304394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:53.304394 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:28:53.305393 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:28:53.326270 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:28:53.327258 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:28:53.328257 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:28:53.331259 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m09:28:53.339250 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:28:53.340267 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:28:53.341263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:53.342248 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:28:53.342248 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:28:53.360250 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:28:53.362235 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:28:53.362235 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:28:53.363235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m09:28:53.366233 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:28:53.366233 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:28:53.367233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:53.367233 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:28:53.368232 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:28:53.376691 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:28:53.377692 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:28:53.378691 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:28:53.379701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef73fbf0-9d89-4c37-93a5-36efd86e78c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EE0F81F0>]}
[0m09:28:53.379701 [debug] [MainThread]: On master: COMMIT
[0m09:28:53.380704 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:28:53.381377 [info ] [MainThread]: 
[0m09:28:53.385680 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:28:53.385680 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:28:53.386980 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:28:53.387996 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:28:53.397989 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:28:53.398988 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:28:53.387996 => 09:28:53.398988
[0m09:28:53.399974 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:28:53.428972 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:53.429971 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:28:53.429971 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:28:53.430971 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:28:53.430971 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:28:53.433976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:53.438982 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:53.438982 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:28:53.451279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:53.460289 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:53.460289 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:28:53.689528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:53.707535 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:53.708535 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:28:53.723136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:53.727149 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:53.727149 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:28:53.728148 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:53.733145 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:53.734150 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:28:53.735149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:53.737148 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:28:53.739129 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:53.739129 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:28:53.788579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:53.804583 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:28:53.808566 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:53.809585 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:28:53.885523 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:53.889520 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:28:53.890521 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:28:53.893518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:53.897516 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:28:53.399974 => 09:28:53.897516
[0m09:28:53.898515 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:28:53.898515 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:28:53.899514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef73fbf0-9d89-4c37-93a5-36efd86e78c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EE147FD0>]}
[0m09:28:53.900513 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.51s]
[0m09:28:53.901512 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:28:53.902512 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:28:53.903512 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:28:53.904511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:28:53.904511 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:28:53.908508 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:28:53.910508 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:28:53.904511 => 09:28:53.909509
[0m09:28:53.910508 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:28:53.917505 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:53.917505 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:28:53.918505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:53.918505 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:28:53.919503 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:28:53.920502 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:53.923504 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:53.924501 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:28:53.933494 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:53.938492 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:53.939491 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:28:53.941490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:53.945489 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:53.946491 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:28:53.958481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:53.960479 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:53.960479 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:28:53.961478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:53.963477 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:53.963477 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:28:53.964476 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:53.966475 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:28:53.967475 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:53.968474 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:28:53.998214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:54.000230 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:28:54.001229 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:54.001229 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:28:54.067197 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:54.073194 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:28:54.073194 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:28:54.075694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:54.077713 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:28:53.911508 => 09:28:54.076709
[0m09:28:54.077713 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:28:54.078712 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:28:54.078712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef73fbf0-9d89-4c37-93a5-36efd86e78c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EDFAB580>]}
[0m09:28:54.079707 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.18s]
[0m09:28:54.080699 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:28:54.081707 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:28:54.081707 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:28:54.082706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:28:54.083705 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:28:54.090687 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:28:54.093686 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:28:54.083705 => 09:28:54.092686
[0m09:28:54.094685 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:28:54.101700 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:28:54.102682 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:28:54.102682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:54.103698 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:28:54.103698 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:28:54.107678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:54.109690 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:28:54.109690 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:28:54.118703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:54.121688 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:28:54.121688 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:28:54.134681 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:54.136679 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:28:54.137679 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:28:54.137679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:54.142678 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:28:54.143675 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:28:54.145684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:54.146674 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:28:54.148654 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:28:54.149672 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE Region != ''NUNAVUT''
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost, mark.Ord
    from Customers as cu
    JOIN Markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*,ord.OrderID,ord.OrderDate,ord.Order_Priority
    from custmarket as cm
    JOIN Orders as o
    on cm.Ord = o.OrdID
),

custmarkordprod as (
    select cmo.*,pr.ProductID,pr.ProductSubCategory
    from custmarkord as cmo
    JOIN products as pr
    on cmo.ProductID=pr.ProductID
),
custmarkordprodship as (
    select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
    from custmarkordprod as cmop
    JOIN shippings as sh
    on cmop.ShippingID=sh.ShippingID
)

SELECT * FROM custmarkordprodship;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:28:54.152670 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:28:54.153671 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:28:54.094685 => 09:28:54.153671
[0m09:28:54.154669 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:28:54.154669 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:28:54.156650 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The multi-part identifier "ord.OrderID" could not be bound. (4104) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The multi-part identifier "ord.OrderDate" could not be bound. (4104); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The multi-part identifier "ord.Order_Priority" could not be bound. (4104)')
[0m09:28:54.161657 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The multi-part identifier "ord.OrderID" could not be bound. (4104) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The multi-part identifier "ord.OrderDate" could not be bound. (4104); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The multi-part identifier "ord.Order_Priority" could not be bound. (4104)')

[0m09:28:54.161657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef73fbf0-9d89-4c37-93a5-36efd86e78c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EE199990>]}
[0m09:28:54.162661 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.08s]
[0m09:28:54.163645 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:28:54.165645 [debug] [MainThread]: On master: COMMIT
[0m09:28:54.166663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:28:54.166663 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:28:54.167662 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m09:28:54.167662 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:28:54.168662 [info ] [MainThread]: 
[0m09:28:54.168662 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m09:28:54.170641 [debug] [MainThread]: Command end result
[0m09:28:54.185633 [info ] [MainThread]: 
[0m09:28:54.187632 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:28:54.187632 [info ] [MainThread]: 
[0m09:28:54.188650 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The multi-part identifier "ord.OrderID" could not be bound. (4104) (SQLMoreResults); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The multi-part identifier "ord.OrderDate" could not be bound. (4104); [42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The multi-part identifier "ord.Order_Priority" could not be bound. (4104)')
[0m09:28:54.190631 [info ] [MainThread]: 
[0m09:28:54.192630 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:28:54.194628 [debug] [MainThread]: Command `dbt run` failed at 09:28:54.194628 after 1.95 seconds
[0m09:28:54.195628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EACFB910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EE435600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217EE0FBB50>]}
[0m09:28:54.196627 [debug] [MainThread]: Flushing usage events
[0m09:29:37.725684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB209ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB49822F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB4982110>]}


============================== 09:29:37.731680 | 3339b404-a9b7-43d0-a514-4d551e06af71 ==============================
[0m09:29:37.731680 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:29:37.732680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:29:38.125874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3339b404-a9b7-43d0-a514-4d551e06af71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB49823B0>]}
[0m09:29:38.228815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3339b404-a9b7-43d0-a514-4d551e06af71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB4F6FE80>]}
[0m09:29:38.229815 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:29:38.244807 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:29:38.373519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:29:38.374519 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:29:38.585411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3339b404-a9b7-43d0-a514-4d551e06af71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB5323070>]}
[0m09:29:38.602242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3339b404-a9b7-43d0-a514-4d551e06af71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB52FFD30>]}
[0m09:29:38.603258 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:29:38.604239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3339b404-a9b7-43d0-a514-4d551e06af71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB52FFEE0>]}
[0m09:29:38.605239 [info ] [MainThread]: 
[0m09:29:38.607237 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:29:38.609236 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:29:38.625229 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:29:38.625229 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:29:38.626228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:29:38.626228 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:29:38.672524 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:29:38.673525 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:29:38.674525 [debug] [ThreadPool]: On list_online: Close
[0m09:29:38.676523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:29:38.677522 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:29:38.683519 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:29:38.684519 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:29:38.684519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:29:38.685518 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:29:38.686517 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:29:38.686983 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:29:38.687999 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:29:38.687999 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:29:38.691084 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m09:29:38.699082 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:29:38.699082 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:29:38.700081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:29:38.700081 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:29:38.701081 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:29:38.702099 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:29:38.703080 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:29:38.704079 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:29:38.705078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m09:29:38.711076 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:29:38.712076 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:29:38.713075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:29:38.714075 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:29:38.715074 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:29:38.718073 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:29:38.722070 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:29:38.723070 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:29:38.725068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3339b404-a9b7-43d0-a514-4d551e06af71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB49823E0>]}
[0m09:29:38.727088 [debug] [MainThread]: On master: COMMIT
[0m09:29:38.728087 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:29:38.730067 [info ] [MainThread]: 
[0m09:29:38.737061 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:29:38.738061 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:29:38.741058 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:29:38.742058 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:29:38.758048 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:29:38.760047 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:29:38.743056 => 09:29:38.759047
[0m09:29:38.761047 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:29:38.798041 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:29:38.798041 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:29:38.799039 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:29:38.800041 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:29:38.800041 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:29:38.801547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:38.805546 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:29:38.805546 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:29:38.806545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:38.814541 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:29:38.815540 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:29:38.818487 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:38.838490 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:29:38.838490 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:29:38.839490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:38.843476 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:29:38.843476 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:29:38.845474 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:38.850488 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:29:38.850488 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:29:38.852488 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:38.855468 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:29:38.857467 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:29:38.857467 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:29:38.906438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:38.925428 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:29:38.929425 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:29:38.930425 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:29:39.039376 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:39.045360 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:29:39.045360 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:29:39.049277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:39.054295 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:29:38.762046 => 09:29:39.053296
[0m09:29:39.054295 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:29:39.055295 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:29:39.056294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3339b404-a9b7-43d0-a514-4d551e06af71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB54DBFA0>]}
[0m09:29:39.056294 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.32s]
[0m09:29:39.057289 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:29:39.058288 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:29:39.059274 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:29:39.060287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:29:39.060287 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:29:39.065289 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:29:39.066271 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:29:39.061291 => 09:29:39.066271
[0m09:29:39.067287 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:29:39.072279 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:29:39.073279 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:29:39.073279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:29:39.074278 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:29:39.074278 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:29:39.075277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:39.077264 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:29:39.078281 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:29:39.091266 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:39.097251 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:29:39.097251 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:29:39.158088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:39.161087 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:29:39.162086 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:29:39.187072 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:39.190070 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:29:39.190070 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:29:39.191070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:39.194068 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:29:39.194068 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:29:39.212058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:39.214056 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:29:39.215057 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:29:39.216057 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:29:39.299270 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:39.301284 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:29:39.302283 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:29:39.302283 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:29:39.488466 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:39.497461 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:29:39.498461 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:29:39.502459 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:39.505456 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:29:39.067287 => 09:29:39.504459
[0m09:29:39.505456 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:29:39.506456 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:29:39.507455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3339b404-a9b7-43d0-a514-4d551e06af71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB533BD90>]}
[0m09:29:39.508454 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.45s]
[0m09:29:39.509454 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:29:39.510454 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:29:39.511453 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:29:39.513456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:29:39.513456 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:29:39.523446 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:29:39.525445 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:29:39.514451 => 09:29:39.524445
[0m09:29:39.526444 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:29:39.537438 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:29:39.538439 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:29:39.539437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:29:39.540437 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:29:39.541436 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:29:39.543435 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:39.545434 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:29:39.546434 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:29:39.573418 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:39.577415 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:29:39.578414 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:29:39.600405 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:39.603401 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:29:39.604400 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:29:39.606399 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:39.608398 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:29:39.608398 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:29:39.610396 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:39.613395 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:29:39.615393 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:29:39.616394 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE Region != ''NUNAVUT''
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost, mark.Ord
    from Customers as cu
    JOIN Markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*,o.OrderID,o.OrderDate,o.Order_Priority
    from custmarket as cm
    JOIN Orders as o
    on cm.Ord = o.OrdID
),

custmarkordprod as (
    select cmo.*,pr.ProductID,pr.ProductSubCategory
    from custmarkord as cmo
    JOIN products as pr
    on cmo.ProductID=pr.ProductID
),
custmarkordprodship as (
    select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
    from custmarkordprod as cmop
    JOIN shippings as sh
    on cmop.ShippingID=sh.ShippingID
)

SELECT * FROM custmarkordprodship;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:29:39.622389 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:29:39.623388 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:29:39.526444 => 09:29:39.623388
[0m09:29:39.624388 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:29:39.625387 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:29:39.626387 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ProductID'. (207) (SQLMoreResults)")
[0m09:29:39.632384 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ProductID'. (207) (SQLMoreResults)")

[0m09:29:39.634383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3339b404-a9b7-43d0-a514-4d551e06af71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB552FC70>]}
[0m09:29:39.635381 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.12s]
[0m09:29:39.637381 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:29:39.640379 [debug] [MainThread]: On master: COMMIT
[0m09:29:39.642378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:29:39.643377 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:29:39.644377 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m09:29:39.645376 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:29:39.646375 [info ] [MainThread]: 
[0m09:29:39.647375 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m09:29:39.649374 [debug] [MainThread]: Command end result
[0m09:29:39.666364 [info ] [MainThread]: 
[0m09:29:39.667364 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:29:39.668363 [info ] [MainThread]: 
[0m09:29:39.669362 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ProductID'. (207) (SQLMoreResults)")
[0m09:29:39.670362 [info ] [MainThread]: 
[0m09:29:39.672361 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:29:39.675359 [debug] [MainThread]: Command `dbt run` failed at 09:29:39.674361 after 2.02 seconds
[0m09:29:39.675359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB209ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB553C730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB552FC70>]}
[0m09:29:39.676358 [debug] [MainThread]: Flushing usage events
[0m09:30:14.315553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE83C0ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE864F22C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE864F20E0>]}


============================== 09:30:14.321549 | 1f9cf18e-84a4-479b-b302-f87d1dbb9280 ==============================
[0m09:30:14.321549 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:30:14.323548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:30:14.742420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f9cf18e-84a4-479b-b302-f87d1dbb9280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE864F2380>]}
[0m09:30:14.844361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f9cf18e-84a4-479b-b302-f87d1dbb9280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE86ADFE50>]}
[0m09:30:14.845361 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:30:14.858244 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:30:14.988175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:30:14.989174 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:30:15.202047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f9cf18e-84a4-479b-b302-f87d1dbb9280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE86E93040>]}
[0m09:30:15.218026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f9cf18e-84a4-479b-b302-f87d1dbb9280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE86E6FD00>]}
[0m09:30:15.218026 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:30:15.219026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f9cf18e-84a4-479b-b302-f87d1dbb9280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE86E6FEB0>]}
[0m09:30:15.221023 [info ] [MainThread]: 
[0m09:30:15.223041 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:30:15.224023 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:30:15.240012 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:30:15.240012 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:30:15.241021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:30:15.241021 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:30:15.315529 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:30:15.317545 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:15.319525 [debug] [ThreadPool]: On list_online: Close
[0m09:30:15.321525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:30:15.322524 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:30:15.328520 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:30:15.328520 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:30:15.329520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:15.329520 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:30:15.330519 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:30:15.342171 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:15.343173 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:30:15.344172 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:30:15.346185 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m09:30:15.353180 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:30:15.354180 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:30:15.354180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:30:15.355179 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:30:15.355179 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:30:15.368763 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:15.370749 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:30:15.370749 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:30:15.371748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m09:30:15.374746 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:30:15.375746 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:30:15.376745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:15.376745 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:30:15.376745 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:30:15.385065 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:30:15.386051 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:30:15.387050 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:30:15.388049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f9cf18e-84a4-479b-b302-f87d1dbb9280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE86AC9F30>]}
[0m09:30:15.388049 [debug] [MainThread]: On master: COMMIT
[0m09:30:15.389064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:30:15.390050 [info ] [MainThread]: 
[0m09:30:15.394131 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:30:15.394131 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:30:15.395444 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:30:15.396460 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:30:15.407440 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:30:15.409437 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:30:15.396460 => 09:30:15.409437
[0m09:30:15.410437 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:30:15.437435 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:30:15.438421 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:30:15.439420 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:30:15.439420 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:30:15.440419 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:30:15.441438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:15.445417 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:30:15.446417 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:30:15.457410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:15.465424 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:30:15.466423 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:30:15.674863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:15.695849 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:30:15.696848 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:30:15.709842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:15.713838 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:30:15.714839 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:30:15.715838 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:15.721852 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:30:15.721852 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:30:15.722853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:15.725833 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:30:15.726833 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:30:15.728830 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:30:15.768813 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:15.783821 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:30:15.787818 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:30:15.787818 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:30:15.857965 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:15.863962 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:30:15.864961 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:30:15.866746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:15.870764 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:30:15.410437 => 09:30:15.870764
[0m09:30:15.871763 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:30:15.871763 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:30:15.872763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f9cf18e-84a4-479b-b302-f87d1dbb9280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE8704FF70>]}
[0m09:30:15.873762 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.48s]
[0m09:30:15.874745 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:30:15.874745 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:30:15.875757 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:30:15.876743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:30:15.877760 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:30:15.881758 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:30:15.882740 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:30:15.877760 => 09:30:15.882740
[0m09:30:15.883756 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:30:15.888749 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:30:15.889748 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:30:15.889748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:30:15.890748 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:30:15.890748 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:30:15.892733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:15.894732 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:30:15.894732 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:30:15.903726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:15.908724 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:30:15.909729 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:30:15.912545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:15.915558 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:30:15.915558 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:30:15.927538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:15.930537 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:30:15.931536 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:30:15.932547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:15.934548 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:30:15.935547 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:30:15.936279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:15.937280 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:30:15.939279 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:30:15.940278 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:30:15.969718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:15.971722 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:30:15.972705 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:30:15.973705 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:30:16.046664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:16.051661 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:30:16.051661 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:30:16.053661 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:16.055669 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:30:15.883756 => 09:30:16.055669
[0m09:30:16.056658 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:30:16.056658 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:30:16.057657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f9cf18e-84a4-479b-b302-f87d1dbb9280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE86EAA1D0>]}
[0m09:30:16.058657 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.18s]
[0m09:30:16.059656 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:30:16.059656 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:30:16.060655 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:30:16.061667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:30:16.062655 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:30:16.069652 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:30:16.071651 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:30:16.062655 => 09:30:16.070651
[0m09:30:16.072650 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:30:16.079645 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:30:16.079645 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:30:16.080645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:30:16.080645 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:30:16.081643 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:30:16.083668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:16.086641 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:30:16.086641 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:30:16.096653 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:16.099653 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:30:16.100652 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:30:16.112626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:16.115647 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:30:16.115647 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:30:16.117626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:16.119624 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:30:16.119624 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:30:16.120623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:16.121622 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:30:16.122622 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:30:16.123621 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE Region != ''NUNAVUT''
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost, mark.Ord
    from Customers as cu
    JOIN Markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*,o.OrderID,o.OrderDate,o.Order_Priority, o.ProductID
    from custmarket as cm
    JOIN Orders as o
    on cm.Ord = o.OrdID
),

custmarkordprod as (
    select cmo.*,pr.ProductID,pr.ProductSubCategory
    from custmarkord as cmo
    JOIN products as pr
    on cmo.ProductID=pr.ProductID
),
custmarkordprodship as (
    select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
    from custmarkordprod as cmop
    JOIN shippings as sh
    on cmop.ShippingID=sh.ShippingID
)

SELECT * FROM custmarkordprodship;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:30:16.127642 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:30:16.128639 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:30:16.072650 => 09:30:16.128639
[0m09:30:16.129618 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:30:16.129618 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:30:16.130618 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ProductID'. (207) (SQLMoreResults)")
[0m09:30:16.134615 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ProductID'. (207) (SQLMoreResults)")

[0m09:30:16.135616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f9cf18e-84a4-479b-b302-f87d1dbb9280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE870A3EB0>]}
[0m09:30:16.135616 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.07s]
[0m09:30:16.137614 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:30:16.138610 [debug] [MainThread]: On master: COMMIT
[0m09:30:16.139631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:30:16.139631 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:30:16.140629 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m09:30:16.141610 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:30:16.141610 [info ] [MainThread]: 
[0m09:30:16.142627 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m09:30:16.144627 [debug] [MainThread]: Command end result
[0m09:30:16.159599 [info ] [MainThread]: 
[0m09:30:16.160598 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:30:16.161617 [info ] [MainThread]: 
[0m09:30:16.162616 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ProductID'. (207) (SQLMoreResults)")
[0m09:30:16.163599 [info ] [MainThread]: 
[0m09:30:16.165596 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:30:16.168594 [debug] [MainThread]: Command `dbt run` failed at 09:30:16.167598 after 1.93 seconds
[0m09:30:16.168594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE83C0ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE86E80DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE86FF7BE0>]}
[0m09:30:16.169593 [debug] [MainThread]: Flushing usage events
[0m09:32:03.310772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F5F3BCCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F61CA2320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F61CA2140>]}


============================== 09:32:03.317767 | 4bf5e683-61cf-465b-8e9b-c200b0061c91 ==============================
[0m09:32:03.317767 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:32:03.318767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:32:03.720305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bf5e683-61cf-465b-8e9b-c200b0061c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F61CA23E0>]}
[0m09:32:03.821247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bf5e683-61cf-465b-8e9b-c200b0061c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F6228FEB0>]}
[0m09:32:03.821247 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:32:03.836224 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:32:03.968162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:32:03.969161 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:32:04.181047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bf5e683-61cf-465b-8e9b-c200b0061c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F626430A0>]}
[0m09:32:04.197018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bf5e683-61cf-465b-8e9b-c200b0061c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F6261FD60>]}
[0m09:32:04.198030 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:32:04.199025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bf5e683-61cf-465b-8e9b-c200b0061c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F6261FEE0>]}
[0m09:32:04.201033 [info ] [MainThread]: 
[0m09:32:04.202033 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:32:04.203013 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:32:04.218027 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:32:04.219005 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:32:04.219005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:04.220005 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:32:04.316797 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:32:04.325704 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:32:04.327705 [debug] [ThreadPool]: On list_online: Close
[0m09:32:04.328704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:32:04.329704 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:32:04.336700 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:32:04.337699 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:32:04.337699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:32:04.338698 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:32:04.338698 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:32:04.356166 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:32:04.357182 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:32:04.358180 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:32:04.360251 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m09:32:04.367249 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:32:04.368249 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:32:04.368249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:04.369248 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:32:04.369248 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:32:04.390869 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:32:04.391870 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:32:04.392869 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:32:04.393868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m09:32:04.396867 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:32:04.396867 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:32:04.397866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:32:04.397866 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:32:04.398866 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:32:04.406470 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:32:04.407456 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:32:04.408455 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:32:04.409456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bf5e683-61cf-465b-8e9b-c200b0061c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F627BDAE0>]}
[0m09:32:04.409456 [debug] [MainThread]: On master: COMMIT
[0m09:32:04.410468 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:32:04.411283 [info ] [MainThread]: 
[0m09:32:04.415401 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:32:04.415401 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:32:04.417685 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:32:04.417685 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:32:04.428689 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:32:04.430673 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:32:04.417685 => 09:32:04.429673
[0m09:32:04.430673 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:32:04.459669 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:04.460668 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:32:04.460668 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:32:04.461667 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:32:04.461667 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:32:04.464496 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:04.468496 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:04.469495 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:32:04.481703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:04.490699 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:04.490699 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:32:04.748336 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:04.767345 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:04.767345 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:32:04.782133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:04.786150 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:04.787149 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:32:04.788131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:04.793128 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:04.793128 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:32:04.794146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:04.797144 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:32:04.799124 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:04.800124 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:32:04.849717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:04.864726 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:32:04.868715 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:04.869706 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:32:04.942663 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:04.947660 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:04.947660 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:32:04.950129 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:04.955127 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:32:04.431672 => 09:32:04.954128
[0m09:32:04.955127 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:32:04.955127 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:32:04.956127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf5e683-61cf-465b-8e9b-c200b0061c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F62763730>]}
[0m09:32:04.957126 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.54s]
[0m09:32:04.958126 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:32:04.959125 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:32:04.960125 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:32:04.961139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:32:04.961139 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:32:04.965140 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:32:04.967121 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:32:04.962142 => 09:32:04.967121
[0m09:32:04.968121 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:32:04.978116 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:04.979115 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:32:04.979115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:04.980115 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:32:04.981115 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:32:04.982114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:04.984112 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:04.985112 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:32:04.994119 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:04.999116 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:04.999116 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:32:05.001837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:05.004856 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:05.004856 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:32:05.016830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:05.018829 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:05.018829 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:32:05.019828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:05.022828 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:05.022828 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:32:05.023840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:05.025840 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:32:05.026824 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:05.027838 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:32:05.057147 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:05.059158 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:32:05.060157 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:05.060157 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:32:05.125124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:05.130126 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:05.131125 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:32:05.133124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:05.135104 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:32:04.969120 => 09:32:05.135104
[0m09:32:05.136104 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:32:05.136104 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:32:05.137103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf5e683-61cf-465b-8e9b-c200b0061c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F62862E90>]}
[0m09:32:05.138103 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.18s]
[0m09:32:05.139104 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:32:05.140115 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:32:05.141114 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:32:05.142119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:32:05.143119 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:32:05.150096 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:32:05.152095 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:32:05.143119 => 09:32:05.151116
[0m09:32:05.153114 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:32:05.161108 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:32:05.162107 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:32:05.162107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:05.163107 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:32:05.163107 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:32:05.164107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:05.166105 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:32:05.166105 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:32:05.176082 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:05.179093 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:32:05.180078 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:32:05.191072 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:05.194073 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:32:05.195081 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:32:05.197069 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:05.199067 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:32:05.199067 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:32:05.200067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:05.201066 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:32:05.203068 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:32:05.204065 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE Region != ''NUNAVUT''
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost, mark.Ord, mark.ProductID
    from Customers as cu
    JOIN Markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*,o.OrderID,o.OrderDate,o.Order_Priority
    from custmarket as cm
    JOIN Orders as o
    on cm.Ord = o.OrdID
),

custmarkordprod as (
    select cmo.*,pr.ProductID,pr.ProductSubCategory
    from custmarkord as cmo
    JOIN products as pr
    on cmo.ProductID=pr.ProductID
),
custmarkordprodship as (
    select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
    from custmarkordprod as cmop
    JOIN shippings as sh
    on cmop.ShippingID=sh.ShippingID
)

SELECT * FROM custmarkordprodship;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:32:05.208062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:05.210061 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:32:05.153114 => 09:32:05.209062
[0m09:32:05.210061 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:32:05.211061 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:32:05.212060 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The column 'ProductID' was specified multiple times for 'custmarkordprod'. (8156) (SQLMoreResults)")
[0m09:32:05.216058 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The column 'ProductID' was specified multiple times for 'custmarkordprod'. (8156) (SQLMoreResults)")

[0m09:32:05.217057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf5e683-61cf-465b-8e9b-c200b0061c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F628510F0>]}
[0m09:32:05.217057 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.07s]
[0m09:32:05.218057 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:32:05.220057 [debug] [MainThread]: On master: COMMIT
[0m09:32:05.221055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:32:05.222054 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:32:05.222054 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m09:32:05.223068 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:32:05.223068 [info ] [MainThread]: 
[0m09:32:05.224067 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m09:32:05.226052 [debug] [MainThread]: Command end result
[0m09:32:05.240045 [info ] [MainThread]: 
[0m09:32:05.242044 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:32:05.243043 [info ] [MainThread]: 
[0m09:32:05.243043 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The column 'ProductID' was specified multiple times for 'custmarkordprod'. (8156) (SQLMoreResults)")
[0m09:32:05.244042 [info ] [MainThread]: 
[0m09:32:05.246042 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:32:05.248040 [debug] [MainThread]: Command `dbt run` failed at 09:32:05.248040 after 2.01 seconds
[0m09:32:05.249039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F5F3BCCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F62428FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F62853B50>]}
[0m09:32:05.249039 [debug] [MainThread]: Flushing usage events
[0m09:32:21.097824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E34E6AF5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E350FA2380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E350FA21A0>]}


============================== 09:32:21.102820 | e051989b-a0eb-48a6-8936-1060c18a4e18 ==============================
[0m09:32:21.102820 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:32:21.103820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:32:21.504845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e051989b-a0eb-48a6-8936-1060c18a4e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E350FA2440>]}
[0m09:32:21.604788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e051989b-a0eb-48a6-8936-1060c18a4e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35159FF10>]}
[0m09:32:21.604788 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:32:21.618780 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:32:21.748221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:32:21.749221 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:32:21.970082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e051989b-a0eb-48a6-8936-1060c18a4e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E351953100>]}
[0m09:32:21.988075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e051989b-a0eb-48a6-8936-1060c18a4e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35192FDC0>]}
[0m09:32:21.989069 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:32:21.990072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e051989b-a0eb-48a6-8936-1060c18a4e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35192FEB0>]}
[0m09:32:21.993068 [info ] [MainThread]: 
[0m09:32:21.994068 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:32:21.997065 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:32:22.011057 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:32:22.012057 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:32:22.013056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:22.013056 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:32:22.057480 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:32:22.058614 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:32:22.059615 [debug] [ThreadPool]: On list_online: Close
[0m09:32:22.060614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:32:22.061614 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:32:22.067610 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:32:22.068610 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:32:22.068610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:32:22.069609 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:32:22.069609 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:32:22.070995 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:32:22.071997 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:32:22.071997 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:32:22.074636 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m09:32:22.081633 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:32:22.082633 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:32:22.082633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:22.083632 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:32:22.083632 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:32:22.084952 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:32:22.086967 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:32:22.086967 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:32:22.087967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m09:32:22.090965 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:32:22.090965 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:32:22.091964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:32:22.091964 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:32:22.091964 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:32:22.093968 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:32:22.094968 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:32:22.094968 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:32:22.096948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e051989b-a0eb-48a6-8936-1060c18a4e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35155BDC0>]}
[0m09:32:22.096948 [debug] [MainThread]: On master: COMMIT
[0m09:32:22.097961 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:32:22.098955 [info ] [MainThread]: 
[0m09:32:22.102954 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:32:22.102954 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:32:22.104943 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:32:22.104943 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:32:22.114956 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:32:22.116936 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:32:22.105942 => 09:32:22.115955
[0m09:32:22.117954 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:32:22.148952 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:22.149931 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:32:22.149931 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:32:22.150939 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:32:22.151930 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:32:22.152363 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.156377 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:22.157376 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:32:22.158009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.165007 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:22.166006 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:32:22.215435 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.233450 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:22.234450 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:32:22.235481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.238481 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:22.239481 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:32:22.239481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.244478 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:22.245478 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:32:22.246477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.248476 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:32:22.250484 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:22.250484 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:32:22.289657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.304650 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:32:22.308648 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:22.308648 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:32:22.310195 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.314195 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:32:22.315194 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:32:22.317225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.321238 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:32:22.117954 => 09:32:22.321238
[0m09:32:22.322237 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:32:22.322237 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:32:22.323237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e051989b-a0eb-48a6-8936-1060c18a4e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E351B07A90>]}
[0m09:32:22.324236 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.22s]
[0m09:32:22.325222 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:32:22.325222 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:32:22.326222 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:32:22.327235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:32:22.327235 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:32:22.331232 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:32:22.333218 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:32:22.328234 => 09:32:22.333218
[0m09:32:22.333218 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:32:22.339215 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:22.340213 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:32:22.340213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:22.341213 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:32:22.341213 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:32:22.342212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.344230 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:22.345210 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:32:22.346210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.351228 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:22.351228 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:32:22.353959 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.356978 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:22.356978 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:32:22.357960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.358972 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:22.359971 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:32:22.360957 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.361971 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:22.362969 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:32:22.363960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.366972 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:32:22.368954 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:22.369970 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:32:22.399108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.402099 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:32:22.403097 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:22.403097 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:32:22.404086 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.408097 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:32:22.409097 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:32:22.411202 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.413216 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:32:22.334235 => 09:32:22.412218
[0m09:32:22.413216 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:32:22.414202 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:32:22.415217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e051989b-a0eb-48a6-8936-1060c18a4e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E351968460>]}
[0m09:32:22.416215 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.09s]
[0m09:32:22.417201 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:32:22.417201 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:32:22.418200 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:32:22.419200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:32:22.420213 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:32:22.426209 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:32:22.428214 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:32:22.420213 => 09:32:22.427209
[0m09:32:22.428214 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:32:22.435210 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:32:22.435210 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:32:22.436212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:22.437205 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:32:22.437205 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:32:22.439270 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.441271 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:32:22.441271 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:32:22.442271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.444270 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:32:22.445269 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:32:22.445943 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.447945 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:32:22.447945 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:32:22.448950 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.450959 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:32:22.451955 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:32:22.452955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.454954 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:32:22.455941 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:32:22.455941 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE Region != ''NUNAVUT''
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost, mark.Ord, mark.ProductID
    from Customers as cu
    JOIN Markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*,o.OrderID,o.OrderDate,o.Order_Priority
    from custmarket as cm
    JOIN Orders as o
    on cm.Ord = o.OrdID
),

custmarkordprod as (
    select cmo.*,pr.ProductSubCategory
    from custmarkord as cmo
    JOIN products as pr
    on cmo.ProductID=pr.ProductID
),
custmarkordprodship as (
    select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
    from custmarkordprod as cmop
    JOIN shippings as sh
    on cmop.ShippingID=sh.ShippingID
)

SELECT * FROM custmarkordprodship;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:32:22.458896 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:32:22.459909 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:32:22.428214 => 09:32:22.459909
[0m09:32:22.460909 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:32:22.460909 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:32:22.461908 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ShippingID'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ShippingID'. (207)")
[0m09:32:22.465902 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ShippingID'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ShippingID'. (207)")

[0m09:32:22.466902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e051989b-a0eb-48a6-8936-1060c18a4e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E351B59FF0>]}
[0m09:32:22.467890 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.05s]
[0m09:32:22.468892 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:32:22.470889 [debug] [MainThread]: On master: COMMIT
[0m09:32:22.471898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:32:22.472902 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:32:22.472902 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m09:32:22.472902 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:32:22.473902 [info ] [MainThread]: 
[0m09:32:22.474887 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m09:32:22.475897 [debug] [MainThread]: Command end result
[0m09:32:22.490877 [info ] [MainThread]: 
[0m09:32:22.492877 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:32:22.492877 [info ] [MainThread]: 
[0m09:32:22.494014 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ShippingID'. (207) (SQLMoreResults); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ShippingID'. (207)")
[0m09:32:22.495017 [info ] [MainThread]: 
[0m09:32:22.495017 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:32:22.497015 [debug] [MainThread]: Command `dbt run` failed at 09:32:22.497015 after 1.47 seconds
[0m09:32:22.498016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E34E6AF5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E350F19090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E351B59780>]}
[0m09:32:22.498016 [debug] [MainThread]: Flushing usage events
[0m09:34:21.710793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511F1EF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025121AD2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025121AD2170>]}


============================== 09:34:21.716789 | 71dba472-5931-4deb-b955-a540c3bd8e68 ==============================
[0m09:34:21.716789 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:34:21.717789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:34:22.305287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71dba472-5931-4deb-b955-a540c3bd8e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025121AD2410>]}
[0m09:34:22.409223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71dba472-5931-4deb-b955-a540c3bd8e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251220BFEE0>]}
[0m09:34:22.409223 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:34:22.434406 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:34:23.623398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:34:23.623398 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:34:23.829280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71dba472-5931-4deb-b955-a540c3bd8e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251224730D0>]}
[0m09:34:23.861646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71dba472-5931-4deb-b955-a540c3bd8e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002512244FD90>]}
[0m09:34:23.862646 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:34:23.863631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71dba472-5931-4deb-b955-a540c3bd8e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002512244FD00>]}
[0m09:34:23.865630 [info ] [MainThread]: 
[0m09:34:23.866632 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:34:23.869630 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:34:23.884619 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:34:23.885618 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:34:23.885618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:23.886618 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:34:23.987666 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:34:23.993194 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:34:23.995214 [debug] [ThreadPool]: On list_online: Close
[0m09:34:23.996166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:34:23.997168 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:34:24.003164 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:34:24.003164 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:34:24.003164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:24.004163 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:34:24.004163 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:34:24.023173 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:34:24.024189 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:34:24.025187 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:34:24.027195 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m09:34:24.034193 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:34:24.034193 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:34:24.035193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:24.035193 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:34:24.036192 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:34:24.055875 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:34:24.056874 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:34:24.057873 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:34:24.058873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m09:34:24.061871 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:34:24.061871 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:34:24.061871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:24.062871 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:34:24.062871 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:34:24.071204 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:34:24.072190 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:34:24.073190 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:34:24.074198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71dba472-5931-4deb-b955-a540c3bd8e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251225D81F0>]}
[0m09:34:24.074198 [debug] [MainThread]: On master: COMMIT
[0m09:34:24.075202 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:34:24.076024 [info ] [MainThread]: 
[0m09:34:24.080138 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:34:24.080138 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:34:24.082447 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:34:24.082447 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:34:24.093435 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:34:24.095421 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:34:24.082447 => 09:34:24.094434
[0m09:34:24.095421 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:34:24.125416 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:34:24.126416 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:34:24.126416 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:34:24.127415 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:34:24.127415 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:34:24.130047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.134061 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:34:24.134061 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:34:24.147694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.155691 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:34:24.156690 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:34:24.387582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.405593 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:34:24.406587 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:34:24.421237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.425255 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:34:24.426254 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:34:24.427255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.433232 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:34:24.433232 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:34:24.434232 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.437230 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:34:24.439228 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:34:24.439228 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:34:24.493807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.508800 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:34:24.512798 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:34:24.512798 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:34:24.582802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.591797 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:34:24.593796 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:34:24.595804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.600794 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:34:24.095421 => 09:34:24.600794
[0m09:34:24.601791 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:34:24.601791 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:34:24.602790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71dba472-5931-4deb-b955-a540c3bd8e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002512262BFD0>]}
[0m09:34:24.603789 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.52s]
[0m09:34:24.604320 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:34:24.605336 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:34:24.605336 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:34:24.606323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:34:24.607335 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:34:24.611336 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:34:24.613325 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:34:24.607335 => 09:34:24.612331
[0m09:34:24.613325 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:34:24.620331 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:34:24.621324 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:34:24.622317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:24.622317 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:34:24.623327 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:34:24.624326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.626311 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:34:24.626311 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:34:24.636773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.641790 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:34:24.641790 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:34:24.644770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.648780 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:34:24.648780 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:34:24.660760 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.662758 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:34:24.663757 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:34:24.664757 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.666770 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:34:24.666770 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:34:24.668017 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.669018 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:34:24.671035 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:34:24.672031 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:34:24.702640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.704655 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:34:24.705654 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:34:24.705654 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:34:24.782425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.787418 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:34:24.788417 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:34:24.791400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.793399 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:34:24.614330 => 09:34:24.792401
[0m09:34:24.793399 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:34:24.794399 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:34:24.794399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71dba472-5931-4deb-b955-a540c3bd8e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002512248B850>]}
[0m09:34:24.795398 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.19s]
[0m09:34:24.796413 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:34:24.797415 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:34:24.797415 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:34:24.798423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:34:24.799398 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:34:24.806393 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:34:24.807392 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:34:24.799398 => 09:34:24.807392
[0m09:34:24.808392 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:34:24.816387 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:34:24.816387 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:34:24.817387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:24.817387 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:34:24.818387 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:34:24.819386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.821386 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:34:24.822384 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:34:24.832396 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.835394 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:34:24.836374 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:34:24.849367 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.853366 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:34:24.854366 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:34:24.855365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.858362 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:34:24.859363 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:34:24.861361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.862361 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:34:24.864359 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:34:24.864359 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE Region != ''NUNAVUT''
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost, mark.Ord, mark.ProductID
    from Customers as cu
    JOIN Markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*,o.OrderID,o.OrderDate,o.Order_Priority
    from custmarket as cm
    JOIN Orders as o
    on cm.Ord = o.OrdID
),

custmarkordprod as (
    select cmo.*,pr.ProductSubCategory
    from custmarkord as cmo
    JOIN products as pr
    on cmo.ProductID=pr.ProductID
),
custmarkordprodship as (
    select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
    from custmarkordprod as cmop
    JOIN shippings as sh
    on cmop.ShipID=sh.ShipID
)

SELECT * FROM custmarkordprodship;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:34:24.868357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:34:24.869356 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:34:24.808392 => 09:34:24.869356
[0m09:34:24.869356 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:34:24.870356 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:34:24.871355 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ShipID'. (207) (SQLMoreResults)")
[0m09:34:24.960655 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ShipID'. (207) (SQLMoreResults)")

[0m09:34:24.961655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71dba472-5931-4deb-b955-a540c3bd8e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002512267D3F0>]}
[0m09:34:24.962658 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.16s]
[0m09:34:24.963639 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:34:24.965653 [debug] [MainThread]: On master: COMMIT
[0m09:34:24.966656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:34:24.966656 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:34:24.966656 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m09:34:24.967656 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:34:24.967656 [info ] [MainThread]: 
[0m09:34:24.968640 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m09:34:24.969637 [debug] [MainThread]: Command end result
[0m09:34:24.984641 [info ] [MainThread]: 
[0m09:34:24.985628 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:34:24.985628 [info ] [MainThread]: 
[0m09:34:24.986642 [error] [MainThread]:   ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'ShipID'. (207) (SQLMoreResults)")
[0m09:34:24.987627 [info ] [MainThread]: 
[0m09:34:24.987627 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:34:24.989624 [debug] [MainThread]: Command `dbt run` failed at 09:34:24.989624 after 3.38 seconds
[0m09:34:24.990624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511F1EF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025121A4A6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025122990EE0>]}
[0m09:34:24.991623 [debug] [MainThread]: Flushing usage events
[0m09:41:15.322557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA04EED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA2DD22F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA2DD2110>]}


============================== 09:41:15.328554 | 29ee6410-d8e2-4244-a7de-b3abc1230c6e ==============================
[0m09:41:15.328554 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:41:15.329619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:41:15.723376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29ee6410-d8e2-4244-a7de-b3abc1230c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA2DD23B0>]}
[0m09:41:15.825331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29ee6410-d8e2-4244-a7de-b3abc1230c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA33BBE80>]}
[0m09:41:15.825331 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:41:15.839570 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:41:15.968706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:41:15.969706 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:41:16.174602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29ee6410-d8e2-4244-a7de-b3abc1230c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA3773070>]}
[0m09:41:16.190580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29ee6410-d8e2-4244-a7de-b3abc1230c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA374FD30>]}
[0m09:41:16.190580 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:41:16.191598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29ee6410-d8e2-4244-a7de-b3abc1230c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA374FEE0>]}
[0m09:41:16.193578 [info ] [MainThread]: 
[0m09:41:16.194580 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:41:16.196578 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:41:16.212569 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:41:16.212569 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:41:16.213568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:16.213568 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:41:16.277312 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:41:16.280719 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:16.282734 [debug] [ThreadPool]: On list_online: Close
[0m09:41:16.283721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:41:16.284733 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:41:16.289730 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:41:16.290729 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:41:16.290729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:16.291729 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:41:16.291729 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:41:16.295689 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:16.296691 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:41:16.297690 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:41:16.299841 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_staging'
[0m09:41:16.306839 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:41:16.307838 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:41:16.307838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:16.308837 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:41:16.308837 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:41:16.322079 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:16.324097 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:41:16.324097 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:41:16.325096 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_staging, now list_online_dbt_mart)
[0m09:41:16.329094 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:41:16.329094 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:41:16.330075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:16.331074 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:41:16.332073 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:41:16.340068 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:16.342081 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:41:16.342081 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:41:16.343081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29ee6410-d8e2-4244-a7de-b3abc1230c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA38EC8E0>]}
[0m09:41:16.344080 [debug] [MainThread]: On master: COMMIT
[0m09:41:16.344080 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:41:16.345080 [info ] [MainThread]: 
[0m09:41:16.348695 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:41:16.349680 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:41:16.350681 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:41:16.350681 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:41:16.361687 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:41:16.363672 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:41:16.351697 => 09:41:16.362687
[0m09:41:16.363672 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:41:16.392677 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:16.393655 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:41:16.393655 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:41:16.394654 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:41:16.394654 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:41:16.396522 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:16.400522 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:16.400522 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:41:16.411845 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:16.418842 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:16.419842 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:41:16.630970 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:16.648976 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:16.649980 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:41:16.664387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:16.668105 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:16.669104 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:41:16.670001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:16.675000 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:16.676000 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:41:16.676999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:16.679997 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:41:16.680996 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:16.681996 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:41:16.729700 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:16.744706 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:41:16.748706 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:16.748706 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:41:16.819650 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:16.824665 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:16.825660 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:41:16.828097 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:16.833091 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:41:16.363672 => 09:41:16.833091
[0m09:41:16.834090 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:41:16.834090 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:41:16.835089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ee6410-d8e2-4244-a7de-b3abc1230c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA392FBE0>]}
[0m09:41:16.836089 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 0.49s]
[0m09:41:16.837095 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:41:16.838088 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:41:16.838088 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:41:16.839108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:41:16.840101 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:41:16.844098 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:41:16.846083 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:41:16.840101 => 09:41:16.846083
[0m09:41:16.847083 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:41:16.855097 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:16.855097 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:41:16.856096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:16.856096 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:41:16.857095 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:41:16.858078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:16.861088 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:16.861088 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:41:16.869604 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:16.873604 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:16.874611 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:41:16.877799 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:16.880801 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:16.881800 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:41:16.892551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:16.895569 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:16.896551 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:41:16.897548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:16.900546 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:16.900546 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:41:16.902053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:16.903054 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:41:16.905053 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:16.905053 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:41:16.936089 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:16.938105 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:41:16.939104 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:16.940103 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:41:17.005897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:17.010882 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:17.010882 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:41:17.013584 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:17.015585 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:41:16.847083 => 09:41:17.015585
[0m09:41:17.015585 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:41:17.016584 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:41:17.017584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ee6410-d8e2-4244-a7de-b3abc1230c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA337B5B0>]}
[0m09:41:17.018583 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.18s]
[0m09:41:17.019321 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:41:17.020336 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:41:17.020336 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:41:17.022335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:41:17.022335 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:41:17.029331 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:41:17.030316 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:41:17.022335 => 09:41:17.030316
[0m09:41:17.031330 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:41:17.039327 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:41:17.040325 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:41:17.041312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:17.041312 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:41:17.042326 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:41:17.044310 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:17.046308 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:41:17.046308 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:41:17.055303 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:17.059301 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:41:17.059301 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:41:17.071306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:17.073310 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:41:17.074310 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:41:17.076290 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:17.079298 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:41:17.079298 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:41:17.080589 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:17.081605 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:41:17.083589 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:41:17.083589 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE Region != ''NUNAVUT''
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost, mark.Ord, mark.ProductID, mark.ShipID
    from Customers as cu
    JOIN Markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*,o.OrderID,o.OrderDate,o.Order_Priority
    from custmarket as cm
    JOIN Orders as o
    on cm.Ord = o.OrdID
),

custmarkordprod as (
    select cmo.*,pr.ProductSubCategory
    from custmarkord as cmo
    JOIN products as pr
    on cmo.ProductID=pr.ProductID
),
custmarkordprodship as (
    select cmop.*,sh.ShipDate,sh.ShipMode,sh.ShipID
    from custmarkordprod as cmop
    JOIN shippings as sh
    on cmop.ShipID=sh.ShipID
)

SELECT * FROM custmarkordprodship;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:41:17.086653 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:17.088665 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:41:17.032330 => 09:41:17.087664
[0m09:41:17.088665 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:41:17.089664 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:41:17.090663 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_shopping\models\mart\orders.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The column 'ShipID' was specified multiple times for 'custmarkordprodship'. (8156) (SQLMoreResults)")
[0m09:41:17.094674 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\base.py", line 424, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 83, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\jinja2\runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\NadimintiDeepthi\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The column 'ShipID' was specified multiple times for 'custmarkordprodship'. (8156) (SQLMoreResults)")

[0m09:41:17.095661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ee6410-d8e2-4244-a7de-b3abc1230c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA399C340>]}
[0m09:41:17.096664 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model online.dbt_mart.orders ................... [[31mERROR[0m in 0.07s]
[0m09:41:17.097645 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:41:17.099645 [debug] [MainThread]: On master: COMMIT
[0m09:41:17.100645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:41:17.100645 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:41:17.101644 [debug] [MainThread]: Connection 'list_online_dbt_mart' was properly closed.
[0m09:41:17.101644 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:41:17.101644 [info ] [MainThread]: 
[0m09:41:17.103051 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m09:41:17.105066 [debug] [MainThread]: Command end result
[0m09:41:17.120044 [info ] [MainThread]: 
[0m09:41:17.121042 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:41:17.121042 [info ] [MainThread]: 
[0m09:41:17.122056 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The column 'ShipID' was specified multiple times for 'custmarkordprodship'. (8156) (SQLMoreResults)")
[0m09:41:17.123041 [info ] [MainThread]: 
[0m09:41:17.124055 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:41:17.126054 [debug] [MainThread]: Command `dbt run` failed at 09:41:17.126054 after 1.89 seconds
[0m09:41:17.127053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA04EED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA399D3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA3980E50>]}
[0m09:41:17.128053 [debug] [MainThread]: Flushing usage events
[0m09:41:41.610558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A904ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AB9322C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AB9320E0>]}


============================== 09:41:41.615556 | f2385aae-7670-415d-8044-6acf2e63188e ==============================
[0m09:41:41.615556 [info ] [MainThread]: Running with dbt=1.7.9
[0m09:41:41.616749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NadimintiDeepthi\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:mart --select tag:orders', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:41:42.019969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2385aae-7670-415d-8044-6acf2e63188e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AB932380>]}
[0m09:41:42.121914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2385aae-7670-415d-8044-6acf2e63188e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276ABF1BE50>]}
[0m09:41:42.122913 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m09:41:42.140886 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m09:41:42.297794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:41:42.298794 [debug] [MainThread]: Partial parsing: updated file: online_shopping://models\mart\orders.sql
[0m09:41:42.532660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2385aae-7670-415d-8044-6acf2e63188e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC2D3040>]}
[0m09:41:42.550649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2385aae-7670-415d-8044-6acf2e63188e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC2AFD00>]}
[0m09:41:42.550649 [info ] [MainThread]: Found 9 models, 1 seed, 2 tests, 5 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:41:42.551649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2385aae-7670-415d-8044-6acf2e63188e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC2AFEB0>]}
[0m09:41:42.553648 [info ] [MainThread]: 
[0m09:41:42.554647 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m09:41:42.556646 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online'
[0m09:41:42.574636 [debug] [ThreadPool]: Using sqlserver connection "list_online"
[0m09:41:42.574636 [debug] [ThreadPool]: On list_online: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online"} */
select  name as [schema]
    from sys.schemas 
  
[0m09:41:42.575636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:42.575636 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:41:42.666562 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:41:42.680554 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:42.682554 [debug] [ThreadPool]: On list_online: Close
[0m09:41:42.683554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online, now create_online_dbt_mart)
[0m09:41:42.684553 [debug] [ThreadPool]: Creating schema "database: "online"
schema: "dbt_mart"
"
[0m09:41:42.691548 [debug] [ThreadPool]: Using sqlserver connection "create_online_dbt_mart"
[0m09:41:42.691548 [debug] [ThreadPool]: On create_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "create_online_dbt_mart"} */
USE [online];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbt_mart')
    BEGIN
    EXEC('CREATE SCHEMA [dbt_mart]')
    END
  
[0m09:41:42.692548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:42.692548 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:41:42.693548 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:41:42.709537 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:42.710537 [debug] [ThreadPool]: On create_online_dbt_mart: COMMIT
[0m09:41:42.711536 [debug] [ThreadPool]: On create_online_dbt_mart: Close
[0m09:41:42.714535 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online_dbt_mart'
[0m09:41:42.722530 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_mart"
[0m09:41:42.723530 [debug] [ThreadPool]: On list_online_dbt_mart: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_mart"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
  
[0m09:41:42.723530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:42.724529 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:41:42.724529 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:41:42.767011 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:42.768027 [debug] [ThreadPool]: On list_online_dbt_mart: ROLLBACK
[0m09:41:42.769030 [debug] [ThreadPool]: On list_online_dbt_mart: Close
[0m09:41:42.770030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online_dbt_mart, now list_online_dbt_staging)
[0m09:41:42.773028 [debug] [ThreadPool]: Using sqlserver connection "list_online_dbt_staging"
[0m09:41:42.773028 [debug] [ThreadPool]: On list_online_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "connection_name": "list_online_dbt_staging"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_staging'
  
[0m09:41:42.774027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:42.774027 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:41:42.775028 [debug] [ThreadPool]: fabric adapter: Connected to db: master
[0m09:41:42.783004 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:41:42.785021 [debug] [ThreadPool]: On list_online_dbt_staging: ROLLBACK
[0m09:41:42.785021 [debug] [ThreadPool]: On list_online_dbt_staging: Close
[0m09:41:42.786021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2385aae-7670-415d-8044-6acf2e63188e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276ABF09F30>]}
[0m09:41:42.787015 [debug] [MainThread]: On master: COMMIT
[0m09:41:42.787015 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:41:42.788015 [info ] [MainThread]: 
[0m09:41:42.791586 [debug] [Thread-1 (]: Began running node model.online_shopping.customer
[0m09:41:42.792598 [info ] [Thread-1 (]: 1 of 3 START sql table model online.dbt_mart.customer .......................... [RUN]
[0m09:41:42.793379 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_shopping.customer'
[0m09:41:42.794380 [debug] [Thread-1 (]: Began compiling node model.online_shopping.customer
[0m09:41:42.803375 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.customer"
[0m09:41:42.804375 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (compile): 09:41:42.794380 => 09:41:42.804375
[0m09:41:42.804375 [debug] [Thread-1 (]: Began executing node model.online_shopping.customer
[0m09:41:42.833358 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:42.834358 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:41:42.835357 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:41:42.835357 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:41:42.836357 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:41:42.838958 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:42.842971 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:42.842971 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'customer'
  
[0m09:41:42.865674 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:42.873671 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:42.874668 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */
USE [online];
      EXEC sp_rename 'dbt_mart.customer', 'customer__dbt_backup'
[0m09:41:43.170889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:43.201872 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:43.202871 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:41:43.233871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:43.238849 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:43.238849 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');

  
[0m09:41:43.240853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:43.247846 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:43.248845 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'customer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:41:43.299663 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:43.303665 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.customer"
[0m09:41:43.304648 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:43.305645 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."customer_temp_view" as 
 
WITH notnunavut AS (
    SELECT *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE region != ''NUNAVUT''
),
 
joincustmark AS (
    SELECT
        cu.CustomerId,
        cu.CustomerName,
        cu.Province,
        cu.CustomerSegment,
        ma.Ord,
        ma.Sales
    FROM notnunavut as cu
    JOIN "online"."dbt_staging"."stg_market" as ma ON cu.CustomerId = ma.CustomerId
),
 
joincustorder AS (
    SELECT
        cus.CustomerId,
        cus.CustomerName,
        cus.Province,
        cus.CustomerSegment,
        ord.OrdID,
        cus.Sales,
        ord.OrderDate
    FROM joincustmark as cus
    JOIN "online"."dbt_staging"."stg_order" as ord ON cus.Ord = ord.OrdID
),
 
finalcustorder AS (
    SELECT
        CustomerId,
        CustomerName,
        Province,
        CustomerSegment,
        MIN(OrderDate) AS FirstOrderDate,
        MAX(OrderDate) AS RecentOrderDate,
        COUNT(OrdId) AS TotalOrders,
        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount
    FROM joincustorder
    GROUP BY CustomerId, CustomerName, Province, CustomerSegment
)
 
SELECT * FROM finalcustorder;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[customer] FROM [online].[dbt_mart].[customer_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."customer_temp_view";');



  
[0m09:41:49.193586 [debug] [Thread-1 (]: SQL status: OK in 6.0 seconds
[0m09:41:49.208577 [debug] [Thread-1 (]: On model.online_shopping.customer: COMMIT
[0m09:41:49.212555 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:49.213554 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'customer__dbt_backup'
  
[0m09:41:49.295507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.303528 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.customer"
[0m09:41:49.305527 [debug] [Thread-1 (]: On model.online_shopping.customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.customer"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."customer__dbt_backup";');

[0m09:41:49.310507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.322517 [debug] [Thread-1 (]: Timing info for model.online_shopping.customer (execute): 09:41:42.805374 => 09:41:49.322517
[0m09:41:49.324516 [debug] [Thread-1 (]: On model.online_shopping.customer: ROLLBACK
[0m09:41:49.326514 [debug] [Thread-1 (]: On model.online_shopping.customer: Close
[0m09:41:49.328490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2385aae-7670-415d-8044-6acf2e63188e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC48BF70>]}
[0m09:41:49.329489 [info ] [Thread-1 (]: 1 of 3 OK created sql table model online.dbt_mart.customer ..................... [[32mOK[0m in 6.54s]
[0m09:41:49.330488 [debug] [Thread-1 (]: Finished running node model.online_shopping.customer
[0m09:41:49.331487 [debug] [Thread-1 (]: Began running node model.online_shopping.market
[0m09:41:49.332486 [info ] [Thread-1 (]: 2 of 3 START sql table model online.dbt_mart.market ............................ [RUN]
[0m09:41:49.333486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.customer, now model.online_shopping.market)
[0m09:41:49.334485 [debug] [Thread-1 (]: Began compiling node model.online_shopping.market
[0m09:41:49.339498 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.market"
[0m09:41:49.342481 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (compile): 09:41:49.334485 => 09:41:49.341482
[0m09:41:49.343483 [debug] [Thread-1 (]: Began executing node model.online_shopping.market
[0m09:41:49.351478 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:49.352477 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:41:49.352477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:49.353477 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:41:49.354475 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:41:49.356473 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.359486 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:49.360484 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'market'
  
[0m09:41:49.371483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.377474 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:49.377474 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */
USE [online];
      EXEC sp_rename 'dbt_mart.market', 'market__dbt_backup'
[0m09:41:49.585461 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.588481 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:49.588481 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:41:49.601453 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.603464 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:49.604452 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');

  
[0m09:41:49.605451 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.606451 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:49.607468 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'market_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:41:49.608465 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.609468 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.market"
[0m09:41:49.610449 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:49.611448 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."market_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
 
NotNunavut AS (
    SELECT
        cu.*
    FROM customers as cu
    WHERE UPPER(cu.Region) != ''NUNAVUT''
),
 
final AS (
    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from
    NotNunavut as nn
    JOIN markets as mark
    on nn.CustomerID=mark.CustomerId
    join products as pro
    on mark.ProductID=pro.ProductId
)
 
select * from final;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[market] FROM [online].[dbt_mart].[market_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."market_temp_view";');



  
[0m09:41:49.640557 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.642574 [debug] [Thread-1 (]: On model.online_shopping.market: COMMIT
[0m09:41:49.643573 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:49.643573 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'market__dbt_backup'
  
[0m09:41:49.714516 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.719527 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.market"
[0m09:41:49.720532 [debug] [Thread-1 (]: On model.online_shopping.market: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.market"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."market__dbt_backup";');

[0m09:41:49.722387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.724401 [debug] [Thread-1 (]: Timing info for model.online_shopping.market (execute): 09:41:49.343483 => 09:41:49.723402
[0m09:41:49.724401 [debug] [Thread-1 (]: On model.online_shopping.market: ROLLBACK
[0m09:41:49.725400 [debug] [Thread-1 (]: On model.online_shopping.market: Close
[0m09:41:49.725400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2385aae-7670-415d-8044-6acf2e63188e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC2EB9A0>]}
[0m09:41:49.726405 [info ] [Thread-1 (]: 2 of 3 OK created sql table model online.dbt_mart.market ....................... [[32mOK[0m in 0.39s]
[0m09:41:49.727386 [debug] [Thread-1 (]: Finished running node model.online_shopping.market
[0m09:41:49.728399 [debug] [Thread-1 (]: Began running node model.online_shopping.orders
[0m09:41:49.728399 [info ] [Thread-1 (]: 3 of 3 START sql table model online.dbt_mart.orders ............................ [RUN]
[0m09:41:49.729398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shopping.market, now model.online_shopping.orders)
[0m09:41:49.730402 [debug] [Thread-1 (]: Began compiling node model.online_shopping.orders
[0m09:41:49.736395 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shopping.orders"
[0m09:41:49.737382 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (compile): 09:41:49.730402 => 09:41:49.737382
[0m09:41:49.737382 [debug] [Thread-1 (]: Began executing node model.online_shopping.orders
[0m09:41:49.743390 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:41:49.744389 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:41:49.744389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:49.745389 [debug] [Thread-1 (]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=DESKTOP-GLV0LAC;Database=master;trusted_connection=Yes;encrypt=No;TrustServerCertificate=No;APP=dbt-sqlserver/1.7.4;ConnectRetryCount=1
[0m09:41:49.745389 [debug] [Thread-1 (]: fabric adapter: Connected to db: master
[0m09:41:49.747381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.749373 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:41:49.749373 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbt_mart'
    and table_name like 'orders'
  
[0m09:41:49.759381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.762379 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:41:49.763378 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:41:49.773379 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.776358 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:41:49.777373 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');

  
[0m09:41:49.779356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.781368 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:41:49.781368 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online'
      and refs.referenced_schema_name = 'dbt_mart'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m09:41:49.782368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.783367 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shopping.orders"
[0m09:41:49.785352 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:41:49.785352 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

  
    

   

    USE [online];
    
    

    EXEC('create view "dbt_mart"."orders_temp_view" as 
 
WITH
Customers AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_customer"
    WHERE Region != ''NUNAVUT''
),
 
Products AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_product"
),
 
Markets AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_market"
),
Orders AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_order"
),
Shippings AS (
    SELECT
        *
    FROM "online"."dbt_staging"."stg_shipping"
),
 
custmarket as (
    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost, mark.Ord, mark.ProductID, mark.ShipID
    from Customers as cu
    JOIN Markets as mark
    on cu.CustomerID=mark.CustomerId
),
custmarkord as (
    select cm.*,o.OrderID,o.OrderDate,o.Order_Priority
    from custmarket as cm
    JOIN Orders as o
    on cm.Ord = o.OrdID
),

custmarkordprod as (
    select cmo.*,pr.ProductSubCategory
    from custmarkord as cmo
    JOIN products as pr
    on cmo.ProductID=pr.ProductID
),
custmarkordprodship as (
    select cmop.*,sh.ShipDate,sh.ShipMode
    from custmarkordprod as cmop
    JOIN shippings as sh
    on cmop.ShipID=sh.ShipID
)

SELECT * FROM custmarkordprodship;');



    
      EXEC('SELECT * INTO [online].[dbt_mart].[orders] FROM [online].[dbt_mart].[orders_temp_view];');
    

    
      
      
    
    USE [online];
    EXEC('DROP view IF EXISTS "dbt_mart"."orders_temp_view";');



  
[0m09:41:49.872052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.874049 [debug] [Thread-1 (]: On model.online_shopping.orders: COMMIT
[0m09:41:49.875049 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:41:49.875049 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      USE [online];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbt_mart' and tab2.name = 'orders__dbt_backup'
  
[0m09:41:49.942151 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.947161 [debug] [Thread-1 (]: Using sqlserver connection "model.online_shopping.orders"
[0m09:41:49.947161 [debug] [Thread-1 (]: On model.online_shopping.orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "online_shopping", "target_name": "dev", "node_id": "model.online_shopping.orders"} */

      
      
    USE [online];
    EXEC('DROP table IF EXISTS "dbt_mart"."orders__dbt_backup";');

[0m09:41:49.948147 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:41:49.950160 [debug] [Thread-1 (]: Timing info for model.online_shopping.orders (execute): 09:41:49.738380 => 09:41:49.950160
[0m09:41:49.951160 [debug] [Thread-1 (]: On model.online_shopping.orders: ROLLBACK
[0m09:41:49.951160 [debug] [Thread-1 (]: On model.online_shopping.orders: Close
[0m09:41:49.952159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2385aae-7670-415d-8044-6acf2e63188e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC50B8E0>]}
[0m09:41:49.953158 [info ] [Thread-1 (]: 3 of 3 OK created sql table model online.dbt_mart.orders ....................... [[32mOK[0m in 0.22s]
[0m09:41:49.954147 [debug] [Thread-1 (]: Finished running node model.online_shopping.orders
[0m09:41:49.955158 [debug] [MainThread]: On master: COMMIT
[0m09:41:49.956153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:41:49.957153 [debug] [MainThread]: Connection 'create_online_dbt_mart' was properly closed.
[0m09:41:49.957153 [debug] [MainThread]: Connection 'list_online_dbt_staging' was properly closed.
[0m09:41:49.957153 [debug] [MainThread]: Connection 'model.online_shopping.orders' was properly closed.
[0m09:41:49.958151 [info ] [MainThread]: 
[0m09:41:49.959141 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m09:41:49.960151 [debug] [MainThread]: Command end result
[0m09:41:49.977150 [info ] [MainThread]: 
[0m09:41:49.978130 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:41:49.979131 [info ] [MainThread]: 
[0m09:41:49.980130 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:41:49.982138 [debug] [MainThread]: Command `dbt run` succeeded at 09:41:49.982138 after 8.46 seconds
[0m09:41:49.982138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A904ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276ABF09F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC2BD930>]}
[0m09:41:49.983138 [debug] [MainThread]: Flushing usage events
