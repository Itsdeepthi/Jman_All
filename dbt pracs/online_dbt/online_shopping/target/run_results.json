{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.9", "generated_at": "2024-03-14T04:11:49.959141Z", "invocation_id": "f2385aae-7670-415d-8044-6acf2e63188e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-14T04:11:42.794380Z", "completed_at": "2024-03-14T04:11:42.804375Z"}, {"name": "execute", "started_at": "2024-03-14T04:11:42.805374Z", "completed_at": "2024-03-14T04:11:49.322517Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.535110950469971, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.online_shopping.customer", "compiled": true, "compiled_code": "\n \nWITH notnunavut AS (\n    SELECT *\n    FROM \"online\".\"dbt_staging\".\"stg_customer\"\n    WHERE region != 'NUNAVUT'\n),\n \njoincustmark AS (\n    SELECT\n        cu.CustomerId,\n        cu.CustomerName,\n        cu.Province,\n        cu.CustomerSegment,\n        ma.Ord,\n        ma.Sales\n    FROM notnunavut as cu\n    JOIN \"online\".\"dbt_staging\".\"stg_market\" as ma ON cu.CustomerId = ma.CustomerId\n),\n \njoincustorder AS (\n    SELECT\n        cus.CustomerId,\n        cus.CustomerName,\n        cus.Province,\n        cus.CustomerSegment,\n        ord.OrdID,\n        cus.Sales,\n        ord.OrderDate\n    FROM joincustmark as cus\n    JOIN \"online\".\"dbt_staging\".\"stg_order\" as ord ON cus.Ord = ord.OrdID\n),\n \nfinalcustorder AS (\n    SELECT\n        CustomerId,\n        CustomerName,\n        Province,\n        CustomerSegment,\n        MIN(OrderDate) AS FirstOrderDate,\n        MAX(OrderDate) AS RecentOrderDate,\n        COUNT(OrdId) AS TotalOrders,\n        SUM(cast(Sales as DECIMAL(10,5))) AS TotalAmount\n    FROM joincustorder\n    GROUP BY CustomerId, CustomerName, Province, CustomerSegment\n)\n \nSELECT * FROM finalcustorder", "relation_name": "\"online\".\"dbt_mart\".\"customer\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-14T04:11:49.334485Z", "completed_at": "2024-03-14T04:11:49.341482Z"}, {"name": "execute", "started_at": "2024-03-14T04:11:49.343483Z", "completed_at": "2024-03-14T04:11:49.723402Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.39191460609436035, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.online_shopping.market", "compiled": true, "compiled_code": "\n \nWITH\nCustomers AS (\n    SELECT\n        *\n    FROM \"online\".\"dbt_staging\".\"stg_customer\"\n),\n \nProducts AS (\n    SELECT\n        *\n    FROM \"online\".\"dbt_staging\".\"stg_product\"\n),\n \nMarkets AS (\n    SELECT\n        *\n    FROM \"online\".\"dbt_staging\".\"stg_market\"\n),\n \nNotNunavut AS (\n    SELECT\n        cu.*\n    FROM customers as cu\n    WHERE UPPER(cu.Region) != 'NUNAVUT'\n),\n \nfinal AS (\n    SELECT nn.*, pro.ProductCategory, pro.ProductSubCategory from\n    NotNunavut as nn\n    JOIN markets as mark\n    on nn.CustomerID=mark.CustomerId\n    join products as pro\n    on mark.ProductID=pro.ProductId\n)\n \nselect * from final", "relation_name": "\"online\".\"dbt_mart\".\"market\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-14T04:11:49.730402Z", "completed_at": "2024-03-14T04:11:49.737382Z"}, {"name": "execute", "started_at": "2024-03-14T04:11:49.738380Z", "completed_at": "2024-03-14T04:11:49.950160Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.22276043891906738, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.online_shopping.orders", "compiled": true, "compiled_code": "\n \nWITH\nCustomers AS (\n    SELECT\n        *\n    FROM \"online\".\"dbt_staging\".\"stg_customer\"\n    WHERE Region != 'NUNAVUT'\n),\n \nProducts AS (\n    SELECT\n        *\n    FROM \"online\".\"dbt_staging\".\"stg_product\"\n),\n \nMarkets AS (\n    SELECT\n        *\n    FROM \"online\".\"dbt_staging\".\"stg_market\"\n),\nOrders AS (\n    SELECT\n        *\n    FROM \"online\".\"dbt_staging\".\"stg_order\"\n),\nShippings AS (\n    SELECT\n        *\n    FROM \"online\".\"dbt_staging\".\"stg_shipping\"\n),\n \ncustmarket as (\n    select cu.*,mark.Sales,mark.OrderQuantity,mark.Profit,mark.ShippingCost, mark.Ord, mark.ProductID, mark.ShipID\n    from Customers as cu\n    JOIN Markets as mark\n    on cu.CustomerID=mark.CustomerId\n),\ncustmarkord as (\n    select cm.*,o.OrderID,o.OrderDate,o.Order_Priority\n    from custmarket as cm\n    JOIN Orders as o\n    on cm.Ord = o.OrdID\n),\n\ncustmarkordprod as (\n    select cmo.*,pr.ProductSubCategory\n    from custmarkord as cmo\n    JOIN products as pr\n    on cmo.ProductID=pr.ProductID\n),\ncustmarkordprodship as (\n    select cmop.*,sh.ShipDate,sh.ShipMode\n    from custmarkordprod as cmop\n    JOIN shippings as sh\n    on cmop.ShipID=sh.ShipID\n)\n\nSELECT * FROM custmarkordprodship", "relation_name": "\"online\".\"dbt_mart\".\"orders\""}], "elapsed_time": 7.404503107070923, "args": {"version_check": true, "write_json": true, "partial_parse": true, "strict_mode": false, "send_anonymous_usage_stats": true, "use_colors_file": true, "introspect": true, "log_format_file": "debug", "exclude": [], "partial_parse_file_diff": true, "warn_error_options": {"include": [], "exclude": []}, "show_resource_report": false, "project_dir": "C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping", "quiet": false, "static_parser": true, "macro_debugging": false, "printer_width": 80, "invocation_command": "dbt run --select tag:mart --select tag:orders", "print": true, "log_file_max_bytes": 10485760, "log_path": "C:\\Users\\NadimintiDeepthi\\Desktop\\online_dbt\\online_shopping\\logs", "vars": {}, "cache_selected_only": false, "use_colors": true, "profiles_dir": "C:\\Users\\NadimintiDeepthi\\.dbt", "enable_legacy_logger": false, "log_level": "info", "which": "run", "populate_cache": true, "defer": false, "indirect_selection": "eager", "log_level_file": "debug", "log_format": "default", "select": ["tag:mart", "tag:orders"], "favor_state": false}}